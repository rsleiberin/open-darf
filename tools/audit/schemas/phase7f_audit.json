{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Phase 7F Audit Envelope",
  "type": "object",
  "properties": {
    "phase": { "type": "string", "enum": ["7F"] },
    "provenance": {
      "type": "object",
      "properties": {
        "agent": { "type": "string" },
        "activity": { "type": "string" },
        "entity": { "type": "string" },
        "bundle": { "type": "string" }
      },
      "required": ["agent","activity","entity"]
    },
    "constitutional": {
      "type": "object",
      "properties": {
        "decisions": {
          "type": "array",
          "items": { "type": "string", "enum": ["ALLOW","DENY","INDETERMINATE"] }
        }
      },
      "required": ["decisions"]
    },
    "propagation": {
      "type": "object",
      "properties": {
        "p95_ms": { "type": "number", "minimum": 0 }
      },
      "required": ["p95_ms"]
    },
    "revocation": {
      "type": "object",
      "properties": {
        "scope": {
          "type": "array",
          "items": { "type": "string" }
        },
        "cycle_detected": { "type": "boolean" }
      },
      "required": ["scope"]
    }
  },
  "required": ["phase","provenance","constitutional","propagation","revocation"]
}
