{"coref": {"Cityscapes": [[191, 192], [915, 916], [4969, 4970], [4990, 4991], [5021, 5022], [5187, 5188], [5580, 5581], [5647, 5648], [6028, 6029], [6068, 6069], [6417, 6418], [6424, 6425], [6464, 6465], [6566, 6567], [6956, 6957], [5539, 5540], [5952, 5953], [6240, 6241], [6383, 6384]], "Mapillary": [], "Mean_IoU": [], "Semantic_Segmentation": [[347, 349], [447, 449], [588, 590], [908, 910], [4028, 4030], [4574, 4576], [4903, 4905], [4908, 4910], [4929, 4930], [5785, 5787], [6953, 6955], [180, 182], [802, 804]]}, "coref_non_salient": {"0": [[285, 289], [486, 487], [1177, 1178], [4211, 4213], [4394, 4395]], "1": [[1286, 1291], [1917, 1920], [6451, 6453]], "10": [[247, 250], [378, 380]], "100": [[1450, 1454]], "101": [[6653, 6656]], "102": [[6557, 6561]], "103": [[6737, 6740]], "104": [[482, 485], [1412, 1415], [1812, 1814]], "105": [[1678, 1681]], "106": [[332, 335]], "107": [[3337, 3339]], "108": [[1053, 1056]], "109": [[714, 716]], "11": [[494, 495], [4728, 4731], [4739, 4742]], "110": [[6525, 6529]], "111": [[323, 325]], "112": [[5008, 5010]], "113": [[273, 281]], "114": [[6570, 6572]], "115": [[1102, 1103]], "116": [[6320, 6322]], "117": [[5015, 5017]], "118": [[3192, 3194]], "119": [[253, 255]], "12": [[2816, 2818], [3070, 3072], [3099, 3101], [3176, 3178], [3241, 3243], [3261, 3263], [4148, 4150], [4471, 4473], [4496, 4501], [5703, 5706]], "120": [[490, 493]], "121": [[1389, 1392]], "122": [[455, 457]], "123": [[1026, 1029]], "124": [[1077, 1078]], "125": [[946, 949]], "126": [[1520, 1524]], "127": [[1295, 1299]], "128": [[1529, 1530]], "129": [[474, 475]], "13": [[1336, 1338], [2743, 2745], [7040, 7042], [7079, 7080]], "130": [[5974, 5975]], "131": [[4223, 4227]], "132": [[1038, 1040]], "133": [[4064, 4067]], "134": [[5475, 5477]], "135": [[4340, 4341]], "136": [[3188, 3191]], "137": [[2525, 2527]], "138": [[842, 844]], "139": [[3444, 3447]], "14": [[123, 125], [636, 638], [688, 690], [6787, 6789]], "140": [[6, 7]], "141": [[1456, 1458]], "142": [[7035, 7039]], "143": [[4897, 4900]], "144": [[5598, 5599]], "145": [[526, 530]], "146": [[6552, 6555]], "147": [[872, 873]], "148": [[1105, 1106]], "149": [[5553, 5557]], "15": [[5139, 5142], [5520, 5522]], "150": [[3778, 3782]], "151": [[470, 473]], "152": [[6419, 6420]], "153": [[2558, 2560]], "154": [[1171, 1172], [6589, 6591]], "155": [[5296, 5298]], "156": [[5604, 5607]], "157": [[4327, 4329]], "158": [[848, 851]], "159": [[7083, 7085]], "16": [[4826, 4827], [5690, 5697], [5934, 5941], [6104, 6111], [6143, 6144], [6194, 6197]], "160": [[6281, 6285]], "161": [[4386, 4389]], "162": [[2873, 2879]], "163": [[342, 346]], "164": [[3930, 3932]], "165": [[72, 75]], "166": [[2251, 2253]], "167": [[3213, 3217]], "17": [[8, 14], [6830, 6833]], "18": [[1423, 1425], [2248, 2249], [2535, 2537]], "19": [[965, 966], [1303, 1304]], "2": [[693, 696], [731, 735], [819, 826], [3005, 3009], [3706, 3711], [3934, 3938], [3939, 3943], [4015, 4021], [4117, 4120], [4612, 4615], [4888, 4891], [5461, 5465], [5682, 5685], [6666, 6670], [6810, 6813]], "20": [[4464, 4466], [5157, 5158], [5273, 5274]], "21": [[1762, 1764], [5997, 6001]], "22": [[488, 489], [3255, 3256], [4196, 4199], [4475, 4478], [4626, 4629], [4783, 4786], [4816, 4819], [6137, 6140], [6731, 6734], [4701, 4704], [5769, 5772]], "23": [[569, 572], [6853, 6855]], "24": [[193, 195], [917, 919], [936, 938], [4978, 4980], [4996, 4998], [5217, 5219], [6030, 6032], [6468, 6469], [6962, 6964], [6403, 6405], [6997, 6999]], "25": [[26, 29], [875, 878], [6595, 6598], [7119, 7123]], "26": [[5590, 5591], [6025, 6027]], "27": [[5723, 5726], [6249, 6251]], "28": [[2813, 2815], [3047, 3050]], "29": [[969, 970], [3712, 3713], [6691, 6692]], "3": [[2833, 2835], [5018, 5020]], "30": [[5306, 5309], [5325, 5326]], "31": [[81, 84], [408, 411], [756, 759], [961, 964], [1064, 1067], [2027, 2030], [2358, 2361], [6934, 6937]], "32": [[1819, 1820], [2793, 2794], [2828, 2829], [3086, 3087], [3139, 3140], [3239, 3240], [4469, 4470], [4480, 4481]], "33": [[6368, 6372]], "34": [[38, 41], [421, 423], [578, 580], [2329, 2331]], "35": [[6121, 6124], [6506, 6508]], "36": [[598, 599], [1398, 1400], [1481, 1483], [4422, 4423]], "37": [[133, 135], [6672, 6674]], "38": [[67, 69], [745, 749]], "39": [[708, 709], [979, 980], [2168, 2169], [2342, 2343], [2362, 2363], [2372, 2374], [3690, 3691], [6794, 6795]], "4": [[972, 975], [1727, 1730], [1735, 1738], [2595, 2599]], "40": [[646, 650], [859, 863]], "41": [[1696, 1698], [3529, 3531]], "42": [[2801, 2803], [3052, 3054], [3124, 3126], [3144, 3146]], "43": [[464, 466], [1374, 1376], [1377, 1379], [1683, 1685], [1751, 1753], [2587, 2590], [2859, 2862], [3722, 3724], [4631, 4633], [4820, 4823], [517, 519], [1344, 1346], [1512, 1514], [3029, 3031], [6823, 6825], [7090, 7092]], "44": [[1805, 1806]], "45": [[7027, 7029]], "46": [[2118, 2120], [5317, 5319], [5789, 5791]], "47": [[2104, 2105], [2299, 2300], [6763, 6764]], "48": [[1440, 1446], [2256, 2262], [2480, 2486], [2903, 2909]], "49": [[1624, 1626], [4347, 4349], [4367, 4369], [4448, 4450], [5549, 5551], [5918, 5920], [6488, 6490]], "5": [[4948, 4953], [5468, 5470]], "50": [[429, 431], [4673, 4675]], "51": [[503, 504], [4882, 4883]], "52": [[6520, 6523]], "53": [[425, 427], [5963, 5966]], "54": [[6581, 6584]], "55": [[150, 152], [444, 446], [779, 781], [884, 886], [4025, 4027], [4096, 4098], [4124, 4126], [6946, 6948]], "56": [[7056, 7057]], "57": [[6949, 6952]], "58": [[7030, 7034]], "59": [[4319, 4326]], "6": [[5610, 5613], [5808, 5811]], "60": [[1722, 1724]], "61": [[1253, 1255]], "62": [[5805, 5807]], "63": [[4200, 4203], [4724, 4727], [4735, 4738], [4804, 4807], [6083, 6086]], "64": [[4178, 4180], [4617, 4619], [4794, 4795], [4859, 4860]], "65": [[4343, 4345]], "66": [[496, 502], [4892, 4896]], "67": [[5493, 5496]], "68": [[4102, 4108]], "69": [[4935, 4937]], "7": [[160, 163], [782, 783], [887, 890], [3259, 3260], [4109, 4112], [4939, 4940], [5795, 5798]], "70": [[19, 25], [1314, 1317]], "71": [[2020, 2022], [2376, 2379]], "72": [[144, 145], [512, 513], [3678, 3680]], "73": [[6894, 6896]], "74": [[1791, 1792], [2098, 2099], [4240, 4241]], "75": [[5508, 5511], [6546, 6549]], "76": [[5147, 5149], [5182, 5183]], "77": [[6150, 6159]], "78": [[4530, 4536]], "79": [[619, 621], [1050, 1052], [1361, 1363], [2205, 2207], [2334, 2336], [3184, 3186], [6629, 6631], [6881, 6883]], "8": [[336, 339], [4842, 4844], [5011, 5012]], "80": [[4975, 4977]], "81": [[6688, 6690]], "82": [[5328, 5333]], "83": [[6918, 6922]], "84": [[967, 968]], "85": [[1079, 1080]], "86": [[7008, 7011]], "87": [[1043, 1045]], "88": [[43, 46], [438, 441], [1167, 1169], [1393, 1395], [6835, 6838]], "89": [[1069, 1071]], "9": [[239, 243], [1137, 1140]], "90": [[58, 64]], "91": [[950, 953]], "92": [[5600, 5602]], "93": [[6365, 6367]], "94": [[187, 190], [911, 914], [4971, 4974], [4992, 4995], [5124, 5127], [5649, 5652], [5977, 5980], [6958, 6961], [5560, 5563]], "95": [[4336, 4339], [5594, 5597]], "96": [[5201, 5203]], "97": [[5067, 5068]], "98": [[592, 594]], "99": [[467, 468], [1404, 1405], [1608, 1609], [1719, 1720], [2312, 2313], [2431, 2432], [2561, 2562], [3570, 3571], [4757, 4758], [607, 608], [663, 664], [835, 836], [867, 868], [1581, 1582], [1632, 1633], [1691, 1692], [1785, 1786], [1964, 1965], [2040, 2041], [2216, 2217], [2466, 2467], [2547, 2548], [2717, 2718], [2768, 2769], [3279, 3280], [3293, 3294], [3310, 3311], [3326, 3327], [3611, 3612], [3770, 3771], [3920, 3921], [4849, 4850], [5437, 5438], [5654, 5655], [5662, 5663], [5668, 5669], [5680, 5681], [6619, 6620], [6874, 6875], [6914, 6915]]}, "doc_id": "325093f2c5b33d7507c10aa422e96aa5b10a33f1", "method_subrelations": {"Mapillary": [[[0, 9], "Mapillary"]]}, "n_ary_relations": [{"Material": "Cityscapes", "Method": "Mapillary", "Metric": "Mean_IoU", "Task": "Semantic_Segmentation", "score": "82.0%"}], "ner": [[6, 7, "Method"], [8, 14, "Task"], [19, 25, "Task"], [26, 29, "Task"], [38, 41, "Metric"], [43, 46, "Method"], [58, 64, "Method"], [67, 69, "Method"], [72, 75, "Method"], [81, 84, "Method"], [123, 125, "Metric"], [133, 135, "Method"], [144, 145, "Method"], [150, 152, "Task"], [160, 163, "Material"], [187, 190, "Material"], [191, 192, "Material"], [193, 195, "Material"], [239, 243, "Method"], [247, 250, "Method"], [253, 255, "Method"], [273, 281, "Task"], [285, 289, "Method"], [323, 325, "Method"], [332, 335, "Metric"], [336, 339, "Metric"], [342, 346, "Task"], [347, 349, "Task"], [378, 380, "Method"], [408, 411, "Method"], [421, 423, "Metric"], [425, 427, "Method"], [429, 431, "Method"], [438, 441, "Method"], [444, 446, "Task"], [447, 449, "Task"], [455, 457, "Method"], [464, 466, "Method"], [467, 468, "Method"], [470, 473, "Method"], [474, 475, "Method"], [482, 485, "Method"], [486, 487, "Method"], [488, 489, "Method"], [490, 493, "Method"], [494, 495, "Method"], [496, 502, "Method"], [503, 504, "Method"], [512, 513, "Method"], [526, 530, "Task"], [569, 572, "Method"], [578, 580, "Metric"], [588, 590, "Task"], [592, 594, "Metric"], [598, 599, "Task"], [619, 621, "Metric"], [636, 638, "Metric"], [646, 650, "Method"], [688, 690, "Metric"], [693, 696, "Method"], [708, 709, "Method"], [714, 716, "Metric"], [731, 735, "Method"], [745, 749, "Method"], [756, 759, "Method"], [779, 781, "Task"], [782, 783, "Material"], [819, 826, "Method"], [842, 844, "Metric"], [848, 851, "Method"], [859, 863, "Method"], [872, 873, "Method"], [875, 878, "Task"], [884, 886, "Task"], [887, 890, "Material"], [908, 910, "Task"], [911, 914, "Material"], [915, 916, "Material"], [917, 919, "Material"], [936, 938, "Material"], [946, 949, "Task"], [950, 953, "Task"], [961, 964, "Method"], [965, 966, "Method"], [967, 968, "Method"], [969, 970, "Method"], [972, 975, "Method"], [979, 980, "Method"], [1026, 1029, "Task"], [1038, 1040, "Method"], [1043, 1045, "Method"], [1050, 1052, "Metric"], [1053, 1056, "Task"], [1064, 1067, "Method"], [1069, 1071, "Method"], [1077, 1078, "Method"], [1079, 1080, "Method"], [1102, 1103, "Method"], [1105, 1106, "Metric"], [1137, 1140, "Method"], [1167, 1169, "Method"], [1171, 1172, "Metric"], [1177, 1178, "Method"], [1253, 1255, "Method"], [1286, 1291, "Metric"], [1295, 1299, "Task"], [1303, 1304, "Method"], [1314, 1317, "Task"], [1336, 1338, "Task"], [1361, 1363, "Metric"], [1374, 1376, "Method"], [1377, 1379, "Method"], [1389, 1392, "Task"], [1393, 1395, "Method"], [1398, 1400, "Task"], [1404, 1405, "Method"], [1412, 1415, "Method"], [1423, 1425, "Method"], [1440, 1446, "Method"], [1450, 1454, "Method"], [1456, 1458, "Method"], [1481, 1483, "Task"], [1520, 1524, "Method"], [1529, 1530, "Method"], [1608, 1609, "Method"], [1624, 1626, "Metric"], [1678, 1681, "Task"], [1683, 1685, "Method"], [1696, 1698, "Method"], [1719, 1720, "Method"], [1722, 1724, "Method"], [1727, 1730, "Method"], [1735, 1738, "Method"], [1751, 1753, "Method"], [1762, 1764, "Method"], [1791, 1792, "Method"], [1805, 1806, "Task"], [1812, 1814, "Method"], [1819, 1820, "Method"], [1917, 1920, "Metric"], [2020, 2022, "Method"], [2027, 2030, "Method"], [2098, 2099, "Method"], [2104, 2105, "Task"], [2118, 2120, "Method"], [2168, 2169, "Method"], [2205, 2207, "Metric"], [2248, 2249, "Method"], [2251, 2253, "Method"], [2256, 2262, "Method"], [2299, 2300, "Task"], [2312, 2313, "Method"], [2329, 2331, "Metric"], [2334, 2336, "Metric"], [2342, 2343, "Method"], [2358, 2361, "Method"], [2362, 2363, "Method"], [2372, 2374, "Method"], [2376, 2379, "Method"], [2431, 2432, "Method"], [2480, 2486, "Method"], [2525, 2527, "Task"], [2535, 2537, "Method"], [2558, 2560, "Method"], [2561, 2562, "Method"], [2587, 2590, "Method"], [2595, 2599, "Method"], [2743, 2745, "Task"], [2793, 2794, "Method"], [2801, 2803, "Method"], [2813, 2815, "Method"], [2816, 2818, "Method"], [2828, 2829, "Method"], [2833, 2835, "Metric"], [2859, 2862, "Method"], [2873, 2879, "Method"], [2903, 2909, "Method"], [3005, 3009, "Method"], [3047, 3050, "Method"], [3052, 3054, "Method"], [3070, 3072, "Method"], [3086, 3087, "Method"], [3099, 3101, "Method"], [3124, 3126, "Method"], [3139, 3140, "Method"], [3144, 3146, "Method"], [3176, 3178, "Method"], [3184, 3186, "Metric"], [3188, 3191, "Method"], [3192, 3194, "Method"], [3213, 3217, "Method"], [3239, 3240, "Method"], [3241, 3243, "Method"], [3255, 3256, "Method"], [3259, 3260, "Material"], [3261, 3263, "Method"], [3337, 3339, "Method"], [3444, 3447, "Task"], [3529, 3531, "Method"], [3570, 3571, "Method"], [3678, 3680, "Method"], [3690, 3691, "Method"], [3706, 3711, "Method"], [3712, 3713, "Method"], [3722, 3724, "Method"], [3778, 3782, "Method"], [3930, 3932, "Task"], [3934, 3938, "Method"], [3939, 3943, "Method"], [4015, 4021, "Method"], [4025, 4027, "Task"], [4028, 4030, "Task"], [4064, 4067, "Method"], [4096, 4098, "Task"], [4102, 4108, "Method"], [4109, 4112, "Material"], [4117, 4120, "Method"], [4124, 4126, "Task"], [4148, 4150, "Method"], [4178, 4180, "Metric"], [4196, 4199, "Method"], [4200, 4203, "Method"], [4211, 4213, "Method"], [4223, 4227, "Method"], [4240, 4241, "Method"], [4319, 4326, "Method"], [4327, 4329, "Method"], [4336, 4339, "Method"], [4340, 4341, "Method"], [4343, 4345, "Method"], [4347, 4349, "Metric"], [4367, 4369, "Metric"], [4386, 4389, "Method"], [4394, 4395, "Method"], [4422, 4423, "Task"], [4448, 4450, "Metric"], [4464, 4466, "Metric"], [4469, 4470, "Method"], [4471, 4473, "Method"], [4475, 4478, "Method"], [4480, 4481, "Method"], [4496, 4501, "Method"], [4530, 4536, "Metric"], [4574, 4576, "Task"], [4612, 4615, "Method"], [4617, 4619, "Metric"], [4626, 4629, "Method"], [4631, 4633, "Method"], [4673, 4675, "Method"], [4724, 4727, "Method"], [4728, 4731, "Method"], [4735, 4738, "Method"], [4739, 4742, "Method"], [4757, 4758, "Method"], [4783, 4786, "Method"], [4794, 4795, "Metric"], [4816, 4819, "Method"], [4820, 4823, "Method"], [4826, 4827, "Method"], [4842, 4844, "Metric"], [4859, 4860, "Metric"], [4882, 4883, "Method"], [4888, 4891, "Method"], [4892, 4896, "Method"], [4897, 4900, "Method"], [4903, 4905, "Task"], [4908, 4910, "Task"], [4929, 4930, "Task"], [4935, 4937, "Method"], [4939, 4940, "Material"], [4948, 4953, "Method"], [4969, 4970, "Material"], [4971, 4974, "Material"], [4975, 4977, "Material"], [4978, 4980, "Material"], [4990, 4991, "Material"], [4992, 4995, "Material"], [4996, 4998, "Material"], [5008, 5010, "Metric"], [5011, 5012, "Metric"], [5015, 5017, "Metric"], [5018, 5020, "Metric"], [5021, 5022, "Material"], [5067, 5068, "Task"], [5124, 5127, "Material"], [5139, 5142, "Material"], [5147, 5149, "Material"], [5157, 5158, "Metric"], [5182, 5183, "Material"], [5187, 5188, "Material"], [5201, 5203, "Method"], [5217, 5219, "Material"], [5273, 5274, "Metric"], [5296, 5298, "Method"], [5306, 5309, "Method"], [5317, 5319, "Method"], [5325, 5326, "Method"], [5328, 5333, "Method"], [5461, 5465, "Method"], [5468, 5470, "Method"], [5475, 5477, "Method"], [5493, 5496, "Method"], [5508, 5511, "Method"], [5520, 5522, "Material"], [5549, 5551, "Metric"], [5553, 5557, "Metric"], [5580, 5581, "Material"], [5590, 5591, "Task"], [5594, 5597, "Method"], [5598, 5599, "Method"], [5600, 5602, "Method"], [5604, 5607, "Task"], [5610, 5613, "Method"], [5647, 5648, "Material"], [5649, 5652, "Material"], [5682, 5685, "Method"], [5690, 5697, "Method"], [5703, 5706, "Method"], [5723, 5726, "Metric"], [5785, 5787, "Task"], [5789, 5791, "Method"], [5795, 5798, "Material"], [5805, 5807, "Method"], [5808, 5811, "Method"], [5918, 5920, "Metric"], [5934, 5941, "Method"], [5963, 5966, "Method"], [5974, 5975, "Method"], [5977, 5980, "Material"], [5997, 6001, "Method"], [6025, 6027, "Task"], [6028, 6029, "Material"], [6030, 6032, "Material"], [6068, 6069, "Material"], [6104, 6111, "Method"], [6121, 6124, "Metric"], [6137, 6140, "Method"], [6143, 6144, "Method"], [6150, 6159, "Task"], [6194, 6197, "Method"], [6249, 6251, "Metric"], [6281, 6285, "Method"], [6320, 6322, "Method"], [6365, 6367, "Method"], [6368, 6372, "Method"], [6417, 6418, "Material"], [6419, 6420, "Method"], [6424, 6425, "Material"], [6451, 6453, "Metric"], [6464, 6465, "Material"], [6468, 6469, "Material"], [6488, 6490, "Metric"], [6506, 6508, "Metric"], [6520, 6523, "Method"], [6525, 6529, "Method"], [6546, 6549, "Method"], [6552, 6555, "Method"], [6557, 6561, "Task"], [6566, 6567, "Material"], [6570, 6572, "Task"], [6581, 6584, "Task"], [6589, 6591, "Metric"], [6595, 6598, "Task"], [6629, 6631, "Metric"], [6653, 6656, "Task"], [6666, 6670, "Method"], [6672, 6674, "Method"], [6688, 6690, "Method"], [6691, 6692, "Method"], [6731, 6734, "Method"], [6737, 6740, "Method"], [6763, 6764, "Task"], [6787, 6789, "Metric"], [6794, 6795, "Method"], [6810, 6813, "Method"], [6830, 6833, "Task"], [6835, 6838, "Method"], [6853, 6855, "Method"], [6881, 6883, "Metric"], [6894, 6896, "Method"], [6918, 6922, "Method"], [6934, 6937, "Method"], [6946, 6948, "Task"], [6949, 6952, "Task"], [6953, 6955, "Task"], [6956, 6957, "Material"], [6958, 6961, "Material"], [6962, 6964, "Material"], [7008, 7011, "Task"], [7027, 7029, "Task"], [7030, 7034, "Task"], [7035, 7039, "Task"], [7040, 7042, "Task"], [7056, 7057, "Method"], [7079, 7080, "Task"], [7083, 7085, "Method"], [7119, 7123, "Task"], [180, 182, "Task"], [517, 519, "Method"], [607, 608, "Method"], [663, 664, "Method"], [802, 804, "Task"], [835, 836, "Method"], [867, 868, "Method"], [1344, 1346, "Method"], [1512, 1514, "Method"], [1581, 1582, "Method"], [1632, 1633, "Method"], [1691, 1692, "Method"], [1785, 1786, "Method"], [1964, 1965, "Method"], [2040, 2041, "Method"], [2216, 2217, "Method"], [2466, 2467, "Method"], [2547, 2548, "Method"], [2717, 2718, "Method"], [2768, 2769, "Method"], [3029, 3031, "Method"], [3279, 3280, "Method"], [3293, 3294, "Method"], [3310, 3311, "Method"], [3326, 3327, "Method"], [3611, 3612, "Method"], [3770, 3771, "Method"], [3920, 3921, "Method"], [4701, 4704, "Method"], [4804, 4807, "Method"], [4849, 4850, "Method"], [5437, 5438, "Method"], [5539, 5540, "Material"], [5560, 5563, "Material"], [5654, 5655, "Method"], [5662, 5663, "Method"], [5668, 5669, "Method"], [5680, 5681, "Method"], [5769, 5772, "Method"], [5952, 5953, "Material"], [6083, 6086, "Method"], [6240, 6241, "Material"], [6383, 6384, "Material"], [6403, 6405, "Material"], [6619, 6620, "Method"], [6823, 6825, "Method"], [6874, 6875, "Method"], [6914, 6915, "Method"], [6997, 6999, "Material"], [7090, 7092, "Method"]], "sections": [[0, 233], [233, 939], [939, 1309], [1309, 1372], [1372, 1725], [1725, 2983], [2983, 3697], [3697, 4004], [4004, 4094], [4094, 4901], [4901, 6568], [6568, 6801], [6801, 7073], [7073, 7144]], "sentences": [[0, 14], [14, 30], [30, 52], [52, 85], [85, 126], [126, 146], [146, 173], [173, 224], [224, 230], [230, 233], [233, 236], [236, 262], [262, 294], [294, 340], [340, 369], [369, 412], [412, 450], [450, 506], [506, 551], [551, 573], [573, 611], [611, 639], [639, 666], [666, 697], [697, 760], [760, 805], [805, 852], [852, 879], [879, 884], [884, 939], [939, 943], [943, 960], [960, 976], [976, 1014], [1014, 1032], [1032, 1062], [1062, 1094], [1094, 1114], [1114, 1136], [1136, 1173], [1173, 1196], [1196, 1219], [1219, 1228], [1228, 1250], [1250, 1280], [1280, 1303], [1303, 1309], [1309, 1317], [1317, 1348], [1348, 1372], [1372, 1377], [1377, 1401], [1401, 1416], [1416, 1455], [1455, 1467], [1467, 1484], [1484, 1511], [1511, 1607], [1607, 1627], [1627, 1646], [1646, 1675], [1675, 1711], [1711, 1725], [1725, 1730], [1730, 1765], [1765, 1807], [1807, 1815], [1815, 1825], [1825, 1847], [1847, 1860], [1860, 1881], [1881, 1921], [1921, 1927], [1927, 1947], [1947, 1968], [1968, 1984], [1984, 2005], [2005, 2007], [2007, 2031], [2031, 2057], [2057, 2104], [2104, 2108], [2108, 2128], [2128, 2147], [2147, 2175], [2175, 2202], [2202, 2221], [2221, 2263], [2263, 2281], [2281, 2293], [2293, 2314], [2314, 2362], [2362, 2368], [2368, 2407], [2407, 2416], [2416, 2439], [2439, 2469], [2469, 2500], [2500, 2528], [2528, 2554], [2554, 2584], [2584, 2587], [2587, 2630], [2630, 2667], [2667, 2727], [2727, 2748], [2748, 2771], [2771, 2785], [2785, 2836], [2836, 2856], [2856, 2864], [2864, 2879], [2879, 2896], [2896, 2915], [2915, 2955], [2955, 2983], [2983, 2987], [2987, 3047], [3047, 3051], [3051, 3092], [3092, 3120], [3120, 3150], [3150, 3195], [3195, 3231], [3231, 3271], [3271, 3274], [3274, 3281], [3281, 3340], [3340, 3363], [3363, 3382], [3382, 3407], [3407, 3413], [3413, 3420], [3420, 3444], [3444, 3450], [3450, 3467], [3467, 3492], [3492, 3533], [3533, 3562], [3562, 3567], [3567, 3572], [3572, 3595], [3595, 3634], [3634, 3645], [3645, 3676], [3676, 3697], [3697, 3701], [3701, 3732], [3732, 3756], [3756, 3777], [3777, 3797], [3797, 3821], [3821, 3843], [3843, 3891], [3891, 3925], [3925, 3946], [3946, 3949], [3949, 3962], [3962, 3965], [3965, 3977], [3977, 3982], [3982, 3986], [3986, 3994], [3994, 4004], [4004, 4007], [4007, 4042], [4042, 4054], [4054, 4064], [4064, 4076], [4076, 4094], [4094, 4098], [4098, 4127], [4127, 4181], [4181, 4196], [4196, 4204], [4204, 4228], [4228, 4239], [4239, 4246], [4246, 4267], [4267, 4294], [4294, 4315], [4315, 4333], [4333, 4355], [4355, 4375], [4375, 4379], [4379, 4390], [4390, 4421], [4421, 4453], [4453, 4457], [4457, 4482], [4482, 4509], [4509, 4548], [4548, 4596], [4596, 4620], [4620, 4649], [4649, 4689], [4689, 4704], [4704, 4732], [4732, 4759], [4759, 4780], [4780, 4809], [4809, 4852], [4852, 4868], [4868, 4901], [4901, 4905], [4905, 4922], [4922, 4981], [4981, 4986], [4986, 5021], [5021, 5073], [5073, 5119], [5119, 5143], [5143, 5147], [5147, 5182], [5182, 5210], [5210, 5279], [5279, 5296], [5296, 5299], [5299, 5325], [5325, 5362], [5362, 5401], [5401, 5419], [5419, 5457], [5457, 5471], [5471, 5504], [5504, 5520], [5520, 5560], [5560, 5589], [5589, 5603], [5603, 5630], [5630, 5634], [5634, 5658], [5658, 5698], [5698, 5707], [5707, 5765], [5765, 5788], [5788, 5799], [5799, 5825], [5825, 5859], [5859, 5889], [5889, 5909], [5909, 5942], [5942, 5976], [5976, 6005], [6005, 6025], [6025, 6033], [6033, 6064], [6064, 6113], [6113, 6145], [6145, 6186], [6186, 6213], [6213, 6223], [6223, 6264], [6264, 6286], [6286, 6327], [6327, 6363], [6363, 6396], [6396, 6419], [6419, 6454], [6454, 6497], [6497, 6533], [6533, 6568], [6568, 6572], [6572, 6598], [6598, 6616], [6616, 6647], [6647, 6675], [6675, 6693], [6693, 6741], [6741, 6750], [6750, 6778], [6778, 6801], [6801, 6804], [6804, 6842], [6842, 6884], [6884, 6938], [6938, 6965], [6965, 7012], [7012, 7048], [7048, 7050], [7050, 7073], [7073, 7080], [7080, 7118], [7118, 7138], [7138, 7144]], "words": ["document", ":", "In", "-", "Place", "Activated", "BatchNorm", "for", "Memory", "-", "Optimized", "Training", "of", "DNNs", "In", "this", "work", "we", "present", "In", "-", "Place", "Activated", "Batch", "Normalization", "(", "InPlace", "-", "ABN", ")", "\u2013", "a", "novel", "approach", "to", "drastically", "reduce", "the", "training", "memory", "footprint", "of", "modern", "deep", "neural", "networks", "in", "a", "computationally", "efficient", "way", ".", "Our", "solution", "substitutes", "the", "conventionally", "used", "succession", "of", "BatchNorm", "+", "Activation", "layers", "with", "a", "single", "plugin", "layer", ",", "hence", "avoiding", "invasive", "framework", "surgery", "while", "providing", "straightforward", "applicability", "for", "existing", "deep", "learning", "frameworks", ".", "We", "obtain", "memory", "savings", "of", "up", "to", "50", "%", "by", "dropping", "intermediate", "results", "and", "by", "recovering", "required", "information", "during", "the", "backward", "pass", "through", "the", "inversion", "of", "stored", "forward", "results", ",", "with", "only", "minor", "increase", "(", "-", ")", "in", "computation", "time", ".", "Also", ",", "we", "demonstrate", "how", "frequently", "used", "checkpointing", "approaches", "can", "be", "made", "computationally", "as", "efficient", "as", "InPlace", "-", "ABN", ".", "In", "our", "experiments", "on", "image", "classification", ",", "we", "demonstrate", "on", "-", "par", "results", "on", "ImageNet", "-", "1k", "with", "state", "-", "of", "-", "the", "-", "art", "approaches", ".", "On", "the", "memory", "-", "demanding", "task", "of", "semantic", "segmentation", ",", "we", "report", "results", "for", "COCO", "-", "Stuff", ",", "Cityscapes", "and", "Mapillary", "Vistas", ",", "obtaining", "new", "state", "-", "of", "-", "the", "-", "art", "results", "on", "the", "latter", "without", "additional", "training", "data", "but", "in", "a", "single", "-", "scale", "and", "-", "model", "scenario", ".", "Code", "can", "be", "found", "at", ".", "leftmargin=*", ",", "itemsep=0pt", "section", ":", "Introduction", "High", "-", "performance", "computer", "vision", "recognition", "models", "typically", "take", "advantage", "of", "deep", "network", "backbones", ",", "generating", "rich", "feature", "representations", "for", "target", "applications", "to", "operate", "on", ".", "For", "example", ",", "top", "-", "ranked", "architectures", "used", "in", "the", "2017", "LSUN", "or", "MS", "COCO", "segmentation", "/", "detection", "challenges", "are", "predominantly", "based", "on", "ResNet", "/", "ResNeXt", "models", "comprising", ">", "100", "layers", ".", "Obviously", ",", "depth", "/", "width", "of", "networks", "strongly", "correlate", "with", "GPU", "memory", "requirements", "and", "at", "given", "hardware", "memory", "limitations", ",", "trade", "-", "offs", "have", "to", "be", "made", "to", "balance", "feature", "extractor", "performance", "vs.", "application", "-", "specific", "parameters", "like", "network", "output", "resolution", "or", "training", "data", "size", ".", "A", "particularly", "memory", "-", "demanding", "task", "is", "semantic", "segmentation", ",", "where", "one", "has", "to", "compromise", "significantly", "on", "the", "number", "of", "training", "crops", "per", "minibatch", "and", "their", "spatial", "resolution", ".", "In", "fact", ",", "many", "recent", "works", "based", "on", "modern", "backbone", "networks", "have", "to", "set", "the", "training", "batch", "size", "to", "no", "more", "than", "a", "single", "crop", "per", "GPU", ",", "which", "is", "partially", "also", "due", "to", "suboptimal", "memory", "management", "in", "some", "deep", "learning", "frameworks", ".", "In", "this", "work", ",", "we", "focus", "on", "increasing", "the", "memory", "efficiency", "of", "the", "training", "process", "of", "modern", "network", "architectures", "in", "order", "to", "further", "leverage", "performance", "of", "deep", "neural", "networks", "in", "tasks", "like", "image", "classification", "and", "semantic", "segmentation", ".", "We", "introduce", "a", "novel", "and", "unified", "layer", "that", "replaces", "the", "commonly", "used", "succession", "of", "batch", "normalization", "(", "BN", ")", "and", "nonlinear", "activation", "layers", "(", "Act", ")", ",", "which", "are", "integral", "with", "modern", "deep", "learning", "architectures", "like", "ResNet", ",", "ResNeXt", ",", "Inception", "-", "ResNet", ",", "WideResNet", ",", "Squeeze", "-", "and", "-", "Excitation", "Networks", ",", "DenseNet", ",", ".", "Our", "solution", "is", "coined", "InPlace", "-", "ABN", "and", "proposes", "to", "merge", "batch", "normalization", "and", "activation", "layers", "in", "order", "to", "enable", "in", "-", "place", "computation", ",", "using", "only", "a", "single", "memory", "buffer", "for", "storing", "the", "results", "(", "see", "illustration", "in", "Figure", "[", "reference", "]", ")", ".", "During", "the", "backward", "pass", ",", "we", "can", "efficiently", "recover", "all", "required", "quantities", "from", "this", "buffer", "by", "inverting", "the", "forward", "pass", "computations", ".", "Our", "approach", "yields", "a", "theoretical", "memory", "reduction", "of", "up", "to", ",", "and", "our", "experiments", "on", "semantic", "segmentation", "show", "additional", "data", "throughput", "of", "up", "to", "during", "training", ",", "when", "compared", "to", "prevailing", "sequential", "execution", "of", "BN", "+", "Act", ".", "Our", "memory", "gains", "are", "obtained", "without", "introducing", "noticeable", "computational", "overhead", ",", "side", "-", "by", "-", "side", "runtime", "comparisons", "show", "only", "between", "+", "-", "increase", "in", "computation", "time", ".", "As", "additional", "contribution", ",", "we", "review", "the", "checkpointing", "memory", "management", "strategy", "and", "propose", "a", "computationally", "optimized", "application", "of", "this", "idea", "in", "the", "context", "of", "BN", "layers", ".", "This", "optimization", "allows", "us", "to", "drop", "re", "-", "computation", "of", "certain", "quantities", "needed", "during", "the", "backward", "pass", ",", "eventually", "leading", "to", "reduced", "computation", "times", "as", "per", "our", "InPlace", "-", "ABN", ".", "However", ",", "independent", "of", "the", "proposed", "optimized", "application", "of", ",", "conventional", "checkpointing", "in", "general", "suffers", "from", "higher", "implementation", "complexity", "(", "with", "the", "necessity", "to", "invasively", "manipulate", "the", "computation", "graph", ")", ",", "while", "our", "main", "InPlace", "-", "ABN", "contribution", "can", "be", "easily", "implemented", "as", "self", "-", "contained", ",", "standard", "plug", "-", "in", "layer", "and", "therefore", "simply", "integrated", "in", "any", "modern", "deep", "learning", "framework", ".", "Our", "experimental", "evaluations", "demonstrate", "on", "-", "par", "performance", "with", "state", "-", "of", "-", "the", "-", "art", "models", "trained", "for", "image", "classification", "on", "ImageNet", "(", "in", "directly", "comparable", "memory", "settings", ")", ",", "and", "significantly", "improved", "results", "for", "the", "memory", "-", "critical", "application", "of", "semantic", "segmentation", ".", "To", "summarize", ",", "we", "provide", "the", "following", "contributions", ":", "Introduction", "of", "a", "novel", ",", "self", "-", "contained", "InPlace", "-", "ABN", "layer", "that", "enables", "joint", ",", "in", "-", "place", "computation", "of", "BN", "+", "Act", ",", "approximately", "halvening", "the", "memory", "requirements", "during", "training", "of", "modern", "deep", "learning", "models", ".", "A", "computationally", "more", "efficient", "application", "of", "the", "checkpointing", "memory", "management", "strategy", "in", "the", "context", "of", "BN", "layers", ",", "inspired", "by", "optimizations", "used", "for", "InPlace", "-", "ABN", ".", "Experimental", "evaluations", "for", "i", ")", "image", "classification", "on", "ImageNet", "-", "1k", "showing", "approximately", "on", "-", "par", "performance", "with", "state", "-", "of", "-", "the", "-", "art", "models", "and", "ii", ")", "semantic", "segmentation", "on", "COCO", "-", "Stuff", ",", "Cityscapes", "and", "Mapillary", "Vistas", ",", "considerably", "benefiting", "from", "the", "additional", "available", "memory", "and", "generating", "new", "high", "-", "scores", "on", "the", "challenging", "Vistas", "dataset", ".", "section", ":", "Related", "Work", "The", "topic", "of", "optimizing", "memory", "management", "in", "deep", "learning", "frameworks", "is", "typically", "addressed", "at", "different", "levels", ".", "Efficient", "deep", "learning", "frameworks", "like", "TensorFlow", ",", "MxNet", "or", "PyTorch", "follow", "distinct", "memory", "allocation", "strategies", ".", "Among", "them", "is", "checkpointing", ",", "which", "provides", "additional", "memory", "at", "the", "cost", "of", "runtime", "via", "storing", "activation", "buffers", "as", "so", "-", "called", "checkpoints", ",", "from", "where", "required", "quantities", "can", "be", "re", "-", "computed", "during", "the", "backward", "pass", ".", "The", "paper", "in", "describes", "how", "to", "recursively", "apply", "such", "a", "variant", "on", "sub", "-", "graphs", "between", "checkpoints", ".", "In", "this", "is", "further", "optimized", "with", "dynamic", "programming", ",", "where", "a", "storage", "policy", "is", "determined", "that", "minimizes", "the", "computational", "costs", "for", "re", "-", "computation", "at", "a", "fixed", "memory", "budget", ".", "Virtually", "all", "deep", "learning", "frameworks", "based", "on", "NVIDIA", "hardware", "exploit", "low", "-", "level", "functionality", "libraries", "CUDA", "and", "cuDNN", ",", "providing", "GPU", "-", "accelerated", "and", "performance", "-", "optimized", "primitives", "and", "basic", "functionalities", ".", "Another", "line", "of", "research", "has", "focused", "on", "training", "CNNs", "with", "reduced", "precision", "and", "therefore", "smaller", "memory", "-", "footprint", "datatypes", ".", "Such", "works", "include", "(", "partially", ")", "binarized", "weights", "/", "activations", "/", "gradients", ",", "which", "however", "typically", "lead", "to", "degraded", "overall", "performance", ".", "With", "mixed", "precision", "training", ",", "this", "issue", "seems", "to", "be", "overcome", "and", "we", "plan", "to", "exploit", "this", "as", "complementary", "technique", "in", "future", "work", ",", "freeing", "up", "even", "more", "memory", "for", "training", "deep", "networks", "without", "sacrificing", "runtime", ".", "In", "the", "authors", "modify", "ResNet", "in", "a", "way", "to", "contain", "reversible", "residual", "blocks", ",", "residual", "blocks", "whose", "activations", "can", "be", "reconstructed", "backwards", ".", "Backpropagation", "through", "reversible", "blocks", "can", "be", "performed", "without", "having", "stored", "intermediate", "activations", "during", "the", "forward", "pass", ",", "which", "allows", "to", "save", "memory", ".", "However", ",", "the", "cost", "to", "pay", "is", "twofold", ".", "First", ",", "one", "has", "to", "recompute", "each", "residual", "function", "during", "the", "backward", "pass", ",", "thus", "having", "the", "same", "overhead", "as", "checkpointing", ".", "Second", ",", "the", "network", "design", "is", "limited", "to", "using", "blocks", "with", "certain", "restrictions", ",", "reversible", "blocks", "can", "not", "be", "generated", "for", "bottlenecks", "where", "information", "is", "supposed", "to", "be", "discarded", ".", "Finally", ",", "we", "stress", "that", "only", "training", "time", "memory", "-", "efficiency", "is", "targeted", "here", "while", "test", "-", "time", "optimization", "as", "done", "in", "NVIDIAs", "TensorRT", "is", "beyond", "our", "scope", ".", "section", ":", "In", "-", "Place", "Activated", "Batch", "Normalization", "Here", ",", "we", "describe", "our", "contribution", "to", "avoid", "the", "storage", "of", "a", "buffer", "that", "is", "typically", "needed", "for", "the", "gradient", "computation", "during", "the", "backward", "pass", "through", "the", "batch", "normalization", "layer", ".", "As", "opposed", "to", "existing", "approaches", "we", "also", "show", "that", "our", "solution", "minimizes", "the", "computational", "overhead", "we", "have", "to", "trade", "for", "saving", "additional", "memory", ".", "subsection", ":", "Batch", "Normalization", "Review", "Batch", "Normalization", "has", "been", "introduced", "in", "as", "an", "effective", "tool", "to", "reduce", "internal", "covariate", "shift", "in", "deep", "networks", "and", "accelerate", "the", "training", "process", ".", "Ever", "since", ",", "BN", "plays", "a", "key", "role", "in", "most", "modern", "deep", "learning", "architectures", ".", "The", "key", "idea", "consists", "in", "having", "a", "normalization", "layer", "that", "applies", "an", "axis", "-", "aligned", "whitening", "of", "the", "input", "distribution", ",", "followed", "by", "a", "scale", "-", "and", "-", "shift", "operation", "aiming", "at", "preserving", "the", "network", "\u2019s", "representation", "capacity", ".", "The", "whitening", "operation", "exploits", "statistics", "computed", "on", "a", "minibatch", "level", "only", ".", "The", "by", "-", "product", "of", "this", "approximation", "is", "an", "additional", "regularizing", "effect", "for", "the", "training", "process", ".", "In", "details", ",", "we", "can", "fix", "a", "particular", "unit", "in", "the", "network", "and", "let", "be", "the", "set", "of", "values", "takes", "from", "a", "minibatch", "of", "training", "examples", ".", "The", "batch", "normalization", "operation", "applied", "to", "first", "performs", "a", "whitening", "of", "the", "activation", "using", "statistics", "computed", "from", "the", "minibatch", ":", "Here", "is", "a", "small", "constant", "that", "is", "introduced", "to", "prevent", "numerical", "issues", ",", "and", "and", "are", "the", "empirical", "mean", "and", "variance", "of", "the", "activation", "unit", ",", "respectively", ",", "computed", "with", "respect", "to", "the", "minibatch", ",", "The", "whitened", "activations", "are", "then", "scaled", "and", "shifted", "by", "learnable", "parameters", "and", ",", "obtaining", "The", "BN", "transformation", "described", "above", "can", "in", "principle", "be", "applied", "to", "any", "activation", "in", "the", "network", "and", "is", "typically", "adopted", "with", "channel", "-", "specific", "-", "parameters", ".", "Using", "BN", "renders", "training", "resilient", "to", "the", "scale", "of", "parameters", ",", "thus", "enabling", "the", "use", "of", "higher", "learning", "rates", ".", "At", "test", "time", ",", "the", "BN", "statistics", "are", "fixed", "to", "and", ",", "estimated", "from", "the", "entire", "training", "set", ".", "These", "statistics", "are", "typically", "updated", "at", "training", "time", "with", "a", "running", "mean", "over", "the", "respective", "minibatch", "statistics", ",", "but", "could", "also", "be", "recomputed", "before", "starting", "the", "testing", "phase", ".", "Also", ",", "the", "computation", "of", "networks", "trained", "with", "batch", "normalization", "can", "be", "sped", "up", "by", "absorbing", "BN", "parameters", "into", "the", "preceding", "Conv", "layer", ",", "by", "performing", "a", "simple", "update", "of", "the", "convolution", "weights", "and", "biases", ".", "This", "is", "possible", "because", "at", "test", "-", "time", "BN", "becomes", "a", "linear", "operation", ".", "subsection", ":", "Memory", "Optimization", "Strategies", "Here", "we", "sketch", "our", "proposed", "memory", "optimization", "strategies", "after", "introducing", "both", ",", "the", "standard", "(", "memory", "-", "inefficient", ")", "use", "of", "batch", "normalization", "and", "the", "state", "-", "of", "-", "the", "-", "art", "coined", "checkpointing", ".", "In", "Figure", "[", "reference", "]", ",", "we", "provide", "diagrams", "showing", "the", "forward", "and", "backward", "passes", "of", "a", "typical", "building", "block", "BN", "+", "Act", "+", "ConvHaving", "the", "convolution", "at", "the", "end", "of", "the", "block", "is", "not", "strictly", "necessary", ",", "but", "supports", "comprehension", ".", "that", "we", "find", "in", "modern", "deep", "architectures", ".", "The", "activation", "function", "(", "ReLU", ")", "is", "denoted", "by", ".", "Computations", "occurring", "during", "the", "forward", "pass", "are", "shown", "in", "green", "and", "involve", "the", "entire", "minibatch", "(", "we", "omit", "the", "subscript", ")", ".", "Computations", "happening", "during", "the", "backward", "pass", "are", "shown", "in", "cyan", "and", "gray", ".", "The", "gray", "part", "aims", "at", "better", "highlighting", "the", "additional", "computation", "that", "has", "been", "introduced", "to", "compensate", "for", "the", "memory", "savings", ".", "Rectangles", "are", "in", "general", "volatile", "buffers", "holding", "intermediate", "results", ",", "except", "for", "rectangles", "surrounded", "by", "a", "dashed", "frame", ",", "which", "represent", "buffers", "that", "need", "to", "be", "stored", "for", "the", "backward", "pass", "and", "thus", "significantly", "impact", "the", "training", "memory", "footprint", ".", ",", "in", "Figure", "[", "reference", "]", "only", "and", "will", "be", "stored", "for", "the", "backward", "pass", ",", "while", "in", "Figure", "[", "reference", "]", "only", "is", "stored", ".", "For", "the", "sake", "of", "presentation", "clarity", ",", "we", "have", "omitted", "two", "additional", "buffers", "holding", "and", "for", "the", "BN", "backward", "phase", ".", "Nevertheless", ",", "these", "buffers", "represent", "in", "general", "a", "small", "fraction", "of", "the", "total", "allocated", "memory", ".", "Moreover", ",", "we", "have", "also", "omitted", "the", "gradients", "with", "respect", "to", "the", "model", "parameters", "(", ",", "and", "Conv", "weights", ")", ".", "Standard", ".", "In", "Figure", "[", "reference", "]", "we", "present", "the", "standard", "implementation", "of", "the", "reference", "building", "block", ",", "as", "used", "in", "all", "deep", "learning", "frameworks", ".", "During", "the", "forward", "pass", "both", ",", "the", "input", "to", "BN", "and", "the", "output", "of", "the", "activation", "function", "need", "to", "be", "stored", "for", "the", "backward", "pass", ".", "Variable", "is", "used", "during", "the", "backward", "pass", "through", "to", "compute", "both", "the", "gradient", "its", "input", "and", ",", "and", "where", "denotes", "the", "loss", ",", "while", "is", "required", "for", "the", "backward", "pass", "through", "the", "activation", "as", "well", "as", "potential", "subsequent", "operations", "like", "the", "convolution", "shown", "in", "the", "figure", ".", "Checkpointing", "[", "]", ".", "This", "technique", "allows", "to", "trade", "computation", "for", "memory", "when", "training", "neural", "networks", ",", "applicable", "in", "a", "very", "broad", "setting", ".", "In", "Figure", "[", "reference", "]", ",", "we", "limit", "its", "application", "to", "the", "building", "block", "under", "consideration", "like", "in", ".", "In", "contrast", "to", "the", "standard", "implementation", ",", "which", "occupies", "two", "buffers", "for", "the", "backward", "pass", "of", "the", "shown", "building", "block", ",", "checkpointing", "requires", "only", "a", "single", "buffer", ".", "The", "trick", "consists", "in", "storing", "only", "and", "recomputing", "during", "the", "backward", "pass", "by", "reiterating", "the", "forward", "operations", "starting", "from", "(", "see", "gray", "-", "colored", "operations", ")", ".", "Clearly", ",", "the", "computational", "overhead", "to", "be", "paid", "comprises", "both", ",", "recomputation", "of", "the", "BN", "and", "activation", "layers", ".", "It", "is", "worth", "observing", "that", "recomputing", "(", "gray", ")", "during", "the", "backward", "phase", "can", "reuse", "values", "for", "and", "available", "from", "the", "forward", "pass", "and", "fuse", "together", "the", "normalization", "and", "subsequent", "affine", "transformation", "into", "a", "single", "scale", "-", "and", "-", "shift", "operation", ".", "Accordingly", ",", "the", "cost", "of", "the", "second", "forward", "pass", "over", "becomes", "less", "expensive", "(", "see", "also", ")", ".", "The", "three", "approaches", "that", "follow", "are", "all", "contributions", "of", "this", "work", ".", "The", "first", "represents", "a", "variation", "of", "checkpointing", ",", "which", "allows", "us", "to", "save", "additional", "computations", "in", "the", "context", "of", "BN", ".", "The", "second", "and", "third", "are", "our", "main", "contributions", ",", "providing", "strategies", "that", "yield", "the", "same", "memory", "savings", "and", "even", "lower", "computational", "costs", "compared", "to", "the", "proposed", ",", "optimized", "checkpointing", ",", "but", "are", "both", "self", "-", "contained", "and", "thus", "much", "easier", "to", "integrate", "in", "existing", "deep", "learning", "frameworks", ".", "Checkpointing", "(", "proposed", "version", ")", ".", "Direct", "application", "of", "the", "checkpointing", "technique", "in", "the", "sketched", "building", "block", ",", "which", "is", "adopted", "also", "in", ",", "is", "not", "computationally", "optimal", "since", "additional", "operations", "could", "be", "saved", "by", "storing", ",", "the", "normalized", "value", "of", "as", "per", "Eq", ".", "(", "[", "reference", "]", ")", ",", "instead", "of", ".", "Indeed", ",", "as", "we", "will", "see", "in", "the", "next", "subsection", ",", "the", "backward", "pass", "through", "BN", "requires", "recomputing", "if", "not", "already", "stored", ".", "For", "this", "reason", ",", "we", "propose", "in", "Figure", "[", "reference", "]", "an", "alternative", "implementation", "that", "is", "computationally", "more", "efficient", "by", "retaining", "from", "the", "forward", "pass", "through", "the", "BN", "layer", ".", "From", "we", "can", "recover", "during", "the", "backward", "pass", "by", "applying", "the", "scale", "-", "and", "-", "shift", "operation", ",", "followed", "by", "the", "activation", "function", "(", "see", "gray", "-", "colored", "operations", ")", ".", "In", "this", "way", ",", "the", "computation", "of", "becomes", "slightly", "more", "efficient", "than", "the", "one", "shown", "in", "Figure", "[", "reference", "]", ",", "for", "we", "save", "the", "fusion", "operation", ".", "Finally", ",", "an", "additional", "saving", "of", "the", "normalization", "step", "derives", "from", "using", "the", "stored", "in", "the", "backward", "implementation", "of", "BN", "rather", "than", "recomputing", "it", "from", ".", "To", "distinguish", "the", "efficient", "backward", "implementation", "of", "BN", "from", "the", "standard", "one", "we", "write", "in", "place", "of", "(", "cyan", "-", "colored", ",", "see", "additionally", "\u00a7", "[", "reference", "]", ")", ".", "In", "-", "Place", "Activated", "Batch", "Normalization", "I.", "A", "limitation", "of", "the", "memory", "-", "reduction", "strategy", "described", "above", "is", "that", "the", "last", "layer", ",", "namely", "Conv", "in", "the", "example", ",", "depends", "on", "non", "-", "local", "quantities", "like", "(", "or", ")", "for", "the", "computation", "of", "the", "gradient", ".", "This", "makes", "the", "implementation", "of", "the", "approach", "within", "standard", "frameworks", "somewhat", "cumbersome", ",", "because", "the", "backward", "pass", "of", "any", "layer", "that", "follows", ",", "which", "relies", "on", "the", "existence", "of", ",", "has", "to", "somehow", "trigger", "its", "recomputation", ".", "To", "render", "the", "implementation", "of", "the", "proposed", "memory", "savings", "easier", "and", "self", "-", "contained", ",", "we", "suggest", "an", "alternative", "strategy", "shown", "in", "Figure", "[", "reference", "]", ",", "which", "relies", "on", "having", "only", "as", "the", "saved", "buffer", "during", "the", "forward", "pass", ",", "thus", "operating", "an", "in", "-", "place", "computation", "through", "the", "BN", "layer", "(", "therefrom", "the", "paper", "\u2019s", "title", ")", ".", "By", "doing", "so", ",", "any", "layer", "that", "follows", "the", "activation", "would", "have", "the", "information", "for", "the", "gradient", "computation", "locally", "available", ".", "Having", "stored", ",", "we", "need", "to", "recompute", "backwards", ",", "for", "it", "will", "be", "needed", "in", "the", "backward", "pass", "through", "the", "BN", "layer", ".", "However", ",", "this", "operation", "is", "only", "possible", "if", "the", "activation", "function", "is", "invertible", ".", "Even", "though", "this", "requirement", "does", "not", "hold", "for", "ReLU", ",", "one", "of", "the", "most", "dominantly", "used", "activation", "functions", ",", "we", "show", "in", "\u00a7", "[", "reference", "]", "that", "an", "invertible", "function", "like", "Leaky", "ReLU", "with", "a", "small", "slope", "works", "well", "as", "a", "surrogate", "of", "ReLU", "without", "compromising", "on", "the", "model", "quality", ".", "We", "also", "need", "to", "invert", "the", "scale", "-", "and", "-", "shift", "operation", ",", "which", "is", "in", "general", "possible", "if", ".", "In", "-", "Place", "Activated", "Batch", "Normalization", "II", ".", "The", "complexity", "of", "the", "computation", "of", "used", "in", "the", "backward", "pass", "of", "InPlace", "-", "ABN", "I", "can", "be", "further", "reduced", "by", "rewriting", "the", "gradients", "and", "directly", "as", "functions", "of", "instead", "of", ".", "The", "explicit", "inversion", "of", "to", "recover", "applies", "scale", "-", "and", "-", "shift", "operations", "(", "per", "feature", "channel", ")", ".", "If", "the", "partial", "derivatives", "are", "however", "based", "on", "directly", ",", "the", "resulting", "modified", "gradients", "(", "derivations", "given", "in", "the", "Appendix", ")", "show", "that", "the", "same", "computation", "can", "be", "absorbed", "into", "the", "gradient", "at", "cost", "(", "per", "feature", "channel", ")", ".", "In", "Figure", "[", "reference", "]", "we", "show", "the", "diagram", "of", "this", "optimization", ",", "where", "we", "denote", "as", "the", "implementation", "of", "the", "backward", "pass", "as", "a", "function", "of", ".", "subsection", ":", "Technical", "Details", "The", "key", "components", "of", "our", "method", "are", "the", "computation", "of", "the", "inverse", "of", "both", "the", "activation", "function", "(", "InPlace", "-", "ABN", "I", "&", "II", ")", "and", "(", "InPlace", "-", "ABN", "I", ")", ",", "and", "the", "implementation", "of", "a", "backward", "pass", "through", "the", "batch", "normalization", "layer", "that", "depends", "on", ",", "the", "output", "of", "the", "forward", "pass", "through", "the", "same", "layer", ".", "Invertible", "activation", "function", ".", "Many", "activation", "functions", "are", "actually", "invertible", "and", "can", "be", "computed", "in", "-", "place", "(", "sigmoid", ",", "hyperbolic", "tangent", ",", "Leaky", "ReLU", ",", "and", "others", ")", ",", "but", "the", "probably", "most", "commonly", "used", "one", ",", "namely", "ReLU", ",", "is", "not", "invertible", ".", "However", ",", "we", "can", "replace", "it", "with", "Leaky", "ReLU", "(", "see", ",", "Figure", "[", "reference", "]", ")", "with", "slope", "without", "impacting", "the", "quality", "of", "the", "trained", "models", ".", "This", "will", "be", "the", "activation", "function", "that", "we", "use", "in", "our", "experimental", "evaluation", "due", "to", "its", "affinity", "to", "standard", "ReLU", ",", "even", "though", "other", "activation", "functions", "could", "be", "used", ".", "The", "corresponding", "forward", "pass", "through", "the", "activation", "function", "with", "slope", "for", "negative", "inputs", "and", "its", "inverse", "used", "in", "our", "backward", "pass", "are", "given", "as", "follows", ":", "Leaky", "ReLU", "and", "its", "inverse", "share", "the", "same", "computational", "cost", ",", "an", "elementwise", "sign", "check", "and", "scaling", "operation", ".", "Hence", ",", "the", "overhead", "deriving", "from", "the", "recomputation", "of", "in", "the", "backward", "pass", "of", "the", "previously", "shown", ",", "checkpointing", "-", "based", "approaches", "and", "its", "inverse", "employed", "in", "the", "backward", "pass", "of", "our", "method", "are", "equivalent", ".", "To", "give", "further", "evidence", "of", "the", "interchangeability", "of", "ReLU", "and", "Leaky", "ReLU", "with", "slope", ",", "we", "have", "successfully", "retrained", "well", "-", "known", "models", "like", "ResNeXt", "and", "WideResNet", "on", "ImageNet", "using", "Leaky", "ReLU", "(", "see", "\u00a7", "[", "reference", "]", ")", ".", "InPlace", "-", "ABN", "I", ":", "Backward", "pass", "through", "BN", ".", "The", "gradient", ",", "which", "is", "obtained", "from", "the", "backward", "pass", "through", "the", "BN", "layer", ",", "can", "be", "written", "as", "a", "function", "of", "and", "as", "where", "the", "gradients", "of", "the", "BN", "parameters", "are", "given", "by", "The", "expression", "above", "differs", "from", "what", "is", "found", "in", "the", "original", "BN", "paper", ",", "but", "the", "refactoring", "was", "already", "used", "in", "the", "Caffe", "framework", ".", "It", "is", "implemented", "by", "in", "the", "proposed", "solutions", "in", "Figures", "[", "reference", "]", "and", "[", "reference", "]", "and", "does", "not", "depend", "on", ".", "Hence", ",", "we", "store", "during", "the", "forward", "pass", "only", "(", "this", "dependency", "was", "omitted", "from", "the", "diagrams", ")", ".", "Instead", ",", "in", "Figures", "[", "reference", "]", "and", "[", "reference", "]", ",", "which", "depends", "on", ",", "requires", "the", "additional", "recomputation", "of", "from", "via", "Eq", ".", "(", "[", "reference", "]", ")", ".", "Hence", ",", "it", "also", "requires", "storing", ".", "Our", "solution", "is", "hence", "memory", "-", "wise", "more", "efficient", "than", "the", "state", "-", "of", "-", "the", "-", "art", "from", "Figure", "[", "reference", "]", ".", "Inversion", "of", "\u03c0\u03b3", ",", "\u03b2", ".", "In", "the", "configuration", "of", "InPlace", "-", "ABN", "I", ",", "the", "inversion", "of", "becomes", "critical", "if", "since", ".", "While", "we", "never", "encountered", "such", "a", "case", "in", "practice", ",", "one", "can", "protect", "against", "it", "by", "preventing", "from", "getting", "less", "than", "a", "given", "tolerance", ".", "We", "can", "even", "avoid", "this", "problem", "by", "simply", "not", "considering", "a", "learnable", "parameter", "and", "by", "fixing", "it", "to", ",", "in", "case", "the", "activation", "function", "is", "scale", "covariant", "(", "all", "ReLU", "-", "like", "activations", ")", "and", "when", "a", "Conv", "layer", "follows", ".", "Indeed", ",", "it", "is", "easy", "to", "show", "that", "the", "network", "retains", "the", "exact", "same", "capacity", "in", "that", "case", ",", "for", "can", "be", "absorbed", "into", "the", "subsequent", "Conv", "layer", ".", "InPlace", "-", "ABN", "II", ":", "Backward", "pass", "through", "BN", ".", "We", "obtain", "additional", "memory", "savings", "for", "our", "solution", "illustrated", "in", "Figure", "[", "reference", "]", "and", "as", "outlined", "in", "\u00a7", "[", "reference", "]", ".", "The", "gradient", "when", "written", "as", "a", "function", "of", "instead", "of", "becomes", "For", "the", "gradients", "of", "the", "BN", "parameters", ",", "remains", "as", "above", "but", "we", "get", "and", "we", "write", "for", "the", "actual", "backward", "implementation", "in", "Figure", "[", "reference", "]", ".", "Detailed", "derivations", "are", "provided", "in", "the", "Appendix", "of", "this", "paper", ".", "In", "summary", ",", "both", "of", "our", "optimized", "main", "contributions", "are", "memory", "-", "wise", "more", "efficient", "than", "the", "state", "-", "of", "-", "the", "-", "art", "solution", "in", "Figure", "[", "reference", "]", "and", "InPlace", "-", "ABN", "II", "is", "computationally", "even", "more", "efficient", "than", "the", "proposed", ",", "optimized", "checkpointing", "from", "Figure", "[", "reference", "]", ".", "subsection", ":", "Implementation", "Details", "We", "have", "implemented", "the", "proposed", "InPlace", "-", "ABN", "I", "layer", "in", "PyTorch", ",", "by", "simply", "creating", "a", "new", "layer", "that", "fuses", "batch", "normalization", "with", "an", "(", "invertible", ")", "activation", "function", ".", "In", "this", "way", "we", "can", "deal", "with", "the", "computation", "of", "from", "internally", "in", "the", "layer", ",", "thus", "keeping", "the", "implementation", "self", "-", "contained", ".", "We", "have", "released", "code", "at", "for", "easy", "plug", "-", "in", "replacement", "of", "the", "block", "BN", "+", "Act", "in", "modern", "architectures", ".", "The", "forward", "and", "backward", "implementations", "are", "also", "given", "as", "pseudocode", "in", "Algorithm", "[", "reference", "]", "and", "[", "reference", "]", ".", "In", "the", "forward", "pass", ",", "in", "line", "3", ",", "we", "explicitly", "indicate", "the", "buffers", "that", "are", "stored", "and", "needed", "for", "the", "backward", "pass", ".", "Any", "other", "buffer", "can", "be", "overwritten", "with", "in", "-", "place", "computations", ",", ",", "and", "can", "point", "to", "the", "same", "memory", "location", ".", "In", "the", "backward", "pass", ",", "we", "recover", "the", "stored", "buffers", "in", "line", "1", "and", ",", "again", ",", "every", "computation", "can", "be", "done", "in", "-", "place", "if", "the", "buffer", "is", "not", "needed", "anymore", "(", ",", ",", "can", "share", "the", "same", "memory", "location", "as", "well", "as", ",", "and", ")", ".", "As", "opposed", "to", "Figure", "[", "reference", "]", ",", "the", "pseudocode", "shows", "also", "the", "dependencies", "on", "additional", ",", "small", ",", "buffers", "like", "and", "reports", "the", "gradients", "with", "respect", "to", "the", "BN", "layer", "parameters", "and", ".", "Please", "note", "the", "difference", "during", "backward", "computation", "when", "applying", "InPlace", "-", "ABN", "I", "or", "InPlace", "-", "ABN", "II", ",", "respectively", ".", "[", "t", "]", "[", "1", "]", ",", ",", "save", "for", "backward", ",", "InPlace", "-", "ABN", "Forward", "[", "t", "]", "[", "1", "]", ",", ",", "saved", "tensors", "during", "forward", "InPlace", "-", "ABN", "I", "(", "see", "Fig", ".", "[", "reference", "]", ")", "InPlace", "-", "ABN", "II", "(", "see", "Fig", ".", "[", "reference", "]", ")", ",", ",", "InPlace", "-", "ABN", "Backward", "section", ":", "Experiments", "We", "assess", "the", "effectiveness", "of", "our", "proposed", ",", "memory", "efficient", "InPlace", "-", "ABN", "layer", "for", "the", "tasks", "of", "image", "classification", "and", "semantic", "segmentation", "in", "\u00a7", "[", "reference", "]", "and", "[", "reference", "]", ",", "respectively", ".", "Additionally", ",", "we", "provide", "timing", "analyses", "in", "\u00a7", "[", "reference", "]", ".", "Experiments", "were", "run", "and", "timed", "on", "machines", "comprising", "four", "NVIDIA", "Titan", "Xp", "cards", "(", "with", "12", "GB", "of", "RAM", "each", ")", ".", "Where", "not", "otherwise", "noted", ",", "the", "activation", "function", "used", "in", "all", "experiments", "is", "Leaky", "ReLU", "with", "slope", ".", "subsection", ":", "Image", "Classification", "We", "have", "trained", "several", "residual", "-", "unit", "-", "based", "models", "on", "ImageNet", "-", "1k", "to", "demonstrate", "the", "effectiveness", "of", "InPlace", "-", "ABN", "for", "the", "task", "of", "image", "classification", ".", "In", "particular", ",", "we", "focus", "our", "attention", "on", "two", "main", "questions", ":", "i", ")", "whether", "using", "an", "invertible", "activation", "function", "(", "Leaky", "ReLU", "in", "our", "experiments", ")", "impacts", "on", "the", "performance", "of", "the", "models", ",", "and", "ii", ")", "how", "the", "memory", "savings", "obtained", "with", "our", "method", "can", "be", "exploited", "to", "improve", "classification", "accuracy", ".", "Our", "results", "are", "summarized", "in", "Table", "[", "reference", "]", "and", "described", "in", "this", "subsection", ".", "ResNeXt", "-", "101", "/", "ResNeXt", "-", "152", ".", "This", "is", "a", "variant", "of", "the", "original", "ResNet", "architecture", "in", "which", "the", "bottleneck", "residual", "units", "are", "replaced", "with", "a", "multi", "-", "branch", "version", ".", "In", "practice", ",", "this", "equates", "to", "\u2018", "\u2018", "grouping", "\u2019", "\u2019", "the", "convolutions", "of", "each", "residual", "unit", ".", "The", "number", "of", "groups", ",", "parallel", "branches", ",", "is", "known", "as", "cardinality", "and", "is", "an", "additional", "hyperparameter", "to", "be", "set", ".", "We", "follow", "the", "best", "performing", "design", "guidelines", "described", "in", "and", "train", "models", "with", "cardinality", "64", ",", "while", "considering", "the", "101", "-", "and", "152", "-", "layers", "configurations", ".", "During", "training", ",", "we", "proportionally", "scale", "input", "images", "so", "that", "their", "smallest", "side", "equals", "pixels", ",", "before", "randomly", "taking", "crops", ".", "Additionally", ",", "we", "perform", "per", "-", "channel", "mean", "and", "variance", "normalization", "and", "color", "augmentation", "as", "described", "in", ".", "We", "train", "using", "stochastic", "gradient", "descent", "(", "SGD", ")", "with", "Nesterov", "updates", ",", "initial", "learning", "rate", ",", "weight", "decay", "and", "momentum", ".", "The", "training", "is", "run", "for", "a", "total", "of", "epochs", ",", "reducing", "the", "learning", "rate", "every", "epochs", "by", "a", "factor", ".", "WideResNet", "-", "38", ".", "This", "is", "another", "modern", "architecture", "built", "by", "stacking", "residual", "units", ".", "Compared", "to", "the", "original", "ResNet", ",", "WideResNet", "trades", "depth", "for", "width", ",", "it", "uses", "units", "with", "an", "increased", "number", "of", "feature", "channels", "while", "reducing", "the", "total", "number", "of", "stacked", "units", ".", "For", "training", ",", "we", "use", "the", "same", "setup", "and", "hyperparameters", "as", "for", "ResNeXt", ",", "with", "one", "exception", ":", "following", "we", "train", "for", "epochs", ",", "linearly", "decreasing", "the", "learning", "rate", "from", "to", ".", "Discussion", "of", "results", ".", "In", "our", "experiments", "we", "also", "compared", "the", "validation", "accuracy", "obtained", "when", "replacing", "ReLU", "with", "Leaky", "ReLU", "in", "a", "ResNeXt", "-", "101", "trained", "with", "ReLU", ".", "We", "also", "considered", "the", "opposite", "case", ",", "replacing", "Leaky", "ReLU", "with", "ReLU", "in", "a", "Leaky", "ReLU", "-", "trained", "network", "(", "see", "Table", "[", "reference", "]", ")", ".", "Our", "results", "are", "in", "line", "with", ",", "and", "never", "differ", "by", "more", "than", "a", "single", "point", "per", "training", "except", "for", "the", "center", "crop", "evaluation", "top", "-", "1", "results", ",", "probably", "also", "due", "to", "non", "-", "deterministic", "training", "behaviour", ".", "Our", "results", "may", "slightly", "differ", "from", "what", "was", "reported", "in", "the", "original", "papers", ",", "as", "our", "training", "protocol", "does", "not", "exactly", "match", "the", "one", "in", "(", "data", "augmentation", "regarding", "scale", "and", "aspect", "ratio", "settings", ",", "learning", "rate", "schedule", ",", ")", "or", "due", "to", "changes", "in", "reference", "implementations", ".", "Next", ",", "we", "focus", "on", "how", "to", "better", "exploit", "the", "memory", "savings", "due", "to", "our", "proposed", "InPlace", "-", "ABN", "for", "improving", "classification", "accuracy", ".", "As", "a", "baseline", ",", "we", "train", "ResNeXt", "-", "101", "with", "standard", "Batch", "Normalization", "and", "the", "maximum", "batch", "size", "that", "fits", "in", "GPU", "memory", ",", "256", "images", "per", "batch", ".", "Then", ",", "we", "consider", "two", "different", "options", ":", "i", ")", "using", "the", "extra", "memory", "to", "fit", "more", "images", "per", "training", "batch", "while", "fixing", "the", "network", "architecture", ",", "or", "ii", ")", "fixing", "the", "batch", "size", "while", "training", "a", "larger", "network", ".", "For", "option", "i", ")", "we", "double", "the", "batch", "size", "to", "512", "(", "ResNeXt", "-", "101", ",", "InPlace", "-", "ABN", ",", "512", "in", "Table", "[", "reference", "]", ")", ",", "while", "for", "option", "ii", ")", "we", "train", "ResNeXt", "-", "152", "and", "WideResNet", "-", "38", ".", "Note", "that", "neither", "ResNeXt", "-", "152", "nor", "WideResNet", "-", "38", "would", "fit", "in", "memory", "when", "using", "256", "images", "per", "training", "batch", "and", "when", "using", "standard", "BN", ".", "As", "it", "is", "clear", "from", "the", "table", ",", "both", "i", ")", "and", "ii", ")", "result", "in", "a", "noticeable", "performance", "increase", ".", "Interestingly", ",", "training", "ResNeXt", "-", "101", "with", "an", "increased", "batch", "size", "results", "in", "similar", "accuracy", "to", "the", "deeper", "(", "and", "computationally", "more", "expensive", ")", "ResNeXt", "-", "152", "model", ".", "As", "an", "additional", "reference", ",", "we", "train", "ResNeXt", "-", "101", "with", "synchronized", "Batch", "Normalization", "(", "InPlace", "-", "ABNsync", ")", ",", "which", "can", "be", "seen", "as", "a", "\u2018", "\u2018", "virtual", "\u2019", "\u2019", "increase", "of", "batch", "size", "applied", "to", "the", "computation", "of", "BN", "statistics", ".", "In", "this", "case", "we", "only", "observe", "small", "accuracy", "improvements", "when", "compared", "to", "the", "baseline", "model", ".", "For", "the", "future", ",", "we", "plan", "to", "conduct", "further", "experiments", "with", "deeper", "variants", "of", "DenseNet", ",", "and", "investigate", "effects", "of", "InPlace", "-", "ABN", "on", "Squeeze", "&", "Excitation", "networks", "or", "deformable", "convolutional", "networks", ".", "subsection", ":", "Semantic", "Segmentation", "The", "goal", "of", "semantic", "segmentation", "is", "to", "assign", "categorical", "labels", "to", "each", "pixel", "in", "an", "image", ".", "State", "-", "of", "-", "the", "-", "art", "segmentations", "are", "typically", "obtained", "by", "combining", "classification", "models", "pretrained", "on", "ImageNet", "(", "typically", "referred", "to", "as", "body", ")", "with", "segmentation", "-", "specific", "head", "architectures", "and", "jointly", "fine", "-", "tuning", "them", "on", "suitable", ",", "(", "densely", ")", "annotated", "training", "data", "like", "Cityscapes", ",", "COCO", "-", "Stuff", ",", "ADE20", "K", "or", "Mapillary", "Vistas", ".", "Datasets", "used", "for", "Evaluation", ".", "We", "report", "results", "on", "Cityscapes", ",", "COCO", "-", "Stuff", "and", "Mapillary", "Vistas", ",", "since", "these", "datasets", "have", "complementary", "properties", "in", "terms", "of", "image", "content", ",", "size", ",", "number", "of", "class", "labels", "and", "annotation", "quality", ".", "Cityscapes", "shows", "street", "-", "level", "images", "captured", "in", "central", "Europe", "and", "comprises", "a", "total", "of", "5k", "densely", "annotated", "images", "(", "19", "object", "categories", "+", "1", "void", "class", ",", "all", "images", "sized", "2048", "1024", ")", ",", "split", "into", "2975", "/", "500", "/", "1525", "images", "for", "training", ",", "validation", "and", "test", ",", "respectively", ".", "While", "there", "exist", "additional", "20k", "images", "with", "so", "-", "called", "coarse", "annotations", ",", "we", "learn", "only", "from", "the", "high", "-", "quality", "(", "fine", ")", "annotations", "in", "the", "training", "set", "and", "test", "on", "the", "corresponding", "validation", "set", "(", "for", "which", "ground", "truth", "is", "publicly", "available", ")", ".", "We", "also", "show", "results", "on", "COCO", "-", "Stuff", ",", "which", "provides", "stuff", "-", "class", "annotations", "for", "the", "well", "-", "known", "MS", "COCO", "dataset", ".", "This", "dataset", "comprises", "65k", "COCO", "images", "(", "with", "40k", "for", "training", ",", "5k", "for", "validation", ",", "5k", "for", "test", "-", "dev", "and", "15k", "as", "challenge", "test", "set", ")", "with", "annotations", "for", "91", "stuff", "classes", "and", "1", "void", "class", ".", "Images", "are", "smaller", "than", "in", "Cityscapes", "and", "with", "varying", "sizes", ",", "and", "the", "provided", "semantic", "annotations", "are", "based", "on", "superpixel", "segmentations", ",", "consequently", "suffering", "from", "considerable", "mislabelings", ".", "Finally", ",", "we", "also", "report", "results", "on", "Mapillary", "Vistas", "(", "research", "edition", ")", ",", "a", "novel", "and", "large", "-", "scale", "street", "-", "level", "image", "dataset", "comprising", "25k", "densely", "annotation", "images", "(", "65", "object", "categories", "+", "1", "void", "class", ",", "images", "have", "varying", "aspect", "ratios", "and", "sizes", "up", "to", "22", "Megapixel", ")", ",", "split", "into", "18k", "/", "2k", "/", "5k", "images", "for", "training", ",", "validation", "and", "test", ",", "respectively", ".", "Similar", "to", "the", "aforementioned", "datasets", ",", "we", "train", "on", "training", "data", "and", "test", "on", "validation", "data", ".", "Segmentation", "approach", ".", "We", "chose", "to", "adopt", "the", "recently", "introduced", "DeepLabV3", "segmentation", "approach", "as", "head", ",", "and", "evaluate", "its", "performance", "with", "body", "networks", "from", "\u00a7", "[", "reference", "]", ".", "DeepLabV3", "is", "exploiting", "atrous", "(", "dilated", ")", "convolutions", "in", "a", "cascaded", "way", "for", "capturing", "contextual", "information", ",", "together", "with", "crop", "-", "level", "features", "encoding", "global", "context", "(", "close", "in", "spirit", "to", "PSPNet", "\u2019s", "global", "feature", ")", ".", "We", "follow", "the", "parameter", "choices", "suggested", "in", ",", "assembling", "the", "head", "as", "4", "parallel", "Conv", "blocks", "with", "output", "channels", "each", "and", "dilation", "rates", "(", "with", "x8", "downsampled", "crop", "sizes", "from", "the", "body", ")", "and", "kernel", "sizes", ",", "respectively", ".", "The", "global", "features", "are", "computed", "in", "a", "channel", "-", "specific", "way", "and", "Conv", "ed", "into", "additional", "channels", ".", "Each", "output", "block", "is", "followed", "by", "BatchNorm", "before", "all", "features", "are", "stacked", "and", "reduced", "by", "another", "Conv", "+", "BN", "+", "Act", "block", "(", "into", "256", "features", ")", "and", "finally", "Conv", "ed", "to", "the", "number", "of", "target", "classes", ".", "We", "exploit", "our", "proposed", "InPlace", "-", "ABN", "strategy", "also", "in", "the", "head", "architecture", ".", "Finally", ",", "we", "apply", "bilinear", "upsampling", "to", "the", "logits", "to", "obtain", "the", "original", "input", "crop", "resolution", "before", "computing", "the", "loss", "using", "an", "online", "bootstrapping", "strategy", "as", "described", "in", "(", "setting", "and", ")", ".", "We", "did", "not", "apply", "hybrid", "dilated", "convolutions", "nor", "added", "an", "auxiliary", "loss", "as", "proposed", "in", ".", "Training", "data", "is", "sampled", "in", "a", "uniform", "way", "(", "by", "shuffling", "the", "database", "in", "each", "epoch", ")", "and", "all", "Cityscapes", "experiments", "are", "run", "for", "360", "epochs", "using", "an", "initial", "learning", "rate", "of", "and", "polynomial", "learning", "rate", "decay", ",", "following", ".", "COCO", "-", "Stuff", "experiments", "were", "trained", "only", "for", "30", "epochs", ",", "which", "however", "approximately", "matches", "the", "number", "of", "iterations", "on", "Cityscapes", "due", "to", "the", "considerably", "larger", "dataset", "size", ".", "For", "optimization", ",", "we", "use", "stochastic", "gradient", "descent", "with", "momentum", "and", "weight", "decay", ".", "For", "training", "data", "augmentation", ",", "we", "apply", "random", "horizontal", "flipping", "(", "with", "prob", ".", ")", "and", "random", "scaling", "selected", "from", "-", "before", "cropping", "the", "actual", "patches", ".", "Discussion", "of", "Results", ".", "In", "Table", "[", "reference", "]", ",", "we", "provide", "results", "on", "validation", "data", "for", "Cityscapes", "and", "COCO", "-", "Stuff", "under", "different", "BN", "layer", "configurations", ".", "We", "distinguish", "between", "standard", "BN", "layers", "(", "coined", "Std", "-", "BN", ")", "and", "our", "proposed", "variants", "using", "in", "-", "place", ",", "activated", "BN", "(", "InPlace", "-", "ABN", ")", "as", "well", "as", "its", "gradient", "-", "synchronized", "version", "InPlace", "-", "ABNsync", ".", "All", "experiments", "are", "based", "on", "Leaky", "ReLU", "activations", ".", "Trainings", "were", "conducted", "in", "a", "way", "to", "maximize", "GPU", "memory", "utilization", "by", "i", ")", "fixing", "the", "training", "crop", "size", "and", "therefore", "pushing", "the", "amount", "of", "crops", "per", "minibatch", "to", "the", "limit", "(", "denoted", "as", "fixed", "crop", ")", "or", "ii", ")", "fixing", "the", "number", "of", "crops", "per", "minibatch", "and", "maximizing", "the", "training", "crop", "resolutions", "(", "fixed", "batch", ")", ".", "Experiments", "are", "conducted", "for", "ResNeXt", "-", "101", "and", "WideResNet", "-", "38", "network", "bodies", ",", "where", "the", "latter", "seems", "preferable", "for", "segmentation", "tasks", ".", "Both", "body", "networks", "were", "solely", "trained", "on", "ImageNet", "-", "1k", ".", "All", "results", "derive", "from", "single", "-", "scale", "testing", "without", "horizontal", "image", "flipping", ",", "deliberately", "avoiding", "dilution", "of", "results", "by", "well", "-", "known", "bells", "and", "whistles", ".", "Table", "[", "reference", "]", "shows", "the", "positive", "effects", "of", "applying", "more", "training", "data", "(", "in", "terms", "of", "both", ",", "#", "training", "crops", "per", "minibatch", "and", "input", "crop", "resolutions", ")", "on", "the", "validation", "results", ".", "The", "increase", "of", "data", "(", "pixels", "/", "minibatch", ")", "we", "can", "put", "in", "GPU", "memory", ",", "relative", "to", "the", "baseline", "(", "top", "row", ")", "is", "reported", "in", "square", "brackets", ".", "We", "observe", "that", "higher", "input", "resolution", "is", "in", "general", "even", "more", "beneficial", "than", "adding", "more", "crops", "to", "the", "batch", ".", "For", "the", "sake", "of", "direct", "comparability", "we", "left", "the", "learning", "rates", "unchanged", ",", "but", "there", "might", "be", "better", "hyper", "-", "parameters", "for", "our", "variants", "of", "InPlace", "-", "ABN", "and", "InPlace", "-", "ABNsync", ".", "In", "essence", ",", "our", "results", "closely", "approach", "reported", "numbers", "for", "Cityscapes", "in", ",", "which", "however", "include", "more", "training", "data", "in", "the", "body", "model", "training", "or", "are", "based", "on", "already", "trained", "models", "like", "DeepLabV2", ".", "For", "COCO", "-", "Stuff", ",", "results", "are", "not", "directly", "comparable", "to", "the", "original", "publication", "since", "they", "used", "a", "lower", "-", "performing", "VGG", "-", "16", "network", "for", "the", "body", ".", "However", ",", "all", "experiments", "show", "significant", "improvements", "the", "baseline", "method", "in", "the", "first", "line", "of", "Table", "[", "reference", "]", ".", "Optimizing", "Settings", "for", "Cityscapes", "and", "Vistas", "Datasets", ".", "Here", "we", "show", "further", "experiments", "when", "tuning", "settings", "like", "#", "training", "crops", "and", "crop", "sizes", "in", "favor", "of", "our", "method", "(", "as", "opposed", "to", "maintaining", "comparability", "with", "baselines", "above", ")", ".", "First", ",", "we", "report", "Cityscapes", "results", "in", "Table", "[", "reference", "]", "when", "fine", "-", "tuning", "our", "InPlace", "-", "ABN", "ResNeXt", "-", "152", "ImageNet", "model", "from", "\u00a7", "[", "reference", "]", ",", "using", "12", "crops", "of", "size", "per", "minibatch", "(", "using", "the", "gradient", "-", "synchronized", "variant", "InPlace", "-", "ABNsync", ")", ".", "Going", "deeper", "with", "the", "body", "results", "in", "a", "validation", "set", "score", "of", "78.49", "%", ",", "improving", "over", "the", "score", "of", "77.58", "%", "obtained", "by", "ResNeXt", "-", "101", ",", "InPlace", "-", "ABNsync", ".", "We", "provide", "additional", "results", "using", "WideResNet", "-", "38", "InPlace", "-", "ABNsync", "-", "based", "settings", ",", "where", "we", "trained", "the", "model", "with", "i", ")", "16", "crops", "at", "yielding", "79.02", "%", "and", "ii", ")", "12", "crops", "at", ",", "resulting", "in", "79.16", "%", ".", "As", "can", "be", "seen", ",", "the", "combination", "of", "InPlace", "-", "ABNsync", "with", "larger", "crop", "sizes", "improves", "by", "over", "the", "best", "performing", "setting", "in", "Table", "[", "reference", "]", "(", "InPlace", "-", "ABN", "with", "20", "crops", "at", ")", ".", "We", "also", "list", "a", "non", "-", "gradient", "synchronized", "experiment", "(", "as", "this", "gave", "the", "highest", "score", "on", "Cityscapes", "before", ")", ",", "where", "an", "increase", "of", "the", "crop", "size", "yields", "to", "minor", "improvements", ",", "climbing", "from", "78.31", "%", "to", "78.45", "%", ".", "Finally", ",", "we", "have", "run", "another", "experiment", "with", "12", "crops", "at", "where", "we", "however", "used", "a", "different", "training", "data", "sampling", "strategy", ".", "Instead", "of", "just", "randomly", "perturbing", "the", "dataset", "and", "taking", "training", "crops", "from", "random", "positions", ",", "we", "compiled", "the", "minibatches", "per", "epoch", "in", "a", "way", "to", "show", "all", "classes", "approximately", "uniformly", "(", "thus", "following", "an", "oversampling", "strategy", "for", "underrepresented", "categories", ")", ".", "In", "practice", ",", "we", "tracked", "object", "class", "presence", "for", "all", "images", "and", "eventually", "class", "-", "uniformly", "sampled", "from", "eligible", "image", "candidates", ",", "making", "sure", "to", "take", "training", "crops", "from", "areas", "containing", "the", "class", "of", "interest", ".", "Applying", "this", "sampling", "strategy", "coined", "Class", "-", "Uniform", "sampling", "yields", "79.40", "%", ",", "which", "matches", "the", "highest", "reported", "score", "on", "Cityscapes", "validation", "data", "reported", "in", ",", "without", "however", "using", "additional", "training", "data", ".", "Next", ",", "we", "provide", "results", "for", "the", "Mapillary", "Vistas", "dataset", ",", "using", "hyperparameter", "settings", "inspired", "by", "our", "highest", "scoring", "configuration", "for", "Cityscapes", ".", "Vistas", "is", "considerably", "larger", "than", "Cityscapes", "(", "in", "terms", "of", "#", "classes", ",", "#", "images", "and", "image", "resolution", ")", ",", "so", "running", "an", "exhaustive", "amount", "of", "experiments", "is", "prohibitive", "in", "terms", "of", "training", "time", ".", "Due", "to", "the", "increase", "of", "object", "classes", "(", "19", "for", "Cityscapes", "and", "65", "for", "Vistas", ")", ",", "we", "used", "minibatches", "of", "12", "crops", "at", "(", "with", "InPlace", "-", "ABNsync", ")", ",", "increased", "the", "initial", "learning", "rate", "to", "and", "trained", "for", "90", "epochs", ".", "This", "setting", "leads", "to", "the", "highest", "reported", "single", "-", "scale", "score", "of", "53.12", "%", "on", "validation", "data", "so", "far", ",", "significantly", "outperforming", "the", "LSUN", "2017", "segmentation", "winner", "\u2019s", "single", "-", "scale", "approach", "of", "51.59", "%", ".", "As", "also", "listed", "in", "Table", "[", "reference", "]", ",", "their", "approach", "additionally", "used", "hybrid", "dilated", "convolutions", ",", "applied", "an", "inverse", "frequency", "weighting", "for", "correcting", "training", "data", "class", "imbalance", "as", "well", "as", "pretrained", "on", "Cityscapes", ".", "subsection", ":", "Timing", "analyses", "Besides", "the", "discussed", "memory", "improvements", "and", "their", "impact", "on", "computer", "vision", "applications", ",", "we", "also", "provide", "actual", "runtime", "comparisons", "and", "analyses", "for", "the", "InPlace", "-", "ABN", "I", "setting", "shown", "in", "[", "reference", "]", ",", "as", "this", "is", "the", "implementation", "we", "made", "publicly", "available", ".", "Isolating", "a", "single", "BN", "+", "Act", "+", "Conv", "block", ",", "we", "evaluate", "the", "computational", "times", "required", "for", "a", "forward", "and", "backward", "pass", "over", "it", "(", "Figure", "[", "reference", "]", ")", ".", "We", "compare", "the", "conventional", "approach", "of", "serially", "executing", "layers", "and", "storing", "intermediate", "results", "(", "Standard", ")", ",", "our", "proposed", "InPlace", "-", "ABN", "I", "and", "the", "Checkpointing", "approach", ".", "In", "order", "to", "obtain", "fair", "timing", "comparisons", ",", "we", "re", "-", "implemented", "the", "checkpointing", "idea", "in", "PyTorch", ".", "The", "results", "are", "obtained", "by", "running", "all", "operations", "over", "a", "batch", "comprising", "32", "-", "images", "and", "setting", "the", "meta", "-", "parameters", "(", "number", "of", "feature", "channels", ",", "spatial", "dimensions", ")", "to", "those", "encountered", "in", "the", "four", "modules", "of", "ResNeXt", "-", "101", ",", "denoted", "as", "Conv1", "-", "Conv4", ".", "The", "actual", "runtimes", "were", "averaged", "over", "200", "iterations", ".", "We", "observe", "consistent", "speed", "advantages", "in", "favor", "of", "our", "method", "when", "comparing", "against", "Checkpointing", ",", "with", "the", "actual", "percentage", "difference", "depending", "on", "block", "\u2019s", "meta", "-", "parameters", ".", "As", "we", "can", "see", ",", "InPlace", "-", "ABN", "induces", "computation", "time", "increase", "between", "over", "Standard", "while", "Checkpointing", "is", "almost", "doubling", "our", "overheads", ".", "section", ":", "Conclusions", "In", "this", "work", "we", "have", "presented", "InPlace", "-", "ABN", ",", "which", "is", "a", "novel", ",", "computationally", "efficient", "fusion", "of", "batch", "normalization", "and", "activation", "layers", ",", "targeting", "memory", "-", "optimization", "for", "modern", "deep", "neural", "networks", "during", "training", "time", ".", "We", "reconstruct", "necessary", "quantities", "for", "the", "backward", "pass", "by", "inverting", "the", "forward", "computation", "from", "the", "storage", "buffer", ",", "and", "manage", "to", "free", "up", "almost", "50", "%", "of", "the", "memory", "needed", "in", "conventional", "BN", "+", "Act", "implementations", "at", "little", "additional", "computational", "costs", ".", "In", "contrast", "to", "state", "-", "of", "-", "the", "-", "art", "checkpointing", "attempts", ",", "our", "method", "is", "reconstructing", "discarded", "buffers", "backwards", "during", "the", "backward", "pass", ",", "thus", "allowing", "us", "to", "encapsulate", "BN", "+", "Act", "as", "self", "-", "contained", "layer", ",", "which", "is", "easy", "to", "implement", "and", "deploy", "in", "virtually", "all", "modern", "deep", "learning", "frameworks", ".", "We", "have", "validated", "our", "approach", "with", "experiments", "for", "image", "classification", "on", "ImageNet", "-", "1k", "and", "semantic", "segmentation", "on", "Cityscapes", ",", "COCO", "-", "Stuff", "and", "Mapillary", "Vistas", ".", "Our", "obtained", "networks", "have", "performed", "consistently", "and", "considerably", "better", "when", "trained", "with", "larger", "batch", "sizes", "(", "or", "training", "crop", "sizes", ")", ",", "leading", "to", "a", "new", "high", "-", "score", "on", "the", "challenging", "Mapillary", "Vistas", "dataset", "in", "a", "single", "-", "scale", ",", "single", "-", "model", "inference", "setting", ".", "In", "future", "works", ",", "we", "will", "investigate", "the", "consequences", "of", "our", "approach", "for", "problems", "like", "object", "detection", ",", "instance", "-", "specific", "segmentation", "and", "learning", "in", "3D.", "Derivations", "for", "gradient", "computation", "are", "provided", "in", "the", "Appendix", ".", "Acknowledgements", ".", "We", "acknowledge", "financial", "support", "from", "project", "DIGIMAP", ",", "funded", "under", "grant", "#", "860375", "by", "the", "Austrian", "Research", "Promotion", "Agency", "(", "FFG", ")", ".", "section", ":", "Appendix", "\u2013", "Derivation", "of", "Gradient", "We", "follow", "the", "gradient", "derivations", "as", "provided", "in", "the", "original", "batch", "normalization", "paper", "and", "rewrite", "them", "as", "a", "function", "of", ",", "starting", "with", "generally", "required", "derivatives", "for", "InPlace", "-", "ABN", "and", "particular", "ones", "of", "InPlace", "-", "ABN", "I.", "For", "InPlace", "-", "ABN", "II", ",", "we", "write", "gradients", "and", "as", "functions", "of", "instead", "of", "in", "the", "following", "way", ":", ".", "/", "bib", "/", "GeneralRefs", "."]}