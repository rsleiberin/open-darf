{"coref": {"Constituency_Parsing": [[43, 44], [374, 375], [2243, 2244], [3971, 3972], [4210, 4211], [4226, 4227], [5168, 5169], [621, 622], [634, 635], [796, 797], [1156, 1157], [1823, 1824], [1834, 1835], [2121, 2122], [4512, 4513], [5070, 5071], [5142, 5143], [5178, 5179]], "F1_score": [], "Penn_Treebank": [[625, 627], [642, 643], [1410, 1411], [1714, 1717], [2112, 2113], [3848, 3849], [4494, 4496], [4638, 4639], [4505, 4506]], "Stack-only_RNNG": [[4, 8], [17, 18], [610, 611], [661, 665], [666, 667], [684, 685], [747, 748], [781, 782], [839, 840], [875, 876], [1028, 1029], [1035, 1036], [1104, 1105], [1191, 1192], [1198, 1199], [1428, 1429], [1592, 1593], [1699, 1700], [1754, 1755], [1776, 1777], [1878, 1884], [1899, 1900], [1978, 1979], [1985, 1986], [2059, 2063], [2085, 2089], [2414, 2418], [2940, 2946], [2962, 2963], [4032, 4033], [5359, 5360]]}, "coref_non_salient": {"0": [[1535, 1537], [5010, 5018]], "1": [[774, 779], [5182, 5188]], "10": [[5102, 5107], [5129, 5132], [5138, 5140]], "100": [[23, 27]], "101": [[2573, 2579]], "102": [[2232, 2234]], "103": [[871, 873]], "104": [[2128, 2131]], "105": [[146, 147]], "106": [[1073, 1075]], "107": [[1885, 1886]], "108": [[2140, 2141]], "109": [[2768, 2770]], "11": [[1225, 1226], [4091, 4093], [4443, 4444]], "12": [[4051, 4053], [4100, 4101]], "13": [[4688, 4689], [4830, 4831]], "14": [[1158, 1159], [1164, 1165]], "15": [[165, 167], [4319, 4321], [4567, 4568]], "16": [[5466, 5468], [5482, 5483]], "17": [[1949, 1951], [2459, 2461]], "18": [[40, 42], [1855, 1857], [2049, 2051]], "19": [[3065, 3068], [3184, 3186]], "2": [[2250, 2251], [2407, 2410]], "20": [[75, 77], [104, 106], [493, 496], [2441, 2443], [2956, 2958], [5342, 5345]], "21": [[3491, 3493], [3554, 3556]], "22": [[78, 81], [500, 503], [519, 522], [2453, 2456], [2463, 2466], [2986, 2989], [3049, 3052], [4128, 4131], [4382, 4385], [4526, 4529], [4961, 4964], [5263, 5266], [5294, 5297]], "23": [[376, 378], [1161, 1163]], "24": [[3483, 3485]], "25": [[1058, 1060], [1965, 1968], [3005, 3007]], "26": [[743, 745], [4763, 4765]], "27": [[116, 118], [2214, 2216], [2335, 2337]], "28": [[3812, 3815]], "29": [[4433, 4436]], "3": [[2445, 2447], [2798, 2801]], "30": [[5228, 5232]], "31": [[534, 536], [2159, 2161], [2221, 2223], [2299, 2301], [5436, 5438]], "32": [[3188, 3190]], "33": [[60, 61], [1552, 1553], [1909, 1910], [5334, 5336]], "34": [[5474, 5475]], "35": [[5004, 5006]], "36": [[244, 246], [329, 331]], "37": [[5092, 5095]], "38": [[5252, 5254]], "39": [[4107, 4108]], "4": [[4593, 4596], [5190, 5194]], "40": [[983, 984], [1069, 1070], [2840, 2841]], "41": [[5225, 5227]], "42": [[5444, 5447]], "43": [[5121, 5126]], "44": [[948, 950], [1038, 1040], [1078, 1080], [1489, 1491], [1944, 1946], [2433, 2435]], "45": [[12, 16], [200, 204], [5325, 5329]], "46": [[4564, 4565]], "47": [[1311, 1315], [2095, 2099]], "48": [[5244, 5246]], "49": [[2925, 2927]], "5": [[4397, 4402], [4474, 4479], [4535, 4540], [4603, 4609], [4624, 4629], [4673, 4678], [4743, 4748]], "50": [[2865, 2870]], "51": [[5146, 5150]], "52": [[2523, 2525]], "53": [[4657, 4660]], "54": [[4303, 4308]], "55": [[93, 94], [1202, 1203]], "56": [[649, 651]], "57": [[2587, 2595]], "58": [[1184, 1187]], "59": [[1412, 1414]], "6": [[2355, 2357], [2379, 2381], [4358, 4362], [4561, 4563]], "60": [[867, 868]], "61": [[456, 458]], "62": [[1917, 1920]], "63": [[2181, 2183]], "64": [[2968, 2969]], "65": [[2686, 2688]], "66": [[1607, 1611]], "67": [[313, 315], [2167, 2169], [4994, 4997]], "68": [[3707, 3711]], "69": [[4684, 4687]], "7": [[487, 490], [1352, 1357], [5154, 5157]], "70": [[5362, 5366]], "71": [[2842, 2845]], "72": [[2267, 2269]], "73": [[2123, 2125]], "74": [[4413, 4419]], "75": [[5065, 5066]], "76": [[5049, 5051]], "77": [[4043, 4048]], "78": [[197, 199]], "79": [[761, 764]], "8": [[1323, 1325], [1391, 1393], [1771, 1773]], "80": [[4036, 4038]], "81": [[1727, 1728]], "82": [[4277, 4280]], "83": [[631, 632]], "84": [[3853, 3855]], "85": [[232, 233]], "86": [[4223, 4225]], "87": [[1177, 1179]], "88": [[786, 789]], "89": [[955, 957], [2851, 2853]], "9": [[205, 206], [226, 227], [317, 318], [361, 362], [453, 454], [1213, 1218], [1417, 1419], [1651, 1653], [2303, 2304], [3574, 3575], [5421, 5422]], "90": [[228, 231], [1107, 1109], [1331, 1333], [1405, 1407], [1750, 1752], [1757, 1759], [1785, 1787]], "91": [[2745, 2746]], "92": [[4998, 4999]], "93": [[1632, 1635]], "94": [[3962, 3964]], "95": [[218, 222]], "96": [[612, 613]], "97": [[4213, 4215]], "98": [[1145, 1148]], "99": [[1379, 1383]]}, "doc_id": "35ff11e0a5e465c810a30b022b26a9d577a434ce", "method_subrelations": {"Stack-only_RNNG": [[[0, 15], "Stack-only_RNNG"]]}, "n_ary_relations": [{"Material": "Penn_Treebank", "Method": "Stack-only_RNNG", "Metric": "F1_score", "Task": "Constituency_Parsing", "score": "93.6"}], "ner": [[4, 8, "Method"], [12, 16, "Method"], [17, 18, "Method"], [23, 27, "Method"], [40, 42, "Method"], [43, 44, "Task"], [60, 61, "Method"], [75, 77, "Method"], [78, 81, "Method"], [93, 94, "Task"], [104, 106, "Method"], [116, 118, "Task"], [146, 147, "Method"], [165, 167, "Method"], [197, 199, "Method"], [200, 204, "Method"], [205, 206, "Method"], [218, 222, "Task"], [226, 227, "Method"], [228, 231, "Method"], [232, 233, "Method"], [244, 246, "Method"], [313, 315, "Method"], [317, 318, "Method"], [329, 331, "Method"], [361, 362, "Method"], [374, 375, "Task"], [376, 378, "Task"], [453, 454, "Method"], [456, 458, "Task"], [487, 490, "Method"], [493, 496, "Method"], [500, 503, "Method"], [519, 522, "Method"], [534, 536, "Method"], [610, 611, "Method"], [612, 613, "Method"], [625, 627, "Material"], [631, 632, "Method"], [642, 643, "Material"], [649, 651, "Method"], [661, 665, "Method"], [666, 667, "Method"], [684, 685, "Method"], [743, 745, "Method"], [747, 748, "Method"], [761, 764, "Method"], [774, 779, "Method"], [781, 782, "Method"], [786, 789, "Method"], [839, 840, "Method"], [867, 868, "Method"], [871, 873, "Task"], [875, 876, "Method"], [948, 950, "Method"], [955, 957, "Method"], [983, 984, "Method"], [1028, 1029, "Method"], [1035, 1036, "Method"], [1038, 1040, "Method"], [1058, 1060, "Method"], [1069, 1070, "Method"], [1073, 1075, "Method"], [1078, 1080, "Method"], [1104, 1105, "Method"], [1107, 1109, "Method"], [1145, 1148, "Method"], [1158, 1159, "Task"], [1161, 1163, "Task"], [1164, 1165, "Task"], [1177, 1179, "Task"], [1184, 1187, "Method"], [1191, 1192, "Method"], [1198, 1199, "Method"], [1202, 1203, "Task"], [1213, 1218, "Method"], [1225, 1226, "Metric"], [1311, 1315, "Method"], [1323, 1325, "Method"], [1331, 1333, "Method"], [1352, 1357, "Method"], [1379, 1383, "Metric"], [1391, 1393, "Method"], [1405, 1407, "Method"], [1410, 1411, "Material"], [1412, 1414, "Method"], [1417, 1419, "Method"], [1428, 1429, "Method"], [1489, 1491, "Method"], [1535, 1537, "Method"], [1552, 1553, "Method"], [1592, 1593, "Method"], [1607, 1611, "Method"], [1632, 1635, "Method"], [1651, 1653, "Method"], [1699, 1700, "Method"], [1714, 1717, "Material"], [1727, 1728, "Task"], [1750, 1752, "Method"], [1754, 1755, "Method"], [1757, 1759, "Method"], [1771, 1773, "Method"], [1776, 1777, "Method"], [1785, 1787, "Method"], [1855, 1857, "Method"], [1878, 1884, "Method"], [1885, 1886, "Method"], [1899, 1900, "Method"], [1909, 1910, "Method"], [1917, 1920, "Method"], [1944, 1946, "Method"], [1949, 1951, "Method"], [1965, 1968, "Method"], [1978, 1979, "Method"], [1985, 1986, "Method"], [2049, 2051, "Method"], [2059, 2063, "Method"], [2085, 2089, "Method"], [2095, 2099, "Method"], [2112, 2113, "Material"], [2123, 2125, "Method"], [2128, 2131, "Method"], [2140, 2141, "Task"], [2159, 2161, "Method"], [2167, 2169, "Method"], [2181, 2183, "Method"], [2214, 2216, "Task"], [2221, 2223, "Method"], [2232, 2234, "Method"], [2243, 2244, "Task"], [2250, 2251, "Method"], [2267, 2269, "Method"], [2299, 2301, "Method"], [2303, 2304, "Method"], [2335, 2337, "Task"], [2355, 2357, "Method"], [2379, 2381, "Method"], [2407, 2410, "Method"], [2414, 2418, "Method"], [2433, 2435, "Method"], [2441, 2443, "Method"], [2445, 2447, "Method"], [2453, 2456, "Method"], [2459, 2461, "Method"], [2463, 2466, "Method"], [2523, 2525, "Method"], [2573, 2579, "Method"], [2587, 2595, "Method"], [2686, 2688, "Method"], [2745, 2746, "Method"], [2768, 2770, "Method"], [2798, 2801, "Method"], [2840, 2841, "Method"], [2842, 2845, "Method"], [2851, 2853, "Method"], [2865, 2870, "Method"], [2925, 2927, "Method"], [2940, 2946, "Method"], [2956, 2958, "Method"], [2962, 2963, "Method"], [2968, 2969, "Material"], [2986, 2989, "Method"], [3005, 3007, "Method"], [3049, 3052, "Method"], [3065, 3068, "Metric"], [3184, 3186, "Metric"], [3188, 3190, "Method"], [3483, 3485, "Task"], [3491, 3493, "Method"], [3554, 3556, "Method"], [3574, 3575, "Method"], [3707, 3711, "Task"], [3812, 3815, "Method"], [3848, 3849, "Material"], [3853, 3855, "Method"], [3962, 3964, "Metric"], [3971, 3972, "Task"], [4032, 4033, "Method"], [4036, 4038, "Method"], [4043, 4048, "Method"], [4051, 4053, "Metric"], [4091, 4093, "Metric"], [4100, 4101, "Metric"], [4107, 4108, "Task"], [4128, 4131, "Method"], [4210, 4211, "Task"], [4213, 4215, "Metric"], [4223, 4225, "Metric"], [4226, 4227, "Task"], [4277, 4280, "Method"], [4303, 4308, "Method"], [4319, 4321, "Method"], [4358, 4362, "Method"], [4382, 4385, "Method"], [4397, 4402, "Method"], [4413, 4419, "Task"], [4433, 4436, "Method"], [4443, 4444, "Metric"], [4474, 4479, "Method"], [4494, 4496, "Material"], [4526, 4529, "Method"], [4535, 4540, "Method"], [4561, 4563, "Method"], [4564, 4565, "Task"], [4567, 4568, "Method"], [4593, 4596, "Method"], [4603, 4609, "Method"], [4624, 4629, "Method"], [4638, 4639, "Material"], [4657, 4660, "Method"], [4673, 4678, "Method"], [4684, 4687, "Task"], [4688, 4689, "Method"], [4743, 4748, "Method"], [4763, 4765, "Method"], [4830, 4831, "Method"], [4961, 4964, "Method"], [4994, 4997, "Method"], [4998, 4999, "Task"], [5004, 5006, "Method"], [5010, 5018, "Method"], [5049, 5051, "Metric"], [5065, 5066, "Method"], [5092, 5095, "Method"], [5102, 5107, "Task"], [5121, 5126, "Task"], [5129, 5132, "Task"], [5138, 5140, "Task"], [5146, 5150, "Method"], [5154, 5157, "Method"], [5168, 5169, "Task"], [5182, 5188, "Method"], [5190, 5194, "Method"], [5225, 5227, "Method"], [5228, 5232, "Method"], [5244, 5246, "Method"], [5252, 5254, "Method"], [5263, 5266, "Method"], [5294, 5297, "Method"], [5325, 5329, "Method"], [5334, 5336, "Method"], [5342, 5345, "Method"], [5359, 5360, "Method"], [5362, 5366, "Method"], [5421, 5422, "Method"], [5436, 5438, "Method"], [5444, 5447, "Method"], [5466, 5468, "Method"], [5474, 5475, "Task"], [5482, 5483, "Method"], [621, 622, "Task"], [634, 635, "Task"], [796, 797, "Task"], [1156, 1157, "Task"], [1823, 1824, "Task"], [1834, 1835, "Task"], [2121, 2122, "Task"], [4505, 4506, "Material"], [4512, 4513, "Task"], [5070, 5071, "Task"], [5142, 5143, "Task"], [5178, 5179, "Task"]], "sections": [[0, 182], [182, 659], [659, 1200], [1200, 1415], [1415, 2126], [2126, 2205], [2205, 2405], [2405, 2947], [2947, 2981], [2981, 3822], [3822, 4265], [4265, 4986], [4986, 5319], [5319, 5484], [5484, 5601], [5601, 5604]], "sentences": [[0, 12], [12, 31], [31, 46], [46, 87], [87, 102], [102, 144], [144, 168], [168, 182], [182, 185], [185, 223], [223, 242], [242, 265], [265, 298], [298, 313], [313, 339], [339, 361], [361, 380], [380, 412], [412, 446], [446, 459], [459, 479], [479, 517], [517, 557], [557, 597], [597, 646], [646, 659], [659, 665], [665, 681], [681, 727], [727, 780], [780, 827], [827, 851], [851, 874], [874, 925], [925, 964], [964, 1008], [1008, 1030], [1030, 1054], [1054, 1077], [1077, 1098], [1098, 1102], [1102, 1144], [1144, 1176], [1176, 1188], [1188, 1200], [1200, 1205], [1205, 1274], [1274, 1330], [1330, 1342], [1342, 1360], [1360, 1384], [1384, 1398], [1398, 1415], [1415, 1419], [1419, 1445], [1445, 1465], [1465, 1508], [1508, 1519], [1519, 1531], [1531, 1572], [1572, 1606], [1606, 1644], [1644, 1683], [1683, 1705], [1705, 1708], [1708, 1743], [1743, 1756], [1756, 1788], [1788, 1801], [1801, 1804], [1804, 1863], [1863, 1896], [1896, 1898], [1898, 1926], [1926, 1937], [1937, 1973], [1973, 2002], [2002, 2042], [2042, 2056], [2056, 2076], [2076, 2100], [2100, 2126], [2126, 2131], [2131, 2165], [2165, 2179], [2179, 2205], [2205, 2209], [2209, 2217], [2217, 2232], [2232, 2280], [2280, 2297], [2297, 2313], [2313, 2325], [2325, 2373], [2373, 2405], [2405, 2410], [2410, 2457], [2457, 2522], [2522, 2546], [2546, 2568], [2568, 2580], [2580, 2612], [2612, 2626], [2626, 2636], [2636, 2658], [2658, 2674], [2674, 2697], [2697, 2702], [2702, 2714], [2714, 2747], [2747, 2758], [2758, 2780], [2780, 2802], [2802, 2816], [2816, 2842], [2842, 2845], [2845, 2872], [2872, 2891], [2891, 2894], [2894, 2917], [2917, 2947], [2947, 2952], [2952, 2981], [2981, 2990], [2990, 3011], [3011, 3053], [3053, 3072], [3072, 3123], [3123, 3146], [3146, 3178], [3178, 3198], [3198, 3241], [3241, 3272], [3272, 3305], [3305, 3310], [3310, 3348], [3348, 3374], [3374, 3424], [3424, 3448], [3448, 3470], [3470, 3486], [3486, 3519], [3519, 3551], [3551, 3583], [3583, 3585], [3585, 3614], [3614, 3647], [3647, 3672], [3672, 3712], [3712, 3714], [3714, 3744], [3744, 3784], [3784, 3816], [3816, 3822], [3822, 3829], [3829, 3860], [3860, 3900], [3900, 3932], [3932, 3956], [3956, 3982], [3982, 3984], [3984, 4012], [4012, 4039], [4039, 4090], [4090, 4126], [4126, 4128], [4128, 4148], [4148, 4191], [4191, 4229], [4229, 4249], [4249, 4265], [4265, 4272], [4272, 4317], [4317, 4377], [4377, 4403], [4403, 4420], [4420, 4462], [4462, 4497], [4497, 4499], [4499, 4515], [4515, 4544], [4544, 4564], [4564, 4566], [4566, 4591], [4591, 4616], [4616, 4618], [4618, 4646], [4646, 4684], [4684, 4690], [4690, 4706], [4706, 4711], [4711, 4757], [4757, 4781], [4781, 4827], [4827, 4848], [4848, 4869], [4869, 4892], [4892, 4917], [4917, 4950], [4950, 4986], [4986, 4990], [4990, 5007], [5007, 5052], [5052, 5076], [5076, 5108], [5108, 5144], [5144, 5171], [5171, 5195], [5195, 5218], [5218, 5247], [5247, 5290], [5290, 5319], [5319, 5322], [5322, 5350], [5350, 5373], [5373, 5402], [5402, 5421], [5421, 5461], [5461, 5484], [5484, 5487], [5487, 5527], [5527, 5530], [5530, 5537], [5537, 5548], [5548, 5566], [5566, 5574], [5574, 5601], [5601, 5604]], "words": ["document", ":", "What", "Do", "Recurrent", "Neural", "Network", "Grammars", "Learn", "About", "Syntax", "?", "Recurrent", "neural", "network", "grammars", "(", "RNNG", ")", "are", "a", "recently", "proposed", "probabilistic", "generative", "modeling", "family", "for", "natural", "language", ".", "They", "show", "state", "-", "of", "-", "the", "-", "art", "language", "modeling", "and", "parsing", "performance", ".", "We", "investigate", "what", "information", "they", "learn", ",", "from", "a", "linguistic", "perspective", ",", "through", "various", "ablations", "to", "the", "model", "and", "the", "data", ",", "and", "by", "augmenting", "the", "model", "with", "an", "attention", "mechanism", "(", "GA", "-", "RNNG", ")", "to", "enable", "closer", "inspection", ".", "We", "find", "that", "explicit", "modeling", "of", "composition", "is", "crucial", "for", "achieving", "the", "best", "performance", ".", "Through", "the", "attention", "mechanism", ",", "we", "find", "that", "headedness", "plays", "a", "central", "role", "in", "phrasal", "representation", "(", "with", "the", "model", "\u2019s", "latent", "attention", "largely", "agreeing", "with", "predictions", "made", "by", "hand", "-", "crafted", "head", "rules", ",", "albeit", "with", "some", "important", "differences", ")", ".", "By", "training", "grammars", "without", "nonterminal", "labels", ",", "we", "find", "that", "phrasal", "representations", "depend", "minimally", "on", "nonterminals", ",", "providing", "support", "for", "the", "endocentricity", "hypothesis", ".", "noitemsep", ",", "topsep=10pt", ",", "parsep=0pt", ",", "partopsep=0pt", "noitemsep", ",", "topsep=10pt", ",", "parsep=0pt", ",", "partopsep=0pt", "section", ":", "Introduction", "In", "this", "paper", ",", "we", "focus", "on", "a", "recently", "proposed", "class", "of", "probability", "distributions", ",", "recurrent", "neural", "network", "grammars", "(", "RNNGs", ";", "Dyer", "et", "al", ".", ",", "2016", ")", ",", "designed", "to", "model", "syntactic", "derivations", "of", "sentences", ".", "We", "focus", "on", "RNNGs", "as", "generative", "probabilistic", "models", "over", "trees", ",", "as", "summarized", "in", "\u00a7", "[", "reference", "]", ".", "Fitting", "a", "probabilistic", "model", "to", "data", "has", "often", "been", "understood", "as", "a", "way", "to", "test", "or", "confirm", "some", "aspect", "of", "a", "theory", ".", "We", "talk", "about", "a", "model", "\u2019s", "assumptions", "and", "sometimes", "explore", "its", "parameters", "or", "posteriors", "over", "its", "latent", "variables", "in", "order", "to", "gain", "understanding", "of", "what", "it", "\u201c", "discovers", "\u201d", "from", "the", "data", ".", "In", "some", "sense", ",", "such", "models", "can", "be", "thought", "of", "as", "mini", "-", "scientists", ".", "Neural", "networks", ",", "including", "RNNGs", ",", "are", "capable", "of", "representing", "larger", "classes", "of", "hypotheses", "than", "traditional", "probabilistic", "models", ",", "giving", "them", "more", "freedom", "to", "explore", ".", "Unfortunately", ",", "they", "tend", "to", "be", "bad", "mini", "-", "scientists", ",", "because", "their", "parameters", "are", "difficult", "for", "human", "scientists", "to", "interpret", ".", "RNNGs", "are", "striking", "because", "they", "obtain", "state", "-", "of", "-", "the", "-", "art", "parsing", "and", "language", "modeling", "performance", ".", "Their", "relative", "lack", "of", "independence", "assumptions", ",", "while", "still", "incorporating", "a", "degree", "of", "linguistically", "-", "motivated", "prior", "knowledge", ",", "affords", "the", "model", "considerable", "freedom", "to", "derive", "its", "own", "insights", "about", "syntax", ".", "If", "they", "are", "mini", "-", "scientists", ",", "the", "discoveries", "they", "make", "should", "be", "of", "particular", "interest", "as", "propositions", "about", "syntax", "(", "at", "least", "for", "the", "particular", "genre", "and", "dialect", "of", "the", "data", ")", ".", "This", "paper", "manipulates", "the", "inductive", "bias", "of", "RNNGs", "to", "test", "linguistic", "hypotheses", ".", "We", "begin", "with", "an", "ablation", "study", "to", "discover", "the", "importance", "of", "the", "composition", "function", "in", "\u00a7", "[", "reference", "]", ".", "Based", "on", "the", "findings", ",", "we", "augment", "the", "RNNG", "composition", "function", "with", "a", "novel", "gated", "attention", "mechanism", "(", "leading", "to", "the", "GA", "-", "RNNG", ")", "to", "incorporate", "more", "interpretability", "into", "the", "model", "in", "\u00a7", "[", "reference", "]", ".", "Using", "the", "GA", "-", "RNNG", ",", "we", "proceed", "by", "investigating", "the", "role", "that", "individual", "heads", "play", "in", "phrasal", "representation", "(", "\u00a7", "[", "reference", "]", ")", "and", "the", "role", "that", "nonterminal", "category", "labels", "play", "(", "\u00a7", "[", "reference", "]", ")", ".", "Our", "key", "findings", "are", "that", "lexical", "heads", "play", "an", "important", "role", "in", "representing", "most", "phrase", "types", "(", "although", "compositions", "of", "multiple", "salient", "heads", "are", "not", "infrequent", ",", "especially", "for", "conjunctions", ")", "and", "that", "nonterminal", "labels", "provide", "little", "additional", "information", ".", "As", "a", "by", "-", "product", "of", "our", "investigation", ",", "a", "variant", "of", "the", "RNNG", "without", "ensembling", "achieved", "the", "best", "reported", "supervised", "phrase", "-", "structure", "parsing", "(", "93.6", ";", "English", "PTB", ")", "and", ",", "through", "conversion", ",", "dependency", "parsing", "(", "95.8", "UAS", ",", "94.6", "LAS", ";", "PTB", "SD", ")", ".", "The", "code", "and", "pretrained", "models", "to", "replicate", "our", "results", "are", "publicly", "available", ".", "section", ":", "Recurrent", "Neural", "Network", "Grammars", "An", "RNNG", "defines", "a", "joint", "probability", "distribution", "over", "string", "terminals", "and", "phrase", "-", "structure", "nonterminals", ".", "Formally", ",", "the", "RNNG", "is", "defined", "by", "a", "triple", ",", "where", "denotes", "the", "set", "of", "nonterminal", "symbols", "(", "NP", ",", "VP", ",", "etc", ".", ")", ",", "the", "set", "of", "all", "terminal", "symbols", "(", "we", "assume", "that", ")", ",", "and", "the", "set", "of", "all", "model", "parameters", ".", "Unlike", "previous", "works", "that", "rely", "on", "hand", "-", "crafted", "rules", "to", "compose", "more", "fine", "-", "grained", "phrase", "representations", ",", "the", "RNNG", "implicitly", "parameterizes", "the", "information", "passed", "through", "compositions", "of", "phrases", "(", "in", "and", "the", "neural", "network", "architecture", ")", ",", "hence", "weakening", "the", "strong", "independence", "assumptions", "in", "classical", "probabilistic", "context", "-", "free", "grammars", ".", "The", "RNNG", "is", "based", "on", "an", "abstract", "state", "machine", "like", "those", "used", "in", "transition", "-", "based", "parsing", ",", "with", "its", "algorithmic", "state", "consisting", "of", "a", "stack", "of", "partially", "completed", "constituents", ",", "a", "buffer", "of", "already", "-", "generated", "terminal", "symbols", ",", "and", "a", "list", "of", "past", "actions", ".", "To", "generate", "a", "sentence", "and", "its", "phrase", "-", "structure", "tree", ",", "the", "RNNG", "samples", "a", "sequence", "of", "actions", "to", "construct", "top", "-", "down", ".", "Given", ",", "there", "is", "one", "such", "sequence", "(", "easily", "identified", ")", ",", "which", "we", "call", "the", "oracle", ",", "used", "during", "supervised", "training", ".", "The", "RNNG", "uses", "three", "different", "actions", ":", ",", "where", ",", "introduces", "an", "open", "nonterminal", "symbol", "onto", "the", "stack", ",", "e.g.", ",", "\u201c", "(", "NP", "\u201d", ";", ",", "where", ",", "generates", "a", "terminal", "symbol", "and", "places", "it", "on", "the", "stack", "and", "buffer", ";", "and", "reduce", "indicates", "a", "constituent", "is", "now", "complete", ".", "The", "elements", "of", "the", "stack", "that", "comprise", "the", "current", "constituent", "(", "going", "back", "to", "the", "last", "open", "nonterminal", ")", "are", "popped", ",", "a", "composition", "function", "is", "executed", ",", "yielding", "a", "composed", "representation", "that", "is", "pushed", "onto", "the", "stack", ".", "At", "each", "timestep", ",", "the", "model", "encodes", "the", "stack", ",", "buffer", ",", "and", "past", "actions", ",", "with", "a", "separate", "LSTM", "for", "each", "component", "as", "features", "to", "define", "a", "distribution", "over", "the", "next", "action", "to", "take", "(", "conditioned", "on", "the", "full", "algorithmic", "state", ")", ".", "The", "overall", "architecture", "is", "illustrated", "in", "Figure", "[", "reference", "]", ";", "examples", "of", "full", "action", "sequences", "can", "be", "found", "in", "rnng", ".", "A", "key", "element", "of", "the", "RNNG", "is", "the", "composition", "function", ",", "which", "reduces", "a", "completed", "constituent", "into", "a", "single", "element", "on", "the", "stack", ".", "This", "function", "computes", "a", "vector", "representation", "of", "the", "new", "constituent", ";", "it", "also", "uses", "an", "LSTM", "(", "here", "a", "bidirectional", "one", ")", ".", "This", "composition", "function", ",", "which", "we", "consider", "in", "greater", "depth", "in", "\u00a7", "[", "reference", "]", ",", "is", "illustrated", "in", "Fig", ".", "[", "reference", "]", ".", "Since", "the", "RNNG", "is", "a", "generative", "model", ",", "it", "attempts", "to", "maximize", ",", "the", "joint", "distribution", "of", "strings", "and", "trees", ",", "defined", "as", "In", "other", "words", ",", "is", "defined", "as", "a", "product", "of", "local", "probabilities", ",", "conditioned", "on", "all", "past", "actions", ".", "The", "joint", "probability", "estimate", "can", "be", "used", "for", "both", "phrase", "-", "structure", "parsing", "(", "finding", ")", "and", "language", "modeling", "(", "finding", "by", "marginalizing", "over", "the", "set", "of", "possible", "parses", "for", ")", ".", "Both", "inference", "problems", "can", "be", "solved", "using", "an", "importance", "sampling", "procedure", ".", "We", "report", "all", "RNNG", "performance", "based", "on", "the", "corrigendum", "to", "rnng", ".", "section", ":", "Composition", "is", "Key", "Given", "the", "same", "data", ",", "under", "both", "the", "discriminative", "and", "generative", "settings", "RNNGs", "were", "found", "to", "parse", "with", "significantly", "higher", "accuracy", "than", "(", "respectively", ")", "the", "models", "of", "vinyals:2015", "and", "choe:2016", "that", "represent", "as", "a", "\u201c", "linearized", "\u201d", "sequence", "of", "symbols", "and", "parentheses", "without", "explicitly", "capturing", "the", "tree", "structure", ",", "or", "even", "constraining", "the", "to", "be", "a", "well", "-", "formed", "tree", "(", "see", "Table", "[", "reference", "]", ")", ".", "vinyals:2015", "directly", "predict", "the", "sequence", "of", "nonterminals", ",", "\u201c", "shifts", "\u201d", "(", "which", "consume", "a", "terminal", "symbol", ")", ",", "and", "parentheses", "from", "left", "to", "right", ",", "conditional", "on", "the", "input", "terminal", "sequence", ",", "while", "choe:2016", "used", "a", "sequential", "LSTM", "language", "model", "on", "the", "same", "linearized", "trees", "to", "create", "a", "generative", "variant", "of", "the", "vinyals:2015", "model", ".", "The", "generative", "model", "is", "used", "to", "re", "-", "rank", "parse", "candidates", ".", "The", "results", "in", "Table", "[", "reference", "]", "suggest", "that", "the", "RNNG", "\u2019s", "explicit", "composition", "function", "(", "Fig", ".", "[", "reference", "]", ")", ",", "which", "vinyals:2015", "and", "choe:2016", "must", "learn", "implicitly", ",", "plays", "a", "crucial", "role", "in", "the", "RNNG", "\u2019s", "generalization", "success", ".", "Beyond", "this", ",", "Choe", "and", "Charniak", "\u2019s", "generative", "variant", "of", "Vinyals", "et", "al", ".", "(", "2015", ")", "is", "another", "instance", "where", "generative", "models", "trained", "on", "the", "PTB", "outperform", "discriminative", "models", ".", "subsection", ":", "Ablated", "RNNGs", "On", "close", "inspection", ",", "it", "is", "clear", "that", "the", "RNNG", "\u2019s", "three", "data", "structures", "\u2014", "stack", ",", "buffer", ",", "and", "action", "history", "\u2014", "are", "redundant", ".", "For", "example", ",", "the", "action", "history", "and", "buffer", "contents", "completely", "determine", "the", "structure", "of", "the", "stack", "at", "every", "timestep", ".", "Every", "generated", "word", "goes", "onto", "the", "stack", ",", "too", ";", "and", "some", "past", "words", "will", "be", "composed", "into", "larger", "structures", ",", "but", "through", "the", "composition", "function", ",", "they", "are", "all", "still", "\u201c", "available", "\u201d", "to", "the", "network", "that", "predicts", "the", "next", "action", ".", "Similarly", ",", "the", "past", "actions", "are", "redundant", "with", "the", "stack", ".", "Despite", "this", "redundancy", ",", "only", "the", "stack", "incorporates", "the", "composition", "function", ".", "Since", "each", "of", "the", "ablated", "models", "is", "sufficient", "to", "encode", "all", "necessary", "partial", "tree", "information", ",", "the", "primary", "difference", "is", "that", "ablations", "with", "the", "stack", "use", "explicit", "composition", ",", "to", "which", "we", "can", "therefore", "attribute", "most", "of", "the", "performance", "difference", ".", "We", "conjecture", "that", "the", "stack", "\u2014", "the", "component", "that", "makes", "use", "of", "the", "composition", "function", "\u2014", "is", "critical", "to", "the", "RNNG", "\u2019s", "performance", ",", "and", "that", "the", "buffer", "and", "action", "history", "are", "not", ".", "In", "transition", "-", "based", "parsers", "built", "on", "expert", "-", "crafted", "features", ",", "the", "most", "recent", "words", "and", "actions", "are", "useful", "if", "they", "are", "salient", ",", "although", "neural", "representation", "learners", "can", "automatically", "learn", "what", "information", "should", "be", "salient", ".", "To", "test", "this", "conjecture", ",", "we", "train", "ablated", "RNNGs", "that", "lack", "each", "of", "the", "three", "data", "structures", "(", "action", "history", ",", "buffer", ",", "stack", ")", ",", "as", "well", "as", "one", "that", "lacks", "both", "the", "action", "history", "and", "buffer", ".", "If", "our", "conjecture", "is", "correct", ",", "performance", "should", "degrade", "most", "without", "the", "stack", ",", "and", "the", "stack", "alone", "should", "perform", "competitively", ".", "Experimental", "settings", ".", "We", "perform", "our", "experiments", "on", "the", "English", "PTB", "corpus", ",", "with", "\u00a7", "02\u201321", "for", "training", ",", "\u00a7", "24", "for", "validation", ",", "and", "\u00a7", "23", "for", "test", ";", "no", "additional", "data", "were", "used", "for", "training", ".", "We", "follow", "the", "same", "hyperparameters", "as", "the", "generative", "model", "proposed", "in", "rnng", ".", "The", "generative", "model", "did", "not", "use", "any", "pretrained", "word", "embeddings", "or", "POS", "tags", ";", "a", "discriminative", "variant", "of", "the", "standard", "RNNG", "was", "used", "to", "obtain", "tree", "samples", "for", "the", "generative", "model", ".", "All", "further", "experiments", "use", "the", "same", "settings", "and", "hyperparameters", "unless", "otherwise", "noted", ".", "Experimental", "results", ".", "We", "trained", "each", "ablation", "from", "scratch", ",", "and", "compared", "these", "models", "on", "three", "tasks", ":", "English", "phrase", "-", "structure", "parsing", "(", "labeled", ")", ",", "Table", "[", "reference", "]", ";", "dependency", "parsing", ",", "Table", "[", "reference", "]", ",", "by", "converting", "parse", "output", "to", "Stanford", "dependencies", "using", "the", "tool", "by", "kong_14", ";", "and", "language", "modeling", ",", "Table", "[", "reference", "]", ".", "The", "last", "row", "of", "each", "table", "reports", "the", "performance", "of", "a", "novel", "variant", "of", "the", "(", "stack", "-", "only", ")", "RNNG", "with", "attention", ",", "to", "be", "presented", "in", "\u00a7", "[", "reference", "]", ".", "Discussion", ".", "The", "RNNG", "with", "only", "a", "stack", "is", "the", "strongest", "of", "the", "ablations", ",", "and", "it", "even", "outperforms", "the", "\u201c", "full", "\u201d", "RNNG", "with", "all", "three", "data", "structures", ".", "Ablating", "the", "stack", "gives", "the", "worst", "among", "the", "new", "results", ".", "This", "strongly", "supports", "the", "importance", "of", "the", "composition", "function", ":", "a", "proper", "reduce", "operation", "that", "transforms", "a", "constituent", "\u2019s", "parts", "and", "nonterminal", "label", "into", "a", "single", "explicit", "(", "vector", ")", "representation", "is", "helpful", "to", "performance", ".", "It", "is", "noteworthy", "that", "the", "stack", "alone", "is", "stronger", "than", "the", "original", "RNNG", ",", "which", "\u2014", "in", "principle", "\u2014", "can", "learn", "to", "disregard", "the", "buffer", "and", "action", "history", ".", "Since", "the", "stack", "maintains", "syntactically", "\u201c", "recent", "\u201d", "information", "near", "its", "top", ",", "we", "conjecture", "that", "the", "learner", "is", "overfitting", "to", "spurious", "predictors", "in", "the", "buffer", "and", "action", "history", "that", "explain", "the", "training", "data", "but", "do", "not", "generalize", "well", ".", "A", "similar", "performance", "degradation", "is", "seen", "in", "language", "modeling", "(", "Table", "[", "reference", "]", ")", ":", "the", "stack", "-", "only", "RNNG", "achieves", "the", "best", "performance", ",", "and", "ablating", "the", "stack", "is", "most", "harmful", ".", "Indeed", ",", "modeling", "syntax", "without", "explicit", "composition", "(", "the", "stack", "-", "ablated", "RNNG", ")", "provides", "little", "benefit", "over", "a", "sequential", "LSTM", "language", "model", ".", "We", "remark", "that", "the", "stack", "-", "only", "results", "are", "the", "best", "published", "PTB", "results", "for", "both", "phrase", "-", "structure", "and", "dependency", "parsing", "among", "supervised", "models", ".", "section", ":", "Gated", "Attention", "RNNG", "Having", "established", "that", "the", "composition", "function", "is", "key", "to", "RNNG", "performance", "(", "\u00a7", "[", "reference", "]", ")", ",", "we", "now", "seek", "to", "understand", "the", "nature", "of", "the", "composed", "phrasal", "representations", "that", "are", "learned", ".", "Like", "most", "neural", "networks", ",", "interpreting", "the", "composition", "function", "\u2019s", "behavior", "is", "challenging", ".", "Fortunately", ",", "linguistic", "theories", "offer", "a", "number", "of", "hypotheses", "about", "the", "nature", "of", "representations", "of", "phrases", "that", "can", "provide", "a", "conceptual", "scaffolding", "to", "understand", "them", ".", "subsection", ":", "Linguistic", "Hypotheses", "We", "consider", "two", "theories", "about", "phrasal", "representation", ".", "The", "first", "is", "that", "phrasal", "representations", "are", "strongly", "determined", "by", "a", "privileged", "lexical", "head", ".", "Augmenting", "grammars", "with", "lexical", "head", "information", "has", "a", "long", "history", "in", "parsing", ",", "starting", "with", "the", "models", "of", "collins_97", ",", "and", "theories", "of", "syntax", "such", "as", "the", "\u201c", "bare", "phrase", "structure", "\u201d", "hypothesis", "of", "the", "Minimalist", "Program", "posit", "that", "phrases", "are", "represented", "purely", "by", "single", "lexical", "heads", ".", "Proposals", "for", "multiple", "headed", "phrases", "(", "to", "deal", "with", "tricky", "cases", "like", "conjunction", ")", "likewise", "exist", ".", "Do", "the", "phrasal", "representations", "learned", "by", "RNNGs", "depend", "on", "individual", "lexical", "heads", "or", "multiple", "heads", "?", "Or", "do", "the", "representations", "combine", "all", "children", "without", "any", "salient", "head", "?", "Related", "to", "the", "question", "about", "the", "role", "of", "heads", "in", "phrasal", "representation", "is", "the", "question", "of", "whether", "phrase", "-", "internal", "material", "wholly", "determines", "the", "representation", "of", "a", "phrase", "(", "an", "endocentric", "representation", ")", "or", "whether", "nonterminal", "relabeling", "of", "a", "constitutent", "introduces", "new", "information", "(", "exocentric", "representations", ")", ".", "To", "illustrate", "the", "contrast", ",", "an", "endocentric", "representation", "is", "representing", "a", "noun", "phrase", "with", "a", "noun", "category", ",", "whereas", "exocentrically", "introduces", "a", "new", "syntactic", "category", "that", "is", "neither", "NP", "nor", "VP", ".", "subsection", ":", "Gated", "Attention", "Composition", "To", "investigate", "what", "the", "stack", "-", "only", "RNNG", "learns", "about", "headedness", "(", "and", "later", "endocentricity", ")", ",", "we", "propose", "a", "variant", "of", "the", "composition", "function", "that", "makes", "use", "of", "an", "explicit", "attention", "mechanism", "and", "a", "sigmoid", "gate", "with", "multiplicative", "interactions", ",", "henceforth", "called", "GA", "-", "RNNG", ".", "At", "every", "reduce", "operation", ",", "the", "GA", "-", "RNNG", "assigns", "an", "\u201c", "attention", "weight", "\u201d", "to", "each", "of", "its", "children", "(", "between", "0", "and", "1", "such", "that", "the", "total", "weight", "off", "all", "children", "sums", "to", "1", ")", ",", "and", "the", "parent", "phrase", "is", "represented", "by", "the", "combination", "of", "a", "sum", "of", "each", "child", "\u2019s", "representation", "scaled", "by", "its", "attention", "weight", "and", "its", "nonterminal", "type", ".", "Our", "weighted", "sum", "is", "more", "expressive", "than", "traditional", "head", "rules", ",", "however", ",", "because", "it", "allows", "attention", "to", "be", "divided", "among", "multiple", "constituents", ".", "Head", "rules", ",", "conversely", ",", "are", "analogous", "to", "giving", "all", "attention", "to", "one", "constituent", ",", "the", "one", "containing", "the", "lexical", "head", ".", "We", "now", "formally", "define", "the", "GA", "-", "RNNG", "\u2019s", "composition", "function", ".", "Recall", "that", "is", "the", "concatenation", "of", "the", "vector", "representations", "of", "the", "RNNG", "\u2019s", "data", "structures", ",", "used", "to", "assign", "probabilities", "to", "each", "of", "the", "actions", "available", "at", "timestep", "(", "see", "Fig", ".", "[", "reference", "]", ",", "the", "layer", "before", "the", "softmax", "at", "the", "top", ")", ".", "For", "simplicity", ",", "we", "drop", "the", "timestep", "index", "here", ".", "Let", "denote", "the", "vector", "embedding", "(", "learned", ")", "of", "the", "nonterminal", "being", "constructed", ",", "for", "the", "purpose", "of", "computing", "attention", "weights", ".", "Now", "let", "denote", "the", "sequence", "of", "vector", "embeddings", "for", "the", "constituents", "of", "the", "new", "phrase", ".", "The", "length", "of", "these", "vectors", "is", "defined", "by", "the", "dimensionality", "of", "the", "bidirectional", "LSTM", "used", "in", "the", "original", "composition", "function", "(", "Fig", ".", "[", "reference", "]", ")", ".", "We", "use", "semicolon", "(", ";", ")", "to", "denote", "vector", "concatenation", "operations", ".", "The", "attention", "vector", "is", "given", "by", ":", "Note", "that", "the", "length", "of", "is", "the", "same", "as", "the", "number", "of", "constituents", ",", "and", "that", "this", "vector", "sums", "to", "one", "due", "to", "the", "softmax", ".", "It", "divides", "a", "single", "unit", "of", "attention", "among", "the", "constituents", ".", "Next", ",", "note", "that", "the", "constituent", "source", "vector", "is", "a", "convex", "combination", "of", "the", "child", "-", "constituents", ",", "weighted", "by", "attention", ".", "We", "will", "combine", "this", "with", "another", "embedding", "of", "the", "nonterminal", "denoted", "as", "(", "separate", "from", ")", "using", "a", "sigmoid", "gating", "mechanism", ":", "Note", "that", "the", "value", "of", "the", "gate", "is", "bounded", "between", "in", "each", "dimension", ".", "The", "new", "phrase", "\u2019s", "final", "representation", "uses", "element", "-", "wise", "multiplication", "(", ")", "with", "respect", "to", "both", "and", ",", "a", "process", "reminiscent", "of", "the", "LSTM", "\u201c", "forget", "\u201d", "gate", ":", "The", "intuition", "is", "that", "the", "composed", "representation", "should", "incorporate", "both", "nonterminal", "information", "and", "information", "about", "the", "constituents", "(", "through", "weighted", "sum", "and", "attention", "mechanism", ")", ".", "The", "gate", "modulates", "the", "interaction", "between", "them", "to", "account", "for", "varying", "importance", "between", "the", "two", "in", "different", "contexts", ".", "Experimental", "results", ".", "We", "include", "this", "model", "\u2019s", "performance", "in", "Tables", "[", "reference", "]", "\u2013", "[", "reference", "]", "(", "last", "row", "in", "all", "tables", ")", ".", "It", "is", "clear", "that", "the", "model", "outperforms", "the", "baseline", "RNNG", "with", "all", "three", "structures", "present", "and", "achieves", "competitive", "performance", "with", "the", "strongest", ",", "stack", "-", "only", ",", "RNNG", "variant", ".", "section", ":", "Headedness", "in", "Phrases", "We", "now", "exploit", "the", "attention", "mechanism", "to", "probe", "what", "the", "RNNG", "learns", "about", "headedness", "on", "the", "WSJ", "\u00a7", "23", "test", "set", "(", "unseen", "before", "by", "the", "model", ")", ".", "subsection", ":", "The", "Heads", "that", "GA", "-", "RNNG", "Learns", "The", "attention", "weight", "vectors", "tell", "us", "which", "constituents", "are", "most", "important", "to", "a", "phrase", "\u2019s", "vector", "representation", "in", "the", "stack", ".", "Here", ",", "we", "inspect", "the", "attention", "vectors", "to", "investigate", "whether", "the", "model", "learns", "to", "center", "its", "attention", "around", "a", "single", ",", "or", "by", "extension", "a", "few", ",", "salient", "elements", ",", "which", "would", "confirm", "the", "presence", "of", "headedness", "in", "GA", "-", "RNNG", ".", "First", ",", "we", "consider", "several", "major", "nonterminal", "categories", ",", "and", "estimate", "the", "average", "perplexity", "of", "the", "attention", "vectors", ".", "The", "average", "perplexity", "can", "be", "interpreted", "as", "the", "average", "number", "of", "\u201c", "choices", "\u201d", "for", "each", "nonterminal", "category", ";", "this", "value", "is", "only", "computed", "for", "the", "cases", "where", "the", "number", "of", "components", "in", "the", "composed", "phrase", "is", "at", "least", "two", "(", "otherwise", "the", "attention", "weight", "would", "be", "trivially", "1", ")", ".", "The", "minimum", "possible", "value", "for", "the", "perplexity", "is", "1", ",", "indicating", "a", "full", "attention", "weight", "around", "one", "component", "and", "zero", "everywhere", "else", ".", "Figure", "[", "reference", "]", "(", "in", "blue", ")", "shows", "much", "less", "than", "2", "average", "\u201c", "choices", "\u201d", "across", "nonterminal", "categories", ",", "which", "also", "holds", "true", "for", "all", "other", "categories", "not", "shown", ".", "For", "comparison", "we", "also", "report", "the", "average", "perplexity", "of", "the", "uniform", "distribution", "for", "the", "same", "nonterminal", "categories", "(", "Fig", ".", "[", "reference", "]", "in", "red", ")", ";", "this", "represents", "the", "highest", "entropy", "cases", "where", "there", "is", "no", "headedness", "at", "all", "by", "assigning", "the", "same", "attention", "weight", "to", "each", "constituent", "(", "e.g.", "attention", "weights", "of", "0.25", "each", "for", "phrases", "with", "four", "constituents", ")", ".", "It", "is", "clear", "that", "the", "learned", "attention", "weights", "have", "much", "lower", "perplexity", "than", "the", "uniform", "distribution", "baseline", ",", "indicating", "that", "the", "learned", "attention", "weights", "are", "quite", "peaked", "around", "certain", "components", ".", "This", "implies", "that", "phrases", "\u2019", "vectors", "tend", "to", "resemble", "the", "vector", "of", "one", "salient", "constituent", ",", "but", "not", "exclusively", ",", "as", "the", "perplexity", "for", "most", "categories", "is", "still", "not", "close", "to", "one", ".", "Next", ",", "we", "consider", "the", "how", "attention", "is", "distributed", "for", "the", "major", "nonterminal", "categories", "in", "Table", "[", "reference", "]", ",", "where", "the", "first", "five", "rows", "of", "each", "category", "represent", "compositions", "with", "highest", "entropy", ",", "and", "the", "next", "five", "rows", "are", "qualitatively", "analyzed", ".", "The", "high", "-", "entropy", "cases", "where", "the", "attention", "is", "most", "divided", "represent", "more", "complex", "phrases", "with", "conjunctions", "or", "more", "than", "one", "plausible", "head", ".", "NPs", ".", "In", "most", "simple", "noun", "phrases", "(", "representative", "samples", "in", "rows", "6\u20137", "of", "Table", "[", "reference", "]", ")", ",", "the", "model", "pays", "the", "most", "attention", "to", "the", "rightmost", "noun", "and", "assigns", "near", "-", "zero", "attention", "on", "determiners", "and", "possessive", "determiners", ",", "while", "also", "paying", "nontrivial", "attention", "weights", "to", "the", "adjectives", ".", "This", "finding", "matches", "existing", "head", "rules", "and", "our", "intuition", "that", "nouns", "head", "noun", "phrases", ",", "and", "that", "adjectives", "are", "more", "important", "than", "determiners", ".", "We", "analyze", "the", "case", "where", "the", "noun", "phrase", "contains", "a", "conjunction", "in", "the", "last", "three", "rows", "of", "Table", "[", "reference", "]", ".", "The", "syntax", "of", "conjunction", "is", "a", "long", "-", "standing", "source", "of", "controversy", "in", "syntactic", "analysis", ".", "Our", "model", "suggests", "that", "several", "representational", "strategies", "are", "used", ",", "when", "coordinating", "single", "nouns", ",", "both", "the", "first", "noun", "(", "8", ")", "and", "the", "last", "noun", "(", "9", ")", "may", "be", "selected", ".", "However", ",", "in", "the", "case", "of", "conjunctions", "of", "multiple", "noun", "phrases", "(", "as", "opposed", "to", "multiple", "single", "-", "word", "nouns", ")", ",", "the", "model", "consistently", "picks", "the", "conjunction", "as", "the", "head", ".", "All", "of", "these", "representational", "strategies", "have", "been", "argued", "for", "individually", "on", "linguistic", "grounds", ",", "and", "since", "we", "see", "all", "of", "them", "present", ",", "RNNGs", "face", "the", "same", "confusion", "that", "linguists", "do", ".", "VPs", ".", "The", "attention", "weights", "on", "simple", "verb", "phrases", "(", "e.g.", ",", "\u201c", "VP", "V", "NP", "\u201d", ",", "9", ")", "are", "peaked", "around", "the", "noun", "phrase", "instead", "of", "the", "verb", ".", "This", "implies", "that", "the", "verb", "phrase", "would", "look", "most", "similar", "to", "the", "noun", "under", "it", "and", "contradicts", "existing", "head", "rules", "that", "unanimously", "put", "the", "verb", "as", "the", "head", "of", "the", "verb", "phrase", ".", "Another", "interesting", "finding", "is", "that", "the", "model", "pays", "attention", "to", "polarity", "information", ",", "where", "negations", "are", "almost", "always", "assigned", "non", "-", "trivial", "attention", "weights", ".", "Furthermore", ",", "we", "find", "that", "the", "model", "attends", "to", "the", "conjunction", "terminal", "in", "conjunctions", "of", "verb", "phrases", "(", "e.g.", ",", "\u201c", "VP", "VP", "and", "VP", "\u201d", ",", "10", ")", ",", "reinforcing", "the", "similar", "finding", "for", "conjunction", "of", "noun", "phrases", ".", "PPs", ".", "In", "almost", "all", "cases", ",", "the", "model", "attends", "to", "the", "preposition", "terminal", "instead", "of", "the", "noun", "phrases", "or", "complete", "clauses", "under", "it", ",", "regardless", "of", "the", "type", "of", "preposition", ".", "Even", "when", "the", "prepositional", "phrase", "is", "only", "used", "to", "make", "a", "connection", "between", "two", "noun", "phrases", "(", "e.g.", ",", "\u201c", "PP", "NP", "after", "NP", "\u201d", ",", "10", ")", ",", "the", "prepositional", "connector", "is", "still", "considered", "the", "most", "salient", "element", ".", "This", "is", "less", "consistent", "with", "the", "Collins", "and", "Stanford", "head", "rules", ",", "where", "prepositions", "are", "assigned", "a", "lower", "priority", "when", "composing", "PPs", ",", "although", "more", "consistent", "with", "the", "Johansson", "head", "rule", ".", "ADJP", "VP", "NP", "PP", "QP", "SBAR", "subsection", ":", "Comparison", "to", "Existing", "Head", "Rules", "To", "better", "measure", "the", "overlap", "between", "the", "attention", "vectors", "and", "existing", "head", "rules", ",", "we", "converted", "the", "trees", "in", "PTB", "\u00a7", "23", "into", "a", "dependency", "representation", "using", "the", "attention", "weights", ".", "In", "this", "case", ",", "the", "attention", "weight", "functions", "as", "a", "\u201c", "dynamic", "\u201d", "head", "rule", ",", "where", "all", "other", "constituents", "within", "the", "same", "composed", "phrase", "are", "considered", "to", "modify", "the", "constituent", "with", "the", "highest", "attention", "weight", ",", "repeated", "recursively", ".", "The", "head", "of", "the", "composed", "representation", "for", "\u201c", "S", "\u201d", "at", "the", "top", "of", "the", "tree", "is", "attached", "to", "a", "special", "root", "symbol", "and", "functions", "as", "the", "head", "of", "the", "sentence", ".", "We", "measure", "the", "overlap", "between", "the", "resulting", "tree", "and", "conversion", "results", "of", "the", "same", "trees", "using", "the", "collins_97", "and", "Stanford", "dependencies", "head", "rules", ".", "Results", "are", "evaluated", "using", "the", "standard", "evaluation", "script", "(", "excluding", "punctuation", ")", "in", "terms", "of", "UAS", ",", "since", "the", "attention", "weights", "do", "not", "provide", "labels", ".", "Results", ".", "The", "model", "has", "a", "higher", "overlap", "with", "the", "conversion", "using", "Collins", "head", "rules", "(", "49.8", "UAS", ")", "rather", "than", "the", "Stanford", "head", "rules", "(", "40.4", "UAS", ")", ".", "We", "attribute", "this", "large", "gap", "to", "the", "fact", "that", "the", "Stanford", "head", "rules", "incorporate", "more", "semantic", "considerations", ",", "while", "the", "RNNG", "is", "a", "purely", "syntactic", "model", ".", "In", "general", ",", "the", "attention", "-", "based", "tree", "output", "has", "a", "high", "error", "rate", "(", "90", "%", ")", "when", "the", "dependent", "is", "a", "verb", ",", "since", "the", "constituent", "with", "the", "highest", "attention", "weight", "in", "a", "verb", "phrase", "is", "often", "the", "noun", "phrase", "instead", "of", "the", "verb", ",", "as", "discussed", "above", ".", "The", "conversion", "accuracy", "is", "better", "for", "nouns", "(", "50", "%", "error", ")", ",", "and", "much", "better", "for", "determiners", "(", "30", "%", ")", "and", "particles", "(", "6", "%", ")", "with", "respect", "to", "the", "Collins", "head", "rules", ".", "Discussion", ".", "GA", "-", "RNNG", "has", "the", "power", "to", "infer", "head", "rules", ",", "and", "to", "a", "large", "extent", ",", "it", "does", ".", "It", "follows", "some", "conventions", "that", "are", "established", "in", "one", "or", "more", "previous", "head", "rule", "sets", "(", "e.g.", ",", "prepositions", "head", "prepositional", "phrases", ",", "nouns", "head", "noun", "phrases", ")", ",", "but", "attends", "more", "to", "a", "verb", "phrase", "\u2019s", "nominal", "constituents", "than", "the", "verb", ".", "It", "is", "important", "to", "note", "that", "this", "is", "not", "the", "by", "-", "product", "of", "learning", "a", "specific", "model", "for", "parsing", ";", "the", "training", "objective", "is", "joint", "likelihood", ",", "which", "is", "not", "a", "proxy", "loss", "for", "parsing", "performance", ".", "These", "decisions", "were", "selected", "because", "they", "make", "the", "data", "maximally", "likely", "(", "though", "admittedly", "only", "locally", "maximally", "likely", ")", ".", "We", "leave", "deeper", "consideration", "of", "this", "noun", "-", "centered", "verb", "phrase", "hypothesis", "to", "future", "work", ".", "section", ":", "The", "Role", "of", "Nonterminal", "Labels", "Emboldened", "by", "our", "finding", "that", "GA", "-", "RNNGs", "learn", "a", "notion", "of", "headedness", ",", "we", "next", "explore", "whether", "heads", "are", "sufficient", "to", "create", "representations", "of", "phrases", "(", "in", "line", "with", "an", "endocentric", "theory", "of", "phrasal", "representation", ")", "or", "whether", "extra", "nonterminal", "information", "is", "necessary", ".", "If", "the", "endocentric", "hypothesis", "is", "true", "(", "that", "is", ",", "the", "representation", "of", "a", "phrase", "is", "built", "from", "within", "depending", "on", "its", "components", "but", "independent", "of", "explicit", "category", "labels", ")", ",", "then", "the", "nonterminal", "types", "should", "be", "easily", "inferred", "given", "the", "endocentrically", "-", "composed", "representation", ",", "and", "that", "ablating", "the", "nonterminal", "information", "would", "not", "make", "much", "difference", "in", "performance", ".", "Specifically", ",", "we", "train", "a", "GA", "-", "RNNG", "on", "unlabeled", "trees", "(", "only", "bracketings", "without", "nonterminal", "types", ")", ",", "denoted", "U", "-", "GA", "-", "RNNG", ".", "This", "idea", "has", "been", "explored", "in", "research", "on", "methods", "for", "learning", "syntax", "with", "less", "complete", "annotation", ".", "A", "key", "finding", "from", "klein_02", "was", "that", ",", "given", "bracketing", "structure", ",", "simple", "dimensionality", "reduction", "techniques", "could", "reveal", "conventional", "nonterminal", "categories", "with", "high", "accuracy", ";", "petrov_2006", "also", "showed", "that", "latent", "variables", "can", "be", "used", "to", "recover", "fine", "-", "grained", "nonterminal", "categories", ".", "We", "therefore", "expect", "that", "the", "vector", "embeddings", "of", "the", "constituents", "that", "the", "U", "-", "GA", "-", "RNNG", "correctly", "recovers", "(", "on", "test", "data", ")", "will", "capture", "categories", "similar", "to", "those", "in", "the", "Penn", "Treebank", ".", "Experiments", ".", "Using", "the", "same", "hyperparameters", "and", "the", "PTB", "dataset", ",", "we", "first", "consider", "unlabeled", "parsing", "accuracy", ".", "On", "test", "data", "(", "with", "the", "usual", "split", ")", ",", "the", "GA", "-", "RNNG", "achieves", "94.2", "%", ",", "while", "the", "U", "-", "GA", "-", "RNNG", "achieves", "93.5", "%", ".", "This", "result", "suggests", "that", "nonterminal", "category", "labels", "add", "a", "relatively", "small", "amount", "of", "information", "compared", "to", "purely", "endocentric", "representations", ".", "Visualization", ".", "If", "endocentricity", "is", "largely", "sufficient", "to", "account", "for", "the", "behavior", "of", "phrases", ",", "where", "do", "our", "robust", "intuitions", "for", "syntactic", "category", "types", "come", "from", "?", "We", "use", "t", "-", "SNE", "to", "visualize", "composed", "phrase", "vectors", "from", "the", "U", "-", "GA", "-", "RNNG", "model", "applied", "to", "the", "unseen", "test", "data", ".", "Fig", ".", "[", "reference", "]", "shows", "that", "the", "U", "-", "GA", "-", "RNNG", "tends", "to", "recover", "nonterminal", "categories", "as", "encoded", "in", "the", "PTB", ",", "even", "when", "trained", "without", "them", ".", "These", "results", "suggest", "nonterminal", "types", "can", "be", "inferred", "from", "the", "purely", "endocentric", "compositional", "process", "to", "a", "certain", "extent", ",", "and", "that", "the", "phrase", "clusters", "found", "by", "the", "U", "-", "GA", "-", "RNNG", "largely", "overlap", "with", "nonterminal", "categories", ".", "Analysis", "of", "PP", "and", "SBAR", ".", "Figure", "[", "reference", "]", "indicates", "a", "certain", "degree", "of", "overlap", "between", "SBAR", "(", "red", ")", "and", "PP", "(", "yellow", ")", ".", "As", "both", "categories", "are", "interesting", "from", "the", "linguistic", "perspective", "and", "quite", "similar", ",", "we", "visualize", "the", "learned", "phrase", "vectors", "of", "40", "randomly", "selected", "SBARs", "and", "PPs", "from", "the", "test", "set", "(", "using", "U", "-", "GA", "-", "RNNG", ")", ",", "illustrated", "in", "Figure", "[", "reference", "]", ".", "First", ",", "we", "can", "see", "that", "phrase", "representations", "for", "PPs", "and", "SBARs", "depend", "less", "on", "the", "nonterminal", "categories", "and", "more", "on", "the", "connector", ".", "For", "instance", ",", "the", "model", "learns", "to", "cluster", "phrases", "that", "start", "with", "words", "that", "can", "be", "either", "prepositions", "or", "complementizers", "(", "e.g.", ",", "for", ",", "at", ",", "to", ",", "under", ",", "by", ")", ",", "regardless", "of", "whether", "the", "true", "nonterminal", "labels", "are", "PPs", "or", "SBARs", ".", "This", "suggests", "that", "SBARs", "that", "start", "with", "\u201c", "prepositional", "\u201d", "words", "are", "similar", "to", "PPs", "from", "the", "model", "\u2019s", "perspective", ".", "Second", ",", "the", "model", "learns", "to", "disregard", "the", "word", "that", ",", "as", "\u201c", "\u201d", "and", "\u201c", "\u201d", "are", "close", "together", ".", "This", "finding", "is", "intuitive", ",", "as", "complementizer", "that", "is", "often", "optional", ",", "unlike", "prepositional", "words", "that", "might", "describe", "relative", "time", "and", "location", ".", "Third", ",", "certain", "categories", "of", "PPs", "and", "SBARs", "form", "their", "own", "separate", "clusters", ",", "such", "as", "those", "that", "involve", "the", "words", "because", "and", "of", ".", "We", "attribute", "these", "distinctions", "to", "the", "fact", "that", "these", "words", "convey", "different", "meanings", "than", "many", "prepositional", "words", ";", "the", "word", "of", "indicates", "possession", "while", "because", "indicates", "cause", "-", "and", "-", "effect", "relationship", ".", "These", "examples", "show", "that", ",", "to", "a", "certain", "extent", ",", "the", "GA", "-", "RNNG", "is", "able", "to", "learn", "non", "-", "trivial", "semantic", "information", ",", "even", "when", "trained", "on", "a", "fairly", "small", "amount", "of", "syntactic", "data", ".", "section", ":", "Related", "Work", "The", "problem", "of", "understanding", "neural", "network", "models", "in", "NLP", "has", "been", "previously", "studied", "for", "sequential", "RNNs", ".", "shi_16", "showed", "that", "sequence", "-", "to", "-", "sequence", "neural", "translation", "models", "capture", "a", "certain", "degree", "of", "syntactic", "knowledge", "of", "the", "source", "language", ",", "such", "as", "voice", "(", "active", "or", "passive", ")", "and", "tense", "information", ",", "as", "a", "by", "-", "product", "of", "the", "translation", "objective", ".", "Our", "experiment", "on", "the", "importance", "of", "composition", "function", "was", "motivated", "by", "vinyals:2015", "and", "wiseman_16", ",", "who", "achieved", "competitive", "parsing", "accuracy", "without", "explicit", "composition", ".", "In", "another", "work", ",", "li:15", "investigated", "the", "importance", "of", "recursive", "tree", "structures", "(", "as", "opposed", "to", "linear", "recurrent", "models", ")", "in", "four", "different", "tasks", ",", "including", "sentiment", "and", "semantic", "relation", "classification", ".", "Their", "findings", "suggest", "that", "recursive", "tree", "structures", "are", "beneficial", "for", "tasks", "that", "require", "identifying", "long", "-", "range", "relations", ",", "such", "as", "semantic", "relationship", "classification", ",", "with", "no", "conclusive", "advantage", "for", "sentiment", "classification", "and", "discourse", "parsing", ".", "Through", "the", "stack", "-", "only", "ablation", "we", "demonstrate", "that", "the", "RNNG", "composition", "function", "is", "crucial", "to", "obtaining", "state", "-", "of", "-", "the", "-", "art", "parsing", "performance", ".", "Extensive", "prior", "work", "on", "phrase", "-", "structure", "parsing", "typically", "employs", "the", "probabilistic", "context", "-", "free", "grammar", "formalism", ",", "with", "lexicalized", "and", "nonterminal", "augmentations", ".", "The", "conjecture", "that", "fine", "-", "grained", "nonterminal", "rules", "and", "labels", "can", "be", "discovered", "given", "weaker", "bracketing", "structures", "was", "based", "on", "several", "studies", ".", "In", "a", "similar", "work", ",", "sangati:09", "proposed", "entropy", "minimization", "and", "greedy", "familiarity", "maximization", "techniques", "to", "obtain", "lexical", "heads", "from", "labeled", "phrase", "-", "structure", "trees", "in", "an", "unsupervised", "manner", ".", "In", "contrast", ",", "we", "used", "neural", "attention", "to", "obtain", "the", "\u201c", "head", "rules", "\u201d", "in", "the", "GA", "-", "RNNG", ";", "the", "whole", "model", "is", "trained", "end", "-", "to", "-", "end", "to", "maximize", "the", "log", "probability", "of", "the", "correct", "action", "given", "the", "history", ".", "Unlike", "prior", "work", ",", "GA", "-", "RNNG", "allows", "the", "attention", "weight", "to", "be", "divided", "among", "phrase", "constituents", ",", "essentially", "propagating", "(", "weighted", ")", "headedness", "information", "from", "multiple", "components", ".", "section", ":", "Conclusion", "We", "probe", "what", "recurrent", "neural", "network", "grammars", "learn", "about", "syntax", ",", "through", "ablation", "scenarios", "and", "a", "novel", "variant", "with", "a", "gated", "attention", "mechanism", "on", "the", "composition", "function", ".", "The", "composition", "function", ",", "a", "key", "differentiator", "between", "the", "RNNG", "and", "other", "neural", "models", "of", "syntax", ",", "is", "crucial", "for", "good", "performance", ".", "Using", "the", "attention", "vectors", "we", "discover", "that", "the", "model", "is", "learning", "something", "similar", "to", "heads", ",", "although", "the", "attention", "vectors", "are", "not", "completely", "peaked", "around", "a", "single", "component", ".", "We", "show", "some", "cases", "where", "the", "attention", "vector", "is", "divided", "and", "measure", "the", "relationship", "with", "existing", "head", "rules", ".", "RNNGs", "without", "access", "to", "nonterminal", "information", "during", "training", "are", "used", "to", "support", "the", "hypothesis", "that", "phrasal", "representations", "are", "largely", "endocentric", ",", "and", "a", "visualization", "of", "representations", "shows", "that", "traditional", "nonterminal", "categories", "fall", "out", "naturally", "from", "the", "composed", "phrase", "vectors", ".", "This", "confirms", "previous", "conjectures", "that", "bracketing", "annotation", "does", "most", "of", "the", "work", "of", "syntax", ",", "with", "nonterminal", "categories", "easily", "discoverable", "given", "bracketing", ".", "section", ":", "Acknowledgments", "This", "work", "was", "sponsored", "in", "part", "by", "the", "Defense", "Advanced", "Research", "Projects", "Agency", "(", "DARPA", ")", "Information", "Innovation", "Office", "(", "I2O", ")", "under", "the", "Low", "Resource", "Languages", "for", "Emergent", "Incidents", "(", "LORELEI", ")", "program", "issued", "by", "DARPA", "/", "I2O", "under", "Contract", "No", ".", "HR0011", "-", "15", "-", "C", "-", "0114", ";", "it", "was", "also", "supported", "in", "part", "by", "Contract", "No", ".", "W911NF", "-", "15", "-", "1", "-", "0543", "with", "DARPA", "and", "the", "Army", "Research", "Office", "(", "ARO", ")", ".", "Approved", "for", "public", "release", ",", "distribution", "unlimited", ".", "The", "views", "expressed", "are", "those", "of", "the", "authors", "and", "do", "not", "reflect", "the", "official", "policy", "or", "position", "of", "the", "Department", "of", "Defense", "or", "the", "U.S.", "Government", ".", "bibliography", ":", "References"]}