{"coref": {"Face_Recognition": [[159, 160], [227, 229], [232, 233], [535, 537], [973, 975], [1214, 1216], [1356, 1358], [1613, 1615], [1875, 1877], [2104, 2106], [2995, 2997], [3013, 3015], [5494, 5496], [5694, 5696], [5, 7], [29, 31], [239, 241], [746, 748], [934, 936], [1020, 1022], [1160, 1162], [1565, 1567], [1574, 1576], [3140, 3142], [4058, 4060], [4113, 4115], [5188, 5190], [5197, 5199], [6630, 6632]], "GhostVLAD__SE-GV-3": [[0, 1], [1838, 1839], [2133, 2134], [2224, 2225], [2239, 2243], [2337, 2338], [2469, 2470], [2481, 2482], [2626, 2627], [2646, 2647], [3019, 3020], [3712, 3713], [3761, 3762], [3836, 3837], [3852, 3853], [3966, 3967], [5368, 5369], [5458, 5459], [6486, 6487], [85, 86], [1690, 1691], [1881, 1882], [1915, 1916], [3171, 3172], [4776, 4777], [5241, 5242], [5246, 5247], [5983, 5984], [6070, 6071], [6637, 6638]], "IJB-A": [[920, 924], [4061, 4064], [4100, 4103], [4128, 4132], [4166, 4170], [4174, 4177], [4279, 4282], [4453, 4456], [4478, 4481], [4483, 4487], [4702, 4705], [4706, 4710], [5069, 5073], [5082, 5085], [5900, 5903], [5904, 5908], [6014, 6017], [6018, 6022], [6106, 6109], [6114, 6117], [6141, 6145], [6672, 6675]], "IJB-B": [[183, 189], [928, 931], [4068, 4071], [4104, 4107], [4283, 4286], [4462, 4465], [5050, 5053], [6364, 6367], [6379, 6382], [6421, 6424], [6436, 6439], [6676, 6679]], "SE-GV-3": [[5873, 5878], [4664, 4669], [5592, 5597], [5600, 5605]], "TAR___FAR_0_01": [[4353, 4356], [4357, 4358], [4360, 4363], [4364, 4365], [6151, 6152], [6352, 6353], [6354, 6355], [6410, 6411], [6153, 6154], [6157, 6158], [6173, 6174], [6177, 6178], [6412, 6413]]}, "coref_non_salient": {"0": [[1714, 1716], [2202, 2206]], "1": [[1242, 1247], [5271, 5275]], "10": [[3456, 3458], [3477, 3479]], "100": [[3994, 3996]], "101": [[3268, 3270]], "102": [[3868, 3869]], "103": [[505, 508], [1132, 1134], [1520, 1523]], "104": [[3388, 3391]], "105": [[3033, 3035]], "106": [[2850, 2854]], "107": [[3872, 3873]], "108": [[2361, 2363]], "109": [[445, 448], [1188, 1194], [2293, 2297]], "11": [[555, 556], [1555, 1556], [2226, 2227], [2287, 2288], [2319, 2320], [2339, 2340], [2473, 2474], [2604, 2605], [2644, 2645], [2657, 2658], [2784, 2785], [3766, 3767], [5257, 5258], [5461, 5462], [5585, 5587]], "110": [[5926, 5934]], "111": [[2002, 2004]], "112": [[3637, 3640], [4615, 4618], [4838, 4841], [4877, 4880]], "113": [[2668, 2670]], "114": [[4401, 4405]], "115": [[67, 69], [652, 654]], "116": [[688, 690], [1755, 1757], [1783, 1785]], "117": [[3541, 3543]], "118": [[1826, 1829]], "119": [[356, 358]], "12": [[2112, 2116], [2217, 2221]], "120": [[61, 65]], "121": [[4858, 4864]], "122": [[500, 504]], "123": [[792, 794]], "124": [[3950, 3952]], "125": [[2629, 2632]], "126": [[2673, 2676]], "127": [[1293, 1295]], "128": [[54, 58]], "129": [[261, 263]], "13": [[4297, 4300], [4368, 4370]], "130": [[1314, 1316]], "131": [[4827, 4831]], "14": [[367, 369], [437, 439], [1483, 1485], [1983, 1984], [2235, 2237]], "15": [[76, 78], [386, 389]], "16": [[574, 577], [1647, 1650], [1811, 1814], [2823, 2828]], "17": [[3082, 3090], [3702, 3705], [3745, 3751], [3910, 3918]], "18": [[1854, 1856], [2171, 2173], [3839, 3841], [4911, 4913], [5105, 5107]], "19": [[2741, 2745], [2831, 2834]], "2": [[1551, 1554], [1850, 1852]], "20": [[1840, 1843], [1993, 1996]], "21": [[4529, 4532], [5162, 5165]], "22": [[5262, 5267], [5415, 5420], [5705, 5709]], "23": [[374, 376], [459, 461], [876, 878], [2819, 2821], [2888, 2890], [2942, 2944], [3064, 3066], [3189, 3191], [4804, 4806], [4853, 4855], [5378, 5380], [5690, 5692], [6489, 6491], [6538, 6540], [6658, 6660]], "24": [[155, 157], [3258, 3260], [6617, 6619]], "25": [[4330, 4332], [4502, 4504]], "26": [[542, 544], [4475, 4476], [5090, 5091], [6009, 6010], [6104, 6105], [6377, 6378], [6700, 6704]], "27": [[3609, 3614], [3645, 3650], [3692, 3696], [4927, 4932], [5936, 5940]], "28": [[43, 45], [1432, 1434], [1634, 1636], [1910, 1912], [1952, 1954], [3166, 3168], [6613, 6616], [6686, 6688]], "29": [[1480, 1481], [1672, 1674], [1974, 1976], [1988, 1990], [2013, 2015], [2121, 2123], [4562, 4565], [4844, 4846]], "3": [[98, 99], [816, 817], [1181, 1184], [1226, 1227], [1389, 1390], [2127, 2128], [2779, 2781]], "30": [[3776, 3779], [3821, 3824]], "31": [[4393, 4399], [6094, 6095], [6123, 6124], [6369, 6370], [6426, 6427]], "32": [[3100, 3104], [3674, 3678]], "33": [[6621, 6626]], "34": [[3590, 3591], [5967, 5968], [6318, 6319], [6339, 6340], [6392, 6393]], "35": [[540, 541], [4470, 4471], [5088, 5089], [6011, 6012], [6362, 6363], [6419, 6420], [6434, 6435], [217, 218], [4293, 4294], [4306, 4307], [6037, 6038]], "36": [[3806, 3807]], "37": [[1707, 1711], [3047, 3052]], "38": [[5047, 5049]], "39": [[3834, 3835], [4577, 4578], [5156, 5159]], "4": [[4602, 4609], [4612, 4613]], "40": [[1665, 1668], [1720, 1723], [2124, 2126], [2466, 2468], [4872, 4874]], "41": [[4406, 4407], [6371, 6372], [6428, 6429]], "42": [[1662, 1664], [2066, 2068], [2177, 2179], [3660, 3663], [4907, 4909]], "43": [[6441, 6445]], "44": [[3209, 3211], [3265, 3267], [3355, 3357]], "45": [[5041, 5044]], "46": [[3000, 3002], [3114, 3116]], "47": [[1933, 1936], [5223, 5225]], "48": [[6578, 6584]], "49": [[1656, 1659], [4677, 4680], [5006, 5011], [5166, 5169]], "5": [[20, 25], [1581, 1586]], "50": [[6696, 6698]], "51": [[1968, 1970], [4682, 4684], [5102, 5104], [5329, 5332]], "52": [[5879, 5886], [5986, 5993], [6263, 6270], [5612, 5619]], "53": [[1695, 1700], [2193, 2197]], "54": [[4336, 4339], [4340, 4343]], "55": [[1832, 1837], [2261, 2266]], "56": [[4411, 4420]], "57": [[1652, 1655], [4533, 4536], [5171, 5174], [5333, 5336]], "58": [[4994, 4999]], "59": [[1147, 1149]], "6": [[1489, 1492], [5541, 5543], [6706, 6710]], "60": [[6323, 6325]], "61": [[3955, 3957], [3987, 3989]], "62": [[4423, 4426]], "63": [[1338, 1340]], "64": [[4551, 4555]], "65": [[1373, 1375], [3240, 3242]], "66": [[3752, 3754]], "67": [[699, 704]], "68": [[4429, 4436]], "69": [[1493, 1496]], "7": [[509, 512], [1524, 1527], [6239, 6243]], "70": [[1608, 1611], [3122, 3127]], "71": [[1238, 1239]], "72": [[4269, 4271], [4438, 4440]], "73": [[3425, 3427]], "74": [[1857, 1859]], "75": [[4866, 4868]], "76": [[6050, 6051]], "77": [[1154, 1156]], "78": [[1252, 1257]], "79": [[2228, 2230]], "8": [[2988, 2994], [3327, 3331], [3410, 3411], [5279, 5280]], "80": [[3864, 3867]], "81": [[442, 444], [1516, 1519], [5012, 5015], [5521, 5524]], "82": [[5922, 5924]], "83": [[1717, 1718]], "84": [[2714, 2719]], "85": [[1138, 1141]], "86": [[4697, 4699]], "87": [[3502, 3504]], "88": [[6341, 6342]], "89": [[3421, 3423]], "9": [[603, 607], [1107, 1111], [1738, 1743], [4237, 4238]], "90": [[2272, 2274]], "91": [[2844, 2846]], "92": [[2058, 2062]], "93": [[3462, 3464]], "94": [[3106, 3108]], "95": [[641, 646]], "96": [[2028, 2030]], "97": [[2006, 2008]], "98": [[1402, 1405]], "99": [[1069, 1072]]}, "doc_id": "05ee231749c9ce97f036c71c1d2d599d660a8c81", "method_subrelations": {"GhostVLAD__SE-GV-3": [[[0, 18], "GhostVLAD__SE-GV-3"]], "SE-GV-3": [[[0, 7], "SE-GV-3"]]}, "n_ary_relations": [{"Material": "IJB-A", "Method": "SE-GV-3", "Metric": "TAR___FAR_0_01", "Task": "Face_Recognition", "score": "0.972"}, {"Material": "IJB-B", "Method": "GhostVLAD__SE-GV-3", "Metric": "TAR___FAR_0_01", "Task": "Face_Recognition", "score": "0.963"}], "ner": [[0, 1, "Method"], [20, 25, "Method"], [43, 45, "Method"], [54, 58, "Method"], [61, 65, "Method"], [67, 69, "Method"], [76, 78, "Task"], [98, 99, "Task"], [155, 157, "Method"], [159, 160, "Task"], [183, 189, "Material"], [227, 229, "Task"], [232, 233, "Task"], [261, 263, "Task"], [356, 358, "Task"], [367, 369, "Method"], [374, 376, "Method"], [386, 389, "Task"], [437, 439, "Method"], [442, 444, "Method"], [445, 448, "Method"], [459, 461, "Method"], [500, 504, "Method"], [505, 508, "Method"], [509, 512, "Method"], [535, 537, "Task"], [540, 541, "Task"], [542, 544, "Task"], [555, 556, "Method"], [574, 577, "Method"], [603, 607, "Method"], [641, 646, "Metric"], [652, 654, "Method"], [688, 690, "Method"], [699, 704, "Task"], [792, 794, "Method"], [816, 817, "Task"], [876, 878, "Method"], [920, 924, "Material"], [928, 931, "Material"], [973, 975, "Task"], [1069, 1072, "Method"], [1107, 1111, "Method"], [1132, 1134, "Method"], [1138, 1141, "Method"], [1147, 1149, "Task"], [1154, 1156, "Method"], [1181, 1184, "Task"], [1188, 1194, "Method"], [1214, 1216, "Task"], [1226, 1227, "Task"], [1238, 1239, "Method"], [1242, 1247, "Method"], [1252, 1257, "Metric"], [1293, 1295, "Method"], [1314, 1316, "Method"], [1338, 1340, "Method"], [1356, 1358, "Task"], [1373, 1375, "Metric"], [1389, 1390, "Task"], [1402, 1405, "Method"], [1432, 1434, "Method"], [1480, 1481, "Method"], [1483, 1485, "Method"], [1489, 1492, "Task"], [1493, 1496, "Task"], [1516, 1519, "Method"], [1520, 1523, "Method"], [1524, 1527, "Method"], [1551, 1554, "Method"], [1555, 1556, "Method"], [1581, 1586, "Method"], [1608, 1611, "Method"], [1613, 1615, "Task"], [1634, 1636, "Method"], [1647, 1650, "Method"], [1652, 1655, "Method"], [1656, 1659, "Method"], [1662, 1664, "Method"], [1665, 1668, "Method"], [1672, 1674, "Method"], [1695, 1700, "Method"], [1707, 1711, "Method"], [1714, 1716, "Method"], [1717, 1718, "Method"], [1720, 1723, "Method"], [1738, 1743, "Method"], [1755, 1757, "Method"], [1783, 1785, "Method"], [1811, 1814, "Method"], [1826, 1829, "Method"], [1832, 1837, "Method"], [1838, 1839, "Method"], [1840, 1843, "Method"], [1850, 1852, "Method"], [1854, 1856, "Task"], [1857, 1859, "Method"], [1875, 1877, "Task"], [1910, 1912, "Method"], [1933, 1936, "Method"], [1952, 1954, "Method"], [1968, 1970, "Method"], [1974, 1976, "Method"], [1983, 1984, "Method"], [1988, 1990, "Method"], [1993, 1996, "Method"], [2002, 2004, "Task"], [2006, 2008, "Method"], [2013, 2015, "Method"], [2028, 2030, "Method"], [2058, 2062, "Method"], [2066, 2068, "Method"], [2104, 2106, "Task"], [2112, 2116, "Method"], [2121, 2123, "Method"], [2124, 2126, "Method"], [2127, 2128, "Task"], [2133, 2134, "Method"], [2171, 2173, "Task"], [2177, 2179, "Method"], [2193, 2197, "Method"], [2202, 2206, "Method"], [2217, 2221, "Method"], [2224, 2225, "Method"], [2226, 2227, "Method"], [2228, 2230, "Method"], [2235, 2237, "Method"], [2239, 2243, "Method"], [2261, 2266, "Method"], [2272, 2274, "Method"], [2287, 2288, "Method"], [2293, 2297, "Method"], [2319, 2320, "Method"], [2337, 2338, "Method"], [2339, 2340, "Method"], [2361, 2363, "Method"], [2466, 2468, "Method"], [2469, 2470, "Method"], [2473, 2474, "Method"], [2481, 2482, "Method"], [2604, 2605, "Method"], [2626, 2627, "Method"], [2629, 2632, "Method"], [2644, 2645, "Method"], [2646, 2647, "Method"], [2657, 2658, "Method"], [2668, 2670, "Method"], [2673, 2676, "Method"], [2714, 2719, "Method"], [2741, 2745, "Task"], [2779, 2781, "Task"], [2784, 2785, "Method"], [2819, 2821, "Method"], [2823, 2828, "Method"], [2831, 2834, "Task"], [2844, 2846, "Method"], [2850, 2854, "Method"], [2888, 2890, "Method"], [2942, 2944, "Method"], [2988, 2994, "Task"], [2995, 2997, "Task"], [3000, 3002, "Method"], [3013, 3015, "Task"], [3019, 3020, "Method"], [3033, 3035, "Metric"], [3047, 3052, "Method"], [3064, 3066, "Method"], [3082, 3090, "Method"], [3100, 3104, "Metric"], [3106, 3108, "Method"], [3114, 3116, "Method"], [3122, 3127, "Method"], [3166, 3168, "Method"], [3189, 3191, "Method"], [3209, 3211, "Task"], [3240, 3242, "Metric"], [3258, 3260, "Method"], [3265, 3267, "Task"], [3268, 3270, "Task"], [3327, 3331, "Task"], [3355, 3357, "Task"], [3388, 3391, "Method"], [3410, 3411, "Task"], [3421, 3423, "Method"], [3425, 3427, "Method"], [3456, 3458, "Task"], [3462, 3464, "Method"], [3477, 3479, "Task"], [3502, 3504, "Task"], [3541, 3543, "Metric"], [3590, 3591, "Method"], [3609, 3614, "Task"], [3637, 3640, "Method"], [3645, 3650, "Task"], [3660, 3663, "Method"], [3674, 3678, "Metric"], [3692, 3696, "Task"], [3702, 3705, "Method"], [3712, 3713, "Method"], [3745, 3751, "Method"], [3752, 3754, "Task"], [3761, 3762, "Method"], [3766, 3767, "Method"], [3776, 3779, "Method"], [3806, 3807, "Task"], [3821, 3824, "Method"], [3834, 3835, "Method"], [3836, 3837, "Method"], [3839, 3841, "Task"], [3852, 3853, "Method"], [3864, 3867, "Method"], [3868, 3869, "Method"], [3872, 3873, "Method"], [3910, 3918, "Method"], [3950, 3952, "Metric"], [3955, 3957, "Metric"], [3966, 3967, "Method"], [3987, 3989, "Metric"], [3994, 3996, "Metric"], [4061, 4064, "Material"], [4068, 4071, "Material"], [4100, 4103, "Material"], [4104, 4107, "Material"], [4128, 4132, "Material"], [4166, 4170, "Material"], [4174, 4177, "Material"], [4237, 4238, "Method"], [4269, 4271, "Metric"], [4279, 4282, "Material"], [4283, 4286, "Material"], [4297, 4300, "Task"], [4330, 4332, "Metric"], [4336, 4339, "Metric"], [4340, 4343, "Metric"], [4353, 4356, "Metric"], [4357, 4358, "Metric"], [4360, 4363, "Metric"], [4364, 4365, "Metric"], [4368, 4370, "Task"], [4393, 4399, "Metric"], [4401, 4405, "Metric"], [4406, 4407, "Metric"], [4411, 4420, "Metric"], [4423, 4426, "Metric"], [4429, 4436, "Metric"], [4438, 4440, "Metric"], [4453, 4456, "Material"], [4462, 4465, "Material"], [4470, 4471, "Task"], [4475, 4476, "Task"], [4478, 4481, "Material"], [4483, 4487, "Material"], [4502, 4504, "Metric"], [4529, 4532, "Method"], [4533, 4536, "Method"], [4551, 4555, "Method"], [4562, 4565, "Method"], [4577, 4578, "Method"], [4602, 4609, "Method"], [4612, 4613, "Method"], [4615, 4618, "Method"], [4677, 4680, "Method"], [4682, 4684, "Method"], [4697, 4699, "Task"], [4702, 4705, "Material"], [4706, 4710, "Material"], [4804, 4806, "Method"], [4827, 4831, "Method"], [4838, 4841, "Method"], [4844, 4846, "Method"], [4853, 4855, "Method"], [4858, 4864, "Method"], [4866, 4868, "Method"], [4872, 4874, "Method"], [4877, 4880, "Method"], [4907, 4909, "Method"], [4911, 4913, "Task"], [4927, 4932, "Task"], [4994, 4999, "Method"], [5006, 5011, "Method"], [5012, 5015, "Method"], [5041, 5044, "Method"], [5047, 5049, "Task"], [5050, 5053, "Material"], [5069, 5073, "Material"], [5082, 5085, "Material"], [5088, 5089, "Task"], [5090, 5091, "Task"], [5102, 5104, "Method"], [5105, 5107, "Task"], [5156, 5159, "Method"], [5162, 5165, "Method"], [5166, 5169, "Method"], [5171, 5174, "Method"], [5223, 5225, "Method"], [5257, 5258, "Method"], [5262, 5267, "Method"], [5271, 5275, "Method"], [5279, 5280, "Task"], [5329, 5332, "Method"], [5333, 5336, "Method"], [5368, 5369, "Method"], [5378, 5380, "Method"], [5415, 5420, "Method"], [5458, 5459, "Method"], [5461, 5462, "Method"], [5494, 5496, "Task"], [5521, 5524, "Method"], [5541, 5543, "Task"], [5585, 5587, "Method"], [5690, 5692, "Method"], [5694, 5696, "Task"], [5705, 5709, "Method"], [5873, 5878, "Method"], [5879, 5886, "Method"], [5900, 5903, "Material"], [5904, 5908, "Material"], [5922, 5924, "Method"], [5926, 5934, "Method"], [5936, 5940, "Task"], [5967, 5968, "Method"], [5986, 5993, "Method"], [6009, 6010, "Task"], [6011, 6012, "Task"], [6014, 6017, "Material"], [6018, 6022, "Material"], [6050, 6051, "Method"], [6094, 6095, "Metric"], [6104, 6105, "Task"], [6106, 6109, "Material"], [6114, 6117, "Material"], [6123, 6124, "Metric"], [6141, 6145, "Material"], [6151, 6152, "Metric"], [6239, 6243, "Method"], [6263, 6270, "Method"], [6318, 6319, "Method"], [6323, 6325, "Method"], [6339, 6340, "Method"], [6341, 6342, "Method"], [6352, 6353, "Metric"], [6354, 6355, "Metric"], [6362, 6363, "Task"], [6364, 6367, "Material"], [6369, 6370, "Metric"], [6371, 6372, "Metric"], [6377, 6378, "Task"], [6379, 6382, "Material"], [6392, 6393, "Method"], [6410, 6411, "Metric"], [6419, 6420, "Task"], [6421, 6424, "Material"], [6426, 6427, "Metric"], [6428, 6429, "Metric"], [6434, 6435, "Task"], [6436, 6439, "Material"], [6441, 6445, "Task"], [6486, 6487, "Method"], [6489, 6491, "Method"], [6538, 6540, "Method"], [6578, 6584, "Metric"], [6613, 6616, "Method"], [6617, 6619, "Method"], [6621, 6626, "Task"], [6658, 6660, "Method"], [6672, 6675, "Material"], [6676, 6679, "Material"], [6686, 6688, "Method"], [6696, 6698, "Task"], [6700, 6704, "Task"], [6706, 6710, "Task"], [5, 7, "Task"], [29, 31, "Task"], [85, 86, "Method"], [217, 218, "Task"], [239, 241, "Task"], [746, 748, "Task"], [934, 936, "Task"], [1020, 1022, "Task"], [1160, 1162, "Task"], [1565, 1567, "Task"], [1574, 1576, "Task"], [1690, 1691, "Method"], [1881, 1882, "Method"], [1915, 1916, "Method"], [3140, 3142, "Task"], [3171, 3172, "Method"], [4058, 4060, "Task"], [4113, 4115, "Task"], [4293, 4294, "Task"], [4306, 4307, "Task"], [4664, 4669, "Method"], [4776, 4777, "Method"], [5188, 5190, "Task"], [5197, 5199, "Task"], [5241, 5242, "Method"], [5246, 5247, "Method"], [5592, 5597, "Method"], [5600, 5605, "Method"], [5612, 5619, "Method"], [5983, 5984, "Method"], [6037, 6038, "Task"], [6070, 6071, "Method"], [6153, 6154, "Metric"], [6157, 6158, "Metric"], [6173, 6174, "Metric"], [6177, 6178, "Metric"], [6412, 6413, "Metric"], [6630, 6632, "Task"], [6637, 6638, "Method"]], "sections": [[0, 7], [7, 220], [220, 1015], [1015, 1569], [1569, 1950], [1950, 2222], [2222, 2998], [2998, 3247], [3247, 4012], [4012, 4046], [4046, 4505], [4505, 5045], [5045, 5854], [5854, 6439], [6439, 6607], [6607, 6747], [6747, 6749], [6749, 6792], [6792, 6795], [6795, 6797]], "sentences": [[0, 7], [7, 9], [9, 11], [11, 32], [32, 66], [66, 79], [79, 100], [100, 141], [141, 162], [162, 190], [190, 220], [220, 223], [223, 259], [259, 293], [293, 333], [333, 339], [339, 364], [364, 379], [379, 395], [395, 435], [435, 493], [493, 525], [525, 545], [545, 567], [567, 613], [613, 635], [635, 691], [691, 730], [730, 762], [762, 785], [785, 799], [799, 818], [818, 840], [840, 865], [865, 885], [885, 904], [904, 938], [938, 958], [958, 993], [993, 995], [995, 1005], [1005, 1015], [1015, 1019], [1019, 1047], [1047, 1097], [1097, 1112], [1112, 1150], [1150, 1194], [1194, 1200], [1200, 1232], [1232, 1258], [1258, 1287], [1287, 1321], [1321, 1359], [1359, 1416], [1416, 1448], [1448, 1451], [1451, 1482], [1482, 1541], [1541, 1569], [1569, 1576], [1576, 1587], [1587, 1616], [1616, 1624], [1624, 1630], [1630, 1632], [1632, 1634], [1634, 1637], [1637, 1677], [1677, 1693], [1693, 1724], [1724, 1750], [1750, 1753], [1753, 1778], [1778, 1781], [1781, 1808], [1808, 1820], [1820, 1840], [1840, 1857], [1857, 1909], [1909, 1922], [1922, 1926], [1926, 1950], [1950, 1954], [1954, 2002], [2002, 2005], [2005, 2021], [2021, 2041], [2041, 2048], [2048, 2079], [2079, 2117], [2117, 2127], [2127, 2129], [2129, 2163], [2163, 2191], [2191, 2222], [2222, 2230], [2230, 2256], [2256, 2287], [2287, 2312], [2312, 2339], [2339, 2341], [2341, 2390], [2390, 2419], [2419, 2420], [2420, 2421], [2421, 2424], [2424, 2459], [2459, 2469], [2469, 2471], [2471, 2490], [2490, 2537], [2537, 2549], [2549, 2568], [2568, 2570], [2570, 2596], [2596, 2624], [2624, 2637], [2637, 2642], [2642, 2677], [2677, 2704], [2704, 2772], [2772, 2786], [2786, 2822], [2822, 2862], [2862, 2901], [2901, 2951], [2951, 2958], [2958, 2998], [2998, 3002], [3002, 3033], [3033, 3036], [3036, 3067], [3067, 3079], [3079, 3105], [3105, 3133], [3133, 3138], [3138, 3162], [3162, 3192], [3192, 3247], [3247, 3251], [3251, 3273], [3273, 3276], [3276, 3296], [3296, 3308], [3308, 3325], [3325, 3355], [3355, 3358], [3358, 3385], [3385, 3402], [3402, 3424], [3424, 3456], [3456, 3476], [3476, 3502], [3502, 3525], [3525, 3550], [3550, 3553], [3553, 3596], [3596, 3634], [3634, 3679], [3679, 3723], [3723, 3752], [3752, 3755], [3755, 3792], [3792, 3833], [3833, 3856], [3856, 3859], [3859, 3873], [3873, 3877], [3877, 3909], [3909, 3953], [3953, 3986], [3986, 4012], [4012, 4015], [4015, 4046], [4046, 4053], [4053, 4061], [4061, 4079], [4079, 4127], [4127, 4165], [4165, 4207], [4207, 4227], [4227, 4269], [4269, 4272], [4272, 4302], [4302, 4330], [4330, 4337], [4337, 4367], [4367, 4387], [4387, 4438], [4438, 4477], [4477, 4505], [4505, 4512], [4512, 4515], [4515, 4521], [4521, 4536], [4536, 4543], [4543, 4583], [4583, 4591], [4591, 4631], [4631, 4661], [4661, 4697], [4697, 4700], [4700, 4721], [4721, 4757], [4757, 4791], [4791, 4819], [4819, 4821], [4821, 4832], [4832, 4875], [4875, 4922], [4922, 4946], [4946, 4975], [4975, 4982], [4982, 5000], [5000, 5045], [5045, 5053], [5053, 5102], [5102, 5108], [5108, 5160], [5160, 5183], [5183, 5191], [5191, 5218], [5218, 5240], [5240, 5244], [5244, 5355], [5355, 5407], [5407, 5412], [5412, 5454], [5454, 5475], [5475, 5498], [5498, 5538], [5538, 5567], [5567, 5570], [5570, 5621], [5621, 5625], [5625, 5632], [5632, 5661], [5661, 5685], [5685, 5697], [5697, 5703], [5703, 5715], [5715, 5744], [5744, 5799], [5799, 5802], [5802, 5854], [5854, 5865], [5865, 5909], [5909, 5969], [5969, 6023], [6023, 6064], [6064, 6133], [6133, 6181], [6181, 6228], [6228, 6232], [6232, 6249], [6249, 6259], [6259, 6297], [6297, 6308], [6308, 6342], [6342, 6382], [6382, 6439], [6439, 6445], [6445, 6477], [6477, 6484], [6484, 6527], [6527, 6550], [6550, 6558], [6558, 6585], [6585, 6607], [6607, 6610], [6610, 6633], [6633, 6657], [6657, 6685], [6685, 6711], [6711, 6747], [6747, 6749], [6749, 6751], [6751, 6773], [6773, 6792], [6792, 6795], [6795, 6797]], "words": ["GhostVLAD", "for", "set", "-", "based", "face", "recognition", "section", ":", "Abstract", ".", "The", "objective", "of", "this", "paper", "is", "to", "learn", "a", "compact", "representation", "of", "image", "sets", "for", "template", "-", "based", "face", "recognition", ".", "We", "make", "the", "following", "contributions", ":", "first", ",", "we", "propose", "a", "network", "architecture", "which", "aggregates", "and", "embeds", "the", "face", "descriptors", "produced", "by", "deep", "convolutional", "neural", "networks", "into", "a", "compact", "fixed", "-", "length", "representation", ".", "This", "compact", "representation", "requires", "minimal", "memory", "storage", "and", "enables", "efficient", "similarity", "computation", ".", "Second", ",", "we", "propose", "a", "novel", "GhostVLAD", "layer", "that", "includes", "ghost", "clusters", ",", "that", "do", "not", "contribute", "to", "the", "aggregation", ".", "We", "show", "that", "a", "quality", "weighting", "on", "the", "input", "faces", "emerges", "automatically", "such", "that", "informative", "images", "contribute", "more", "than", "those", "with", "low", "quality", ",", "and", "that", "the", "ghost", "clusters", "enhance", "the", "network", "'s", "ability", "to", "deal", "with", "poor", "quality", "images", ".", "Third", ",", "we", "explore", "how", "input", "feature", "dimension", ",", "number", "of", "clusters", "and", "different", "training", "techniques", "affect", "the", "recognition", "performance", ".", "Given", "this", "analysis", ",", "we", "train", "a", "network", "that", "far", "exceeds", "the", "state", "-", "of", "-", "the", "-", "art", "on", "the", "IJB", "-", "B", "face", "recognition", "dataset", ".", "This", "is", "currently", "one", "of", "the", "most", "challenging", "public", "benchmarks", ",", "and", "we", "surpass", "the", "state", "-", "of", "-", "the", "-", "art", "on", "both", "the", "identification", "and", "verification", "protocols", ".", "section", ":", "Introduction", "While", "most", "research", "on", "face", "recognition", "has", "focused", "on", "recognition", "from", "a", "singleimage", ",", "template", "based", "face", "recognition", ",", "where", "a", "set", "of", "faces", "of", "the", "same", "subject", "is", "available", ",", "is", "now", "gaining", "attention", ".", "In", "the", "unconstrained", "scenario", "considered", "here", ",", "this", "can", "be", "a", "challenging", "task", "as", "face", "images", "may", "have", "various", "poses", ",", "expression", ",", "illumination", ",", "and", "may", "also", "be", "of", "quite", "varying", "quality", ".", "A", "straightforward", "method", "to", "tackle", "multiple", "images", "per", "subject", "is", "to", "store", "per", "-", "image", "descriptors", "extracted", "from", "each", "face", "image", "(", "or", "frame", "in", "a", "video", ")", ",", "and", "compare", "every", "pair", "of", "images", "between", "sets", "at", "query", "time", "[", "reference", "][", "reference", "]", ".", "However", ",", "this", "type", "of", "approach", "can", "be", "memory", "-", "consuming", "and", "prohibitively", "slow", ",", "especially", "for", "searching", "tasks", "in", "large", "-", "scale", "datasets", ".", "Therefore", ",", "an", "aggregation", "method", "that", "can", "produce", "a", "compact", "template", "representation", "is", "desired", ".", "Furthermore", ",", "this", "representation", "should", "support", "efficient", "computation", "of", "similarity", "and", "require", "minimal", "memory", "storage", ".", "More", "importantly", ",", "the", "representation", "obtained", "from", "image", "sets", "should", "be", "discriminative", "i.e.", "template", "descriptors", "of", "the", "same", "subject", "should", "be", "close", "to", "each", "other", "in", "the", "descriptor", "space", ",", "whereas", "those", "of", "different", "subjects", "should", "be", "far", "apart", ".", "Although", "common", "aggregation", "strategies", ",", "such", "as", "average", "pooling", "and", "max", "-", "pooling", ",", "are", "able", "to", "aggregate", "face", "descriptors", "to", "produce", "a", "compact", "template", "representation", "[", "reference", "][", "reference", "][", "reference", "]", "and", "currently", "achieves", "the", "state", "-", "of", "-", "the", "-", "art", "results", "[", "reference", "]", ",", "we", "seek", "a", "better", "solution", "in", "this", "paper", ".", "As", "revealed", "by", "[", "reference", "]", ",", "image", "retrieval", "encoding", "methods", "like", "Fisher", "Vector", "encoding", "and", "T", "-", "embedding", "increase", "the", "separation", "between", "descriptors", "extracted", "from", "related", "and", "unrelated", "image", "patches", ".", "We", "therefore", "expect", "a", "similar", "encoding", "to", "be", "beneficial", "for", "face", "recognition", ",", "including", "both", "verification", "and", "identification", "tasks", ".", "This", "insight", "inspires", "us", "to", "include", "a", "similar", "encoding", ",", "NetVLAD", "[", "reference", "]", ",", "in", "the", "design", "of", "our", "network", ".", "In", "this", "paper", ",", "we", "propose", "a", "convolutional", "neural", "network", "(", "Fig", ".", "1", ")", "that", "satisfies", "all", "the", "desired", "properties", "mentioned", "above", ":", "it", "can", "take", "any", "number", "of", "input", "faces", "and", "produce", "a", "compact", "fixed", "-", "length", "descriptor", "to", "represent", "the", "image", "set", ".", "Moreover", ",", "this", "network", "embeds", "face", "descriptors", "such", "that", "the", "resultant", "template", "-", "descriptors", "are", "more", "discriminative", "than", "the", "original", "descriptors", ".", "The", "representation", "is", "efficient", "in", "both", "memory", "and", "query", "speed", "aspects", ",", "i.e.", "it", "only", "stores", "one", "compact", "descriptor", "per", "template", ",", "regardless", "of", "the", "number", "of", "face", "images", "in", "a", "template", ",", "and", "the", "similarity", "between", "two", "templates", "is", "simply", "measured", "as", "the", "scalar", "product", "(", "i.e.", "cosine", "similarity", ")", "of", "two", "template", "descriptors", ".", "However", ",", "one", "of", "the", "key", "problems", "in", "unconstrained", "real", "-", "world", "situations", "is", "that", "some", "faces", "in", "a", "template", "may", "be", "of", "low", "quality", "-", "for", "example", ",", "low", "resolution", ",", "or", "blurred", ",", "or", "partially", "occluded", ".", "These", "low", "-", "quality", "images", "are", "distractors", "and", "are", "likely", "to", "hurt", "the", "performance", "of", "the", "face", "recognition", "system", "if", "given", "equal", "weight", "as", "the", "other", "(", "good", "quality", ")", "faces", ".", "Therefore", ",", "a", "sophisticated", "network", "should", "be", "able", "to", "reduce", "the", "impact", "of", "such", "distracting", "images", "and", "focus", "on", "the", "informative", "ones", ".", "To", "this", "end", ",", "we", "extend", "the", "NetVLAD", "architecture", "to", "include", "ghost", "clusters", ".", "These", "are", "clusters", "that", "face", "descriptors", "can", "be", "soft", "assigned", "to", ",", "but", "are", "excluded", "from", "the", "aggregation", ".", "They", "provide", "a", "mechanism", "for", "the", "network", "to", "handle", "low", "quality", "faces", ",", "by", "mainly", "assigning", "them", "to", "the", "ghost", "clusters", ".", "Interestingly", ",", "although", "we", "do", "not", "explicitly", "learn", "any", "importance", "weightings", "between", "faces", "in", "each", "template", ",", "such", "property", "emerges", "automatically", "from", "our", "network", ".", "Specifically", ",", "low", "quality", "faces", "generally", "contribute", "less", "to", "the", "final", "template", "representation", "than", "the", "high", "-", "quality", "ones", ".", "The", "networks", "are", "trained", "in", "an", "end", "-", "to", "-", "end", "fashion", "with", "only", "identity", "-", "level", "labels", ".", "They", "outperform", "state", "-", "of", "-", "the", "-", "art", "methods", "by", "a", "large", "margin", "on", "the", "public", "IJB", "-", "A", "[", "reference", "]", "and", "IJB", "-", "B", "[", "reference", "]", "face", "recognition", "benchmarks", ".", "These", "datasets", "are", "currently", "the", "most", "challenging", "in", "the", "community", ",", "and", "we", "evaluate", "on", "these", "in", "this", "paper", ".", "This", "paper", "is", "organized", "as", "following", ":", "Sec", ".", "2", "reviews", "some", "related", "work", "on", "face", "recognition", "based", "on", "image", "sets", "or", "videos", ";", "the", "proposed", "network", "and", "implementation", "details", "are", "introduced", "in", "Sec", ".", "3", ",", "followed", "by", "experimental", "results", "reported", "in", "Sec", ".", "4", ".", "Finally", "a", "conclusion", "is", "drawn", "in", "Sec", ".", "5", ".", "section", ":", "Related", "work", "Early", "face", "recognition", "approaches", "which", "make", "use", "of", "sets", "of", "face", "examples", "(", "extracted", "from", "different", "images", "or", "video", "frames", ")", "aim", "to", "represent", "image", "sets", "as", "manifolds", "[", "reference", "][", "reference", "][", "reference", "][", "reference", "][", "reference", "][", "reference", "][", "reference", "]", ",", "convex", "hulls", "[", "reference", "]", ",", "Gaussian", "Mixture", "Models", "[", "reference", "]", ",", "or", "set", "covariance", "matrices", "[", "reference", "]", ",", "and", "measure", "the", "dissimilarity", "between", "image", "sets", "as", "distance", "between", "these", "spaces", ".", "Later", "methods", "represent", "face", "sets", "more", "efficiently", "using", "a", "single", "fixed", "-", "length", "descriptor", ".", "For", "example", ",", "[", "reference", "]", "aggregates", "local", "descriptors", "(", "RootSIFT", "[", "reference", "]", ")", "extracted", "from", "face", "crops", "using", "Fisher", "Vector", "[", "reference", "]", "(", "FV", ")", "encoding", "to", "obtain", "a", "single", "descriptor", "per", "face", "track", ".", "Since", "the", "success", "of", "deep", "learning", "in", "image", "-", "based", "face", "recognition", "[", "reference", "][", "reference", "][", "reference", "][", "reference", "][", "reference", "][", "reference", "][", "reference", "]", ",", "simple", "strategies", "for", "face", "descriptor", "aggregation", "prevailed", ",", "such", "as", "average", "-", "and", "max", "-", "pooling", "[", "reference", "][", "reference", "]", ".", "However", ",", "none", "of", "these", "strategies", "are", "trained", "end", "-", "to", "-", "end", "for", "face", "recognition", "as", "typically", "only", "the", "face", "descriptors", "are", "learnt", ",", "while", "aggregation", "is", "performed", "post", "hoc", ".", "A", "few", "methods", "go", "beyond", "simple", "pooling", "by", "computing", "a", "weighted", "average", "of", "face", "descriptors", "based", "on", "some", "measure", "of", "per", "-", "face", "example", "importance", ".", "For", "example", ",", "[", "reference", "]", "train", "a", "module", "to", "predict", "human", "judgement", "on", "how", "memorable", "a", "face", "is", ",", "and", "use", "this", "memorability", "score", "as", "the", "weight", ".", "In", "[", "reference", "]", ",", "an", "attention", "mechanism", "is", "used", "to", "compute", "face", "example", "weights", ",", "so", "that", "the", "contribution", "of", "low", "quality", "images", "to", "the", "final", "set", "representation", "is", "down", "-", "weighted", ".", "However", ",", "these", "methods", "rely", "on", "pretrained", "face", "descriptors", "and", "do", "not", "learn", "them", "jointly", "with", "the", "weighting", "functions", ",", "unlike", "our", "method", "where", "the", "entire", "system", "is", "trained", "end", "-", "to", "-", "end", "for", "face", "recognition", ".", "Two", "other", "recent", "papers", "are", "quite", "related", "in", "that", "they", "explicitly", "take", "account", "of", "image", "quality", ":", "[", "reference", "]", "first", "bins", "face", "images", "of", "similar", "quality", "and", "pose", "before", "aggregation", ";", "whilst", "[", "reference", "]", "introduces", "a", "fully", "end", "-", "to", "-", "end", "trainable", "method", "which", "automatically", "learns", "to", "down", "-", "weight", "low", "quality", "images", ".", "As", "will", "be", "seen", "in", "the", "sequel", ",", "we", "achieve", "similar", "functionality", "implicitly", "due", "to", "the", "network", "architecture", ",", "and", "also", "exceed", "the", "performance", "of", "both", "these", "methods", "(", "see", "Sec", ".", "4.4", ")", ".", "As", "an", "interesting", "yet", "different", "method", "which", "can", "also", "filter", "low", "-", "quality", "images", ",", "[", "reference", "]", "learns", "to", "aggregate", "the", "raw", "face", "images", "and", "then", "computes", "a", "descriptor", ".", "Our", "aggregation", "approach", "is", "inspired", "by", "the", "image", "retrieval", "literature", "on", "aggregating", "local", "descriptors", "[", "reference", "][", "reference", "]", ".", "Namely", ",", "J\u00e9gou", "and", "Zisserman", "[", "reference", "]", "find", "that", ",", "compared", "to", "simple", "average", "-", "pooling", ",", "Fisher", "Vector", "encoding", "and", "T", "-", "embedding", "increase", "the", "contrast", "between", "the", "similarity", "scores", "of", "matching", "and", "mismatching", "local", "descriptors", ".", "Motivated", "by", "this", "fact", ",", "we", "make", "use", "of", "a", "trainable", "aggregation", "layer", ",", "NetVLAD", "[", "reference", "]", ",", "and", "improve", "it", "for", "the", "face", "recognition", "task", ".", "section", ":", "Set", "-", "based", "face", "recognition", "We", "aim", "to", "learn", "a", "compact", "representation", "of", "a", "face", ".", "Namely", ",", "we", "train", "a", "network", "which", "digests", "a", "set", "of", "example", "face", "images", "of", "a", "person", ",", "and", "produces", "a", "fixedlength", "template", "representation", "useful", "for", "face", "recognition", ".", "The", "network", "should", "satisfy", "the", "following", "properties", ":", ".", ".", ".", ".", ".", ".", "Fig", ".", "1", ":", "Network", "architecture", ".", "Input", "images", "in", "each", "template", "are", "first", "passed", "through", "a", "convolutional", "neural", "network", "(", "e.g.", "ResNet", "-", "50", "or", "SENet", "-", "50", "with", "an", "additional", "FC", "layer", "and", "L2", "-", "normalization", ")", "to", "produce", "a", "face", "descriptor", "per", "image", ".", "The", "descriptors", "are", "aggregated", "into", "a", "single", "fixed", "-", "length", "vector", "using", "the", "GhostVLAD", "layer", ".", "The", "final", "D", "-", "dimensional", "template", "descriptor", "is", "obtained", "by", "reducing", "dimensionality", "using", "a", "fully", "-", "connected", "layer", ",", "followed", "by", "batch", "normalization", "(", "BN", ")", "and", "L2", "-", "normalization", ".", "(", "1", ")", "Take", "any", "number", "of", "images", "as", "input", ",", "and", "output", "a", "fixed", "-", "length", "template", "descriptor", "to", "represent", "the", "input", "image", "set", ".", "(", "2", ")", "The", "output", "template", "descriptor", "should", "be", "compact", "(", "i.e.", "low", "-", "dimensional", ")", "in", "order", "to", "require", "little", "memory", "and", "facilitate", "fast", "template", "comparisons", ".", "(", "3", ")", "The", "output", "template", "descriptor", "should", "be", "discriminative", ",", "such", "that", "the", "similarity", "of", "templates", "of", "the", "same", "subject", "is", "much", "larger", "than", "that", "of", "different", "subjects", ".", "We", "propose", "a", "convolutional", "neural", "network", "that", "fulfils", "all", "three", "objectives", ".", "(", "1", ")", "is", "achieved", "by", "aggregating", "face", "descriptors", "using", "a", "modified", "NetVLAD", "[", "reference", "]", "layer", ",", "GhostVLAD", ".", "Compact", "template", "descriptors", "(", "2", ")", "are", "produced", "by", "a", "trained", "layer", "which", "performs", "dimensionality", "reduction", ".", "Discriminative", "representations", "(", "3", ")", "emerge", "because", "the", "entire", "network", "is", "trained", "end", "-", "to", "-", "end", "for", "face", "recognition", ",", "and", "since", "our", "GhostVLAD", "layer", "is", "able", "to", "down", "-", "weight", "the", "contribution", "of", "lowquality", "images", ",", "which", "is", "important", "for", "good", "performance", "[", "reference", "][", "reference", "][", "reference", "]", ".", "The", "network", "architecture", "and", "the", "new", "GhostVLAD", "layer", "are", "described", "in", "Sec", ".", "3.1", "and", "Sec", ".", "3.2", ",", "respectively", ",", "followed", "by", "the", "network", "training", "procedure", "(", "Sec", ".", "3.3", ")", "and", "implementation", "details", "(", "Sec", ".", "3.4", ")", ".", "section", ":", "Network", "architecture", "As", "shown", "in", "Fig", ".", "1", ",", "the", "network", "consists", "of", "two", "parts", ":", "feature", "extraction", ",", "which", "computes", "a", "face", "descriptor", "for", "each", "input", "face", "image", ",", "and", "aggregation", ",", "which", "aggregates", "all", "face", "descriptors", "into", "a", "single", "compact", "template", "representation", "of", "the", "input", "image", "set", ".", "Feature", "extraction", ".", "A", "neural", "network", "is", "used", "to", "extract", "a", "face", "descriptor", "for", "each", "input", "face", "image", ".", "Any", "network", "can", "be", "used", "in", "our", "learning", "framework", ",", "but", "in", "this", "paper", "we", "opt", "for", "ResNet", "-", "50", "[", "reference", "]", "or", "SENet", "-", "50", "[", "reference", "]", ".", "Both", "networks", "are", "cropped", "after", "the", "global", "average", "pooling", "layer", ",", "and", "an", "extra", "FC", "layer", "is", "added", "to", "reduce", "the", "output", "dimension", "to", "D", "F", ".", "We", "typically", "pick", "D", "F", "to", "be", "low", "-", "dimensional", "(", "e.g.", "128", "or", "256", ")", ",", "and", "do", "not", "see", "a", "significant", "drop", "in", "face", "recognition", "performance", "compared", "to", "using", "the", "original", "2048", "-", "D", "descriptors", ".", "Finally", ",", "the", "individual", "face", "descriptors", "are", "L2", "normalized", ".", "Aggregation", ".", "The", "second", "part", "uses", "GhostVLAD", "(", "Sec", ".", "3.2", ")", "to", "aggregate", "multiple", "face", "descriptors", "into", "a", "single", "D", "F", "\u00d7", "K", "vector", "(", "where", "K", "is", "a", "parameter", "of", "the", "method", ")", ".", "To", "keep", "computational", "and", "memory", "requirements", "low", ",", "dimensionality", "reduction", "is", "performed", "via", "an", "FC", "layer", ",", "where", "we", "pick", "the", "output", "dimensionality", "D", "to", "be", "128", ".", "The", "compact", "D", "-", "dimensional", "descriptor", "is", "then", "passed", "to", "a", "batch", "-", "normalization", "layer", "[", "reference", "]", "and", "L2", "-", "normalized", "to", "form", "the", "final", "template", "representation", "x", "template", ".", "section", ":", "GhostVLAD", ":", "NetVLAD", "with", "ghost", "clusters", "The", "key", "component", "of", "the", "aggregation", "block", "is", "our", "GhostVLAD", "trainable", "aggregation", "layer", ",", "which", "given", "N", "D", "F", "-", "dimensional", "face", "descriptors", "computes", "a", "single", "It", "is", "based", "on", "the", "NetVLAD", "[", "reference", "]", "layer", "which", "implements", "an", "encoding", "similar", "to", "VLAD", "encoding", "[", "reference", "]", ",", "while", "being", "differentiable", "and", "thus", "fully", "-", "trainable", ".", "NetVLAD", "has", "been", "shown", "to", "outperform", "average", "and", "max", "pooling", "for", "the", "same", "vector", "dimensionality", ",", "which", "makes", "it", "perfectly", "suited", "for", "our", "task", ".", "Here", "we", "provide", "a", "brief", "overview", "of", "NetVLAD", "(", "for", "full", "details", "please", "refer", "to", "[", "reference", "]", ")", ",", "followed", "by", "our", "improvement", ",", "GhostVLAD", ".", "NetVLAD", ".", "For", "N", "D", "F", "-", "dimensional", "input", "descriptors", "{", "x", "i", "}", "and", "a", "chosen", "number", "of", "clusters", "K", ",", "NetVLAD", "pooling", "produces", "a", "single", "D", "F", "\u00d7", "K", "vector", "V", "(", "for", "convenience", "written", "as", "a", "D", "F", "\u00d7", "K", "matrix", ")", "according", "to", "the", "following", "equation", ":", "where", "{", "a", "k", "}", ",", "{", "b", "k", "}", "and", "{", "c", "k", "}", "are", "trainable", "parameters", ",", "with", "k", "\u2208", "[", "1", ",", "2", ",", ".", ".", ".", ",", "K", "]", ".", "The", "first", "term", "corresponds", "to", "the", "soft", "-", "assignment", "weight", "of", "the", "input", "vector", "x", "i", "for", "cluster", "k", ",", "while", "the", "second", "term", "computes", "the", "residual", "between", "the", "vector", "and", "the", "cluster", "centre", ".", "The", "final", "output", "is", "obtained", "by", "performing", "L2", "normalization", ".", "GhostVLAD", ".", "We", "extend", "NetVLAD", "with", "\"", "ghost", "\"", "clusters", "to", "form", "GhostVLAD", ",", "as", "shown", "in", "Fig", ".", "2", ".", "Namely", ",", "we", "add", "further", "G", "\"", "ghost", "\"", "clusters", "which", "contribute", "to", "the", "soft", "assignments", "in", "the", "same", "manner", "as", "the", "original", "K", "clusters", ",", "but", "residuals", "between", "input", "vectors", "and", "the", "ghost", "cluster", "centres", "are", "ignored", "and", "do", "not", "contribute", "to", "the", "final", "output", ".", "In", "other", "words", ",", "the", "summation", "in", "the", "denominator", "of", "eq", ".", "1", "instead", "of", "to", "K", "goes", "to", "K", "+", "G", ",", "while", "the", "output", "is", "still", "D", "F", "\u00d7", "K", "dimensional", ";", "this", "means", "{", "a", "k", "}", "and", "{", "b", "k", "}", "have", "K", "+", "G", "elements", "each", ",", "while", "{", "c", "k", "}", "still", "has", "K.", "Another", "view", "is", "that", "we", "are", "computing", "NetVLAD", "with", "K", "+", "G", "clusters", ",", "followed", "by", "removing", "the", "elements", "that", "correspond", "to", "the", "G", "ghost", "clusters", ".", "Note", "that", "GhostVLAD", "is", "a", "generalization", "of", "NetVLAD", "as", "with", "G", "=", "0", "the", "two", "are", "equivalent", ".", "As", "with", "NetVLAD", ",", "GhostVLAD", "can", "be", "implemented", "efficiently", "using", "For", "each", "input", "descriptor", ",", "NetVLAD", "performs", "softassignment", "into", "K", "cluster", "centres", ",", "computed", "as", "a", "linear", "transformation", "followed", "by", "a", "soft", "-", "max", ".", "It", "then", ",", "for", "each", "cluster", "centre", ",", "aggregates", "all", "residuals", "between", "input", "descriptors", "and", "the", "cluster", "centre", ",", "weighted", "with", "the", "soft", "-", "assignment", "values", ".", "The", "final", "vector", "is", "produced", "as", "a", "concatenation", "of", "the", "per", "-", "cluster", "aggregated", "residuals", ";", "for", "more", "details", "see", "eq", ".", "1", "and", "[", "reference", "]", ".", "We", "introduce", "G", "\"", "ghost", "\"", "clusters", "in", "the", "soft", "-", "assignment", "stage", ",", "where", "the", "\"", "ghost", "\"", "assignment", "weight", "is", "illustrated", "with", "a", "dotted", "red", "bar", "(", "here", "we", "show", "only", "G", "=", "1", "ghost", "cluster", ")", ".", "The", "ghost", "assignments", "are", "then", "eliminated", "and", "residual", "aggregation", "proceeds", "as", "with", "NetVLAD", ".", "This", "mechanism", "enables", "the", "network", "to", "assign", "uninformative", "descriptors", "to", "ghost", "clusters", "thus", "decreasing", "their", "soft", "-", "assignment", "weights", "for", "non", "-", "ghost", "clusters", ",", "and", "therefore", "reducing", "their", "contribution", "to", "the", "final", "template", "representation", ".", "standard", "convolutional", "neural", "network", "building", "blocks", ",", "e.g.", "the", "soft", "-", "assignment", "can", "be", "done", "by", "stacking", "input", "descriptors", "and", "applying", "a", "convolution", "operation", ",", "followed", "by", "a", "convolutional", "soft", "-", "max", ";", "for", "details", "see", "[", "reference", "]", ".", "The", "intuition", "behind", "the", "incorporation", "of", "ghost", "clusters", "is", "to", "make", "it", "easier", "for", "the", "network", "to", "adjust", "the", "contribution", "of", "each", "face", "example", "to", "the", "template", "representation", "by", "assigning", "examples", "to", "be", "ignored", "to", "the", "ghost", "clusters", ".", "For", "example", ",", "in", "an", "ideal", "case", ",", "a", "highly", "blurry", "face", "image", "would", "be", "strongly", "assigned", "to", "a", "ghost", "cluster", ",", "making", "the", "assignment", "weights", "to", "non", "-", "ghost", "clusters", "close", "to", "zero", ",", "thus", "causing", "its", "contribution", "to", "the", "template", "representation", "to", "be", "negligible", ";", "in", "Sec", ".", "4.5", "we", "qualitatively", "validate", "this", "intuition", ".", "However", ",", "note", "that", "we", "do", "not", "explicitly", "force", "low", "-", "quality", "images", "to", "get", "assigned", "to", "ghost", "clusters", ",", "but", "instead", "let", "the", "network", "discover", "the", "optimal", "behaviour", "through", "end", "-", "to", "-", "end", "training", "for", "face", "recognition", ".", "section", ":", "Network", "training", "In", "this", "section", "we", "describe", "how", "to", "train", "the", "network", "for", "face", "recognition", ",", "but", "note", "that", "GhostVLAD", "is", "a", "general", "layer", "which", "can", "also", "be", "used", "for", "other", "tasks", ".", "Training", "loss", ".", "Just", "for", "training", "purposes", ",", "we", "append", "the", "network", "with", "a", "fullyconnected", "\"", "classification", "\"", "layer", "of", "size", "D", "\u00d7T", ",", "where", "D", "is", "the", "size", "of", "the", "template", "representation", "and", "T", "is", "the", "number", "of", "identities", "available", "in", "the", "training", "set", ".", "We", "use", "the", "one", "-", "versus", "-", "all", "logistic", "regression", "loss", "as", "empirically", "we", "found", "that", "it", "converges", "faster", "and", "outperforms", "cross", "-", "entropy", "loss", ".", "The", "classification", "layer", "is", "discarded", "after", "training", "and", "the", "trained", "network", "is", "used", "to", "extract", "a", "single", "fixed", "-", "length", "template", "representation", "for", "the", "input", "face", "images", ".", "Training", "with", "degraded", "images", ".", "For", "unconstrained", "face", "recognition", ",", "it", "is", "important", "to", "be", "able", "to", "handle", "images", "of", "varying", "quality", "that", "typically", "occur", "in", "the", "wild", ".", "The", "motivation", "behind", "our", "network", "architecture", ",", "namely", "the", "GhostVLAD", "layer", ",", "is", "to", "enable", "it", "to", "down", "-", "weight", "the", "influence", "of", "these", "images", "on", "the", "template", "representation", ".", "However", ",", "since", "our", "training", "dataset", "only", "contains", "good", "quality", "images", ",", "it", "is", "necessary", "to", "perform", "data", "augmentation", "in", "the", "form", "of", "image", "degradation", ",", "such", "as", "blurring", "or", "compression", "(", "see", "Sec", ".", "3.4", "for", "details", ")", ",", "in", "order", "to", "more", "closely", "match", "the", "varying", "image", "quality", "encountered", "at", "test", "time", ".", "section", ":", "Implementation", "details", "This", "section", "discusses", "full", "details", "of", "the", "training", "process", ",", "including", "training", "data", ",", "data", "augmentation", ",", "network", "initialization", ",", "etc", ".", "Training", "data", ".", "We", "use", "face", "images", "from", "the", "training", "set", "of", "the", "VGGFace2", "dataset", "[", "reference", "]", "to", "train", "the", "network", ".", "It", "consists", "of", "around", "3", "million", "images", ",", "covering", "8631", "identities", ".", "For", "each", "identity", ",", "there", "are", "on", "average", "360", "face", "images", "across", "different", "ages", "and", "poses", ".", "To", "perform", "set", "-", "based", "training", ",", "we", "form", "image", "sets", "on", "-", "the", "-", "fly", "by", "repeatedly", "sampling", "a", "fixed", "number", "of", "images", "belonging", "to", "the", "same", "identity", ".", "Data", "augmentation", ".", "Training", "images", "are", "resized", "such", "that", "the", "smallest", "dimension", "is", "256", "and", "random", "crops", "of", "size", "224", "\u00d7", "224", "are", "used", "as", "inputs", "to", "the", "network", ".", "Further", "augmentations", "include", "random", "horizontal", "flipping", "and", "a", "random", "rotation", "of", "no", "greater", "than", "10", "degrees", ".", "We", "adopt", "four", "methods", "to", "degrade", "images", "for", "training", ":", "isotropic", "blur", ",", "motion", "blur", ",", "decreased", "resolution", "and", "JPEG", "compression", ".", "Each", "degradation", "method", "has", "a", "probability", "of", "0.1", "to", "be", "applied", "to", "a", "training", "image", ",", "where", ",", "to", "prevent", "overdegradation", ",", "a", "maximum", "of", "two", "transformations", "per", "image", "is", "allowed", ".", "Isotropic", "blur", "is", "implemented", "using", "a", "Gaussian", "filter", "where", "the", "standard", "deviation", "is", "uniformly", "sampled", "between", "6", "and", "16", ".", "For", "motion", "blur", ",", "the", "angle", "of", "motion", "is", "uniformly", "sampled", "between", "0", "and", "359", "degrees", ",", "and", "the", "motion", "length", "is", "fixed", "to", "11", ".", "Resolution", "decrease", "is", "simulated", "by", "downscaling", "the", "image", "by", "a", "factor", "of", "10", "and", "scaling", "it", "back", "up", "to", "the", "original", "size", ".", "Finally", ",", "we", "add", "JPEG", "compression", "artefacts", "by", "randomly", "compressing", "the", "images", "to", "one", "of", "three", "compression", "ratios", ":", "0.01", ",", "0.05", "and", "0.09", ".", "Training", "procedure", ".", "The", "network", "can", "be", "trained", "end", "-", "to", "-", "end", "in", "one", "go", ",", "but", ",", "to", "make", "the", "training", "faster", "and", "more", "stable", ",", "we", "divide", "it", "into", "three", "stages", ";", "all", "stages", "only", "use", "the", "VGGFace2", "[", "reference", "]", "dataset", ".", "In", "the", "first", "two", "stages", ",", "parts", "of", "the", "network", "are", "trained", "for", "single", "-", "image", "face", "classification", "(", "i.e.", "the", "input", "image", "set", "consists", "of", "a", "single", "image", ")", ",", "and", "image", "degradation", "is", "not", "performed", ".", "Firstly", ",", "the", "feature", "extractor", "network", "is", "pre", "-", "trained", "for", "single", "-", "image", "face", "classification", "by", "temporarily", "(", "just", "for", "this", "stage", ")", "appending", "a", "classification", "FC", "layer", "on", "top", "of", "it", ",", "and", "training", "the", "network", "with", "the", "cross", "-", "entropy", "loss", ".", "Secondly", ",", "we", "train", "the", "whole", "network", "end", "-", "to", "-", "end", "for", "single", "-", "image", "classification", "with", "one", "-", "versus", "-", "all", "logistic", "regression", "loss", ",", "but", "exclude", "the", "ghost", "clusters", "from", "GhostVLAD", "because", "training", "images", "are", "not", "degraded", "in", "this", "stage", ".", "Finally", ",", "we", "add", "ghost", "clusters", "and", "enable", "image", "degradation", ",", "and", "train", "the", "whole", "network", "using", "image", "sets", "with", "one", "-", "versus", "-", "all", "logistic", "regression", "loss", ".", "Parameter", "initialization", ".", "The", "non", "-", "ghost", "clusters", "of", "GhostVLAD", "are", "initialized", "as", "in", "NetVLAD", "[", "reference", "]", "by", "clustering", "its", "input", "features", "with", "k", "-", "means", "into", "K", "clusters", ",", "where", "only", "non", "-", "degraded", "images", "are", "used", ".", "The", "G", "ghost", "clusters", "are", "initialized", "similarly", ",", "but", "using", "degraded", "images", "for", "the", "clustering", ";", "note", "that", "for", "G", "=", "1", "(", "a", "setting", "we", "often", "use", ")", "k", "-", "means", "simplifies", "to", "computing", "the", "mean", "over", "the", "features", ".", "The", "FC", "following", "GhostVLAD", "which", "performs", "dimensionality", "reduction", "is", "then", "initialized", "using", "the", "PCA", "transformation", "matrix", "computed", "on", "the", "GhostVLAD", "output", "features", ".", "Training", "details", ".", "The", "network", "is", "trained", "using", "stochastic", "gradient", "descend", "with", "momentum", ",", "implemented", "in", "MatConvNet", "[", "reference", "]", ".", "The", "mini", "-", "batch", "consists", "of", "84", "face", "images", ",", "i.e.", "if", "we", "train", "with", "image", "sets", "of", "size", "two", ",", "a", "batch", "contains", "42", "image", "sets", ",", "one", "per", "identity", ".", "When", "one", "-", "versus", "-", "all", "logistic", "regression", "loss", "is", "used", ",", "for", "each", "image", "set", ",", "we", "update", "the", "network", "weights", "based", "on", "the", "positive", "class", "and", "only", "20", "negative", "classes", "(", "instead", "of", "8631", ")", "that", "obtain", "the", "highest", "classification", "scores", ".", "The", "initial", "learning", "rate", "of", "0.0001", "is", "used", "for", "all", "parameters", "apart", "from", "GhostVLAD", "'s", "assignment", "parameters", "and", "the", "classification", "FC", "weights", ",", "for", "which", "we", "use", "0.1", "and", "1", ",", "respectively", ".", "The", "learning", "rates", "are", "divided", "by", "10", "when", "validation", "error", "stagnates", ",", "while", "weight", "decay", "and", "momentum", "are", "fixed", "to", "0.0005", "and", "0.9", ",", "respectively", ".", "section", ":", "Experiments", "In", "this", "section", ",", "we", "describe", "the", "experimental", "setup", ",", "investigate", "the", "impact", "of", "our", "design", "choices", ",", "and", "compare", "results", "with", "the", "state", "-", "of", "-", "the", "-", "art", ".", "section", ":", "Benchmark", "datasets", "and", "evaluation", "protocol", "Standard", "and", "most", "challenging", "public", "face", "recognition", "datasets", "IJB", "-", "A", "[", "reference", "]", "and", "IJB", "-", "B", "[", "reference", "]", "are", "used", "for", "evaluation", ".", "In", "contrast", "to", "single", "-", "image", "based", "face", "datasets", "such", "as", "[", "reference", "][", "reference", "][", "reference", "][", "reference", "]", ",", "IJB", "-", "A", "and", "IJB", "-", "B", "are", "intended", "for", "template", "-", "based", "face", "recognition", ",", "which", "is", "exactly", "the", "task", "we", "consider", "in", "this", "work", ".", "The", "IJB", "-", "A", "dataset", "contains", "5", ",", "712", "images", "and", "2", ",", "085", "videos", ",", "covering", "500", "subjects", ";", "thus", "the", "average", "number", "of", "images", "and", "videos", "per", "subject", "are", "11.4", "and", "4.2", "videos", ",", "respectively", ".", "The", "IJB", "-", "B", "dataset", "is", "an", "extension", "of", "IJB", "-", "A", "with", "a", "total", "of", "11", ",", "754", "images", "and", "7", ",", "011", "videos", "from", "1", ",", "845", "subjects", ",", "as", "well", "as", "10", ",", "044", "non", "-", "face", "images", ".", "There", "is", "no", "overlap", "between", "subjects", "in", "VGGFace2", ",", "which", "we", "use", "for", "training", ",", "and", "the", "test", "datasets", ".", "Faces", "are", "detected", "from", "images", "and", "all", "video", "frames", "using", "MTCNN", "[", "reference", "]", ",", "the", "face", "crops", "are", "then", "resized", "such", "that", "the", "smallest", "dimension", "is", "224", "and", "the", "central", "224", "\u00d7", "224", "crop", "is", "used", "as", "the", "face", "example", ".", "Evaluation", "protocol", ".", "We", "follow", "the", "standard", "benchmark", "procedure", "for", "IJB", "-", "A", "and", "IJB", "-", "B", ",", "and", "evaluate", "on", "\"", "1:1", "face", "verification", "\"", "and", "\"", "1:N", "face", "identification", "\"", ".", "The", "goal", "of", "1:1", "verification", "is", "to", "make", "a", "decision", "whether", "two", "templates", "belong", "to", "the", "same", "person", ",", "done", "by", "thresholding", "the", "similarity", "between", "the", "templates", ".", "Verification", "performance", "is", "assessed", "via", "the", "receiver", "operating", "characteristic", "(", "ROC", ")", "curve", ",", "i.e.", "by", "measuring", "the", "trade", "-", "off", "between", "the", "true", "accept", "rates", "(", "TAR", ")", "vs", "false", "accept", "rates", "(", "FAR", ")", ".", "For", "1:N", "identification", ",", "templates", "from", "the", "probe", "set", "are", "used", "to", "rank", "all", "templates", "in", "a", "given", "gallery", ".", "The", "performance", "is", "measured", "using", "the", "true", "positive", "identification", "rate", "(", "TPIR", ")", "vs", "false", "positive", "identification", "rate", "(", "FPIR", ")", "(", "i.e.", "the", "decision", "error", "trade", "-", "off", "(", "DET", ")", "curve", ")", "and", "vs", "Rank", "-", "N", "(", "i.e.", "the", "cumulative", "match", "characteristic", "(", "CMC", ")", "curve", ")", ".", "Evaluation", "protocols", "are", "the", "same", "for", "both", "benchmark", "datasets", ",", "apart", "from", "the", "fact", "that", "IJB", "-", "A", "defines", "10", "test", "splits", ",", "while", "IJB", "-", "B", "only", "has", "one", "split", "for", "verification", "and", "two", "galleries", "for", "identification", ".", "For", "IJB", "-", "A", "and", "for", "IJB", "-", "B", "identification", ",", "we", "report", ",", "as", "per", "standard", ",", "the", "mean", "and", "standard", "deviation", "of", "the", "performance", "measures", ".", "section", ":", "Networks", ",", "deployment", "and", "baselines", "Our", "networks", ".", "As", "explained", "earlier", "in", "Sec", ".", "3.1", ",", "we", "use", "two", "different", "architectures", "as", "backbone", "feature", "extractors", ":", "ResNet", "-", "50", "[", "reference", "]", "and", "SENet", "-", "50", "[", "reference", "]", ".", "They", "are", "cropped", "after", "global", "average", "-", "pooling", "which", "produces", "a", "D", "F", "=", "2048", "dimensional", "face", "descriptor", ",", "while", "we", "also", "experiment", "with", "reducing", "the", "dimensionality", "via", "an", "additional", "FC", ",", "down", "to", "D", "F", "=", "256", "or", "D", "F", "=", "128", ".", "To", "disambiguate", "various", "network", "configurations", ",", "we", "name", "the", "networks", "as", "Ext", "-", "GV", "-", "S", "(-", "gG", ")", ",", "where", "Ext", "is", "the", "feature", "extractor", "network", "(", "Res", "for", "ResNet", "-", "50", "or", "SE", "for", "SENet", "-", "50", ")", ",", "S", "is", "the", "size", "of", "image", "sets", "used", "during", "training", ",", "and", "G", "is", "the", "number", "of", "ghost", "clusters", "(", "if", "zero", ",", "the", "suffix", "is", "dropped", ")", ".", "For", "example", ",", "SE", "-", "GV", "-", "3", "-", "g2", "denotes", "a", "network", "which", "uses", "the", "SENet", "-", "50", "as", "the", "feature", "extractor", ",", "training", "image", "sets", "of", "size", "3", ",", "and", "2", "ghost", "clusters", ".", "Network", "deployment", ".", "In", "the", "IJB", "-", "A", "and", "IJB", "-", "B", "datasets", ",", "there", "are", "images", "and", "videos", "available", "for", "each", "subject", ".", "Here", "we", "follow", "the", "established", "approach", "of", "[", "reference", "][", "reference", "]", "to", "balance", "the", "contributions", "of", "face", "examples", "from", "different", "sources", ",", "as", "otherwise", "a", "single", "very", "long", "video", "could", "completely", "dominate", "the", "representation", ".", "In", "more", "detail", ",", "face", "examples", "are", "extracted", "from", "all", "video", "frames", ",", "and", "their", "additive", "contributions", "to", "the", "GhostVLAD", "representation", "are", "down", "-", "weighed", "by", "the", "number", "of", "frames", "in", "the", "video", ".", "The", "similarity", "between", "two", "templates", "is", "measured", "as", "the", "scalar", "product", "between", "the", "template", "representations", ";", "recall", "that", "they", "have", "unit", "norm", "(", "Fig", ".", "1", ")", ".", "Baselines", ".", "Our", "network", "is", "compared", "with", "several", "average", "-", "pooling", "baselines", ".", "The", "baseline", "architecture", "consists", "of", "a", "feature", "extractor", "network", "which", "produces", "a", "face", "descriptor", "for", "each", "input", "example", ",", "and", "the", "template", "representation", "is", "performed", "by", "average", "-", "pooling", "the", "face", "descriptors", "(", "with", "source", "balancing", ")", ",", "followed", "by", "L2", "normalization", ".", "The", "same", "feature", "extractor", "networks", "are", "used", "as", "for", "our", "method", ",", "ResNet", "-", "50", "or", "SENet", "-", "50", ",", "abbreviated", "as", "Res", "and", "SE", ",", "respectively", ",", "with", "an", "optionally", "added", "FC", "layer", "to", "perform", "dimensionality", "reduction", "down", "to", "128", "-", "D", "or", "256", "-", "D.", "These", "networks", "are", "trained", "for", "single", "-", "image", "face", "classification", ",", "which", "is", "equivalent", "to", "stage", "1", "of", "our", "training", "procedure", "from", "Sec", ".", "3.4", ",", "and", "also", "corresponds", "to", "the", "current", "state", "-", "of", "-", "the", "-", "art", "approach", "[", "reference", "]", "(", "albeit", "with", "more", "training", "data", "-", "see", "Sec", ".", "4.4", "for", "details", "and", "comparisons", ")", ".", "No", "image", "degradation", "is", "performed", "as", "it", "decreases", "performance", "when", "combined", "with", "single", "-", "image", "classification", "training", ".", "In", "addition", ",", "we", "train", "the", "baseline", "architecture", "SENet", "-", "50", "with", "average", "-", "pooling", "using", "our", "training", "procedure", "(", "Sec", ".", "3.3", ")", ",", "i.e.", "with", "image", "sets", "of", "size", "2", "and", "degraded", "images", ",", "and", "refer", "to", "it", "as", "SE", "-", "2", ".", "section", ":", "Ablation", "studies", "on", "IJB", "-", "B", "Here", "we", "evaluate", "various", "design", "choices", "of", "our", "architecture", "and", "compare", "it", "to", "baselines", "on", "the", "IJB", "-", "B", "dataset", ",", "as", "it", "is", "larger", "and", "more", "challenging", "than", "IJB", "-", "A", ";", "results", "on", "verification", "and", "identification", "are", "shown", "in", "Tables", "1", "and", "Table", "2", ",", "respectively", ".", "Feature", "extractor", "and", "dimensionality", "reduction", ".", "Comparing", "rows", "1", "vs", "2", "of", "the", "two", "tables", "shows", "that", "reducing", "the", "dimensionality", "of", "the", "face", "features", "from", "2048", "-", "D", "to", "128", "-", "D", "does", "not", "affect", "the", "performance", "much", ",", "and", "in", "fact", "sometimes", "improves", "it", "due", "to", "added", "parameters", "in", "the", "form", "of", "the", "dimensionality", "reduction", "FC", ".", "As", "the", "feature", "extractor", "backbone", ",", "SENet", "-", "50", "consistently", "beats", "ResNet", "-", "50", ",", "as", "summarized", "in", "rows", "2", "vs", "3", ".", "Training", "for", "set", "-", "based", "face", "recognition", ".", "The", "currently", "adopted", "set", "-", "based", "face", "recognition", "approach", "of", "training", "with", "single", "-", "image", "examples", "and", "performing", "aggregation", "post", "hoc", "(", "SE", ",", "row", "4", ")", "is", "clearly", "inferior", "to", "our", "training", "procedure", "which", "is", "aware", "of", "image", "sets", "(", "SE", "-", "2", ",", "row", "5", ")", ".", "Learnt", "GhostVLAD", "aggregation", ".", "Using", "the", "GhostVLAD", "aggregation", "layer", "(", "with", "G", "=", "0", "i.e.", "equivalent", "to", "NetVLAD", ")", "together", "with", "our", "set", "-", "based", "training", "framework", "strongly", "outperforms", "the", "standard", "average", "-", "pooling", "approach", ",", "regardless", "of", "whether", "training", "is", "done", "with", "non", "-", "degraded", "images", "(", "SE", "-", "GV", "-", "2", ",", "row", "8", "vs", "SE", ",", "rows", "3", "and", "4", ")", ",", "degraded", "images", "(", "SE", "-", "GV", "-", "2", ",", "row", "9", "vs", "SE", "-", "2", ",", "row", "5", ")", ",", "or", "if", "a", "different", "feature", "extractor", "architecture", "(", "ResNet", "-", "50", ")", "is", "used", "(", "Res", "-", "GV", "-", "2", ",", "row", "6", "vs", "Res", ",", "row", "2", ")", ".", "Using", "256", "-", "D", "vs", "128", "-", "D", "face", "descriptors", "as", "inputs", "to", "GhostVLAD", ",", "while", "keeping", "the", "same", "dimensionality", "of", "the", "final", "template", "representation", "(", "128", "-", "D", ")", ",", "achieves", "better", "results", "(", "rows", "9", "vs", "7", ")", ",", "so", "we", "use", "256", "-", "D", "in", "all", "latter", "experiments", ".", "Training", "with", "degraded", "images", ".", "When", "using", "our", "set", "-", "based", "training", "procedure", ",", "training", "with", "degraded", "images", "brings", "a", "consistent", "boost", ",", "as", "shown", "in", "rows", "9", "vs", "8", ",", "since", "it", "better", "matches", "the", "test", "-", "time", "scenario", "which", "contains", "images", "of", "varying", "quality", ".", "Number", "of", "clusters", "K.", "GhostVLAD", "(", "and", "NetVLAD", ")", "have", "a", "hyperparameter", "K", "-", "the", "number", "of", "non", "-", "ghost", "clusters", "-", "which", "we", "vary", "between", "4", "and", "16", "(", "rows", "9", "to", "11", ")", "to", "study", "its", "effect", "on", "face", "recognition", "performance", ".", "It", "is", "expected", "that", "K", "should", "n't", "be", "too", "small", "so", "that", "underfitting", "is", "avoided", "(", "e.g.", "K", "=", "1", "is", "similar", "to", "average", "-", "pooling", ")", "nor", "too", "large", "in", "order", "to", "prevent", "over", "-", "quantization", "and", "overfitting", ".", "As", "in", "traditional", "image", "retrieval", "[", "reference", "]", ",", "we", "find", "that", "a", "wide", "range", "of", "K", "achieves", "good", "performance", ",", "with", "K", "=", "8", "being", "the", "best", ".", "Ghost", "clusters", ".", "Introducing", "a", "single", "ghost", "cluster", "(", "G", "=", "1", ")", "brings", "significant", "improvement", "over", "the", "vanilla", "NetVLAD", ",", "as", "shown", "by", "comparing", "SE", "-", "GV", "-", "3", "-", "g1", "vs", "SE", "-", "GV", "-", "3", "(", "rows", "14", "vs", "12", ")", "and", "SE", "-", "GV", "-", "4", "-", "g1", "vs", "SE", "-", "GV", "-", "4", "(", "rows", "15", "vs", "13", ")", ".", "Using", "one", "ghost", "cluster", "is", "sufficient", "as", "increasing", "the", "number", "of", "ghost", "clusters", "to", "two", "does", "not", "result", "in", "significant", "differences", "(", "row", "16", "vs", "row", "14", ")", ".", "Ghost", "clusters", "enable", "the", "system", "to", "automatically", "down", "-", "weight", "the", "contribution", "of", "low", "quality", "images", ",", "as", "will", "be", "shown", "in", "Sec", ".", "4.5", ",", "which", "improves", "the", "template", "representations", "and", "benefits", "face", "recognition", ".", "Set", "size", "used", "during", "training", ".", "To", "perform", "set", "-", "based", "training", ",", "as", "described", "in", "Sec", ".", "3.4", ",", "image", "sets", "are", "created", "by", "sampling", "a", "fixed", "number", "of", "faces", "for", "a", "subject", ";", "the", "number", "of", "sampled", "faces", "is", "another", "parameter", "of", "the", "method", ".", "Increasing", "the", "set", "size", "from", "2", "to", "3", "consistently", "improves", "results", "(", "rows", "9", "vs", "12", ")", ",", "while", "there", "is", "no", "clear", "winner", "between", "using", "3", "or", "4", "face", "examples", "(", "worse", "for", "G", "=", "0", ",", "rows", "12", "vs", "13", ",", "better", "for", "G", "=", "1", ",", "rows", "15", "vs", "14", ")", ".", "Output", "dimensionality", ".", "Comparisons", "are", "also", "made", "between", "networks", "with", "128", "-", "D", "output", "features", "and", "those", "with", "256", "-", "D", "(", "i.e.", "row", "13", "vs", "17", "and", "row", "15", "vs", "18", ")", ",", "and", "we", "can", "see", "that", "networks", "with", "128", "-", "D", "output", "achieve", "better", "performance", "while", "being", "more", "memory", "-", "efficient", ".", "section", ":", "Comparison", "with", "state", "-", "of", "-", "the", "-", "art", "In", "this", "section", ",", "our", "best", "networks", ",", "SE", "-", "GV", "-", "3", "and", "SE", "-", "GV", "-", "4", "-", "g1", ",", "are", "compared", "against", "the", "state", "-", "of", "-", "the", "-", "art", "on", "the", "IJB", "-", "A", "and", "IJB", "-", "B", "datasets", ".", "The", "currently", "best", "performing", "method", "[", "reference", "]", "is", "the", "same", "as", "our", "SE", "baseline", "(", "i.e.", "average", "-", "pooling", "of", "SENet", "-", "50", "features", "trained", "for", "single", "-", "image", "classification", ")", "but", "trained", "on", "a", "much", "larger", "training", "set", ",", "MS", "-", "Celeb", "-", "1", "M", "dataset", "[", "reference", "]", ",", "and", "then", "fine", "-", "tuned", "on", "VGGFace2", ".", "From", "Tables", "3", "and", "4", ",", "and", "Figure", "3", ",", "it", "is", "clear", "our", "GhostVLAD", "network", "(", "SE", "-", "GV", "-", "4", "-", "g1", ")", "convincingly", "outperforms", "previous", "methods", "and", "sets", "the", "new", "state", "-", "ofthe", "-", "art", "for", "both", "identification", "and", "verification", "on", "both", "IJB", "-", "A", "and", "IJB", "-", "B", "datasets", ".", "In", "particular", ",", "it", "surpasses", "[", "reference", "]", "marginally", "on", "the", "IJB", "-", "A", "verification", "task", ",", "despite", "the", "fact", "that", "[", "reference", "]", "uses", "a", "deeper", "ResNet", "and", "performs", "an", "exhaustive", "scoring", "using", "each", "face", "image", "in", "the", "templates", ".", "The", "only", "points", "for", "which", "the", "GhostVLAD", "network", "does", "n't", "beat", "the", "state", "-", "of", "-", "the", "-", "art", ",", "though", "it", "is", "on", "par", "with", "it", ",", "is", "in", "TPIR", "at", "Rank", "-", "1", "to", "Rank", "-", "10", "for", "identification", "on", "IJB", "-", "A", ";", "but", "this", "is", "because", "IJB", "-", "A", "is", "not", "challenging", "enough", "and", "the", "TPIR", "values", "have", "saturated", "to", "a", "99", "%", "mark", ".", "For", "the", "same", "measures", "on", "the", "more", "challenging", "IJB", "-", "B", "benchmark", ",", "our", "network", "achieves", "the", "best", "TAR", "at", "FAR=1E", "\u2212", "5", "and", "FAR=1E", "\u2212", "4", ",", "and", "is", "only", "lower", "than", "a", "concurrent", "work", "[", "reference", "]", "at", "FAR=1E", "\u2212", "3", "and", "FAR=1E", "\u2212", "2", ".", "Furthermore", ",", "our", "networks", "produce", "much", "smaller", "template", "descriptors", "than", "the", "previous", "stateof", "-", "the", "-", "art", "networks", "(", "128", "-", "D", "vs", "2048", "-", "D", ")", ",", "making", "them", "more", "useful", "in", "real", "-", "world", "[", "reference", "]", "(", "priv1", ")", "and", "[", "reference", "]", "(", "priv2", ")", ".", "'", "512", "-", "pi", "'", "means", "that", "a", "512", "-", "D", "descriptor", "is", "used", "per", "image", ".", "'", "*", "'", "denotes", "the", "value", "given", "by", "the", "author", ".", "Our", "best", "network", ",", "SE", "-", "GV", "-", "4", "-", "g1", ",", "sets", "the", "state", "-", "of", "-", "the", "-", "art", "by", "a", "significant", "margin", "on", "both", "datasets", "(", "except", "for", "concurrent", "work", "[", "reference", "]", ")", ".", "applications", "due", "to", "smaller", "memory", "requirements", "and", "faster", "template", "comparisons", ".", "The", "results", "are", "especially", "impressive", "as", "we", "only", "train", "using", "VGGFace2", "[", "reference", "]", "and", "beat", "methods", "which", "train", "with", "much", "more", "data", ",", "such", "as", "[", "reference", "]", "which", "combine", "VGGFace2", "and", "MS", "-", "Celeb", "-", "1", "M", "[", "reference", "]", ",", "e.g.", "TAR", "at", "FAR=1E", "\u2212", "5", "of", "0.762", "vs", "0.705", "for", "verification", "on", "IJB", "-", "B", ",", "and", "TPIR", "at", "FPIR=0.01", "of", "0.776", "vs", "0.743", "for", "identification", "on", "IJB", "-", "B.", "When", "considering", "only", "methods", "trained", "on", "the", "same", "data", "(", "VGGFace2", ")", ",", "our", "improvement", "over", "the", "state", "-", "of", "-", "the", "-", "art", "is", "even", "larger", ":", "TAR", "at", "FAR=1E", "\u22125", "of", "0.762", "vs", "0.671", "for", "verification", "on", "IJB", "-", "B", ",", "and", "TPIR", "at", "FPIR=0.01", "of", "0.776", "vs", "0.706", "for", "verification", "on", "IJB", "-", "B.", "section", ":", "Analysis", "of", "ghost", "clusters", "Addition", "of", "ghost", "clusters", "was", "motivated", "by", "the", "intuition", "that", "it", "enables", "our", "network", "to", "learn", "to", "ignore", "uninformative", "low", "-", "quality", "images", "by", "assigning", "them", "to", "the", "discarded", "ghost", "clusters", ".", "Here", "we", "evaluate", "this", "hypothesis", "qualitatively", ".", "Recall", "that", "GhostVLAD", "computes", "a", "template", "representation", "by", "aggregating", "residual", "vectors", "of", "input", "descriptors", ",", "where", "a", "residual", "vector", "is", "a", "concatenation", "of", "per", "non", "-", "ghost", "cluster", "residuals", "weighted", "by", "their", "non", "-", "ghost", "assignment", "weights", "(", "Sec", ".", "3.2", ")", ".", "Therefore", ",", "the", "contribution", "of", "a", "specific", "example", "image", "towards", "the", "template", "representation", "can", "be", "measured", "as", "the", "norm", "of", "the", "residual", ".", "Figure", "4", "show", "that", "our", "intuition", "is", "correct", "-", "the", "network", "automatically", "learns", "to", "dramatically", "down", "-", "weight", "blurry", "and", "low", "-", "resolution", "images", ",", "thus", "improving", "the", "signal", "-", "to", "-", "noise", "ratio", ".", "Note", "that", "this", "behaviour", "emerges", "completely", "automatically", "without", "ever", "explicitly", "teaching", "the", "network", "to", "down", "-", "weight", "low", "-", "quality", "images", ".", "section", ":", "Conclusions", "We", "introduced", "a", "neural", "network", "architecture", "and", "training", "procedure", "for", "learning", "compact", "representations", "of", "image", "sets", "for", "template", "-", "based", "face", "recognition", ".", "Due", "to", "the", "novel", "GhostVLAD", "layer", ",", "the", "network", "is", "able", "to", "automatically", "learn", "to", "weight", "face", "descriptors", "depending", "on", "their", "information", "content", ".", "Our", "template", "representations", "outperform", "the", "state", "-", "of", "-", "the", "-", "art", "on", "the", "challenging", "IJB", "-", "A", "and", "IJB", "-", "B", "benchmarks", "by", "a", "large", "margin", ".", "The", "network", "architecture", "proposed", "here", "could", "also", "be", "applied", "to", "other", "imageset", "tasks", "such", "as", "person", "re", "-", "identification", ",", "and", "set", "-", "based", "retrieval", ".", "More", "generally", ",", "the", "idea", "of", "having", "a", "'", "null", "'", "vector", "available", "for", "assignments", "could", "have", "applicability", "in", "many", "situations", "where", "it", "is", "advantageous", "to", "have", "a", "mechanism", "to", "remove", "noisy", "or", "corrupted", "data", ".", "section", ":", "section", ":", "Acknowledgements", "We", "thank", "Weidi", "Xie", "for", "his", "useful", "advice", ",", "and", "we", "thank", "Li", "Shen", "for", "providing", "pre", "-", "trained", "networks", ".", "This", "work", "was", "funded", "by", "an", "EPSRC", "studentship", "and", "EPSRC", "Programme", "Grant", "Seebibyte", "EP", "/", "M013774", "/", "1", ".", "section", ":", "Bibliography", "section", ":"]}