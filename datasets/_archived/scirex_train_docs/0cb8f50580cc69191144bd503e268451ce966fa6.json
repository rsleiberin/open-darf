{"coref": {"Drug_Discovery": [[13, 15], [446, 448]], "Error_ratio": [[866, 869], [875, 877], [890, 892], [906, 908], [919, 921], [1018, 1020], [4858, 4861], [4872, 4875], [4890, 4893], [4894, 4895], [4914, 4916], [4956, 4957], [5130, 5132], [5184, 5186], [5465, 5467], [5743, 5745], [7303, 7305], [7329, 7331], [7339, 7342], [7358, 7361], [7377, 7379], [5859, 5861], [7313, 7316]], "MPNNs": [[115, 119], [120, 121], [132, 133], [503, 507], [508, 509], [1105, 1106], [1135, 1136], [1174, 1175], [1195, 1196], [1197, 1201], [1215, 1216], [1324, 1328], [1346, 1350], [1359, 1360], [1508, 1509], [1551, 1552], [1579, 1580], [1947, 1948], [2177, 2178], [2193, 2194], [2760, 2761], [2851, 2852], [2862, 2863], [3276, 3278], [3283, 3284], [3359, 3360], [3467, 3469], [4109, 4110], [5006, 5007], [5343, 5344], [5392, 5393], [5907, 5908], [5998, 5999], [6175, 6176], [6188, 6189], [6207, 6208], [6491, 6492], [7766, 7767], [5315, 5316]], "QM9": [[655, 657], [662, 663], [718, 719], [745, 746], [860, 861], [1074, 1076], [2436, 2437], [2855, 2857], [2873, 2875], [2982, 2983], [3013, 3014], [4792, 4796], [5211, 5212]]}, "coref_non_salient": {"0": [[2616, 2619], [7238, 7239]], "1": [[900, 902], [922, 924], [950, 952], [992, 994], [1009, 1011], [1031, 1033], [1084, 1086], [1122, 1124], [1141, 1143], [2350, 2351], [2538, 2539], [4904, 4906], [4921, 4923], [4934, 4937], [5345, 5347], [5497, 5498], [7300, 7302], [7318, 7320]], "10": [[3969, 3970], [4305, 4307]], "100": [[4044, 4046]], "101": [[3834, 3837]], "102": [[230, 235]], "103": [[2800, 2802]], "104": [[5639, 5643]], "105": [[4723, 4725]], "106": [[6821, 6825]], "107": [[295, 297]], "108": [[2752, 2754]], "109": [[5818, 5821]], "11": [[3597, 3599], [3653, 3656], [4278, 4280]], "110": [[5208, 5210]], "111": [[1187, 1188]], "112": [[1384, 1386]], "113": [[7779, 7782]], "114": [[4511, 4515], [7789, 7793]], "115": [[2624, 2627]], "116": [[4754, 4758]], "117": [[6698, 6700]], "118": [[4074, 4077]], "119": [[2297, 2299]], "12": [[11, 12], [259, 261], [2995, 2997]], "120": [[2561, 2565]], "121": [[442, 445]], "122": [[4832, 4834]], "123": [[1391, 1394], [1400, 1403], [1959, 1962], [4121, 4124]], "124": [[879, 881], [1138, 1139]], "125": [[4316, 4318]], "126": [[2805, 2808]], "127": [[522, 524]], "128": [[2047, 2051]], "129": [[319, 321]], "13": [[1177, 1179], [1952, 1954], [4472, 4474]], "130": [[4160, 4162], [4288, 4290]], "131": [[7683, 7685]], "132": [[1710, 1714]], "133": [[2491, 2495]], "134": [[0, 2]], "135": [[498, 502]], "136": [[1318, 1321]], "137": [[2263, 2267]], "138": [[1757, 1760]], "139": [[50, 52]], "14": [[187, 190], [2006, 2010]], "140": [[5189, 5193]], "141": [[1791, 1795]], "142": [[335, 340]], "143": [[5294, 5296]], "144": [[6510, 6513]], "145": [[2482, 2484]], "146": [[6515, 6518]], "147": [[241, 243]], "148": [[4175, 4179]], "149": [[1668, 1671]], "15": [[2058, 2061], [6171, 6174]], "150": [[5280, 5281]], "151": [[4829, 4831]], "152": [[2291, 2293]], "153": [[1057, 1059]], "154": [[1222, 1225]], "155": [[2829, 2832]], "156": [[4204, 4205]], "157": [[3972, 3975]], "158": [[579, 581]], "159": [[410, 412]], "16": [[46, 49], [1694, 1696]], "17": [[1184, 1186], [2255, 2257], [2474, 2476]], "18": [[5659, 5662], [7599, 7602], [7617, 7619]], "19": [[1080, 1082], [1119, 1120], [2426, 2428], [2529, 2530], [2540, 2541], [7363, 7365]], "2": [[603, 610], [2342, 2344], [2577, 2579]], "20": [[264, 266], [5938, 5940]], "21": [[1422, 1425], [3899, 3901]], "22": [[1850, 1852], [3583, 3585], [6662, 6664]], "23": [[1396, 1398], [1454, 1456], [2038, 2040], [3979, 3981], [3985, 3987], [3991, 3993]], "24": [[684, 685], [2354, 2357], [2358, 2359], [2381, 2382], [2553, 2554], [2583, 2584], [2944, 2945], [5544, 5546]], "25": [[302, 305], [1288, 1291], [1587, 1589]], "26": [[1219, 1221], [2776, 2778]], "27": [[5619, 5620], [6024, 6025]], "28": [[462, 465], [629, 635]], "29": [[5157, 5158], [5703, 5706]], "3": [[1935, 1938], [5318, 5322]], "30": [[5629, 5637], [7561, 7569], [7574, 7581]], "31": [[5685, 5690], [5734, 5735], [7652, 7654], [7689, 7691], [7707, 7712]], "32": [[4743, 4745], [4774, 4776], [4780, 4782]], "33": [[2833, 2834], [4480, 4482]], "34": [[5718, 5722], [5811, 5814], [5842, 5845]], "35": [[5583, 5585], [5671, 5673], [7670, 7672], [7693, 7695]], "36": [[219, 221], [236, 238], [256, 258], [390, 393], [5277, 5279]], "37": [[4011, 4013], [4016, 4018], [4070, 4072]], "38": [[1766, 1768], [3571, 3573], [5766, 5768]], "39": [[466, 469], [702, 705]], "4": [[84, 87], [143, 147]], "40": [[17, 19], [449, 451]], "41": [[4126, 4128]], "42": [[7570, 7571]], "43": [[1513, 1515], [2704, 2706], [2737, 2739]], "44": [[7240, 7242]], "45": [[7799, 7804]], "46": [[5803, 5806], [7751, 7754]], "47": [[5089, 5091], [5145, 5147]], "48": [[4680, 4685]], "49": [[5234, 5238]], "5": [[4330, 4332], [4452, 4454], [5588, 5590]], "50": [[6098, 6100]], "51": [[6851, 6852]], "52": [[1416, 1419], [1883, 1886]], "53": [[7726, 7727]], "54": [[1871, 1873], [3514, 3516], [3595, 3597], [3604, 3606], [3630, 3632], [3754, 3756], [4619, 4621], [6216, 6218]], "55": [[2416, 2419]], "56": [[1754, 1755], [3580, 3581], [3929, 3930]], "57": [[2628, 2629], [2672, 2673]], "58": [[3519, 3523], [3588, 3592]], "59": [[5867, 5869]], "6": [[341, 344], [679, 683]], "60": [[27, 30], [268, 270], [413, 415], [1653, 1655], [1786, 1788], [1875, 1877], [1888, 1890], [1913, 1915], [2520, 2522], [2675, 2677], [3635, 3637], [3746, 3748], [4095, 4097], [4200, 4202]], "61": [[2143, 2144], [6298, 6299]], "62": [[6522, 6527]], "63": [[5270, 5271]], "64": [[1715, 1718], [3286, 3290], [3608, 3611], [3995, 3998], [4283, 4286], [5330, 5334], [5426, 5430], [7485, 7489], [7582, 7585]], "65": [[2864, 2867], [5924, 5927]], "66": [[5288, 5289]], "67": [[2371, 2375]], "68": [[6320, 6322]], "69": [[559, 561], [1351, 1354]], "7": [[1380, 1382], [3400, 3403]], "70": [[3335, 3338]], "71": [[3618, 3620], [7401, 7403], [7723, 7725], [7746, 7748]], "72": [[7784, 7787]], "73": [[6791, 6792]], "74": [[6196, 6197]], "75": [[7734, 7735]], "76": [[7730, 7733]], "77": [[5921, 5923]], "78": [[6486, 6489]], "79": [[988, 990], [2367, 2369]], "8": [[5150, 5153], [5161, 5166]], "80": [[1306, 1307]], "81": [[1590, 1593]], "82": [[7374, 7376]], "83": [[2589, 2596]], "84": [[2413, 2415]], "85": [[2459, 2461]], "86": [[691, 693]], "87": [[4720, 4721]], "88": [[5262, 5263]], "89": [[1301, 1303]], "9": [[2817, 2818], [5247, 5253]], "90": [[2462, 2465]], "91": [[7250, 7251]], "92": [[4359, 4361]], "93": [[2348, 2349]], "94": [[5298, 5299]], "95": [[5323, 5325]], "96": [[7795, 7797]], "97": [[4129, 4132]], "98": [[2749, 2751]], "99": [[3443, 3445]]}, "doc_id": "0cb8f50580cc69191144bd503e268451ce966fa6", "method_subrelations": {"MPNNs": [[[0, 5], "MPNNs"]]}, "n_ary_relations": [{"Material": "QM9", "Method": "MPNNs", "Metric": "Error_ratio", "Task": "Drug_Discovery", "score": "0.68"}], "ner": [[0, 2, "Method"], [11, 12, "Task"], [13, 15, "Task"], [17, 19, "Task"], [27, 30, "Method"], [46, 49, "Method"], [50, 52, "Method"], [84, 87, "Task"], [115, 119, "Method"], [120, 121, "Method"], [132, 133, "Method"], [143, 147, "Task"], [187, 190, "Method"], [219, 221, "Method"], [230, 235, "Task"], [236, 238, "Method"], [241, 243, "Method"], [256, 258, "Method"], [259, 261, "Task"], [264, 266, "Method"], [268, 270, "Method"], [295, 297, "Method"], [302, 305, "Method"], [319, 321, "Method"], [335, 340, "Task"], [341, 344, "Method"], [390, 393, "Method"], [410, 412, "Method"], [413, 415, "Method"], [442, 445, "Task"], [446, 448, "Task"], [449, 451, "Task"], [462, 465, "Method"], [466, 469, "Task"], [498, 502, "Task"], [503, 507, "Method"], [508, 509, "Method"], [522, 524, "Method"], [559, 561, "Method"], [579, 581, "Task"], [603, 610, "Task"], [629, 635, "Method"], [655, 657, "Material"], [662, 663, "Material"], [679, 683, "Method"], [684, 685, "Method"], [691, 693, "Task"], [702, 705, "Task"], [718, 719, "Material"], [745, 746, "Material"], [860, 861, "Material"], [866, 869, "Metric"], [875, 877, "Metric"], [879, 881, "Method"], [890, 892, "Metric"], [900, 902, "Metric"], [906, 908, "Metric"], [919, 921, "Metric"], [922, 924, "Metric"], [950, 952, "Metric"], [988, 990, "Method"], [992, 994, "Metric"], [1009, 1011, "Metric"], [1018, 1020, "Metric"], [1031, 1033, "Metric"], [1057, 1059, "Method"], [1074, 1076, "Material"], [1080, 1082, "Task"], [1084, 1086, "Metric"], [1105, 1106, "Method"], [1119, 1120, "Task"], [1122, 1124, "Metric"], [1135, 1136, "Method"], [1138, 1139, "Method"], [1141, 1143, "Metric"], [1174, 1175, "Method"], [1177, 1179, "Method"], [1184, 1186, "Metric"], [1187, 1188, "Metric"], [1195, 1196, "Method"], [1197, 1201, "Method"], [1215, 1216, "Method"], [1219, 1221, "Task"], [1222, 1225, "Task"], [1288, 1291, "Method"], [1301, 1303, "Task"], [1306, 1307, "Method"], [1318, 1321, "Task"], [1324, 1328, "Method"], [1346, 1350, "Method"], [1351, 1354, "Method"], [1359, 1360, "Method"], [1380, 1382, "Task"], [1384, 1386, "Method"], [1391, 1394, "Method"], [1396, 1398, "Method"], [1400, 1403, "Method"], [1416, 1419, "Method"], [1422, 1425, "Task"], [1454, 1456, "Method"], [1508, 1509, "Method"], [1513, 1515, "Method"], [1551, 1552, "Method"], [1579, 1580, "Method"], [1587, 1589, "Method"], [1590, 1593, "Task"], [1653, 1655, "Method"], [1668, 1671, "Method"], [1694, 1696, "Method"], [1710, 1714, "Method"], [1715, 1718, "Method"], [1754, 1755, "Method"], [1757, 1760, "Method"], [1766, 1768, "Method"], [1786, 1788, "Method"], [1791, 1795, "Method"], [1850, 1852, "Method"], [1871, 1873, "Method"], [1875, 1877, "Method"], [1883, 1886, "Method"], [1888, 1890, "Method"], [1913, 1915, "Method"], [1935, 1938, "Method"], [1947, 1948, "Method"], [1952, 1954, "Method"], [1959, 1962, "Method"], [2006, 2010, "Method"], [2038, 2040, "Method"], [2047, 2051, "Method"], [2058, 2061, "Method"], [2143, 2144, "Method"], [2177, 2178, "Method"], [2193, 2194, "Method"], [2255, 2257, "Metric"], [2263, 2267, "Method"], [2291, 2293, "Method"], [2297, 2299, "Metric"], [2342, 2344, "Task"], [2348, 2349, "Metric"], [2350, 2351, "Metric"], [2354, 2357, "Method"], [2358, 2359, "Method"], [2367, 2369, "Method"], [2371, 2375, "Method"], [2381, 2382, "Method"], [2413, 2415, "Method"], [2416, 2419, "Task"], [2426, 2428, "Task"], [2436, 2437, "Material"], [2459, 2461, "Method"], [2462, 2465, "Method"], [2474, 2476, "Metric"], [2482, 2484, "Method"], [2491, 2495, "Method"], [2520, 2522, "Method"], [2529, 2530, "Task"], [2538, 2539, "Metric"], [2540, 2541, "Task"], [2553, 2554, "Method"], [2561, 2565, "Method"], [2577, 2579, "Task"], [2583, 2584, "Method"], [2589, 2596, "Method"], [2616, 2619, "Task"], [2624, 2627, "Method"], [2628, 2629, "Method"], [2672, 2673, "Method"], [2675, 2677, "Method"], [2704, 2706, "Method"], [2737, 2739, "Method"], [2749, 2751, "Method"], [2752, 2754, "Task"], [2760, 2761, "Method"], [2776, 2778, "Task"], [2800, 2802, "Method"], [2805, 2808, "Method"], [2817, 2818, "Method"], [2829, 2832, "Method"], [2833, 2834, "Method"], [2851, 2852, "Method"], [2855, 2857, "Material"], [2862, 2863, "Method"], [2864, 2867, "Task"], [2873, 2875, "Material"], [2944, 2945, "Method"], [2982, 2983, "Material"], [2995, 2997, "Task"], [3013, 3014, "Material"], [3276, 3278, "Method"], [3283, 3284, "Method"], [3286, 3290, "Method"], [3335, 3338, "Method"], [3359, 3360, "Method"], [3400, 3403, "Task"], [3443, 3445, "Task"], [3467, 3469, "Method"], [3514, 3516, "Method"], [3519, 3523, "Method"], [3571, 3573, "Method"], [3580, 3581, "Method"], [3583, 3585, "Method"], [3588, 3592, "Method"], [3595, 3597, "Method"], [3597, 3599, "Method"], [3604, 3606, "Method"], [3608, 3611, "Method"], [3618, 3620, "Method"], [3630, 3632, "Method"], [3635, 3637, "Method"], [3653, 3656, "Method"], [3746, 3748, "Method"], [3754, 3756, "Method"], [3834, 3837, "Task"], [3899, 3901, "Task"], [3929, 3930, "Method"], [3969, 3970, "Metric"], [3972, 3975, "Method"], [3979, 3981, "Method"], [3985, 3987, "Method"], [3991, 3993, "Method"], [3995, 3998, "Method"], [4011, 4013, "Method"], [4016, 4018, "Method"], [4044, 4046, "Method"], [4070, 4072, "Method"], [4074, 4077, "Method"], [4095, 4097, "Method"], [4109, 4110, "Method"], [4121, 4124, "Method"], [4126, 4128, "Task"], [4129, 4132, "Task"], [4160, 4162, "Method"], [4175, 4179, "Method"], [4200, 4202, "Method"], [4204, 4205, "Method"], [4278, 4280, "Method"], [4283, 4286, "Method"], [4288, 4290, "Method"], [4305, 4307, "Metric"], [4316, 4318, "Method"], [4330, 4332, "Metric"], [4359, 4361, "Method"], [4452, 4454, "Metric"], [4472, 4474, "Method"], [4480, 4482, "Method"], [4511, 4515, "Method"], [4619, 4621, "Method"], [4680, 4685, "Method"], [4720, 4721, "Method"], [4723, 4725, "Method"], [4743, 4745, "Metric"], [4754, 4758, "Method"], [4774, 4776, "Metric"], [4780, 4782, "Metric"], [4792, 4796, "Material"], [4829, 4831, "Method"], [4832, 4834, "Method"], [4858, 4861, "Metric"], [4872, 4875, "Metric"], [4890, 4893, "Metric"], [4894, 4895, "Metric"], [4904, 4906, "Metric"], [4914, 4916, "Metric"], [4921, 4923, "Metric"], [4934, 4937, "Metric"], [4956, 4957, "Metric"], [5006, 5007, "Method"], [5089, 5091, "Method"], [5130, 5132, "Metric"], [5145, 5147, "Method"], [5150, 5153, "Method"], [5157, 5158, "Method"], [5161, 5166, "Method"], [5184, 5186, "Metric"], [5189, 5193, "Method"], [5208, 5210, "Method"], [5211, 5212, "Material"], [5234, 5238, "Method"], [5247, 5253, "Method"], [5262, 5263, "Method"], [5270, 5271, "Method"], [5277, 5279, "Method"], [5280, 5281, "Method"], [5288, 5289, "Method"], [5294, 5296, "Method"], [5298, 5299, "Method"], [5318, 5322, "Method"], [5323, 5325, "Method"], [5330, 5334, "Method"], [5343, 5344, "Method"], [5345, 5347, "Metric"], [5392, 5393, "Method"], [5426, 5430, "Method"], [5465, 5467, "Metric"], [5497, 5498, "Metric"], [5544, 5546, "Method"], [5583, 5585, "Method"], [5588, 5590, "Metric"], [5619, 5620, "Task"], [5629, 5637, "Method"], [5639, 5643, "Method"], [5659, 5662, "Task"], [5671, 5673, "Method"], [5685, 5690, "Task"], [5703, 5706, "Method"], [5718, 5722, "Method"], [5734, 5735, "Task"], [5743, 5745, "Metric"], [5766, 5768, "Method"], [5803, 5806, "Method"], [5811, 5814, "Method"], [5818, 5821, "Task"], [5842, 5845, "Method"], [5867, 5869, "Task"], [5907, 5908, "Method"], [5921, 5923, "Metric"], [5924, 5927, "Task"], [5938, 5940, "Method"], [5998, 5999, "Method"], [6024, 6025, "Task"], [6098, 6100, "Method"], [6171, 6174, "Method"], [6175, 6176, "Method"], [6188, 6189, "Method"], [6196, 6197, "Method"], [6207, 6208, "Method"], [6216, 6218, "Method"], [6298, 6299, "Method"], [6320, 6322, "Method"], [6486, 6489, "Task"], [6491, 6492, "Method"], [6510, 6513, "Method"], [6515, 6518, "Method"], [6522, 6527, "Method"], [6662, 6664, "Method"], [6698, 6700, "Metric"], [6791, 6792, "Task"], [6821, 6825, "Metric"], [6851, 6852, "Task"], [7238, 7239, "Task"], [7240, 7242, "Task"], [7250, 7251, "Metric"], [7300, 7302, "Metric"], [7303, 7305, "Metric"], [7318, 7320, "Metric"], [7329, 7331, "Metric"], [7339, 7342, "Metric"], [7358, 7361, "Metric"], [7363, 7365, "Task"], [7374, 7376, "Metric"], [7377, 7379, "Metric"], [7401, 7403, "Method"], [7485, 7489, "Method"], [7561, 7569, "Method"], [7570, 7571, "Method"], [7574, 7581, "Method"], [7582, 7585, "Method"], [7599, 7602, "Task"], [7617, 7619, "Task"], [7652, 7654, "Task"], [7670, 7672, "Method"], [7683, 7685, "Method"], [7689, 7691, "Task"], [7693, 7695, "Method"], [7707, 7712, "Task"], [7723, 7725, "Method"], [7726, 7727, "Method"], [7730, 7733, "Method"], [7734, 7735, "Method"], [7746, 7748, "Method"], [7751, 7754, "Method"], [7766, 7767, "Method"], [7779, 7782, "Method"], [7784, 7787, "Method"], [7789, 7793, "Method"], [7795, 7797, "Method"], [7799, 7804, "Method"], [5315, 5316, "Method"], [5859, 5861, "Metric"], [7313, 7316, "Metric"]], "sections": [[0, 173], [173, 1322], [1322, 2184], [2184, 2300], [2300, 2853], [2853, 3274], [3274, 3593], [3593, 3786], [3786, 3977], [3977, 4102], [4102, 4357], [4357, 4668], [4668, 4876], [4876, 5897], [5897, 6113], [6113, 6161], [6161, 6164], [6164, 6167], [6167, 6495], [6495, 6690], [6690, 7298], [7298, 7383], [7383, 7805]], "sentences": [[0, 20], [20, 42], [42, 62], [62, 100], [100, 131], [131, 172], [172, 173], [173, 176], [176, 215], [215, 250], [250, 267], [267, 287], [287, 333], [333, 361], [361, 380], [380, 407], [407, 434], [434, 452], [452, 488], [488, 548], [548, 621], [621, 650], [650, 662], [662, 694], [694, 716], [716, 745], [745, 810], [810, 852], [852, 870], [870, 893], [893, 894], [894, 917], [917, 934], [934, 966], [966, 981], [981, 1003], [1003, 1021], [1021, 1045], [1045, 1092], [1092, 1131], [1131, 1167], [1167, 1202], [1202, 1226], [1226, 1287], [1287, 1322], [1322, 1328], [1328, 1355], [1355, 1372], [1372, 1383], [1383, 1399], [1399, 1420], [1420, 1453], [1453, 1487], [1487, 1516], [1516, 1542], [1542, 1576], [1576, 1587], [1587, 1596], [1596, 1605], [1605, 1637], [1637, 1667], [1667, 1690], [1690, 1710], [1710, 1722], [1722, 1748], [1748, 1763], [1763, 1781], [1781, 1796], [1796, 1801], [1801, 1828], [1828, 1870], [1870, 1882], [1882, 1897], [1897, 1925], [1925, 1935], [1935, 1941], [1941, 1963], [1963, 1972], [1972, 1991], [1991, 2006], [2006, 2013], [2013, 2031], [2031, 2037], [2037, 2064], [2064, 2094], [2094, 2127], [2127, 2146], [2146, 2155], [2155, 2161], [2161, 2184], [2184, 2188], [2188, 2221], [2221, 2247], [2247, 2258], [2258, 2284], [2284, 2300], [2300, 2304], [2304, 2333], [2333, 2376], [2376, 2420], [2420, 2467], [2467, 2482], [2482, 2519], [2519, 2542], [2542, 2566], [2566, 2585], [2585, 2620], [2620, 2641], [2641, 2668], [2668, 2678], [2678, 2693], [2693, 2729], [2729, 2740], [2740, 2755], [2755, 2793], [2793, 2819], [2819, 2826], [2826, 2853], [2853, 2857], [2857, 2876], [2876, 2920], [2920, 2941], [2941, 2963], [2963, 2976], [2976, 3003], [3003, 3015], [3015, 3030], [3030, 3049], [3049, 3065], [3065, 3107], [3107, 3140], [3140, 3159], [3159, 3190], [3190, 3205], [3205, 3214], [3214, 3230], [3230, 3260], [3260, 3274], [3274, 3278], [3278, 3299], [3299, 3321], [3321, 3356], [3356, 3395], [3395, 3426], [3426, 3446], [3446, 3463], [3463, 3508], [3508, 3544], [3544, 3566], [3566, 3593], [3593, 3597], [3597, 3618], [3618, 3646], [3646, 3649], [3649, 3677], [3677, 3689], [3689, 3720], [3720, 3735], [3735, 3749], [3749, 3770], [3770, 3786], [3786, 3791], [3791, 3807], [3807, 3828], [3828, 3849], [3849, 3877], [3877, 3902], [3902, 3932], [3932, 3944], [3944, 3977], [3977, 3981], [3981, 3988], [3988, 4008], [4008, 4015], [4015, 4039], [4039, 4062], [4062, 4089], [4089, 4102], [4102, 4106], [4106, 4113], [4113, 4133], [4133, 4143], [4143, 4183], [4183, 4215], [4215, 4244], [4244, 4270], [4270, 4319], [4319, 4339], [4339, 4357], [4357, 4361], [4361, 4395], [4395, 4409], [4409, 4445], [4445, 4465], [4465, 4480], [4480, 4483], [4483, 4507], [4507, 4551], [4551, 4553], [4553, 4567], [4567, 4596], [4596, 4612], [4612, 4668], [4668, 4671], [4671, 4704], [4704, 4715], [4715, 4741], [4741, 4751], [4751, 4791], [4791, 4802], [4802, 4822], [4822, 4843], [4843, 4855], [4855, 4876], [4876, 4879], [4879, 4910], [4910, 4927], [4927, 4951], [4951, 4965], [4965, 4995], [4995, 5018], [5018, 5058], [5058, 5076], [5076, 5087], [5087, 5109], [5109, 5133], [5133, 5181], [5181, 5198], [5198, 5229], [5229, 5254], [5254, 5303], [5303, 5339], [5339, 5363], [5363, 5384], [5384, 5413], [5413, 5464], [5464, 5480], [5480, 5505], [5505, 5514], [5514, 5537], [5537, 5557], [5557, 5575], [5575, 5577], [5577, 5605], [5605, 5622], [5622, 5652], [5652, 5670], [5670, 5691], [5691, 5707], [5707, 5738], [5738, 5756], [5756, 5759], [5759, 5773], [5773, 5797], [5797, 5815], [5815, 5832], [5832, 5870], [5870, 5884], [5884, 5897], [5897, 5903], [5903, 5941], [5941, 5969], [5969, 5991], [5991, 6029], [6029, 6042], [6042, 6058], [6058, 6087], [6087, 6113], [6113, 6116], [6116, 6137], [6137, 6161], [6161, 6164], [6164, 6167], [6167, 6176], [6176, 6190], [6190, 6203], [6203, 6232], [6232, 6244], [6244, 6260], [6260, 6279], [6279, 6289], [6289, 6301], [6301, 6330], [6330, 6345], [6345, 6362], [6362, 6397], [6397, 6438], [6438, 6447], [6447, 6464], [6464, 6495], [6495, 6507], [6507, 6541], [6541, 6554], [6554, 6582], [6582, 6599], [6599, 6627], [6627, 6629], [6629, 6690], [6690, 6700], [6700, 6707], [6707, 6713], [6713, 6738], [6738, 6750], [6750, 6759], [6759, 6778], [6778, 6803], [6803, 6821], [6821, 6853], [6853, 6865], [6865, 6869], [6869, 6885], [6885, 6894], [6894, 6905], [6905, 6917], [6917, 6941], [6941, 6971], [6971, 6988], [6988, 7003], [7003, 7020], [7020, 7031], [7031, 7038], [7038, 7056], [7056, 7062], [7062, 7074], [7074, 7097], [7097, 7110], [7110, 7133], [7133, 7152], [7152, 7161], [7161, 7175], [7175, 7204], [7204, 7244], [7244, 7273], [7273, 7298], [7298, 7305], [7305, 7321], [7321, 7338], [7338, 7351], [7351, 7370], [7370, 7383], [7383, 7387], [7387, 7413], [7413, 7426], [7426, 7452], [7452, 7469], [7469, 7532], [7532, 7554], [7554, 7592], [7592, 7616], [7616, 7651], [7651, 7669], [7669, 7692], [7692, 7713], [7713, 7718], [7718, 7745], [7745, 7758], [7758, 7772], [7772, 7783], [7783, 7805]], "words": ["Supervised", "learning", "on", "molecules", "has", "incredible", "potential", "to", "be", "useful", "in", "chemistry", ",", "drug", "discovery", ",", "and", "materials", "science", ".", "Luckily", ",", "several", "promising", "and", "closely", "related", "neural", "network", "models", "invariant", "to", "molecular", "symmetries", "have", "already", "been", "described", "in", "the", "literature", ".", "These", "models", "learn", "a", "message", "passing", "algorithm", "and", "aggregation", "procedure", "to", "compute", "a", "function", "of", "their", "entire", "input", "graph", ".", "At", "this", "point", ",", "the", "next", "step", "is", "to", "find", "a", "particularly", "effective", "variant", "of", "this", "general", "approach", "and", "apply", "it", "to", "chemical", "prediction", "benchmarks", "until", "we", "either", "solve", "them", "or", "reach", "the", "limits", "of", "the", "approach", ".", "In", "this", "paper", ",", "we", "reformulate", "existing", "models", "into", "a", "single", "common", "framework", "we", "call", "Message", "Passing", "Neural", "Networks", "(", "MPNNs", ")", "and", "explore", "additional", "novel", "variations", "within", "this", "framework", ".", "Using", "MPNNs", "we", "demonstrate", "state", "of", "the", "art", "results", "on", "an", "important", "molecular", "property", "prediction", "benchmark", ";", "these", "results", "are", "strong", "enough", "that", "we", "believe", "future", "work", "should", "focus", "on", "datasets", "with", "larger", "molecules", "or", "more", "accurate", "ground", "truth", "labels", ".", "NeuralMessagePassingforQuantumChemistry", "section", ":", "Introduction", "The", "past", "decade", "has", "seen", "remarkable", "success", "in", "the", "use", "of", "deep", "neural", "networks", "to", "understand", "and", "translate", "natural", "language", ",", "generate", "and", "decode", "complex", "audio", "signals", ",", "and", "infer", "features", "from", "real", "-", "world", "images", "and", "videos", ".", "Although", "chemists", "have", "applied", "machine", "learning", "to", "many", "problems", "over", "the", "years", ",", "predicting", "the", "properties", "of", "molecules", "and", "materials", "using", "machine", "learning", "(", "and", "especially", "deep", "learning", ")", "is", "still", "in", "its", "infancy", ".", "To", "date", ",", "most", "research", "applying", "machine", "learning", "to", "chemistry", "tasks", "has", "revolved", "around", "feature", "engineering", ".", "While", "neural", "networks", "have", "been", "applied", "in", "a", "variety", "of", "situations", ",", "they", "have", "yet", "to", "become", "widely", "adopted", ".", "This", "situation", "is", "reminiscent", "of", "the", "state", "of", "image", "models", "before", "the", "broad", "adoption", "of", "convolutional", "neural", "networks", "and", "is", "due", ",", "in", "part", ",", "to", "a", "dearth", "of", "empirical", "evidence", "that", "neural", "architectures", "with", "the", "appropriate", "inductive", "bias", "can", "be", "successful", "in", "this", "domain", ".", "Recently", ",", "large", "scale", "quantum", "chemistry", "calculation", "and", "molecular", "dynamics", "simulations", "coupled", "with", "advances", "in", "high", "throughput", "experiments", "have", "begun", "to", "generate", "data", "at", "an", "unprecedented", "rate", ".", "Most", "classical", "techniques", "do", "not", "make", "effective", "use", "of", "the", "larger", "amounts", "of", "data", "that", "are", "now", "available", ".", "The", "time", "is", "ripe", "to", "apply", "more", "powerful", "and", "flexible", "machine", "learning", "methods", "to", "these", "problems", ",", "assuming", "we", "can", "find", "models", "with", "suitable", "inductive", "biases", ".", "The", "symmetries", "of", "atomic", "systems", "suggest", "neural", "networks", "that", "operate", "on", "graph", "structured", "data", "and", "are", "invariant", "to", "graph", "isomorphism", "might", "also", "be", "appropriate", "for", "molecules", ".", "Sufficiently", "successful", "models", "could", "someday", "help", "automate", "challenging", "chemical", "search", "problems", "in", "drug", "discovery", "or", "materials", "science", ".", "In", "this", "paper", ",", "our", "goal", "is", "to", "demonstrate", "effective", "machine", "learning", "models", "for", "chemical", "prediction", "problems", "that", "are", "capable", "of", "learning", "their", "own", "features", "from", "molecular", "graphs", "directly", "and", "are", "invariant", "to", "graph", "isomorphism", ".", "To", "that", "end", ",", "we", "describe", "a", "general", "framework", "for", "supervised", "learning", "on", "graphs", "called", "Message", "Passing", "Neural", "Networks", "(", "MPNNs", ")", "that", "simply", "abstracts", "the", "commonalities", "between", "several", "of", "the", "most", "promising", "existing", "neural", "models", "for", "graph", "structured", "data", ",", "in", "order", "to", "make", "it", "easier", "to", "understand", "the", "relationships", "between", "them", "and", "come", "up", "with", "novel", "variations", ".", "Given", "how", "many", "researchers", "have", "published", "models", "that", "fit", "into", "the", "MPNN", "framework", ",", "we", "believe", "that", "the", "community", "should", "push", "this", "general", "approach", "as", "far", "as", "possible", "on", "practically", "important", "graph", "problems", "and", "only", "suggest", "new", "variations", "that", "are", "well", "motivated", "by", "applications", ",", "such", "as", "the", "application", "we", "consider", "here", ":", "predicting", "the", "quantum", "mechanical", "properties", "of", "small", "organic", "molecules", "(", "see", "task", "schematic", "in", "figure", "[", "reference", "]", ")", ".", "In", "general", ",", "the", "search", "for", "practically", "effective", "machine", "learning", "(", "ML", ")", "models", "in", "a", "given", "domain", "proceeds", "through", "a", "sequence", "of", "increasingly", "realistic", "and", "interesting", "benchmarks", ".", "Here", "we", "focus", "on", "the", "QM9", "dataset", "as", "such", "a", "benchmark", ".", "QM9", "consists", "of", "130k", "molecules", "with", "13", "properties", "for", "each", "molecule", "which", "are", "approximated", "by", "an", "expensive", "quantum", "mechanical", "simulation", "method", "(", "DFT", ")", ",", "to", "yield", "13", "corresponding", "regression", "tasks", ".", "These", "tasks", "are", "plausibly", "representative", "of", "many", "important", "chemical", "prediction", "problems", "and", "are", "(", "currently", ")", "difficult", "for", "many", "existing", "methods", ".", "Additionally", ",", "QM9", "also", "includes", "complete", "spatial", "information", "for", "the", "single", "low", "energy", "conformation", "of", "the", "atoms", "in", "the", "molecule", "that", "was", "used", "in", "calculating", "the", "chemical", "properties", ".", "QM9", "therefore", "lets", "us", "consider", "both", "the", "setting", "where", "the", "complete", "molecular", "geometry", "is", "known", "(", "atomic", "distances", ",", "bond", "angles", ",", "etc", ".", ")", "and", "the", "setting", "where", "we", "need", "to", "compute", "properties", "that", "might", "still", "be", "defined", "in", "terms", "of", "the", "spatial", "positions", "of", "atoms", ",", "but", "where", "only", "the", "atom", "and", "bond", "information", "(", "i.e.", "graph", ")", "is", "available", "as", "input", ".", "In", "the", "latter", "case", ",", "the", "model", "must", "implicitly", "fit", "something", "about", "the", "computation", "used", "to", "determine", "a", "low", "energy", "3D", "conformation", "and", "hopefully", "would", "still", "work", "on", "problems", "where", "it", "is", "not", "clear", "how", "to", "compute", "a", "reasonable", "3D", "conformation", ".", "When", "measuring", "the", "performance", "of", "our", "models", "on", "QM9", ",", "there", "are", "two", "important", "benchmark", "error", "levels", ".", "The", "first", "is", "the", "estimated", "average", "error", "of", "the", "DFT", "approximation", "to", "nature", ",", "which", "we", "refer", "to", "as", "\u201c", "DFT", "error", ".", "\u201d", "The", "second", ",", "known", "as", "\u201c", "chemical", "accuracy", ",", "\u201d", "is", "a", "target", "error", "that", "has", "been", "established", "by", "the", "chemistry", "community", ".", "Estimates", "of", "DFT", "error", "and", "chemical", "accuracy", "are", "provided", "for", "each", "of", "the", "13", "targets", "in", ".", "One", "important", "goal", "of", "this", "line", "of", "research", "is", "to", "produce", "a", "model", "which", "can", "achieve", "chemical", "accuracy", "with", "respect", "to", "the", "true", "targets", "as", "measured", "by", "an", "extremely", "precise", "experiment", ".", "The", "dataset", "containing", "the", "true", "targets", "on", "all", "134k", "molecules", "does", "not", "currently", "exist", ".", "However", ",", "the", "ability", "to", "fit", "the", "DFT", "approximation", "to", "within", "chemical", "accuracy", "would", "be", "an", "encouraging", "step", "in", "this", "direction", ".", "For", "all", "13", "targets", ",", "achieving", "chemical", "accuracy", "is", "at", "least", "as", "hard", "as", "achieving", "DFT", "error", ".", "In", "the", "rest", "of", "this", "paper", "when", "we", "talk", "about", "chemical", "accuracy", "we", "generally", "mean", "with", "respect", "to", "our", "available", "ground", "truth", "labels", ".", "In", "this", "paper", ",", "by", "exploring", "novel", "variations", "of", "models", "in", "the", "MPNN", "family", ",", "we", "are", "able", "to", "both", "achieve", "a", "new", "state", "of", "the", "art", "on", "the", "QM9", "dataset", "and", "to", "predict", "the", "DFT", "calculation", "to", "within", "chemical", "accuracy", "on", "all", "but", "two", "targets", ".", "In", "particular", ",", "we", "provide", "the", "following", "key", "contributions", ":", "We", "develop", "an", "MPNN", "which", "achieves", "state", "of", "the", "art", "results", "on", "all", "13", "targets", "and", "predicts", "DFT", "to", "within", "chemical", "accuracy", "on", "11", "out", "of", "13", "targets", ".", "We", "develop", "several", "different", "MPNNs", "which", "predict", "DFT", "to", "within", "chemical", "accuracy", "on", "5", "out", "of", "13", "targets", "while", "operating", "on", "the", "topology", "of", "the", "molecule", "alone", "(", "with", "no", "spatial", "information", "as", "input", ")", ".", "We", "develop", "a", "general", "method", "to", "train", "MPNNs", "with", "larger", "node", "representations", "without", "a", "corresponding", "increase", "in", "computation", "time", "or", "memory", ",", "yielding", "a", "substantial", "savings", "over", "previous", "MPNNs", "for", "high", "dimensional", "node", "representations", ".", "We", "believe", "our", "work", "is", "an", "important", "step", "towards", "making", "well", "-", "designed", "MPNN\u00e2\u0080\u0099s", "the", "default", "for", "supervised", "learning", "on", "modestly", "sized", "molecules", ".", "In", "order", "for", "this", "to", "happen", ",", "researchers", "need", "to", "perform", "careful", "empirical", "studies", "to", "find", "the", "proper", "way", "to", "use", "these", "types", "of", "models", "and", "to", "make", "any", "necessary", "improvements", "to", "them", ",", "it", "is", "not", "sufficient", "for", "these", "models", "to", "have", "been", "described", "in", "the", "literature", "if", "there", "is", "only", "limited", "accompanying", "empirical", "work", "in", "the", "chemical", "domain", ".", "Indeed", "convolutional", "neural", "networks", "existed", "for", "decades", "before", "careful", "empirical", "work", "applying", "them", "to", "image", "classification", "helped", "them", "displace", "SVMs", "on", "top", "of", "hand", "-", "engineered", "features", "for", "a", "host", "of", "computer", "vision", "problems", ".", "section", ":", "Message", "Passing", "Neural", "Networks", "There", "are", "at", "least", "eight", "notable", "examples", "of", "models", "from", "the", "literature", "that", "we", "can", "describe", "using", "our", "Message", "Passing", "Neural", "Networks", "(", "MPNN", ")", "framework", ".", "For", "simplicity", "we", "describe", "MPNNs", "which", "operate", "on", "undirected", "graphs", "with", "node", "features", "and", "edge", "features", ".", "It", "is", "trivial", "to", "extend", "the", "formalism", "to", "directed", "multigraphs", ".", "The", "forward", "pass", "has", "two", "phases", ",", "a", "message", "passing", "phase", "and", "a", "readout", "phase", ".", "The", "message", "passing", "phase", "runs", "for", "time", "steps", "and", "is", "defined", "in", "terms", "of", "message", "functions", "and", "vertex", "update", "functions", ".", "During", "the", "message", "passing", "phase", ",", "hidden", "states", "at", "each", "node", "in", "the", "graph", "are", "updated", "based", "on", "messages", "according", "to", "where", "in", "the", "sum", ",", "denotes", "the", "neighbors", "of", "in", "graph", ".", "The", "readout", "phase", "computes", "a", "feature", "vector", "for", "the", "whole", "graph", "using", "some", "readout", "function", "according", "to", "The", "message", "functions", ",", "vertex", "update", "functions", ",", "and", "readout", "function", "are", "all", "learned", "differentiable", "functions", ".", "operates", "on", "the", "set", "of", "node", "states", "and", "must", "be", "invariant", "to", "permutations", "of", "the", "node", "states", "in", "order", "for", "the", "MPNN", "to", "be", "invariant", "to", "graph", "isomorphism", ".", "In", "what", "follows", ",", "we", "define", "previous", "models", "in", "the", "literature", "by", "specifying", "the", "message", "function", ",", "vertex", "update", "function", ",", "and", "readout", "function", "used", ".", "Note", "one", "could", "also", "learn", "edge", "features", "in", "an", "MPNN", "by", "introducing", "hidden", "states", "for", "all", "edges", "in", "the", "graph", "and", "updating", "them", "analogously", "to", "equations", "[", "reference", "]", "and", "[", "reference", "]", ".", "Of", "the", "existing", "MPNNs", ",", "only", "has", "used", "this", "idea", ".", "Convolutional", "Networks", "for", "Learning", "Molecular", "Fingerprints", ",", "(", ")", "The", "message", "function", "used", "is", "where", "denotes", "concatenation", ".", "The", "vertex", "update", "function", "used", "is", ",", "where", "is", "the", "sigmoid", "function", ",", "deg", "is", "the", "degree", "of", "vertex", "and", "is", "a", "learned", "matrix", "for", "each", "time", "step", "and", "vertex", "degree", ".", "has", "skip", "connections", "to", "all", "previous", "hidden", "states", "and", "is", "equal", "to", ",", "where", "is", "a", "neural", "network", "and", "are", "learned", "readout", "matrices", ",", "one", "for", "each", "time", "step", ".", "This", "message", "passing", "scheme", "may", "be", "problematic", "since", "the", "resulting", "message", "vector", "is", "which", "separately", "sums", "over", "connected", "nodes", "and", "connected", "edges", ".", "It", "follows", "that", "the", "message", "passing", "implemented", "in", "is", "unable", "to", "identify", "correlations", "between", "edge", "states", "and", "node", "states", ".", "Gated", "Graph", "Neural", "Networks", "(", "GG", "-", "NN", ")", ",", "(", ")", "The", "message", "function", "used", "is", ",", "where", "is", "a", "learned", "matrix", ",", "one", "for", "each", "edge", "label", "(", "the", "model", "assumes", "discrete", "edge", "types", ")", ".", "The", "update", "function", "is", ",", "where", "GRU", "is", "the", "Gated", "Recurrent", "Unit", "introduced", "in", ".", "This", "work", "used", "weight", "tying", ",", "so", "the", "same", "update", "function", "is", "used", "at", "each", "time", "step", ".", "Finally", ",", "where", "and", "are", "neural", "networks", ",", "and", "denotes", "element", "-", "wise", "multiplication", ".", "Interaction", "Networks", ",", "(", ")", "This", "work", "considered", "both", "the", "case", "where", "there", "is", "a", "target", "at", "each", "node", "in", "the", "graph", ",", "and", "where", "there", "is", "a", "graph", "level", "target", ".", "It", "also", "considered", "the", "case", "where", "there", "are", "node", "level", "effects", "applied", "at", "each", "time", "step", ",", "in", "such", "a", "case", "the", "update", "function", "takes", "as", "input", "the", "concatenation", "where", "is", "an", "external", "vector", "representing", "some", "outside", "influence", "on", "the", "vertex", ".", "The", "message", "function", "is", "a", "neural", "network", "which", "takes", "the", "concatenation", ".", "The", "vertex", "update", "function", "is", "a", "neural", "network", "which", "takes", "as", "input", "the", "concatenation", ".", "Finally", ",", "in", "the", "case", "where", "there", "is", "a", "graph", "level", "output", ",", "where", "is", "a", "neural", "network", "which", "takes", "the", "sum", "of", "the", "final", "hidden", "states", ".", "Note", "the", "original", "work", "only", "defined", "the", "model", "for", ".", "Molecular", "Graph", "Convolutions", ",", "(", ")", "This", "work", "deviates", "slightly", "from", "other", "MPNNs", "in", "that", "it", "introduces", "edge", "representations", "which", "are", "updated", "during", "the", "message", "passing", "phase", ".", "The", "message", "function", "used", "for", "node", "messages", "is", ".", "The", "vertex", "update", "function", "is", "where", "denotes", "concatenation", ",", "is", "the", "ReLU", "activation", "and", "are", "learned", "weight", "matrices", ".", "The", "edge", "state", "update", "is", "defined", "by", "where", "the", "are", "also", "learned", "weight", "matrices", ".", "Deep", "Tensor", "Neural", "Networks", ",", "(", ")", "The", "message", "from", "to", "is", "computed", "by", "where", ",", ",", "are", "matrices", "and", ",", "are", "bias", "vectors", ".", "The", "update", "function", "used", "is", ".", "The", "readout", "function", "passes", "each", "node", "independently", "through", "a", "single", "hidden", "layer", "neural", "network", "and", "sums", "the", "outputs", ",", "in", "particular", "Laplacian", "Based", "Methods", ",", "(", ")", "These", "methods", "generalize", "the", "notion", "of", "the", "convolution", "operation", "typically", "applied", "to", "image", "datasets", "to", "an", "operation", "that", "operates", "on", "an", "arbitrary", "graph", "with", "a", "real", "valued", "adjacency", "matrix", ".", "The", "operations", "defined", "in", "result", "in", "message", "functions", "of", "the", "form", ",", "where", "the", "matrices", "are", "parameterized", "by", "the", "eigenvectors", "of", "the", "graph", "laplacian", ",", "and", "the", "learned", "parameters", "of", "the", "model", ".", "The", "vertex", "update", "function", "used", "is", "where", "is", "some", "pointwise", "non", "-", "linearity", "(", "such", "as", "ReLU", ")", ".", "The", "model", "results", "in", "a", "message", "function", "where", ".", "The", "vertex", "update", "function", "is", ".", "For", "the", "exact", "expressions", "for", "the", "and", "the", "derivation", "of", "the", "reformulation", "of", "these", "models", "as", "MPNNs", ",", "see", "the", "supplementary", "material", ".", "subsection", ":", "Moving", "Forward", "Given", "how", "many", "instances", "of", "MPNN\u00e2\u0080\u0099s", "have", "appeared", "in", "the", "literature", ",", "we", "should", "focus", "on", "pushing", "this", "general", "family", "as", "far", "as", "possible", "in", "a", "specific", "application", "of", "substantial", "practical", "importance", ".", "This", "way", "we", "can", "determine", "the", "most", "crucial", "implementation", "details", "and", "potentially", "reach", "the", "limits", "of", "these", "models", "to", "guide", "us", "towards", "future", "modeling", "improvements", ".", "One", "downside", "of", "all", "of", "these", "approaches", "is", "computation", "time", ".", "Recent", "work", "has", "adapted", "the", "GG", "-", "NN", "architecture", "to", "larger", "graphs", "by", "passing", "messages", "on", "only", "subsets", "of", "the", "graph", "at", "each", "time", "step", ".", "In", "this", "work", "we", "also", "present", "a", "MPNN", "modification", "that", "can", "improve", "the", "computational", "costs", ".", "section", ":", "Related", "Work", "Although", "in", "principle", "quantum", "mechanics", "lets", "us", "compute", "the", "properties", "of", "molecules", ",", "the", "laws", "of", "physics", "lead", "to", "equations", "that", "are", "far", "too", "difficult", "to", "solve", "exactly", ".", "Therefore", "scientists", "have", "developed", "a", "hierarchy", "of", "approximations", "to", "quantum", "mechanics", "with", "varying", "tradeoffs", "of", "speed", "and", "accuracy", ",", "such", "as", "Density", "Functional", "Theory", "(", "DFT", ")", "with", "a", "variety", "of", "functionals", ",", "the", "GW", "approximation", ",", "and", "Quantum", "Monte", "-", "Carlo", ".", "Despite", "being", "widely", "used", ",", "DFT", "is", "simultaneously", "still", "too", "slow", "to", "be", "applied", "to", "large", "systems", "(", "scaling", "as", "where", "is", "the", "number", "of", "electrons", ")", "and", "exhibits", "systematic", "as", "well", "as", "random", "errors", "relative", "to", "exact", "solutions", "to", "Schr\u00f6dinger", "\u2019s", "equation", ".", "For", "example", ",", "to", "run", "the", "DFT", "calculation", "on", "a", "single", "9", "heavy", "atom", "molecule", "in", "QM9", "takes", "around", "an", "hour", "on", "a", "single", "core", "of", "a", "Xeon", "E5", "-", "2660", "(", "2.2", "GHz", ")", "using", "a", "version", "of", "Gaussian", "G09", "(", "ES64L", "-", "G09RevD.01", ")", ".", "For", "a", "17", "heavy", "atom", "molecule", ",", "computation", "time", "is", "up", "to", "8", "hours", ".", "Empirical", "potentials", "have", "been", "developed", ",", "such", "as", "the", "Stillinger", "-", "Weber", "potential", ",", "that", "are", "fast", "and", "accurate", "but", "must", "be", "created", "from", "scratch", ",", "from", "first", "principles", ",", "for", "every", "new", "composition", "of", "atoms", ".", "used", "neural", "networks", "to", "approximate", "a", "particularly", "troublesome", "term", "in", "DFT", "called", "the", "exchange", "correlation", "potential", "to", "improve", "the", "accuracy", "of", "DFT", ".", "However", ",", "their", "method", "fails", "to", "improve", "upon", "the", "efficiency", "of", "DFT", "and", "relies", "on", "a", "large", "set", "of", "ad", "hoc", "atomic", "descriptors", ".", "Two", "more", "recent", "approaches", "by", "and", "attempt", "to", "approximate", "solutions", "to", "quantum", "mechanics", "directly", "without", "appealing", "to", "DFT", ".", "In", "the", "first", "case", "single", "-", "hidden", "-", "layer", "neural", "networks", "were", "used", "to", "approximate", "the", "energy", "and", "forces", "for", "configurations", "of", "a", "Silicon", "melt", "with", "the", "goal", "of", "speeding", "up", "molecular", "dynamics", "simulations", ".", "The", "second", "paper", "used", "Kernel", "Ridge", "Regression", "(", "KRR", ")", "to", "infer", "atomization", "energies", "over", "a", "wide", "range", "of", "molecules", ".", "In", "both", "cases", "hand", "engineered", "features", "were", "used", "(", "symmetry", "functions", "and", "the", "Coulomb", "matrix", ",", "respectively", ")", "that", "built", "physical", "symmetries", "into", "the", "input", "representation", ".", "Subsequent", "papers", "have", "replaced", "KRR", "by", "a", "neural", "network", ".", "Both", "of", "these", "lines", "of", "research", "used", "hand", "engineered", "features", "that", "have", "intrinsic", "limitations", ".", "The", "work", "of", "used", "a", "representation", "that", "was", "manifestly", "invariant", "to", "graph", "isomorphism", ",", "but", "has", "difficulty", "when", "applied", "to", "systems", "with", "more", "than", "three", "species", "of", "atoms", "and", "fails", "to", "generalize", "to", "novel", "compositions", ".", "The", "representation", "used", "in", "is", "not", "invariant", "to", "graph", "isomorphism", ".", "Instead", ",", "this", "invariance", "must", "be", "learned", "by", "the", "downstream", "model", "through", "dataset", "augmentation", ".", "In", "addition", "to", "the", "eight", "MPNN\u00e2\u0080\u0099s", "discussed", "in", "Section", "[", "reference", "]", "there", "have", "been", "a", "number", "of", "other", "approaches", "to", "machine", "learning", "on", "graphical", "data", "which", "take", "advantage", "of", "the", "symmetries", "in", "a", "number", "of", "ways", ".", "One", "such", "family", "of", "approaches", "define", "a", "preprocessing", "step", "which", "constructs", "a", "canonical", "graph", "representation", "which", "can", "then", "be", "fed", "into", "into", "a", "standard", "classifier", ".", "Examples", "in", "this", "family", "include", "and", ".", "Finally", "define", "a", "message", "passing", "process", "on", "graphs", "which", "is", "run", "until", "convergence", ",", "instead", "of", "for", "a", "finite", "number", "of", "time", "steps", "as", "in", "MPNNs", ".", "section", ":", "QM9", "Dataset", "To", "investigate", "the", "success", "of", "MPNNs", "on", "predicting", "chemical", "properties", ",", "we", "use", "the", "publicly", "available", "QM9", "dataset", ".", "Molecules", "in", "the", "dataset", "consist", "of", "Hydrogen", "(", "H", ")", ",", "Carbon", "(", "C", ")", ",", "Oxygen", "(", "O", ")", ",", "Nitrogen", "(", "N", ")", ",", "and", "Flourine", "(", "F", ")", "atoms", "and", "contain", "up", "to", "9", "heavy", "(", "non", "Hydrogen", ")", "atoms", ".", "In", "all", ",", "this", "results", "in", "about", "134k", "drug", "-", "like", "organic", "molecules", "that", "span", "a", "wide", "range", "of", "chemistry", ".", "For", "each", "molecule", "DFT", "is", "used", "to", "find", "a", "reasonable", "low", "energy", "structure", "and", "hence", "atom", "\u201c", "positions", "\u201d", "are", "available", ".", "Additionally", "a", "wide", "range", "of", "interesting", "and", "fundamental", "chemical", "properties", "are", "computed", ".", "Given", "how", "fundamental", "some", "of", "the", "QM9", "properties", "are", ",", "it", "is", "hard", "to", "believe", "success", "on", "more", "challenging", "chemical", "tasks", "will", "be", "possible", "if", "we", "ca", "n\u2019t", "make", "accurate", "statistical", "predictions", "for", "the", "properties", "computed", "in", "QM9", ".", "We", "can", "group", "the", "different", "properties", "we", "try", "to", "predict", "into", "four", "broad", "categories", ".", "First", ",", "we", "have", "four", "properties", "related", "to", "how", "tightly", "bound", "together", "the", "atoms", "in", "a", "molecule", "are", ".", "These", "measure", "the", "energy", "required", "to", "break", "up", "the", "molecule", "at", "different", "temperatures", "and", "pressures", ".", "These", "include", "the", "atomization", "energy", "at", ",", "(", "eV", ")", ",", "atomization", "energy", "at", "room", "temperature", ",", "(", "eV", ")", ",", "enthalpy", "of", "atomization", "at", "room", "temperature", ",", "(", "eV", ")", ",", "and", "free", "energy", "of", "atomization", ",", "(", "eV", ")", ".", "Next", "there", "are", "properties", "related", "to", "fundamental", "vibrations", "of", "the", "molecule", ",", "including", "the", "highest", "fundamental", "vibrational", "frequency", "(", ")", "and", "the", "zero", "point", "vibrational", "energy", "(", "ZPVE", ")", "(", "eV", ")", ".", "Additionally", ",", "there", "are", "a", "number", "of", "properties", "that", "concern", "the", "states", "of", "the", "electrons", "in", "the", "molecule", ".", "They", "include", "the", "energy", "of", "the", "electron", "in", "the", "highest", "occupied", "molecular", "orbital", "(", "HOMO", ")", "(", "eV", ")", ",", "the", "energy", "of", "the", "lowest", "unoccupied", "molecular", "orbital", "(", "LUMO", ")", "(", "eV", ")", ",", "and", "the", "electron", "energy", "gap", "(", "(", "eV", ")", ")", ".", "The", "electron", "energy", "gap", "is", "simply", "the", "difference", ".", "Finally", ",", "there", "are", "several", "measures", "of", "the", "spatial", "distribution", "of", "electrons", "in", "the", "molecule", ".", "These", "include", "the", "electronic", "spatial", "extent", "(", "Bohr", ")", ",", "the", "norm", "of", "the", "dipole", "moment", "(", "Debye", ")", ",", "and", "the", "norm", "of", "static", "polarizability", "(", "Bohr", ")", ".", "For", "a", "more", "detailed", "description", "of", "these", "properties", ",", "see", "the", "supplementary", "material", ".", "section", ":", "MPNN", "Variants", "We", "began", "our", "exploration", "of", "MPNNs", "around", "the", "GG", "-", "NN", "model", "which", "we", "believe", "to", "be", "a", "strong", "baseline", ".", "We", "focused", "on", "trying", "different", "message", "functions", ",", "output", "functions", ",", "finding", "the", "appropriate", "input", "representation", ",", "and", "properly", "tuning", "hyperparameters", ".", "For", "the", "rest", "of", "the", "paper", "we", "use", "to", "denote", "the", "dimension", "of", "the", "internal", "hidden", "representation", "of", "each", "node", "in", "the", "graph", ",", "and", "to", "denote", "the", "number", "of", "nodes", "in", "the", "graph", ".", "Our", "implementation", "of", "MPNNs", "in", "general", "operates", "on", "directed", "graphs", "with", "a", "separate", "message", "channel", "for", "incoming", "and", "outgoing", "edges", ",", "in", "which", "case", "the", "incoming", "message", "is", "the", "concatenation", "of", "and", ",", "this", "was", "also", "used", "in", ".", "When", "we", "apply", "this", "to", "undirected", "chemical", "graphs", "we", "treat", "the", "graph", "as", "directed", ",", "where", "each", "original", "edge", "becomes", "both", "an", "incoming", "and", "outgoing", "edge", "with", "the", "same", "label", ".", "Note", "there", "is", "nothing", "special", "about", "the", "direction", "of", "the", "edge", ",", "it", "is", "only", "relevant", "for", "parameter", "tying", ".", "Treating", "undirected", "graphs", "as", "directed", "means", "that", "the", "size", "of", "the", "message", "channel", "is", "instead", "of", ".", "The", "input", "to", "our", "MPNN", "model", "is", "a", "set", "of", "feature", "vectors", "for", "the", "nodes", "of", "the", "graph", ",", ",", "and", "an", "adjacency", "matrix", "with", "vector", "valued", "entries", "to", "indicate", "different", "bonds", "in", "the", "molecule", "as", "well", "as", "pairwise", "spatial", "distance", "between", "two", "atoms", ".", "We", "experimented", "as", "well", "with", "the", "message", "function", "used", "in", "the", "GG", "-", "NN", "family", ",", "which", "assumes", "discrete", "edge", "labels", ",", "in", "which", "case", "the", "matrix", "has", "entries", "in", "a", "discrete", "alphabet", "of", "size", ".", "The", "initial", "hidden", "states", "are", "set", "to", "be", "the", "atom", "input", "feature", "vectors", "and", "are", "padded", "up", "to", "some", "larger", "dimension", ".", "All", "of", "our", "experiments", "used", "weight", "tying", "at", "each", "time", "step", ",", "and", "a", "GRU", "for", "the", "update", "function", "as", "in", "the", "GG", "-", "NN", "family", ".", "subsection", ":", "Message", "Functions", "Matrix", "Multiplication", ":", "We", "started", "with", "the", "message", "function", "used", "in", "GG", "-", "NN", "which", "is", "defined", "by", "the", "equation", ".", "Edge", "Network", ":", "To", "allow", "vector", "valued", "edge", "features", "we", "propose", "the", "message", "function", "where", "is", "a", "neural", "network", "which", "maps", "the", "edge", "vector", "to", "a", "matrix", ".", "Pair", "Message", ":", "One", "property", "that", "the", "matrix", "multiplication", "rule", "has", "is", "that", "the", "message", "from", "node", "to", "node", "is", "a", "function", "only", "of", "the", "hidden", "state", "and", "the", "edge", ".", "In", "particular", ",", "it", "does", "not", "depend", "on", "the", "hidden", "state", ".", "In", "theory", ",", "a", "network", "may", "be", "able", "to", "use", "the", "message", "channel", "more", "efficiently", "if", "the", "node", "messages", "are", "allowed", "to", "depend", "on", "both", "the", "source", "and", "destination", "node", ".", "Thus", "we", "also", "tried", "using", "a", "variant", "on", "the", "message", "function", "as", "described", "in", ".", "Here", "the", "message", "from", "to", "along", "edge", "is", "where", "is", "a", "neural", "network", ".", "When", "we", "apply", "the", "above", "message", "functions", "to", "directed", "graphs", ",", "there", "are", "two", "separate", "functions", "used", ",", "and", "an", ".", "Which", "function", "is", "applied", "to", "a", "particular", "edge", "depends", "on", "the", "direction", "of", "that", "edge", ".", "subsection", ":", "Virtual", "Graph", "Elements", "We", "explored", "two", "different", "ways", "to", "change", "how", "the", "messages", "are", "passed", "throughout", "the", "model", ".", "The", "simplest", "modification", "involves", "adding", "a", "separate", "\u201c", "virtual", "\u201d", "edge", "type", "for", "pairs", "of", "nodes", "that", "are", "not", "connected", ".", "This", "can", "be", "implemented", "as", "a", "data", "preprocessing", "step", "and", "allows", "information", "to", "travel", "long", "distances", "during", "the", "propagation", "phase", ".", "We", "also", "experimented", "with", "using", "a", "latent", "\u201c", "master", "\u201d", "node", ",", "which", "is", "connected", "to", "every", "input", "node", "in", "the", "graph", "with", "a", "special", "edge", "type", ".", "The", "master", "node", "serves", "as", "a", "global", "scratch", "space", "that", "each", "node", "both", "reads", "from", "and", "writes", "to", "in", "every", "step", "of", "message", "passing", ".", "We", "allow", "the", "master", "node", "to", "have", "a", "separate", "node", "dimension", ",", "as", "well", "as", "separate", "weights", "for", "the", "internal", "update", "function", "(", "in", "our", "case", "a", "GRU", ")", ".", "This", "allows", "information", "to", "travel", "long", "distances", "during", "the", "propagation", "phase", ".", "It", "also", ",", "in", "theory", ",", "allows", "additional", "model", "capacity", "(", "e.g.", "large", "values", "of", ")", "without", "a", "substantial", "hit", "in", "performance", ",", "as", "the", "complexity", "of", "the", "master", "node", "model", "is", ".", "subsection", ":", "Readout", "Functions", "We", "experimented", "with", "two", "readout", "functions", ".", "First", "is", "the", "readout", "function", "used", "in", "GG", "-", "NN", ",", "which", "is", "defined", "by", "equation", "[", "reference", "]", ".", "Second", "is", "a", "set2set", "model", "from", ".", "The", "set2set", "model", "is", "specifically", "designed", "to", "operate", "on", "sets", "and", "should", "have", "more", "expressive", "power", "than", "simply", "summing", "the", "final", "node", "states", ".", "This", "model", "first", "applies", "a", "linear", "projection", "to", "each", "tuple", "(", ")", "and", "then", "takes", "as", "input", "the", "set", "of", "projected", "tuples", ".", "Then", ",", "after", "steps", "of", "computation", ",", "the", "set2set", "model", "produces", "a", "graph", "level", "embedding", "which", "is", "invariant", "to", "the", "order", "of", "the", "of", "the", "tuples", ".", "We", "feed", "this", "embedding", "through", "a", "neural", "network", "to", "produce", "the", "output", ".", "subsection", ":", "Multiple", "Towers", "One", "issue", "with", "MPNN\u00e2\u0080\u0099s", "is", "scalability", ".", "In", "particular", ",", "a", "single", "step", "of", "the", "message", "passing", "phase", "for", "a", "dense", "graph", "requires", "floating", "point", "multiplications", ".", "As", "or", "get", "large", "this", "can", "be", "computationally", "expensive", ".", "To", "address", "this", "issue", "we", "break", "the", "dimensional", "node", "embeddings", "into", "different", "dimensional", "embeddings", "and", "run", "a", "propagation", "step", "on", "each", "of", "the", "copies", "separately", "to", "get", "temporary", "embeddings", ",", "using", "separate", "message", "and", "update", "functions", "for", "each", "copy", ".", "The", "temporary", "embeddings", "of", "each", "node", "are", "then", "mixed", "together", "according", "to", "the", "equation", "where", "denotes", "a", "neural", "network", "and", "denotes", "concatenation", ",", "with", "shared", "across", "all", "nodes", "in", "the", "graph", ".", "This", "mixing", "preserves", "the", "invariance", "to", "permutations", "of", "the", "nodes", ",", "while", "allowing", "the", "different", "copies", "of", "the", "graph", "to", "communicate", "with", "each", "other", "during", "the", "propagation", "phase", ".", "This", "can", "be", "advantageous", "in", "that", "it", "allows", "larger", "hidden", "states", "for", "the", "same", "number", "of", "parameters", ",", "which", "yields", "a", "computational", "speedup", "in", "practice", ".", "For", "example", ",", "when", "the", "message", "function", "is", "matrix", "multiplication", "(", "as", "in", "GG", "-", "NN", ")", "a", "propagation", "step", "of", "a", "single", "copy", "takes", "time", ",", "and", "there", "are", "copies", ",", "therefore", "the", "overall", "time", "complexity", "is", ",", "with", "some", "additional", "overhead", "due", "to", "the", "mixing", "network", ".", "For", ",", "and", "we", "see", "a", "factor", "of", "2", "speedup", "in", "inference", "time", "over", "a", ",", ",", "and", "architecture", ".", "This", "variation", "would", "be", "most", "useful", "for", "larger", "molecules", ",", "for", "instance", "molecules", "from", "GDB", "-", "17", ".", "section", ":", "Input", "Representation", "There", "are", "a", "number", "of", "features", "available", "for", "each", "atom", "in", "a", "molecule", "which", "capture", "both", "properties", "of", "the", "electrons", "in", "the", "atom", "as", "well", "as", "the", "bonds", "that", "the", "atom", "participates", "in", ".", "For", "a", "list", "of", "all", "of", "the", "features", "see", "table", "[", "reference", "]", ".", "We", "experimented", "with", "making", "the", "hydrogen", "atoms", "explicit", "nodes", "in", "the", "graph", "(", "as", "opposed", "to", "simply", "including", "the", "count", "as", "a", "node", "feature", ")", ",", "in", "which", "case", "graphs", "have", "up", "to", "29", "nodes", ".", "Note", "that", "having", "larger", "graphs", "significantly", "slows", "training", "time", ",", "in", "this", "case", "by", "a", "factor", "of", "roughly", "10", ".", "For", "the", "adjacency", "matrix", "there", "are", "three", "edge", "representations", "used", "depending", "on", "the", "model", ".", "Chemical", "Graph", ":", "In", "the", "abscence", "of", "distance", "information", ",", "adjacency", "matrix", "entries", "are", "discrete", "bond", "types", ":", "single", ",", "double", ",", "triple", ",", "or", "aromatic", ".", "Distance", "bins", ":", "The", "matrix", "multiply", "message", "function", "assumes", "discrete", "edge", "types", ",", "so", "to", "include", "distance", "information", "we", "bin", "bond", "distances", "into", "10", "bins", ",", "the", "bins", "are", "obtained", "by", "uniformly", "partitioning", "the", "interval", "into", "8", "bins", ",", "followed", "by", "adding", "a", "bin", "and", ".", "These", "bins", "were", "hand", "chosen", "by", "looking", "at", "a", "histogram", "of", "all", "distances", ".", "The", "adjacency", "matrix", "then", "has", "entries", "in", "an", "alphabet", "of", "size", "14", ",", "indicating", "bond", "type", "for", "bonded", "atoms", "and", "distance", "bin", "for", "atoms", "that", "are", "not", "bonded", ".", "We", "found", "the", "distance", "for", "bonded", "atoms", "to", "be", "almost", "completely", "determined", "by", "bond", "type", ".", "Raw", "distance", "feature", ":", "When", "using", "a", "message", "function", "which", "operates", "on", "vector", "valued", "edges", ",", "the", "entries", "of", "the", "adjacency", "matrix", "are", "then", "5", "dimensional", ",", "where", "the", "first", "dimension", "indicates", "the", "euclidean", "distance", "between", "the", "pair", "of", "atoms", ",", "and", "the", "remaining", "four", "are", "a", "one", "-", "hot", "encoding", "of", "the", "bond", "type", ".", "section", ":", "Training", "Each", "model", "and", "target", "combination", "was", "trained", "using", "a", "uniform", "random", "hyper", "parameter", "search", "with", "50", "trials", ".", "was", "constrained", "to", "be", "in", "the", "range", "(", "in", "practice", ",", "any", "works", ")", ".", "The", "number", "of", "set2set", "computations", "was", "chosen", "from", "the", "range", ".", "All", "models", "were", "trained", "using", "SGD", "with", "the", "ADAM", "optimizer", "(", ")", ",", "with", "batch", "size", "20", "for", "3", "million", "steps", "(", "540", "epochs", ")", ".", "The", "initial", "learning", "rate", "was", "chosen", "uniformly", "between", "and", ".", "We", "used", "a", "linear", "learning", "rate", "decay", "that", "began", "between", "10", "%", "and", "90", "%", "of", "the", "way", "through", "training", "and", "the", "initial", "learning", "rate", "decayed", "to", "a", "final", "learning", "rate", ",", "using", "a", "decay", "factor", "in", "the", "range", ".", "The", "QM", "-", "9", "dataset", "has", "130462", "molecules", "in", "it", ".", "We", "randomly", "chose", "10000", "samples", "for", "validation", ",", "10000", "samples", "for", "testing", ",", "and", "used", "the", "rest", "for", "training", ".", "We", "use", "the", "validation", "set", "to", "do", "early", "stopping", "and", "model", "selection", "and", "we", "report", "scores", "on", "the", "test", "set", ".", "All", "targets", "were", "normalized", "to", "have", "mean", "0", "and", "variance", "1", ".", "We", "minimize", "the", "mean", "squared", "error", "between", "the", "model", "output", "and", "the", "target", ",", "although", "we", "evaluate", "mean", "absolute", "error", ".", "section", ":", "Results", "In", "all", "of", "our", "tables", "we", "report", "the", "ratio", "of", "the", "mean", "absolute", "error", "(", "MAE", ")", "of", "our", "models", "with", "the", "provided", "estimate", "of", "chemical", "accuracy", "for", "that", "target", ".", "Thus", "any", "model", "with", "error", "ratio", "less", "than", "1", "has", "achieved", "chemical", "accuracy", "for", "that", "target", ".", "In", "the", "supplementary", "material", "we", "list", "the", "chemical", "accuracy", "estimates", "for", "each", "target", ",", "these", "are", "the", "same", "estimates", "that", "were", "given", "in", ".", "In", "this", "way", ",", "the", "MAE", "of", "our", "models", "can", "be", "calculated", "as", ".", "Note", ",", "unless", "otherwise", "indicated", ",", "all", "tables", "display", "result", "of", "models", "trained", "individually", "on", "each", "target", "(", "as", "opposed", "to", "training", "one", "model", "to", "predict", "all", "13", ")", ".", "We", "performed", "numerous", "experiments", "in", "order", "to", "find", "the", "best", "possible", "MPNN", "on", "this", "dataset", "as", "well", "as", "the", "proper", "input", "representation", ".", "In", "our", "experiments", ",", "we", "found", "that", "including", "the", "complete", "edge", "feature", "vector", "(", "bond", "type", ",", "spatial", "distance", ")", "and", "treating", "hydrogen", "atoms", "as", "explicit", "nodes", "in", "the", "graph", "to", "be", "very", "important", "for", "a", "number", "of", "targets", ".", "We", "also", "found", "that", "training", "one", "model", "per", "target", "consistently", "outperformed", "jointly", "training", "on", "all", "13", "targets", ".", "In", "some", "cases", "the", "improvement", "was", "up", "to", "40", "%", ".", "Our", "best", "MPNN", "variant", "used", "the", "edge", "network", "message", "function", ",", "set2set", "output", ",", "and", "operated", "on", "graphs", "with", "explicit", "hydrogens", ".", "We", "were", "able", "to", "further", "improve", "performance", "on", "the", "test", "set", "by", "ensembling", "the", "predictions", "of", "the", "five", "models", "with", "lowest", "validation", "error", ".", "In", "table", "[", "reference", "]", "we", "compare", "the", "performance", "of", "our", "best", "MPNN", "variant", "(", "denoted", "with", "enn", "-", "s2s", ")", "and", "the", "corresponding", "ensemble", "(", "denoted", "with", "enn", "-", "s2s", "-", "ens5", ")", "with", "the", "previous", "state", "of", "the", "art", "on", "this", "dataset", "as", "reported", "in", ".", "For", "clarity", "the", "error", "ratios", "of", "the", "best", "non", "-", "ensemble", "models", "are", "shown", "in", "bold", ".", "This", "previous", "work", "performed", "a", "comparison", "study", "of", "several", "existing", "ML", "models", "for", "QM9", "and", "we", "have", "taken", "care", "to", "use", "the", "same", "train", ",", "validation", ",", "and", "test", "split", ".", "These", "baselines", "include", "5", "different", "hand", "engineered", "molecular", "representations", ",", "which", "then", "get", "fed", "through", "a", "standard", ",", "off", "-", "the", "-", "shelf", "classifier", ".", "These", "input", "representations", "include", "the", "Coulomb", "Matrix", "(", "CM", ",", ")", ",", "Bag", "of", "Bonds", "(", "BoB", ",", ")", ",", "Bonds", "Angles", ",", "Machine", "Learning", "(", "BAML", ",", ")", ",", "Extended", "Connectivity", "Fingerprints", "(", "ECPF4", ",", ")", ",", "and", "\u201c", "Projected", "Histograms", "\u201d", "(", "HDAD", ",", ")", "representations", ".", "In", "addition", "to", "these", "hand", "engineered", "features", "we", "include", "two", "existing", "baseline", "MPNNs", ",", "the", "Molecular", "Graph", "Convolutions", "model", "(", "GC", ")", "from", ",", "and", "the", "original", "GG", "-", "NN", "model", "trained", "with", "distance", "bins", ".", "Overall", ",", "our", "new", "MPNN", "achieves", "chemical", "accuracy", "on", "11", "out", "of", "13", "targets", "and", "state", "of", "the", "art", "on", "all", "13", "targets", ".", "Training", "Without", "Spatial", "Information", ":", "We", "also", "experimented", "in", "the", "setting", "where", "spatial", "information", "is", "not", "included", "in", "the", "input", ".", "In", "general", ",", "we", "find", "that", "augmenting", "the", "MPNN", "with", "some", "means", "of", "capturing", "long", "range", "interactions", "between", "nodes", "in", "the", "graph", "greatly", "improves", "performance", "in", "this", "setting", ".", "To", "demonstrate", "this", "we", "performed", "4", "experiments", ",", "one", "where", "we", "train", "the", "GG", "-", "NN", "model", "on", "the", "sparse", "graph", ",", "one", "where", "we", "add", "virtual", "edges", ",", "one", "where", "we", "add", "a", "master", "node", ",", "and", "one", "where", "we", "change", "the", "graph", "level", "output", "to", "a", "set2set", "output", ".", "The", "error", "ratios", "averaged", "across", "the", "13", "targets", "are", "shown", "in", "table", "[", "reference", "]", ".", "Overall", ",", "these", "three", "modifications", "help", "on", "all", "13", "targets", ",", "and", "the", "Set2Set", "output", "achieves", "chemical", "accuracy", "on", "5", "out", "of", "13", "targets", ".", "For", "more", "details", ",", "consult", "the", "supplementary", "material", ".", "The", "experiments", "shown", "tables", "[", "reference", "]", "and", "[", "reference", "]", "were", "run", "with", "a", "partial", "charge", "feature", "as", "a", "node", "input", ".", "This", "feature", "is", "an", "output", "of", "the", "DFT", "calculation", "and", "thus", "could", "not", "be", "used", "in", "an", "applied", "setting", ".", "The", "state", "of", "art", "numbers", "we", "report", "in", "table", "[", "reference", "]", "do", "not", "use", "this", "feature", ".", "Towers", ":", "Our", "original", "intent", "in", "developing", "the", "towers", "variant", "was", "to", "improve", "training", "time", ",", "as", "well", "as", "to", "allow", "the", "model", "to", "be", "trained", "on", "larger", "graphs", ".", "However", ",", "we", "also", "found", "some", "evidence", "that", "the", "multi", "-", "tower", "structure", "improves", "generalization", "performance", ".", "In", "table", "[", "reference", "]", "we", "compare", "GG", "-", "NN", "+", "towers", "+", "set2set", "output", "vs", "a", "baseline", "GG", "-", "NN", "+", "set2set", "output", "when", "distance", "bins", "are", "used", ".", "We", "do", "this", "comparison", "in", "both", "the", "joint", "training", "regime", "and", "when", "training", "one", "model", "per", "target", ".", "The", "towers", "model", "outperforms", "the", "baseline", "model", "on", "12", "out", "of", "13", "targets", "in", "both", "individual", "and", "joint", "target", "training", ".", "We", "believe", "the", "benefit", "of", "towers", "is", "that", "it", "resembles", "training", "an", "ensemble", "of", "models", ".", "Unfortunately", ",", "our", "attempts", "so", "far", "at", "combining", "the", "towers", "and", "edge", "network", "message", "function", "have", "failed", "to", "further", "improve", "performance", ",", "possibly", "because", "the", "combination", "makes", "training", "more", "difficult", ".", "Further", "training", "details", ",", "and", "error", "ratios", "on", "all", "targets", "can", "be", "found", "in", "the", "supplementary", "material", ".", "Additional", "Experiments", ":", "In", "preliminary", "experiments", ",", "we", "tried", "disabling", "weight", "tying", "across", "different", "time", "steps", ".", "However", ",", "we", "found", "that", "the", "most", "effective", "way", "to", "increase", "performance", "was", "to", "tie", "the", "weights", "and", "use", "a", "larger", "hidden", "dimension", ".", "We", "also", "early", "on", "found", "the", "pair", "message", "function", "to", "perform", "worse", "than", "the", "edge", "network", "function", ".", "This", "included", "a", "toy", "pathfinding", "problem", "which", "was", "originally", "designed", "to", "benefit", "from", "using", "pair", "messages", ".", "Also", ",", "when", "trained", "jointly", "on", "the", "13", "targets", "the", "edge", "network", "function", "outperforms", "pair", "message", "on", "11", "out", "of", "13", "targets", ",", "and", "has", "an", "average", "error", "ratio", "of", "1.53", "compared", "to", "3.98", "for", "pair", "message", ".", "Given", "the", "difficulties", "with", "training", "this", "function", "we", "did", "not", "pursue", "it", "further", ".", "For", "performance", "on", "smaller", "sized", "training", "sets", ",", "consult", "the", "supplementary", "material", ".", "section", ":", "Conclusions", "and", "Future", "Work", "Our", "results", "show", "that", "MPNN\u00e2\u0080\u0099s", "with", "the", "appropriate", "message", ",", "update", ",", "and", "output", "functions", "have", "a", "useful", "inductive", "bias", "for", "predicting", "molecular", "properties", ",", "outperforming", "several", "strong", "baselines", "and", "eliminating", "the", "need", "for", "complicated", "feature", "engineering", ".", "Moreover", ",", "our", "results", "also", "reveal", "the", "importance", "of", "allowing", "long", "range", "interactions", "between", "nodes", "in", "the", "graph", "with", "either", "the", "master", "node", "or", "the", "set2set", "output", ".", "The", "towers", "variation", "makes", "these", "models", "more", "scalable", ",", "but", "additional", "improvements", "will", "be", "needed", "to", "scale", "to", "much", "larger", "graphs", ".", "An", "important", "future", "direction", "is", "to", "design", "MPNNs", "that", "can", "generalize", "effectively", "to", "larger", "graphs", "than", "those", "appearing", "in", "the", "training", "set", "or", "at", "least", "work", "with", "benchmarks", "designed", "to", "expose", "issues", "with", "generalization", "across", "graph", "sizes", ".", "Generalizing", "to", "larger", "molecule", "sizes", "seems", "particularly", "challenging", "when", "using", "spatial", "information", ".", "First", "of", "all", ",", "the", "pairwise", "distance", "distribution", "depends", "heavily", "on", "the", "number", "of", "atoms", ".", "Second", ",", "our", "most", "successful", "ways", "of", "using", "spatial", "information", "create", "a", "fully", "connected", "graph", "where", "the", "number", "of", "incoming", "messages", "also", "depends", "on", "the", "number", "of", "nodes", ".", "To", "address", "the", "second", "issue", ",", "we", "believe", "that", "adding", "an", "attention", "mechanism", "over", "the", "incoming", "message", "vectors", "could", "be", "an", "interesting", "direction", "to", "explore", ".", "section", ":", "Acknowledgements", "We", "would", "like", "to", "thank", "Lukasz", "Kaiser", ",", "Geoffrey", "Irving", ",", "Alex", "Graves", ",", "and", "Yujia", "Li", "for", "helpful", "discussions", ".", "Thank", "you", "to", "Adrian", "Roitberg", "for", "pointing", "out", "an", "issue", "with", "the", "use", "of", "partial", "charges", "in", "an", "earlier", "version", "of", "this", "paper", ".", "bibliography", ":", "References", "section", ":", "Appendix", "subsection", ":", "Interpretation", "of", "Laplacian", "based", "models", "as", "MPNNs", "Another", "family", "of", "models", "defined", "in", ",", ",", "can", "be", "interpreted", "as", "MPNNs", ".", "These", "models", "generalize", "the", "notion", "of", "convolutions", "a", "general", "graph", "with", "nodes", ".", "In", "the", "language", "of", "MPNNs", ",", "these", "models", "tend", "to", "have", "very", "simple", "message", "functions", "and", "are", "typically", "applied", "to", "much", "larger", "graphs", "such", "as", "social", "network", "data", ".", "We", "closely", "follow", "the", "notation", "defined", "in", "equation", "(", "3.2", ")", ".", "The", "model", "discussed", "in", "(", "equation", "5", ")", "and", "can", "be", "viewed", "as", "special", "cases", ".", "Given", "an", "adjacency", "matrix", "we", "define", "the", "graph", "Laplacian", "to", "be", "where", "is", "the", "diagonal", "degree", "matrix", "with", ".", "Let", "denote", "the", "eigenvectors", "of", ",", "ordered", "by", "eigenvalue", ".", "Let", "be", "a", "real", "valued", "nonlinearity", "(", "such", "as", "ReLU", ")", ".", "We", "now", "define", "an", "operation", "which", "transforms", "an", "input", "vector", "of", "size", "to", "a", "vector", "of", "size", "(", "the", "full", "model", "can", "defined", "as", "stacking", "these", "operations", ")", ".", "Here", "and", "are", "all", "dimensional", "vectors", "corresponding", "to", "a", "scalar", "feature", "at", "each", "node", ".", "The", "matrices", "are", "all", "diagonal", "matrices", "and", "contain", "all", "of", "the", "learned", "parameters", "in", "the", "layer", ".", "We", "now", "expand", "equation", "[", "reference", "]", "in", "terms", "of", "the", "full", "vector", "and", "vector", ",", "using", "and", "to", "index", "nodes", "in", "the", "graph", "and", ",", "to", "index", "the", "dimensions", "of", "the", "node", "states", ".", "In", "this", "way", "denotes", "the", "\u2019", "th", "dimension", "of", "node", ",", "and", "denotes", "the", "\u2019", "th", "dimension", "of", "node", ",", "furthermore", "we", "use", "to", "denote", "the", "dimensional", "vector", "for", "node", "state", ",", "and", "to", "denote", "the", "dimensional", "vector", "for", "node", ".", "Define", "the", "rank", "4", "tensor", "of", "dimension", "where", ".", "We", "will", "use", "to", "denote", "the", "dimensional", "matrix", "where", "and", "to", "denote", "the", "dimensional", "matrix", "where", ".", "Writing", "equation", "[", "reference", "]", "in", "this", "notation", "we", "have", "Relabelling", "as", "and", "as", "this", "last", "line", "can", "be", "interpreted", "as", "the", "message", "passing", "update", "in", "an", "MPNN", "where", "and", ".", "subsubsection", ":", "The", "special", "case", "of", "Kipf", "and", "Welling", "(", "2016", ")", "Motivated", "as", "a", "first", "order", "approximation", "of", "the", "graph", "laplacian", "methods", ",", "propose", "the", "following", "layer", "-", "wise", "propagation", "rule", ":", "Here", "where", "is", "the", "real", "valued", "adjacency", "matrix", "for", "an", "undirected", "graph", ".", "Adding", "the", "identity", "matrix", "corresponds", "to", "adding", "self", "loops", "to", "the", "graph", ".", "Also", "denotes", "the", "degree", "matrix", "for", "the", "graph", "with", "self", "loops", ",", "is", "a", "layer", "-", "specific", "trainable", "weight", "matrix", ",", "and", "denotes", "a", "real", "valued", "nonlinearity", ".", "Each", "is", "a", "dimensional", "matrix", "indicating", "the", "dimensional", "node", "states", "for", "the", "nodes", "in", "the", "graph", ".", "In", "what", "follows", ",", "given", "a", "matrix", "we", "use", "to", "denote", "the", "row", "in", "indexed", "by", "(", "will", "always", "correspond", "to", "a", "node", "in", "the", "graph", ")", ".", "Let", ".", "To", "get", "the", "updated", "node", "state", "for", "node", "we", "have", "Relabelling", "the", "row", "vector", "as", "an", "dimensional", "column", "vector", "the", "above", "equation", "is", "equivalent", "to", "which", "is", "equivalent", "to", "a", "message", "function", "and", "update", "function", "Note", "that", "the", "are", "all", "scalar", "valued", ",", "so", "this", "model", "corresponds", "to", "taking", "a", "certain", "weighted", "average", "of", "neighboring", "nodes", "at", "each", "time", "step", ".", "subsection", ":", "A", "More", "Detailed", "Description", "of", "the", "Quantum", "Properties", "First", "there", "the", "four", "atomization", "energies", ".", "Atomization", "energy", "at", "(", "eV", ")", ":", "This", "is", "the", "energy", "required", "to", "break", "up", "the", "molecule", "into", "all", "of", "its", "constituent", "atoms", "if", "the", "molecule", "is", "at", "absolute", "zero", ".", "This", "calculation", "assumes", "that", "the", "molecules", "are", "held", "at", "fixed", "volume", ".", "Atomization", "energy", "at", "room", "temperature", "(", "eV", ")", ":", "Like", ",", "this", "is", "the", "energy", "required", "to", "break", "up", "the", "molecule", "if", "it", "is", "at", "room", "temperature", ".", "Enthalpy", "of", "atomization", "at", "room", "temperature", "(", "eV", ")", ":", "The", "enthalpy", "of", "atomization", "is", "similar", "in", "spirit", "to", "the", "energy", "of", "atomization", ",", ".", "However", ",", "unlike", "the", "energy", "this", "calculation", "assumes", "that", "the", "constituent", "molecules", "are", "held", "at", "fixed", "pressure", ".", "Free", "energy", "of", "atomization", "(", "eV", ")", ":", "Once", "again", "this", "is", "similar", "to", "and", ",", "but", "assumes", "that", "the", "system", "is", "held", "at", "fixed", "temperature", "and", "pressure", "during", "the", "dissociation", ".", "Next", "there", "are", "properties", "related", "to", "fundamental", "vibrations", "of", "the", "molecule", ":", "Highest", "fundamental", "vibrational", "frequency", "(", ")", ":", "Every", "molecule", "has", "fundamental", "vibrational", "modes", "that", "it", "can", "naturally", "oscillate", "at", ".", "is", "the", "mode", "that", "requires", "the", "most", "energy", ".", "Zero", "Point", "Vibrational", "Energy", "(", "ZPVE", ")", "(", "eV", ")", ":", "Even", "at", "zero", "temperature", "quantum", "mechanical", "uncertainty", "implies", "that", "atoms", "vibrate", ".", "This", "is", "known", "as", "the", "zero", "point", "vibrational", "energy", "and", "can", "be", "calculated", "once", "the", "allowed", "vibrational", "modes", "of", "a", "molecule", "are", "known", ".", "Additionally", ",", "there", "are", "a", "number", "of", "properties", "that", "concern", "the", "states", "of", "the", "electrons", "in", "the", "molecule", ":", "Highest", "Occupied", "Molecular", "Orbital", "(", "HOMO", ")", "(", "eV", ")", ":", "Quantum", "mechanics", "dictates", "that", "the", "allowed", "states", "that", "electrons", "can", "occupy", "in", "a", "molecule", "are", "discrete", ".", "The", "Pauli", "exclusion", "principle", "states", "that", "no", "two", "electrons", "may", "occupy", "the", "same", "state", ".", "At", "zero", "temperature", ",", "therefore", ",", "electrons", "stack", "in", "states", "from", "lowest", "energy", "to", "highest", "energy", ".", "HOMO", "is", "the", "energy", "of", "the", "highest", "occupied", "electronic", "state", ".", "Lowest", "Unoccupied", "Molecular", "Orbital", "(", "LUMO", ")", "(", "eV", ")", ":", "Like", "HOMO", ",", "LUMO", "is", "the", "lowest", "energy", "electronic", "state", "that", "is", "unoccupied", ".", "Electron", "energy", "gap", "(", "eV", ")", ":", "This", "is", "the", "difference", "in", "energy", "between", "LUMO", "and", "HOMO", ".", "It", "is", "the", "lowest", "energy", "transition", "that", "can", "occur", "when", "an", "electron", "is", "excited", "from", "an", "occupied", "state", "to", "an", "unoccupied", "state", ".", "also", "dictates", "the", "longest", "wavelength", "of", "light", "that", "the", "molecule", "can", "absorb", ".", "Finally", ",", "there", "are", "several", "measures", "of", "the", "spatial", "distribution", "of", "electrons", "in", "the", "molecule", ":", "Electronic", "Spatial", "Extent", "(", "Bohr", ")", ":", "The", "electronic", "spatial", "extent", "is", "the", "second", "moment", "of", "the", "charge", "distribution", ",", ",", "or", "in", "other", "words", ".", "Norm", "of", "the", "dipole", "moment", "(", "Debye", ")", ":", "The", "dipole", "moment", ",", ",", "approximates", "the", "electric", "field", "far", "from", "a", "molecule", ".", "The", "norm", "of", "the", "dipole", "moment", "is", "related", "to", "how", "anisotropically", "the", "charge", "is", "distributed", "(", "and", "hence", "the", "strength", "of", "the", "field", "far", "from", "the", "molecule", ")", ".", "This", "degree", "of", "anisotropy", "is", "in", "turn", "related", "to", "a", "number", "of", "material", "properties", "(", "for", "example", "hydrogen", "bonding", "in", "water", "causes", "the", "dipole", "moment", "to", "be", "large", "which", "has", "a", "large", "effect", "on", "dynamics", "and", "surface", "tension", ")", ".", "Norm", "of", "the", "static", "polarizability", "(", "Bohr", ")", ":", "measures", "the", "extent", "to", "which", "a", "molecule", "can", "spontaneously", "incur", "a", "dipole", "moment", "in", "response", "to", "an", "external", "field", ".", "This", "is", "in", "turn", "related", "to", "the", "degree", "to", "which", "i.e.", "Van", "der", "Waals", "interactions", "play", "a", "role", "in", "the", "dynamics", "of", "the", "medium", ".", "subsection", ":", "Chemical", "Accuracy", "and", "DFT", "Error", "In", "Table", "[", "reference", "]", "we", "list", "the", "mean", "absolute", "error", "numbers", "for", "chemical", "accuracy", ".", "These", "are", "the", "numbers", "used", "to", "compute", "the", "error", "ratios", "of", "all", "models", "in", "the", "tables", ".", "The", "mean", "absolute", "errors", "of", "our", "models", "can", "thus", "be", "calculated", "as", ".", "We", "also", "include", "some", "estimates", "of", "the", "mean", "absolute", "error", "for", "the", "DFT", "calculation", "to", "the", "ground", "truth", ".", "Both", "the", "estimates", "of", "chemical", "accruacy", "and", "DFT", "error", "were", "provided", "in", ".", "subsection", ":", "Additional", "Results", "In", "Table", "[", "reference", "]", "we", "compare", "the", "performance", "of", "the", "best", "architecture", "(", "edge", "network", "+", "set2set", "output", ")", "on", "different", "sized", "training", "sets", ".", "It", "is", "surprising", "how", "data", "efficient", "this", "model", "is", "on", "some", "targets", ".", "For", "example", ",", "on", "both", "R2", "and", "Omega", "our", "models", "are", "equal", "or", "better", "with", "11k", "samples", "than", "the", "best", "baseline", "is", "with", "110k", "samples", ".", "In", "Table", "[", "reference", "]", "we", "compare", "the", "performance", "of", "several", "models", "trained", "without", "spatial", "information", ".", "The", "left", "4", "columns", "show", "the", "results", "of", "4", "experiments", ",", "one", "where", "we", "train", "the", "GG", "-", "NN", "model", "on", "the", "sparse", "graph", ",", "one", "where", "we", "add", "virtual", "edges", "(", "ve", ")", ",", "one", "where", "we", "add", "a", "master", "node", "(", "mn", ")", ",", "and", "one", "where", "we", "change", "the", "graph", "level", "output", "to", "a", "set2set", "output", "(", "s2s", ")", ".", "In", "general", ",", "we", "find", "that", "it", "\u2019s", "important", "to", "allow", "the", "model", "to", "capture", "long", "range", "interactions", "in", "these", "graphs", ".", "In", "Table", "[", "reference", "]", "we", "compare", "GG", "-", "NN", "+", "towers", "+", "set2set", "output", "(", "tow8", ")", "vs", "a", "baseline", "GG", "-", "NN", "+", "set2set", "output", "(", "GG", "-", "NN", ")", "when", "distance", "bins", "are", "used", ".", "We", "do", "this", "comparison", "in", "both", "the", "joint", "training", "regime", "(", "j", ")", "and", "when", "training", "one", "model", "per", "target", "(", "i", ")", ".", "For", "joint", "training", "of", "the", "baseline", "we", "used", "100", "trials", "with", "as", "well", "as", "200", "trials", "where", "was", "chosen", "randomly", "in", "the", "set", ",", "we", "report", "the", "minimum", "test", "error", "across", "all", "300", "trials", ".", "For", "individual", "training", "of", "the", "baseline", "we", "used", "100", "trials", "where", "was", "chosen", "uniformly", "in", "the", "range", ".", "The", "towers", "model", "was", "always", "trained", "with", "and", ",", "with", "100", "tuning", "trials", "for", "joint", "training", "and", "50", "trials", "for", "individual", "training", ".", "The", "towers", "model", "outperforms", "the", "baseline", "model", "on", "12", "out", "of", "13", "targets", "in", "both", "individual", "and", "joint", "target", "training", ".", "In", "Table", "[", "reference", "]", "right", "2", "columns", "compare", "the", "edge", "network", "(", "enn", ")", "with", "the", "pair", "message", "network", "(", "pm", ")", "in", "the", "joint", "training", "regime", "(", "j", ")", ".", "The", "edge", "network", "consistently", "outperforms", "the", "pair", "message", "function", "across", "most", "targets", ".", "In", "Table", "[", "reference", "]", "we", "compare", "our", "MPNNs", "with", "different", "input", "featurizations", ".", "All", "models", "use", "the", "Set2Set", "output", "and", "GRU", "update", "functions", ".", "The", "no", "distance", "model", "uses", "the", "matrix", "multiply", "message", "function", ",", "the", "distance", "models", "use", "the", "edge", "neural", "network", "message", "function", "."]}