{"coref": {"Image_Super-Resolution": [[92, 96], [276, 281], [740, 744], [908, 913], [1059, 1064], [1480, 1485], [2811, 2816], [2949, 2954], [3769, 3773], [4167, 4172], [4568, 4570], [4580, 4583], [4900, 4903], [5462, 5467]], "PFF": [[5, 8], [380, 383], [807, 810], [1028, 1031], [1218, 1221], [1592, 1595], [1804, 1807], [2327, 2330], [2548, 2551], [2789, 2790], [3358, 3360], [3399, 3400], [3530, 3531], [3857, 3858], [3947, 3948], [4077, 4078], [4137, 4138], [4257, 4259], [4294, 4295], [4307, 4308], [4783, 4786], [5271, 5274], [5489, 5490], [2784, 2787]], "PSNR": [[1387, 1389], [2962, 2971], [2972, 2973], [3954, 3955], [3962, 3963], [4044, 4047], [4159, 4160]], "SSIM": [[2975, 2978], [2979, 2980], [3956, 3957], [4162, 4164]], "Set14_-_4x_upscaling": [[2947, 2948], [4378, 4379]], "Set5_-_4x_upscaling": [[2945, 2946], [4377, 4378]]}, "coref_non_salient": {"0": [[721, 723], [3672, 3674]], "1": [[944, 946], [1762, 1763], [3407, 3410], [4687, 4689]], "10": [[431, 433], [440, 442], [488, 490], [529, 531], [576, 579], [586, 588], [822, 825], [1074, 1076], [1130, 1132], [1181, 1184], [1595, 1597], [1729, 1732], [1874, 1876], [2161, 2163], [2213, 2215]], "100": [[556, 558]], "101": [[2479, 2481]], "102": [[13, 15]], "103": [[746, 749]], "104": [[1938, 1940]], "105": [[1526, 1530]], "106": [[1005, 1009]], "107": [[240, 245]], "108": [[2750, 2755]], "109": [[2487, 2493]], "11": [[315, 317], [2182, 2183], [2210, 2211]], "110": [[2444, 2448], [2617, 2621], [3199, 3203]], "111": [[221, 222]], "112": [[2302, 2308]], "113": [[1408, 1409], [3812, 3815], [4122, 4124]], "114": [[4058, 4062]], "115": [[2097, 2099]], "116": [[2090, 2093]], "12": [[86, 91], [1362, 1365], [1417, 1420], [1439, 1441]], "13": [[121, 125], [1080, 1083], [1297, 1299]], "14": [[772, 780], [869, 876], [2598, 2608]], "15": [[368, 369], [787, 788]], "16": [[1210, 1212], [1773, 1775], [2402, 2407]], "17": [[623, 625], [2711, 2714]], "18": [[266, 270], [3302, 3306], [3785, 3787]], "19": [[215, 217], [4943, 4947]], "2": [[613, 616], [949, 952]], "20": [[4436, 4439], [4608, 4613]], "21": [[219, 220], [4952, 4954]], "22": [[3139, 3141], [3299, 3301]], "23": [[355, 359], [1458, 1462], [1539, 1543]], "24": [[1577, 1579], [4205, 4207], [4289, 4291]], "25": [[40, 44], [1234, 1237]], "26": [[2506, 2510], [4955, 4957]], "27": [[64, 70], [713, 717], [2397, 2401]], "28": [[3393, 3396], [3546, 3549], [4081, 4084], [4320, 4323], [4343, 4345], [5329, 5332]], "29": [[407, 413], [890, 895], [1122, 1127], [2793, 2798], [4829, 4834]], "3": [[1338, 1340], [3246, 3248]], "30": [[5079, 5081], [5102, 5104], [5160, 5162]], "31": [[5185, 5189]], "32": [[5383, 5385]], "33": [[686, 687], [2170, 2172], [2202, 2203]], "34": [[26, 29], [126, 127], [682, 684], [1334, 1335], [3136, 3137]], "35": [[1436, 1438], [4565, 4567]], "36": [[361, 362], [394, 396]], "37": [[471, 472], [1692, 1693], [2104, 2105], [2541, 2543]], "38": [[79, 85], [896, 902], [1048, 1054], [1242, 1249], [1258, 1260], [2243, 2249], [2799, 2805], [2909, 2915], [3016, 3022], [3026, 3032], [4560, 4564], [5041, 5047], [5217, 5221], [5450, 5456]], "39": [[1396, 1398], [3010, 3013], [4141, 4143]], "4": [[4233, 4237], [4510, 4513], [4684, 4686], [953, 955]], "40": [[4803, 4810], [5180, 5184]], "41": [[3271, 3273]], "42": [[1405, 1407]], "43": [[2746, 2749]], "44": [[3981, 3982], [4004, 4005]], "45": [[2, 4], [21, 24], [283, 286], [391, 392], [734, 736], [852, 853], [983, 989], [1225, 1228], [2345, 2347], [4796, 4799]], "46": [[414, 417], [1598, 1600]], "47": [[3951, 3953]], "48": [[3240, 3244]], "49": [[4744, 4747]], "5": [[1602, 1604], [4763, 4766]], "50": [[2823, 2825]], "51": [[4572, 4573], [5082, 5083], [5107, 5108]], "52": [[2284, 2286]], "53": [[5137, 5139]], "54": [[271, 274], [903, 907], [1055, 1058], [1355, 1358], [2806, 2810], [2939, 2943], [3777, 3781], [4499, 4502], [4904, 4906], [5457, 5461]], "55": [[1554, 1558], [2095, 2096]], "56": [[1343, 1346], [1560, 1563]], "57": [[2534, 2536]], "58": [[2429, 2431]], "59": [[2544, 2546]], "6": [[940, 942], [2076, 2078], [4408, 4410], [5200, 5202]], "60": [[3046, 3049]], "61": [[4333, 4334]], "62": [[348, 352]], "63": [[321, 323]], "64": [[4381, 4382]], "65": [[4404, 4407]], "66": [[4728, 4734]], "67": [[4504, 4509]], "68": [[495, 497]], "69": [[1433, 1435]], "7": [[598, 599], [608, 609], [813, 817], [2122, 2124], [2148, 2150], [3193, 3195], [3218, 3220], [3227, 3228], [3266, 3268], [3318, 3320], [3867, 3870], [3945, 3946], [4075, 4076], [4126, 4127], [4292, 4293], [4721, 4725], [4742, 4743]], "70": [[594, 597], [2689, 2690]], "71": [[4543, 4546]], "72": [[2728, 2732]], "73": [[2413, 2415]], "74": [[4442, 4444]], "75": [[2469, 2472]], "76": [[2765, 2769]], "77": [[1329, 1331], [1532, 1534]], "78": [[256, 258]], "79": [[3459, 3461]], "8": [[2352, 2354], [4949, 4951]], "80": [[291, 293], [310, 312]], "81": [[4962, 4968]], "82": [[4038, 4042]], "83": [[673, 678]], "84": [[724, 725]], "85": [[330, 332]], "86": [[971, 980]], "87": [[1449, 1453]], "88": [[2463, 2467]], "89": [[1628, 1631]], "9": [[2576, 2580], [4858, 4862]], "90": [[797, 798]], "91": [[2476, 2478], [2495, 2496]], "92": [[2739, 2741]], "93": [[1697, 1699]], "94": [[1950, 1952]], "95": [[1641, 1643]], "96": [[802, 803]], "97": [[211, 214]], "98": [[539, 543]], "99": [[2052, 2055]]}, "doc_id": "0b5519f76fc8e31ecf9931f00184aee86694e3a4", "method_subrelations": {"PFF": [[[0, 3], "PFF"]]}, "n_ary_relations": [{"Material": "Set14_-_4x_upscaling", "Method": "PFF", "Metric": "PSNR", "Task": "Image_Super-Resolution", "score": "28.98"}, {"Material": "Set14_-_4x_upscaling", "Method": "PFF", "Metric": "SSIM", "Task": "Image_Super-Resolution", "score": "0.7904"}, {"Material": "Set5_-_4x_upscaling", "Method": "PFF", "Metric": "PSNR", "Task": "Image_Super-Resolution", "score": "32.74"}, {"Material": "Set5_-_4x_upscaling", "Method": "PFF", "Metric": "SSIM", "Task": "Image_Super-Resolution", "score": "0.9021"}], "ner": [[2, 4, "Task"], [5, 8, "Method"], [13, 15, "Method"], [21, 24, "Task"], [26, 29, "Task"], [40, 44, "Method"], [64, 70, "Method"], [79, 85, "Task"], [86, 91, "Task"], [92, 96, "Task"], [121, 125, "Method"], [126, 127, "Task"], [211, 214, "Task"], [215, 217, "Task"], [219, 220, "Task"], [221, 222, "Task"], [240, 245, "Task"], [256, 258, "Task"], [266, 270, "Task"], [271, 274, "Task"], [276, 281, "Task"], [283, 286, "Task"], [291, 293, "Task"], [310, 312, "Task"], [315, 317, "Method"], [321, 323, "Task"], [330, 332, "Method"], [348, 352, "Method"], [355, 359, "Method"], [361, 362, "Task"], [368, 369, "Metric"], [380, 383, "Method"], [391, 392, "Task"], [394, 396, "Task"], [407, 413, "Task"], [414, 417, "Task"], [431, 433, "Method"], [440, 442, "Method"], [471, 472, "Method"], [488, 490, "Method"], [495, 497, "Method"], [529, 531, "Method"], [539, 543, "Task"], [556, 558, "Task"], [576, 579, "Method"], [586, 588, "Method"], [594, 597, "Method"], [598, 599, "Method"], [608, 609, "Method"], [613, 616, "Method"], [623, 625, "Method"], [673, 678, "Task"], [682, 684, "Task"], [686, 687, "Task"], [713, 717, "Method"], [721, 723, "Method"], [724, 725, "Method"], [734, 736, "Task"], [740, 744, "Task"], [746, 749, "Method"], [772, 780, "Method"], [787, 788, "Metric"], [797, 798, "Metric"], [802, 803, "Task"], [807, 810, "Method"], [813, 817, "Method"], [822, 825, "Method"], [852, 853, "Task"], [869, 876, "Method"], [890, 895, "Task"], [896, 902, "Task"], [903, 907, "Task"], [908, 913, "Task"], [940, 942, "Method"], [944, 946, "Method"], [949, 952, "Method"], [971, 980, "Method"], [983, 989, "Task"], [1005, 1009, "Task"], [1028, 1031, "Method"], [1048, 1054, "Task"], [1055, 1058, "Task"], [1059, 1064, "Task"], [1074, 1076, "Method"], [1080, 1083, "Method"], [1122, 1127, "Task"], [1130, 1132, "Method"], [1181, 1184, "Method"], [1210, 1212, "Task"], [1218, 1221, "Method"], [1225, 1228, "Task"], [1234, 1237, "Method"], [1242, 1249, "Task"], [1258, 1260, "Task"], [1297, 1299, "Method"], [1329, 1331, "Method"], [1334, 1335, "Task"], [1338, 1340, "Method"], [1343, 1346, "Method"], [1355, 1358, "Task"], [1362, 1365, "Task"], [1387, 1389, "Metric"], [1396, 1398, "Metric"], [1405, 1407, "Method"], [1408, 1409, "Method"], [1417, 1420, "Task"], [1433, 1435, "Method"], [1436, 1438, "Task"], [1439, 1441, "Task"], [1449, 1453, "Task"], [1458, 1462, "Method"], [1480, 1485, "Task"], [1526, 1530, "Method"], [1532, 1534, "Method"], [1539, 1543, "Method"], [1554, 1558, "Metric"], [1560, 1563, "Method"], [1577, 1579, "Method"], [1592, 1595, "Method"], [1595, 1597, "Method"], [1598, 1600, "Task"], [1602, 1604, "Method"], [1628, 1631, "Method"], [1641, 1643, "Method"], [1692, 1693, "Method"], [1697, 1699, "Method"], [1729, 1732, "Method"], [1762, 1763, "Method"], [1773, 1775, "Task"], [1804, 1807, "Method"], [1874, 1876, "Method"], [1938, 1940, "Method"], [1950, 1952, "Method"], [2052, 2055, "Method"], [2076, 2078, "Method"], [2090, 2093, "Method"], [2095, 2096, "Metric"], [2097, 2099, "Metric"], [2104, 2105, "Method"], [2122, 2124, "Method"], [2148, 2150, "Method"], [2161, 2163, "Method"], [2170, 2172, "Task"], [2182, 2183, "Method"], [2202, 2203, "Task"], [2210, 2211, "Method"], [2213, 2215, "Method"], [2243, 2249, "Task"], [2284, 2286, "Method"], [2302, 2308, "Method"], [2327, 2330, "Method"], [2345, 2347, "Task"], [2352, 2354, "Task"], [2397, 2401, "Method"], [2402, 2407, "Task"], [2413, 2415, "Method"], [2429, 2431, "Method"], [2444, 2448, "Method"], [2463, 2467, "Method"], [2469, 2472, "Method"], [2476, 2478, "Method"], [2479, 2481, "Method"], [2487, 2493, "Method"], [2495, 2496, "Method"], [2506, 2510, "Task"], [2534, 2536, "Method"], [2541, 2543, "Method"], [2544, 2546, "Method"], [2548, 2551, "Method"], [2576, 2580, "Method"], [2598, 2608, "Method"], [2617, 2621, "Method"], [2689, 2690, "Method"], [2711, 2714, "Method"], [2728, 2732, "Metric"], [2739, 2741, "Task"], [2746, 2749, "Method"], [2750, 2755, "Metric"], [2765, 2769, "Method"], [2789, 2790, "Method"], [2793, 2798, "Task"], [2799, 2805, "Task"], [2806, 2810, "Task"], [2811, 2816, "Task"], [2823, 2825, "Metric"], [2909, 2915, "Task"], [2939, 2943, "Task"], [2945, 2946, "Material"], [2947, 2948, "Material"], [2949, 2954, "Task"], [2962, 2971, "Metric"], [2972, 2973, "Metric"], [2975, 2978, "Metric"], [2979, 2980, "Metric"], [3010, 3013, "Metric"], [3016, 3022, "Task"], [3026, 3032, "Task"], [3046, 3049, "Method"], [3136, 3137, "Task"], [3139, 3141, "Method"], [3193, 3195, "Method"], [3199, 3203, "Method"], [3218, 3220, "Method"], [3227, 3228, "Method"], [3240, 3244, "Method"], [3246, 3248, "Method"], [3266, 3268, "Method"], [3271, 3273, "Method"], [3299, 3301, "Method"], [3302, 3306, "Task"], [3318, 3320, "Method"], [3358, 3360, "Method"], [3393, 3396, "Method"], [3399, 3400, "Method"], [3407, 3410, "Method"], [3459, 3461, "Method"], [3530, 3531, "Method"], [3546, 3549, "Method"], [3672, 3674, "Method"], [3769, 3773, "Task"], [3777, 3781, "Task"], [3785, 3787, "Task"], [3812, 3815, "Method"], [3857, 3858, "Method"], [3867, 3870, "Method"], [3945, 3946, "Method"], [3947, 3948, "Method"], [3951, 3953, "Metric"], [3954, 3955, "Metric"], [3956, 3957, "Metric"], [3962, 3963, "Metric"], [3981, 3982, "Method"], [4004, 4005, "Method"], [4038, 4042, "Method"], [4044, 4047, "Metric"], [4058, 4062, "Task"], [4075, 4076, "Method"], [4077, 4078, "Method"], [4081, 4084, "Method"], [4122, 4124, "Method"], [4126, 4127, "Method"], [4137, 4138, "Method"], [4141, 4143, "Metric"], [4162, 4164, "Metric"], [4167, 4172, "Task"], [4205, 4207, "Method"], [4233, 4237, "Method"], [4257, 4259, "Method"], [4289, 4291, "Method"], [4292, 4293, "Method"], [4294, 4295, "Method"], [4307, 4308, "Method"], [4320, 4323, "Method"], [4333, 4334, "Task"], [4343, 4345, "Method"], [4377, 4378, "Material"], [4378, 4379, "Material"], [4381, 4382, "Task"], [4404, 4407, "Method"], [4408, 4410, "Method"], [4436, 4439, "Method"], [4442, 4444, "Method"], [4499, 4502, "Task"], [4504, 4509, "Method"], [4510, 4513, "Method"], [4543, 4546, "Method"], [4560, 4564, "Task"], [4565, 4567, "Task"], [4568, 4570, "Task"], [4572, 4573, "Method"], [4580, 4583, "Task"], [4608, 4613, "Method"], [4684, 4686, "Method"], [4687, 4689, "Method"], [4721, 4725, "Method"], [4728, 4734, "Task"], [4742, 4743, "Method"], [4744, 4747, "Method"], [4763, 4766, "Method"], [4783, 4786, "Method"], [4796, 4799, "Task"], [4803, 4810, "Method"], [4829, 4834, "Task"], [4858, 4862, "Method"], [4900, 4903, "Task"], [4904, 4906, "Task"], [4943, 4947, "Task"], [4949, 4951, "Task"], [4952, 4954, "Task"], [4955, 4957, "Task"], [4962, 4968, "Method"], [5041, 5047, "Task"], [5079, 5081, "Method"], [5082, 5083, "Method"], [5102, 5104, "Method"], [5107, 5108, "Method"], [5137, 5139, "Method"], [5160, 5162, "Method"], [5180, 5184, "Method"], [5185, 5189, "Method"], [5200, 5202, "Method"], [5217, 5221, "Task"], [5271, 5274, "Method"], [5329, 5332, "Method"], [5383, 5385, "Method"], [5450, 5456, "Task"], [5457, 5461, "Task"], [5462, 5467, "Task"], [5489, 5490, "Method"], [953, 955, "Method"], [2784, 2787, "Method"], [4159, 4160, "Metric"]], "sections": [[0, 160], [160, 1065], [1065, 1590], [1590, 1769], [1769, 1948], [1948, 2151], [2151, 2316], [2316, 2411], [2411, 2777], [2777, 2848], [2848, 3014], [3014, 3775], [3775, 4165], [4165, 4379], [4379, 4767], [4767, 4969], [4969, 4997], [4997, 5064], [5064, 5215], [5215, 5425], [5425, 5501]], "sentences": [[0, 8], [8, 30], [30, 58], [58, 71], [71, 97], [97, 128], [128, 160], [160, 163], [163, 171], [171, 215], [215, 240], [240, 282], [282, 306], [306, 324], [324, 346], [346, 370], [370, 397], [397, 418], [418, 439], [439, 468], [468, 488], [488, 525], [525, 550], [550, 571], [571, 606], [606, 626], [626, 628], [628, 639], [639, 667], [667, 685], [685, 705], [705, 730], [730, 767], [767, 807], [807, 843], [843, 877], [877, 914], [914, 936], [936, 958], [958, 1065], [1065, 1069], [1069, 1098], [1098, 1128], [1128, 1140], [1140, 1158], [1158, 1176], [1176, 1205], [1205, 1216], [1216, 1242], [1242, 1272], [1272, 1284], [1284, 1304], [1304, 1322], [1322, 1355], [1355, 1384], [1384, 1403], [1403, 1436], [1436, 1454], [1454, 1480], [1480, 1501], [1501, 1522], [1522, 1559], [1559, 1590], [1590, 1595], [1595, 1618], [1618, 1648], [1648, 1688], [1688, 1724], [1724, 1745], [1745, 1769], [1769, 1775], [1775, 1790], [1790, 1799], [1799, 1808], [1808, 1836], [1836, 1864], [1864, 1877], [1877, 1904], [1904, 1915], [1915, 1930], [1930, 1948], [1948, 1952], [1952, 1961], [1961, 1971], [1971, 1991], [1991, 2006], [2006, 2041], [2041, 2079], [2079, 2106], [2106, 2151], [2151, 2156], [2156, 2173], [2173, 2220], [2220, 2276], [2276, 2294], [2294, 2316], [2316, 2321], [2321, 2355], [2355, 2388], [2388, 2411], [2411, 2417], [2417, 2436], [2436, 2453], [2453, 2457], [2457, 2497], [2497, 2534], [2534, 2547], [2547, 2571], [2571, 2591], [2591, 2634], [2634, 2652], [2652, 2680], [2680, 2709], [2709, 2736], [2736, 2756], [2756, 2777], [2777, 2780], [2780, 2817], [2817, 2848], [2848, 2853], [2853, 2878], [2878, 2890], [2890, 2902], [2902, 2931], [2931, 2955], [2955, 2999], [2999, 3014], [3014, 3022], [3022, 3071], [3071, 3095], [3095, 3120], [3120, 3142], [3142, 3169], [3169, 3189], [3189, 3217], [3217, 3254], [3254, 3263], [3263, 3315], [3315, 3350], [3350, 3370], [3370, 3386], [3386, 3401], [3401, 3411], [3411, 3450], [3450, 3471], [3471, 3485], [3485, 3489], [3489, 3496], [3496, 3522], [3522, 3542], [3542, 3581], [3581, 3622], [3622, 3651], [3651, 3668], [3668, 3692], [3692, 3710], [3710, 3746], [3746, 3775], [3775, 3781], [3781, 3806], [3806, 3826], [3826, 3852], [3852, 3866], [3866, 3905], [3905, 3909], [3909, 3938], [3938, 3971], [3971, 3996], [3996, 4018], [4018, 4048], [4048, 4063], [4063, 4066], [4066, 4069], [4069, 4079], [4079, 4102], [4102, 4125], [4125, 4159], [4159, 4162], [4162, 4165], [4165, 4172], [4172, 4188], [4188, 4202], [4202, 4214], [4214, 4230], [4230, 4248], [4248, 4264], [4264, 4278], [4278, 4281], [4281, 4284], [4284, 4296], [4296, 4319], [4319, 4340], [4340, 4358], [4358, 4377], [4377, 4378], [4378, 4379], [4379, 4384], [4384, 4400], [4400, 4433], [4433, 4463], [4463, 4467], [4467, 4515], [4515, 4537], [4537, 4542], [4542, 4572], [4572, 4591], [4591, 4654], [4654, 4658], [4658, 4690], [4690, 4712], [4712, 4735], [4735, 4767], [4767, 4773], [4773, 4800], [4800, 4823], [4823, 4850], [4850, 4887], [4887, 4928], [4928, 4969], [4969, 4972], [4972, 4997], [4997, 5000], [5000, 5001], [5001, 5048], [5048, 5064], [5064, 5073], [5073, 5105], [5105, 5135], [5135, 5153], [5153, 5215], [5215, 5221], [5221, 5266], [5266, 5275], [5275, 5303], [5303, 5333], [5333, 5363], [5363, 5425], [5425, 5430], [5430, 5443], [5443, 5470], [5470, 5501]], "words": ["document", ":", "Image", "Reconstruction", "with", "Predictive", "Filter", "Flow", "We", "propose", "a", "simple", ",", "interpretable", "framework", "for", "solving", "a", "wide", "range", "of", "image", "reconstruction", "problems", "such", "as", "denoising", "and", "deconvolution", ".", "Given", "a", "corrupted", "input", "image", ",", "the", "model", "synthesizes", "a", "spatially", "varying", "linear", "filter", "which", ",", "when", "applied", "to", "the", "input", "image", ",", "reconstructs", "the", "desired", "output", ".", "The", "model", "parameters", "are", "learned", "using", "supervised", "or", "self", "-", "supervised", "training", ".", "We", "test", "this", "model", "on", "three", "tasks", ":", "non", "-", "uniform", "motion", "blur", "removal", ",", "lossy", "-", "compression", "artifact", "reduction", "and", "single", "image", "super", "resolution", ".", "We", "demonstrate", "that", "our", "model", "substantially", "outperforms", "state", "-", "of", "-", "the", "-", "art", "methods", "on", "all", "these", "tasks", "and", "is", "significantly", "faster", "than", "optimization", "-", "based", "approaches", "to", "deconvolution", ".", "Unlike", "models", "that", "directly", "predict", "output", "pixel", "values", ",", "the", "predicted", "filter", "flow", "is", "controllable", "and", "interpretable", ",", "which", "we", "demonstrate", "by", "visualizing", "the", "space", "of", "predicted", "filters", "for", "different", "tasks", ".", "section", ":", "Introduction", "Real", "-", "world", "images", "are", "seldom", "perfect", ".", "Practical", "engineering", "trade", "-", "offs", "entail", "that", "consumer", "photos", "are", "often", "blurry", "due", "to", "low", "-", "light", ",", "camera", "shake", "or", "object", "motion", ",", "limited", "in", "resolution", "and", "further", "degraded", "by", "image", "compression", "artifacts", "introduced", "for", "the", "sake", "of", "affordable", "transmission", "and", "storage", ".", "Scientific", "applications", "such", "as", "microscopy", "or", "astronomy", ",", "which", "push", "the", "fundamental", "physical", "limitations", "of", "light", ",", "lenses", "and", "sensors", ",", "face", "similar", "challenges", ".", "Recovering", "high", "-", "quality", "images", "from", "degraded", "measurements", "has", "been", "a", "long", "-", "standing", "problem", "for", "image", "analysis", "and", "spans", "a", "range", "of", "tasks", "such", "as", "blind", "-", "image", "deblurring", ",", "compression", "artifact", "reduction", ",", "and", "single", "image", "super", "-", "resolution", ".", "Such", "image", "reconstruction", "tasks", "can", "be", "viewed", "mathematically", "as", "inverse", "problems", ",", "which", "are", "typically", "ill", "-", "posed", "and", "massively", "under", "-", "constrained", ".", "Many", "contemporary", "techniques", "to", "inverse", "problems", "have", "focused", "on", "regularization", "techniques", "which", "are", "amenable", "to", "computational", "optimization", ".", "While", "such", "approaches", "are", "interpretable", "as", "Bayesian", "estimators", "with", "particular", "choice", "of", "priors", ",", "they", "are", "often", "computationally", "expensive", "in", "practice", ".", "Alternately", ",", "data", "-", "driven", "methods", "based", "on", "training", "deep", "convolutional", "neural", "networks", "yield", "fast", "inference", "but", "lack", "interpretability", "and", "guarantees", "of", "robustness", ".", "In", "this", "paper", ",", "we", "propose", "a", "new", "framework", "called", "Predictive", "Filter", "Flow", "that", "retains", "interpretability", "and", "control", "over", "the", "resulting", "reconstruction", "while", "allowing", "fast", "inference", ".", "The", "proposed", "framework", "is", "directly", "applicable", "to", "a", "variety", "of", "low", "-", "level", "computer", "vision", "problems", "involving", "local", "pixel", "transformations", ".", "As", "the", "name", "suggests", ",", "our", "approach", "is", "built", "on", "the", "notion", "of", "filter", "flow", "introduced", "by", "Seitz", "and", "Baker", ".", "In", "filter", "flow", "pixels", "in", "a", "local", "neighborhood", "of", "the", "input", "image", "are", "linearly", "combined", "to", "reconstruct", "the", "pixel", "centered", "at", "the", "same", "location", "in", "the", "output", "image", ".", "However", ",", "unlike", "convolution", ",", "the", "filter", "weights", "are", "allowed", "to", "vary", "from", "one", "spatial", "location", "to", "the", "next", ".", "Filter", "flows", "are", "a", "flexible", "class", "of", "image", "transformations", "that", "can", "model", "a", "wide", "range", "of", "imaging", "effects", "(", "including", "optical", "flow", ",", "lighting", "changes", ",", "non", "-", "uniform", "blur", ",", "non", "-", "parametric", "distortion", ")", ".", "The", "original", "work", "on", "filter", "flow", "focused", "on", "the", "problem", "of", "estimating", "an", "appropriately", "regularized", "/", "constrained", "flow", "between", "a", "given", "pair", "of", "images", ".", "This", "yielded", "convex", "but", "impractically", "large", "optimization", "problems", "(", "e.g.", ",", "hours", "of", "computation", "to", "compute", "a", "single", "flow", ")", ".", "Instead", "of", "solving", "for", "an", "optimal", "filter", "flow", ",", "we", "propose", "to", "directly", "predict", "a", "filter", "flow", "given", "an", "input", "image", "using", "a", "convolutional", "neural", "net", "(", "CNN", ")", "to", "regress", "the", "filter", "weights", ".", "Using", "a", "CNN", "to", "directly", "predict", "a", "well", "regularized", "solution", "is", "orders", "of", "magnitude", "faster", "than", "expensive", "iterative", "optimization", ".", "Fig", ".", "[", "reference", "]", "provides", "an", "illustration", "of", "our", "overall", "framework", ".", "Instead", "of", "estimating", "the", "flow", "between", "a", "pair", "of", "input", "images", ",", "we", "focus", "on", "applications", "where", "the", "model", "predicts", "both", "the", "flow", "and", "the", "transformed", "image", ".", "This", "can", "be", "viewed", "as", "\u201c", "blind", "\u201d", "filter", "flow", "estimation", ",", "in", "analogy", "with", "blind", "deconvolution", ".", "During", "training", ",", "we", "use", "a", "loss", "defined", "over", "the", "transformed", "image", "(", "rather", "than", "the", "predicted", "flow", ")", ".", "This", "is", "closely", "related", "to", "so", "-", "called", "self", "-", "supervised", "techniques", "that", "learn", "to", "predict", "optical", "flow", "and", "depth", "from", "unlabeled", "video", "data", ".", "Specifically", ",", "for", "the", "reconstruction", "tasks", "we", "consider", "such", "as", "image", "super", "-", "resolution", ",", "the", "forward", "degradation", "process", "can", "be", "easily", "simulated", "to", "generate", "a", "large", "quantity", "of", "training", "data", "without", "manual", "collection", "or", "annotation", ".", "The", "lack", "of", "interpretability", "in", "deep", "image", "-", "to", "-", "image", "regression", "models", "makes", "it", "hard", "to", "provide", "guarantees", "of", "robustness", "in", "the", "presence", "of", "adversarial", "input", ",", "and", "confer", "reliability", "needed", "for", "researchers", "in", "biology", "and", "medical", "science", ".", "Predictive", "filter", "flow", "differs", "from", "other", "CNN", "-", "based", "approaches", "in", "this", "regard", "since", "the", "intermediate", "filter", "flows", "are", "interpretable", "and", "transparent", ",", "providing", "an", "explicit", "description", "of", "how", "the", "input", "is", "transformed", "into", "output", ".", "It", "is", "also", "straightforward", "to", "inject", "constraints", "on", "the", "reconstruction", "(", "e.g.", ",", "local", "brightness", "conservation", ")", "which", "would", "be", "nearly", "impossible", "to", "guarantee", "for", "deep", "image", "-", "to", "-", "image", "regression", "models", ".", "To", "evaluate", "our", "model", ",", "we", "carry", "out", "extensive", "experiments", "on", "three", "different", "low", "-", "level", "vision", "tasks", ",", "non", "-", "uniform", "motion", "blur", "removal", ",", "JPEG", "compression", "artifact", "reduction", "and", "single", "image", "super", "-", "resolution", ".", "We", "show", "that", "our", "model", "surpasses", "all", "the", "state", "-", "of", "-", "the", "-", "art", "methods", "on", "all", "the", "three", "tasks", ".", "We", "also", "visualize", "the", "predicted", "filters", "which", "reveals", "filtering", "operators", "reminiscent", "of", "classic", "unsharp", "masking", "filters", "and", "anisotropic", "diffusion", "along", "boundaries", ".", "To", "summarize", "our", "contribution", ":", "(", "1", ")", "we", "propose", "a", "novel", ",", "end", "-", "to", "-", "end", "trainable", ",", "learning", "framework", "for", "solving", "various", "low", "-", "level", "image", "reconstruction", "tasks", ";", "(", "2", ")", "we", "show", "this", "framework", "is", "highly", "interpretable", "and", "controllable", ",", "enabling", "direct", "post", "-", "hoc", "analysis", "of", "how", "the", "reconstructed", "image", "is", "generated", "from", "the", "degraded", "input", ";", "(", "3", ")", "we", "show", "experimentally", "that", "predictive", "filter", "flow", "outperforms", "the", "state", "-", "of", "-", "the", "-", "art", "methods", "remarkably", "on", "the", "three", "different", "tasks", ",", "non", "-", "uniform", "motion", "blur", "removal", ",", "compression", "artifact", "reduction", "and", "single", "image", "super", "-", "resolution", ".", "section", ":", "Related", "Work", "Our", "work", "is", "inspired", "by", "filter", "flow", ",", "which", "is", "an", "optimization", "based", "method", "for", "finding", "a", "linear", "transformation", "relating", "nearby", "pixel", "values", "in", "a", "pair", "of", "images", ".", "By", "imposing", "additional", "constraints", "on", "certain", "structural", "properties", "of", "these", "filters", ",", "it", "serves", "as", "a", "general", "framework", "for", "understanding", "a", "wide", "variety", "of", "low", "-", "level", "vision", "problems", ".", "However", ",", "filter", "flow", "as", "originally", "formulated", "has", "some", "obvious", "shortcomings", ".", "First", ",", "it", "requires", "prior", "knowledge", "to", "specify", "a", "set", "of", "constraints", "needed", "to", "produce", "good", "results", ".", "It", "is", "not", "always", "straightforward", "to", "model", "or", "even", "come", "up", "with", "such", "knowledge", "-", "based", "constraints", ".", "Second", ",", "solving", "for", "an", "optimal", "filter", "flow", "is", "compute", "intensive", ";", "it", "may", "take", "up", "to", "20", "hours", "to", "compute", "over", "a", "pair", "of", "500", "500", "images", ".", "We", "address", "these", "by", "directly", "predicting", "flows", "from", "image", "data", ".", "We", "leverage", "predictive", "filter", "flow", "for", "targeting", "three", "specific", "image", "reconstruction", "tasks", "which", "can", "be", "framed", "as", "performing", "spatially", "variant", "filtering", "over", "local", "image", "patches", ".", "Non", "-", "Uniform", "Blind", "Motion", "Blur", "Removal", "is", "an", "extremely", "challenging", "yet", "practically", "significant", "task", "of", "removing", "blur", "caused", "by", "object", "motion", "or", "camera", "shake", "on", "a", "blurry", "photo", ".", "The", "blur", "kernel", "is", "unknown", "and", "may", "vary", "over", "the", "image", ".", "Recent", "methods", "estimate", "blur", "kernels", "locally", "at", "patch", "level", ",", "and", "adopt", "an", "optimization", "method", "for", "deblurring", "the", "patches", ".", "leverage", "prior", "information", "about", "smooth", "motion", "by", "selecting", "from", "a", "predefine", "discretized", "set", "of", "linear", "blur", "kernels", ".", "These", "methods", "are", "computationally", "expensive", "as", "an", "iterative", "solver", "is", "required", "for", "deconvolution", "after", "estimating", "the", "blur", "kernel", ";", "and", "the", "deep", "learning", "approach", "can", "not", "generalize", "well", "to", "novel", "motion", "kernels", ".", "Compression", "Artifact", "Reduction", "is", "of", "significance", "as", "lossy", "image", "compression", "is", "ubiquitous", "for", "reducing", "the", "size", "of", "images", "transmitted", "over", "the", "web", "and", "recorded", "on", "data", "storage", "media", ".", "However", ",", "high", "compression", "rates", "come", "with", "visual", "artifacts", "that", "degrade", "the", "image", "quality", "and", "thus", "user", "experience", ".", "Among", "various", "compression", "algorithms", ",", "JPEG", "has", "become", "the", "most", "widely", "accepted", "standard", "in", "lossy", "image", "compression", "with", "several", "(", "non", "-", "invertible", ")", "transforms", ",", "i.e.", ",", "downsampling", "and", "DCT", "quantization", ".", "Removing", "artifacts", "from", "jpeg", "compression", "can", "be", "viewed", "as", "a", "practical", "variant", "of", "natural", "image", "denoising", "problems", ".", "Recent", "methods", "based", "on", "deep", "convolutional", "neural", "networks", "trained", "to", "take", "as", "input", "the", "compressed", "image", "and", "output", "the", "denoised", "image", "directly", "achieve", "good", "performance", ".", "Single", "Image", "Super", "-", "Resolution", "aims", "at", "recovering", "a", "high", "-", "resolution", "image", "from", "a", "single", "low", "-", "resolution", "image", ".", "This", "problem", "is", "inherently", "ill", "-", "posed", "as", "a", "multiplicity", "of", "solutions", "exists", "for", "any", "given", "low", "-", "resolution", "input", ".", "Many", "methods", "adopt", "an", "example", "-", "based", "strategy", "requiring", "an", "optimization", "solver", ",", "others", "are", "based", "on", "deep", "convolutional", "neural", "nets", "which", "achieve", "the", "state", "-", "of", "-", "the", "-", "art", "and", "real", "-", "time", "performance", ".", "The", "deep", "learning", "methods", "take", "as", "input", "the", "low", "-", "resolution", "image", "(", "usually", "4", "upsampled", "one", "using", "bicubic", "interpolation", ")", ",", "and", "output", "the", "high", "-", "resolution", "image", "directly", ".", "section", ":", "Predictive", "Filter", "Flow", "Filter", "flow", "models", "image", "transformations", "as", "a", "linear", "mapping", "where", "each", "output", "pixel", "only", "depends", "on", "a", "local", "neighborhood", "of", "the", "input", ".", "Find", "such", "a", "flow", "can", "be", "framed", "as", "solving", "a", "constrained", "linear", "system", "where", "is", "a", "matrix", "whose", "rows", "act", "separately", "on", "a", "vectorized", "version", "of", "the", "source", "image", ".", "For", "the", "model", "[", "reference", "]", "to", "make", "sense", ",", "must", "serve", "as", "a", "placeholder", "for", "the", "entire", "set", "of", "additional", "constraints", "on", "the", "operator", "which", "enables", "a", "unique", "solution", "that", "satisfies", "our", "expectations", "for", "particular", "problems", "of", "interest", ".", "For", "example", ",", "standard", "convolution", "corresponds", "to", "being", "a", "circulant", "matrix", "whose", "rows", "are", "cyclic", "permutations", "of", "a", "single", "set", "of", "filter", "weights", "which", "are", "typically", "constrained", "to", "have", "compact", "localized", "non", "-", "zero", "support", ".", "For", "a", "theoretical", "perspective", ",", "Filter", "Flow", "model", "[", "reference", "]", "is", "simple", "and", "elegant", ",", "but", "directly", "solving", "Eq", ".", "[", "reference", "]", "is", "intractable", "for", "image", "sizes", "we", "typically", "encounter", "in", "practice", ",", "particularly", "when", "the", "filters", "are", "allowed", "to", "vary", "spatially", ".", "subsection", ":", "Learning", "to", "predict", "flows", "Instead", "of", "optimizing", "over", "directly", ",", "we", "seek", "for", "a", "learnable", "function", "parameterized", "by", "that", "predicts", "the", "transformation", "specific", "to", "image", "taken", "as", "input", ":", "We", "call", "this", "model", "Predictive", "Filter", "Flow", ".", "Manually", "designing", "such", "a", "function", "is", "n\u2019t", "feasible", "in", "general", ",", "therefore", "we", "learn", "a", "specific", "under", "the", "assumption", "that", "are", "drawn", "from", "some", "fixed", "joint", "distribution", ".", "Given", "sampled", "image", "pairs", ",", ",", "where", ",", "we", "seek", "parameters", "that", "minimize", "the", "difference", "between", "a", "recovered", "image", "and", "the", "real", "one", "measured", "by", "some", "loss", ".", "Note", "that", "constraints", "on", "are", "different", "from", "constraints", "used", "in", "Filter", "Flow", ".", "In", "practice", ",", "we", "enforce", "hard", "constraints", "via", "our", "choice", "of", "the", "architecture", "/", "functional", "form", "of", "along", "with", "soft", "-", "constraints", "via", "additional", "regularization", "term", ".", "We", "also", "adopt", "commonly", "used", "regularization", "on", "to", "reduce", "overfitting", ".", "There", "are", "a", "range", "of", "possible", "choices", "for", "measuring", "the", "difference", "between", "two", "images", ".", "In", "our", "experiments", ",", "we", "simply", "use", "the", "robust", "norm", "to", "measure", "the", "pixel", "-", "level", "difference", ".", "paragraph", ":", "Filter", "locality", "In", "principle", ",", "each", "pixel", "output", "in", "Eq", ".", "[", "reference", "]", "can", "depend", "on", "all", "input", "pixels", ".", "We", "introduce", "the", "structural", "constraint", "that", "each", "output", "pixel", "only", "depends", "on", "a", "corresponding", "local", "neighborhood", "of", "the", "input", ".", "The", "size", "of", "this", "neighborhood", "is", "thus", "a", "hyper", "-", "parameter", "of", "the", "model", ".", "We", "note", "that", "while", "the", "predicted", "filter", "flow", "acts", "locally", ",", "the", "estimation", "of", "the", "correct", "local", "flow", "within", "a", "patch", "can", "depend", "on", "global", "context", "captured", "by", "large", "receptive", "fields", "in", "the", "predictor", ".", "In", "practice", ",", "this", "constraint", "is", "implemented", "by", "using", "the", "\u201c", "im2col", "\u201d", "operation", "to", "vectorize", "the", "local", "neighborhood", "patch", "centered", "at", "each", "pixel", "and", "compute", "the", "inner", "product", "of", "this", "vector", "with", "the", "corresponding", "predicted", "filter", ".", "This", "operation", "is", "highly", "optimized", "for", "available", "hardware", "architectures", "in", "most", "deep", "learning", "libraries", "and", "has", "time", "and", "space", "cost", "similar", "to", "computing", "a", "single", "convolution", ".", "For", "example", ",", "if", "the", "filter", "size", "is", "20", "20", ",", "the", "last", "layer", "of", "the", "CNN", "model", "outputs", "a", "three", "-", "dimensional", "array", "with", "a", "channel", "dimension", "of", ",", "which", "is", "comparable", "to", "feature", "activations", "at", "a", "single", "layer", "of", "typical", "CNN", "architectures", ".", "paragraph", ":", "Other", "filter", "constraints", "Various", "priori", "constraints", "on", "the", "filter", "flow", "can", "be", "added", "easily", "to", "enable", "better", "model", "training", ".", "For", "example", ",", "if", "smoothness", "is", "desired", ",", "an", "regularization", "on", "the", "(", "1st", "order", "or", "2nd", "order", ")", "derivative", "of", "the", "filter", "flow", "maps", "can", "be", "inserted", "during", "training", ";", "if", "sparsity", "is", "desired", ",", "an", "regularization", "on", "the", "filter", "flows", "can", "be", "added", "easily", ".", "In", "our", "work", ",", "we", "add", "sum", "-", "to", "-", "one", "and", "non", "-", "negative", "constraints", "on", "the", "filters", "for", "the", "task", "of", "non", "-", "uniform", "motion", "blur", "removal", ",", "meaning", "that", "the", "values", "in", "each", "filter", "should", "be", "non", "-", "negative", "and", "sum", "-", "to", "-", "one", "by", "assuming", "there", "is", "no", "lighting", "change", ".", "This", "can", "be", "easily", "done", "by", "inserting", "a", "softmax", "transform", "across", "channels", "of", "the", "predicted", "filter", "weights", ".", "For", "other", "tasks", ",", "we", "simply", "let", "the", "model", "output", "free", "-", "form", "filters", "with", "no", "further", "constraints", "on", "the", "weights", ".", "paragraph", ":", "Self", "-", "Supervision", "Though", "the", "proposed", "framework", "for", "training", "Predictive", "Filter", "Flow", "requires", "paired", "inputs", "and", "target", "outputs", ",", "we", "note", "that", "generating", "training", "data", "for", "many", "reconstruction", "tasks", "can", "be", "accomplished", "automatically", "without", "manual", "labeling", ".", "Given", "a", "pool", "of", "high", "quality", "images", ",", "we", "can", "automatically", "generate", "low", "-", "resolution", ",", "blurred", "or", "JPEG", "degraded", "counterparts", "to", "use", "in", "training", "(", "see", "Section", "[", "reference", "]", ")", ".", "This", "can", "also", "be", "generalized", "to", "so", "-", "called", "self", "-", "supervised", "training", "for", "predicting", "flows", "between", "video", "frames", "or", "stereo", "pairs", ".", "subsection", ":", "Model", "Architecture", "and", "Training", "Our", "basic", "framework", "is", "largely", "agnostic", "to", "the", "choice", "of", "architectures", ",", "learning", "method", ",", "and", "loss", "functions", ".", "In", "our", "experiments", ",", "we", "utilize", "to", "a", "two", "-", "stream", "architecture", "as", "shown", "in", "Fig", ".", "[", "reference", "]", ".", "The", "first", "stream", "is", "a", "simple", "18", "-", "layer", "network", "with", "3", "3", "convolutional", "layers", ",", "skip", "connections", ",", "pooling", "layers", "and", "upsampling", "layers", ";", "the", "second", "stream", "is", "a", "shallow", "but", "full", "-", "resolution", "network", "with", "no", "pooling", ".", "The", "first", "stream", "has", "larger", "receptive", "fields", "for", "estimating", "per", "-", "pixel", "filters", "by", "considering", "long", "-", "range", "contextual", "information", ",", "while", "the", "second", "stream", "keeps", "original", "resolution", "as", "input", "image", "without", "inducing", "spatial", "information", "loss", ".", "Batch", "normalization", "is", "also", "inserted", "between", "a", "convolution", "layer", "and", "ReLU", "layer", ".", "The", "Predictive", "Filter", "Flow", "is", "self", "-", "supervised", "so", "we", "could", "generate", "an", "unlimited", "amount", "of", "image", "pairs", "for", "training", "very", "large", "models", ".", "However", ",", "we", "find", "a", "light", "-", "weight", "architecture", "trained", "over", "moderate", "-", "scale", "training", "set", "performs", "quite", "well", ".", "Since", "our", "architecture", "is", "different", "from", "other", "feed", "-", "forward", "image", "-", "to", "-", "image", "regression", "CNNs", ",", "we", "also", "report", "the", "baseline", "performance", "of", "the", "two", "-", "stream", "architecture", "trained", "to", "directly", "predict", "the", "reconstructed", "image", "rather", "than", "the", "filter", "coefficients", ".", "For", "training", ",", "we", "crop", "64", "64", "-", "resolution", "patches", "to", "form", "a", "batch", "of", "size", "56", ".", "Since", "the", "model", "adapts", "to", "patch", "boundary", "effects", "seen", "during", "training", ",", "at", "test", "time", "we", "apply", "it", "to", "non", "-", "overlapping", "tiles", "of", "the", "input", "image", ".", "However", ",", "we", "note", "that", "the", "model", "is", "fully", "convolutional", "so", "it", "could", "be", "trained", "over", "larger", "patches", "to", "avoid", "boundary", "effects", "and", "applied", "to", "arbitrary", "size", "inputs", ".", "We", "use", "ADAM", "optimization", "method", "during", "training", ",", "with", "initial", "learning", "0.0005", "and", "coefficients", "0.9", "and", "0.999", "for", "computing", "running", "averages", "of", "gradient", "and", "its", "square", ".", "As", "for", "the", "training", "loss", ",", "we", "simply", "use", "the", "-", "norm", "loss", "measuring", "absolute", "difference", "over", "pixel", "intensities", ".", "We", "train", "our", "model", "from", "scratch", "on", "a", "single", "NVIDIA", "TITAN", "X", "GPU", ",", "and", "terminate", "after", "several", "hundred", "epochs", ".", "section", ":", "Experiments", "We", "evaluate", "the", "proposed", "Predictive", "Filter", "Flow", "framework", "(", "PFF", ")", "on", "three", "low", "-", "level", "vision", "tasks", ":", "non", "-", "uniform", "motion", "blur", "removal", ",", "JPEG", "compression", "artifact", "reduction", "and", "single", "image", "super", "-", "resolution", ".", "We", "first", "describe", "the", "datasets", "and", "evaluation", "metrics", ",", "and", "then", "compare", "with", "state", "-", "of", "-", "the", "-", "art", "methods", "on", "the", "three", "tasks", "in", "separate", "subsections", ",", "respectively", ".", "subsection", ":", "Datasets", "and", "Metrics", "We", "use", "the", "high", "-", "resolution", "images", "in", "DIV2", "K", "dataset", "and", "BSDS500", "training", "set", "for", "training", "all", "our", "models", "on", "the", "three", "tasks", ".", "This", "results", "into", "a", "total", "of", "1", ",", "200", "training", "images", ".", "We", "evaluate", "each", "model", "over", "different", "datasets", "specific", "to", "the", "task", ".", "Concretely", ",", "we", "test", "our", "model", "for", "non", "-", "uniform", "motion", "blur", "removal", "over", "the", "dataset", "introduced", "in", ",", "which", "contains", "large", "motion", "blur", "up", "to", "38", "pixels", ".", "We", "evaluate", "over", "the", "classic", "LIVE1", "dataset", "for", "JPEG", "compression", "artifacts", "reduction", ",", "and", "Set5", "and", "Set14", "for", "single", "image", "super", "-", "resolution", ".", "To", "quantitatively", "measure", "performance", ",", "we", "use", "Peak", "-", "Signal", "-", "to", "-", "Noise", "-", "Ratio", "(", "PSNR", ")", "and", "Structural", "Similarity", "Index", "(", "SSIM", ")", "over", "the", "Y", "channel", "in", "YCbCr", "color", "space", "between", "the", "output", "quality", "image", "and", "the", "original", "image", ".", "This", "is", "a", "standard", "practice", "in", "literature", "for", "quantitatively", "measuring", "the", "recovered", "image", "quality", ".", "subsection", ":", "Non", "-", "Uniform", "Motion", "Blur", "Removal", "To", "train", "models", "for", "non", "-", "uniform", "motion", "blur", "removal", ",", "we", "generate", "the", "64", "64", "-", "resolution", "blurry", "patches", "from", "clear", "ones", "using", "random", "linear", "kernels", ",", "which", "are", "of", "size", "30", "30", "and", "have", "motion", "vector", "with", "random", "orientation", "in", "degrees", "and", "random", "length", "in", "pixels", ".", "We", "set", "the", "predicted", "filter", "size", "to", "be", "17", "17", "so", "the", "model", "outputs", "17", "17", "289", "filter", "weights", "at", "each", "image", "location", ".", "Note", "that", "we", "generate", "training", "pairs", "on", "the", "fly", "during", "training", ",", "so", "our", "model", "can", "deal", "with", "a", "wide", "range", "of", "motion", "blurs", ".", "This", "is", "advantageous", "over", "methods", "in", "which", "require", "a", "predefined", "set", "of", "blur", "kernels", "used", "for", "deconvolution", "through", "some", "offline", "algorithm", ".", "In", "Table", "[", "reference", "]", ",", "we", "list", "the", "comparison", "with", "the", "state", "-", "of", "-", "the", "-", "art", "methods", "over", "the", "released", "test", "set", "by", ".", "There", "are", "two", "subsets", "in", "the", "dataset", ",", "one", "with", "moderate", "motion", "blur", "and", "the", "other", "with", "large", "blur", ".", "We", "also", "report", "our", "CNN", "models", "based", "on", "the", "proposed", "two", "-", "stream", "architecture", "that", "outputs", "the", "quality", "images", "directly", "by", "taking", "as", "input", "the", "blurry", "ones", ".", "Our", "CNN", "model", "outperforms", "the", "one", "in", "which", "trains", "a", "CNN", "for", "predicting", "the", "blur", "kernel", "over", "a", "patch", ",", "but", "carries", "out", "non", "-", "blind", "deconvolution", "with", "the", "estimated", "kernel", "for", "the", "final", "quality", "image", ".", "We", "attribute", "our", "better", "performance", "to", "two", "reasons", ".", "First", ",", "our", "CNN", "model", "learns", "a", "direct", "inverse", "mapping", "from", "blurry", "patch", "to", "its", "clear", "counterpart", "based", "on", "the", "learned", "image", "distribution", ",", "whereas", "only", "estimates", "the", "blur", "kernel", "for", "the", "patch", "and", "uses", "an", "offline", "optimization", "for", "non", "-", "blind", "deblurring", ",", "resulting", "in", "some", "artifacts", "such", "as", "ringing", ".", "Second", ",", "our", "CNN", "architecture", "is", "higher", "fidelity", "than", "the", "one", "used", "in", ",", "as", "ours", "outputs", "full", "-", "resolution", "result", "and", "learns", "internally", "to", "minimize", "artifacts", ",", "e.g.", ",", "aliasing", "and", "ringing", "effect", ".", "From", "the", "table", ",", "we", "can", "see", "our", "PFF", "model", "outperforms", "all", "the", "other", "methods", "by", "a", "fair", "margin", ".", "To", "understand", "where", "our", "model", "performs", "better", ",", "we", "visualize", "the", "qualitative", "results", "in", "Fig", ".", "[", "reference", "]", ",", "along", "with", "the", "filter", "flow", "maps", "as", "output", "from", "PFF", ".", "We", "ca", "n\u2019t", "easily", "visualize", "the", "289", "dimensional", "filters", ".", "However", ",", "since", "the", "predicted", "weights", "are", "positive", "and", "normalized", ",", "we", "can", "treat", "them", "as", "a", "distribution", "which", "we", "summarize", "by", "computing", "the", "expected", "flow", "vector", "where", "is", "a", "particular", "output", "pixel", "and", "indexes", "the", "input", "pixels", ".", "This", "can", "be", "interpreted", "as", "the", "optical", "flow", "(", "delta", "filter", ")", "which", "most", "closely", "approximates", "the", "predicted", "filter", "flow", ".", "We", "use", "the", "the", "color", "legend", "shown", "in", "top", "-", "left", "of", "Fig", ".", "[", "reference", "]", ".", "The", "last", "two", "rows", "of", "Fig", ".", "[", "reference", "]", "show", "the", "results", "over", "real", "-", "world", "blurry", "images", "for", "which", "there", "is", "no", "\u201c", "blur", "-", "free", "\u201d", "ground", "-", "truth", ".", "We", "can", "clearly", "see", "that", "images", "produced", "by", "PFF", "have", "less", "artifacts", "such", "as", "ringing", "artifacts", "around", "sharp", "edges", ".", "Interestingly", ",", "from", "the", "filter", "flow", "maps", ",", "we", "can", "see", "that", "the", "expected", "flow", "vectors", "are", "large", "near", "high", "contrast", "boundaries", "and", "smaller", "in", "regions", "that", "are", "already", "in", "sharp", "focus", "or", "which", "are", "uniform", "in", "color", ".", "Although", "we", "define", "the", "filter", "size", "as", "17", "17", ",", "which", "is", "much", "smaller", "than", "the", "maximum", "shift", "in", "the", "largest", "blur", "(", "up", "to", "30", "pixels", ")", ",", "our", "model", "still", "handles", "large", "motion", "blur", "and", "performs", "better", "than", ".", "We", "assume", "it", "should", "be", "possible", "to", "utilize", "larger", "filter", "sizes", "but", "we", "did", "not", "observe", "further", "improvements", "when", "training", "models", "to", "synthesize", "larger", "per", "-", "pixel", "kernels", ".", "This", "suggests", "that", "a", "larger", "blurry", "dataset", "is", "needed", "to", "validate", "this", "point", "in", "future", "work", ".", "We", "also", "considered", "an", "iterative", "variant", "of", "our", "model", "in", "which", "we", "feed", "the", "resulting", "deblurred", "image", "back", "as", "input", "to", "the", "model", ".", "However", ",", "we", "found", "relatively", "little", "improvement", "with", "additional", "iterations", "(", "results", "shown", "in", "the", "appendix", ")", ".", "We", "conjecture", "that", ",", "although", "the", "model", "was", "trained", "with", "a", "wide", "range", "of", "blurred", "examples", ",", "the", "statistics", "of", "the", "transformed", "image", "from", "the", "first", "iteration", "are", "sufficiently", "different", "than", "the", "blurred", "training", "inputs", ".", "One", "solution", "could", "be", "inserting", "adversarial", "loss", "to", "push", "the", "model", "to", "generate", "more", "fine", "-", "grained", "textures", "(", "as", "done", "in", "for", "image", "super", "-", "resolution", ")", ".", "subsection", ":", "JPEG", "Compression", "Artifact", "Reduction", "Similar", "to", "training", "for", "image", "deblurring", ",", "we", "generate", "JPEG", "compressed", "image", "patches", "from", "original", "non", "-", "compressed", "ones", "on", "the", "fly", "during", "training", ".", "This", "can", "be", "easily", "done", "using", "JPEG", "compression", "function", "by", "varying", "the", "quality", "factor", "(", "QF", ")", "of", "interest", ".", "In", "Table", "[", "reference", "]", ",", "we", "list", "the", "performance", "of", "our", "model", "and", "compare", "to", "the", "state", "-", "of", "-", "the", "-", "art", "methods", ".", "We", "note", "that", "our", "final", "PFF", "achieves", "the", "best", "among", "all", "the", "methods", ".", "Our", "CNN", "baseline", "model", "also", "achieves", "on", "-", "par", "performance", "with", "state", "-", "of", "-", "the", "-", "art", ",", "though", "we", "do", "not", "show", "in", "the", "table", ",", "we", "draw", "the", "performance", "under", "the", "ablation", "study", "in", "Fig", ".", "[", "reference", "]", ".", "Specifically", ",", "we", "study", "how", "our", "model", "trained", "with", "single", "or", "a", "mixed", "QFs", "affect", "the", "performance", "when", "tested", "on", "image", "compressed", "with", "a", "range", "of", "different", "QFs", ".", "We", "plot", "the", "detailed", "performances", "of", "our", "CNN", "and", "PFF", "in", "terms", "of", "absolute", "measurements", "by", "PSNR", "and", "SSIM", ",", "and", "the", "increase", "in", "PSNR", "between", "the", "reconstructed", "and", "JPEG", "compressed", "image", ".", "We", "can", "see", "that", ",", "though", "a", "model", "trained", "with", "QF=10", "overfits", "the", "dataset", ",", "all", "the", "other", "models", "achieve", "generalizable", "and", "stable", "performance", ".", "Basically", ",", "a", "model", "trained", "on", "a", "single", "QF", "brings", "the", "largest", "performance", "gain", "over", "images", "compressed", "with", "the", "same", "QF", ".", "Moreover", ",", "when", "our", "model", "is", "trained", "with", "mixed", "quality", "factors", ",", "its", "performance", "is", "quite", "stable", "and", "competitive", "with", "quality", "-", "specific", "models", "across", "different", "compression", "quality", "factors", ".", "This", "indicates", "that", "our", "model", "is", "of", "practical", "value", "in", "real", "-", "world", "applications", ".", "In", "Fig", ".", "[", "reference", "]", ",", "we", "demonstrate", "qualitative", "comparison", "between", "CNN", "and", "PFF", ".", "The", "output", "filter", "flow", "maps", "indicate", "from", "the", "colorful", "edges", "how", "the", "pixels", "are", "warped", "from", "the", "neighborhood", "in", "the", "input", "image", ".", "This", "also", "clearly", "shows", "where", "the", "JPEG", "image", "degrades", "most", ",", "e.g.", ",", "the", "large", "sky", "region", "is", "quantized", "by", "JPEG", "compression", ".", "Though", "CNN", "makes", "the", "block", "effect", "smooth", "to", "some", "extent", ",", "our", "PFF", "produces", "the", "best", "visual", "quality", ",", "smoothing", "the", "block", "artifact", "while", "maintaining", "both", "high", "-", "and", "low", "-", "frequency", "details", ".", "PSNR", "improvements", ".", "SSIM", "improvements", ".", "subsection", ":", "Single", "Image", "Super", "-", "Resolution", "In", "this", "work", ",", "we", "only", "generate", "pairs", "to", "super", "-", "resolve", "images", "4", "larger", ".", "To", "generate", "training", "pairs", ",", "for", "each", "original", "image", ",", "we", "downsample", "and", "upsample", "4", "again", "using", "bicubic", "interpolation", "(", "with", "anti", "-", "aliasing", ")", ".", "The", "4", "upsampled", "image", "from", "the", "low", "-", "resolution", "is", "the", "input", "to", "our", "model", ".", "Therefore", ",", "a", "super", "-", "resolution", "model", "is", "expected", "to", "be", "learned", "for", "sharpening", "the", "input", "image", ".", "In", "Table", "[", "reference", "]", ",", "we", "compare", "our", "PFF", "model", "quantitatively", "with", "other", "methods", ".", "We", "can", "see", "that", "our", "model", "outperforms", "the", "others", "on", "both", "test", "sets", ".", "In", "Fig", ".", "[", "reference", "]", ",", "we", "compare", "visually", "over", "bicubic", "interpolation", ",", "CNN", "and", "PFF", ".", "We", "can", "see", "from", "the", "zoom", "-", "in", "regions", "that", "our", "PFF", "generates", "sharper", "boundaries", "and", "delivers", "an", "anti", "-", "aliasing", "functionality", ".", "The", "filter", "flow", "maps", "once", "again", "act", "as", "a", "guide", ",", "illustrating", "where", "the", "smoothing", "happens", "and", "where", "sharpening", "happens", ".", "Especially", ",", "the", "filter", "maps", "demonstrate", "from", "the", "strong", "colorful", "edges", "where", "the", "pixels", "undergo", "larger", "transforms", ".", "In", "next", "section", ",", "we", "visualize", "the", "per", "-", "pixel", "kernels", "to", "have", "an", "in", "-", "depth", "understanding", ".", "Set5", "Set14", "section", ":", "Visualization", "and", "Analysis", "We", "explored", "a", "number", "of", "techniques", "to", "visualize", "the", "predicted", "filter", "flows", "for", "different", "tasks", ".", "First", ",", "we", "ran", "k", "-", "means", "on", "predicted", "filters", "from", "the", "set", "of", "test", "images", "for", "each", "the", "three", "tasks", ",", "respectively", ",", "to", "cluster", "the", "kernels", "into", "=", "400", "groups", ".", "Then", "we", "run", "t", "-", "SNE", "over", "the", "400", "mean", "filters", "to", "display", "them", "in", "the", "image", "plane", ",", "shown", "by", "the", "scatter", "plots", "in", "top", "row", "of", "Fig", ".", "[", "reference", "]", ".", "Qualitative", "inspection", "shows", "filters", "that", "can", "be", "interpreted", "as", "performing", "translation", "or", "integration", "along", "lines", "of", "different", "orientation", "(", "non", "-", "uniform", "blur", ")", ",", "filling", "in", "high", "-", "frequency", "detail", "(", "jpeg", "artifact", "reduction", ")", "and", "deformed", "Laplacian", "-", "like", "filters", "(", "super", "-", "resolution", ")", ".", "We", "also", "examined", "the", "top", "10", "principal", "components", "of", "the", "predicted", "filters", "(", "shown", "in", "the", "second", "row", "grid", "in", "Fig", ".", "[", "reference", "]", ")", ".", "The", "10D", "principal", "subspace", "capture", "99.65", "%", ",", "99.99", "%", "and", "99.99", "%", "of", "the", "filter", "energy", "for", "non", "-", "uniform", "blur", ",", "artifact", "removal", "and", "super", "resolution", "respectively", ".", "PCA", "reveals", "smooth", ",", "symmetric", "harmonic", "structure", "for", "super", "-", "resolution", "with", "some", "intriguing", "vertical", "and", "horizontal", "features", ".", "Finally", ",", "in", "order", "to", "summarize", "the", "spatially", "varying", "structure", "of", "the", "filters", ",", "we", "use", "the", "2D", "t", "-", "SNE", "embedding", "to", "assign", "a", "color", "to", "each", "centroid", "(", "as", "given", "by", "the", "reference", "color", "chart", "shown", "top", "-", "left", ")", ",", "and", "visualize", "the", "nearest", "centroid", "for", "the", "filter", "at", "each", "filter", "location", "in", "the", "third", "row", "grid", "in", "Fig", ".", "[", "reference", "]", ".", "This", "visualization", "demonstrates", "the", "filters", "as", "output", "by", "our", "model", "generally", "vary", "smoothly", "over", "the", "image", "with", "discontinuities", "along", "salient", "edges", "and", "textured", "regions", "reminiscent", "of", "anisotropic", "diffusion", "or", "bilateral", "filtering", ".", "In", "summary", ",", "these", "visualizations", "provide", "a", "transparent", "view", "of", "how", "each", "reconstructed", "pixel", "is", "assembled", "from", "the", "degraded", "input", "image", ".", "We", "view", "this", "as", "a", "notable", "advantage", "over", "other", "CNN", "-", "based", "models", "which", "simply", "perform", "image", "-", "to", "-", "image", "regression", ".", "Unlike", "activations", "of", "intermediate", "layers", "of", "a", "CNN", ",", "linear", "filter", "weights", "have", "a", "well", "defined", "semantics", "that", "can", "be", "visualized", "and", "analyzed", "using", "well", "developed", "tools", "of", "linear", "signal", "processing", ".", "section", ":", "Conclusion", "and", "Future", "Work", "We", "propose", "a", "general", ",", "elegant", "and", "simple", "framework", "called", "Predictive", "Filter", "Flow", ",", "which", "has", "direct", "applications", "to", "a", "broad", "range", "of", "image", "reconstruction", "tasks", ".", "Our", "framework", "generates", "space", "-", "variant", "per", "-", "pixel", "filters", "which", "are", "easy", "to", "interpret", "and", "fast", "to", "compute", "at", "test", "time", ".", "Through", "extensive", "experiments", "over", "three", "different", "low", "-", "level", "vision", "tasks", ",", "we", "demonstrate", "this", "approach", "outperforms", "the", "state", "-", "of", "-", "the", "-", "art", "methods", ".", "In", "our", "experiments", "here", ",", "we", "only", "train", "light", "-", "weight", "models", "over", "patches", ",", "However", ",", "we", "believe", "global", "image", "context", "is", "also", "important", "for", "these", "tasks", "and", "is", "an", "obvious", "direction", "for", "future", "work", ".", "For", "example", ",", "the", "global", "blur", "structure", "conveys", "information", "about", "camera", "shake", ";", "super", "-", "resolution", "and", "compression", "reduction", "can", "benefit", "from", "long", "-", "range", "interactions", "to", "reconstruct", "high", "-", "frequency", "detail", "(", "as", "in", "non", "-", "local", "means", ")", ".", "Moreover", ",", "we", "expect", "that", "the", "interpretability", "of", "the", "output", "will", "be", "particularly", "appealing", "for", "interactive", "and", "scientific", "applications", "such", "as", "medical", "imaging", "and", "biological", "microscopy", "where", "predicted", "filters", "could", "be", "directly", "compared", "to", "physical", "models", "of", "the", "imaging", "process", ".", "section", ":", "Acknowledgement", "This", "project", "is", "supported", "by", "NSF", "grants", "IIS", "-", "1618806", ",", "IIS", "-", "1253538", ",", "DBI", "-", "1262547", "and", "a", "hardware", "donation", "from", "NVIDIA", ".", "bibliography", ":", "References", "Appendix", "In", "the", "supplementary", "material", ",", "we", "first", "show", "more", "visualizations", "to", "understand", "the", "predicted", "filter", "flows", ",", "then", "show", "if", "it", "is", "possible", "to", "refine", "the", "results", "by", "iteratively", "feeding", "deblurred", "image", "to", "the", "same", "model", "for", "the", "task", "of", "non", "-", "uniform", "motion", "blur", "removal", ".", "We", "finally", "present", "more", "qualitative", "results", "for", "all", "the", "three", "tasks", "studied", "in", "this", "paper", ".", "section", ":", "Visualization", "of", "Per", "-", "Pixel", "Loading", "Factors", "As", "a", "supplementary", "visualization", "to", "the", "principal", "components", "by", "PCA", "shown", "in", "the", "main", "paper", ",", "we", "can", "also", "visualize", "the", "per", "-", "pixel", "loading", "factors", "corresponding", "to", "each", "principal", "component", ".", "We", "run", "PCA", "over", "testing", "set", "and", "show", "the", "first", "six", "principal", "components", "and", "the", "corresponding", "per", "-", "pixel", "loading", "factors", "as", "a", "heatmap", "in", "Figure", "[", "reference", "]", ".", "With", "this", "visualization", "technique", ",", "we", "can", "know", "what", "region", "has", "higher", "response", "to", "which", "component", "kernels", ".", "Moreover", ",", "given", "that", "the", "first", "ten", "principal", "components", "capture", "filter", "energy", "(", "stated", "in", "the", "main", "paper", ")", ",", "we", "expect", "future", "work", "to", "predict", "compact", "per", "-", "pixel", "filters", "using", "low", "-", "rank", "technique", ",", "which", "allows", "for", "incorporating", "long", "-", "range", "pixels", "through", "large", "predictive", "filters", "while", "with", "compact", "features", "(", "thus", "memory", "consumption", "is", "reduced", "largely", ")", ".", "section", ":", "Iteratively", "Removing", "Motion", "Blur", "As", "the", "deblurred", "images", "are", "still", "not", "perfect", ",", "we", "are", "interested", "in", "studying", "if", "we", "can", "improve", "performance", "by", "iteratively", "running", "the", "model", ",", "i.e.", ",", "feeding", "the", "deblurred", "image", "as", "input", "to", "the", "same", "model", "one", "more", "time", "to", "get", "the", "result", ".", "We", "denote", "this", "method", "as", "PFF", "+", "1", ".", "Not", "much", "surprisingly", ",", "we", "do", "not", "observe", "further", "improvement", "as", "listed", "in", "Figure", "[", "reference", "]", ",", "instead", ",", "such", "a", "practice", "even", "hurts", "performance", "slightly", ".", "The", "qualitative", "results", "are", "shown", "in", "Figure", "[", "reference", "]", ",", "from", "which", "we", "can", "see", "the", "second", "run", "does", "not", "generate", "much", "change", "through", "the", "filter", "flow", "maps", ".", "We", "believe", "the", "reason", "is", "that", ",", "the", "deblurred", "images", "have", "different", "statistics", "from", "the", "original", "blurry", "input", ",", "and", "the", "model", "is", "not", "trained", "with", "such", "deblurred", "images", ".", "Therefore", ",", "it", "suggests", "two", "natural", "directions", "as", "future", "work", "for", "improving", "the", "results", ",", "1", ")", "training", "explicitly", "with", "recurrent", "loops", "with", "multiple", "losses", "to", "improve", "the", "performance", ",", "similar", "to", ",", "or", "2", ")", "simultaneously", "inserting", "an", "adversarial", "loss", "to", "force", "the", "model", "to", "hallucinate", "details", "for", "realistic", "output", ",", "which", "can", "be", "useful", "in", "practice", "as", "done", "in", ".", "section", ":", "More", "Qualitative", "Results", "In", "Figure", "[", "reference", "]", ",", "[", "reference", "]", "and", "[", "reference", "]", ",", "we", "show", "more", "qualitative", "results", "for", "non", "-", "uniform", "motion", "blur", "removal", ",", "JPEG", "compression", "artifact", "reduction", "and", "single", "image", "super", "-", "resolution", ",", "respectively", ".", "From", "these", "comparisons", "and", "with", "the", "guide", "of", "filter", "flow", "maps", ",", "we", "can", "see", "at", "what", "regions", "our", "PFF", "pays", "attention", "to", "and", "how", "it", "outperforms", "the", "other", "methods", "."]}