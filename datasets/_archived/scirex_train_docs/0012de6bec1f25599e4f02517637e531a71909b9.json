{"coref": {"Dice-based_loss": [[875, 878], [1907, 1909], [1924, 1926], [1958, 1959], [2813, 2816], [2827, 2830], [129, 130], [1751, 1752], [2550, 2551]], "Dice_Score": [[2568, 2569]], "PROMISE_2012": [[2362, 2367], [2581, 2583], [2959, 2962]], "V-Net": [[2, 5], [79, 86], [665, 668], [768, 773], [826, 830], [1243, 1246], [2481, 2484]], "V-Net___Dice-based_loss": [], "Volumetric_Medical_Image_Segmentation": [[11, 15], [73, 76], [106, 107], [246, 247], [329, 330], [390, 392], [513, 516], [817, 820], [1450, 1454], [2518, 2519], [2787, 2792]]}, "coref_non_salient": {"0": [[2152, 2153], [2155, 2156]], "1": [[363, 364], [378, 380], [1894, 1895]], "10": [[15, 18], [232, 235], [741, 746], [928, 931], [7, 10], [2782, 2785]], "11": [[19, 20], [88, 89], [236, 237], [270, 271], [507, 508], [635, 636], [792, 794], [1213, 1214], [1509, 1510], [1592, 1593], [1678, 1679], [2045, 2046]], "12": [[934, 935], [987, 988], [1116, 1117], [1149, 1150], [1264, 1266]], "13": [[340, 348], [520, 522]], "14": [[596, 598], [1257, 1259], [1755, 1757]], "15": [[2195, 2199]], "16": [[763, 765]], "17": [[294, 296], [1386, 1388], [1666, 1668]], "18": [[1350, 1353], [1512, 1516]], "19": [[359, 362], [376, 377], [477, 478]], "2": [[274, 276], [2025, 2028]], "20": [[1122, 1124], [1151, 1154]], "21": [[705, 707], [732, 735]], "22": [[1879, 1883], [2029, 2033], [2833, 2837]], "23": [[173, 178], [2413, 2415]], "24": [[2624, 2626]], "25": [[648, 650]], "26": [[1636, 1638]], "27": [[31, 33], [222, 224], [684, 686]], "28": [[1903, 1905], [2803, 2805]], "29": [[2749, 2751]], "3": [[225, 227], [244, 245], [779, 781]], "30": [[1018, 1020], [1052, 1054], [1072, 1074], [1222, 1224], [1292, 1294], [1464, 1466], [1537, 1539], [1572, 1574], [2299, 2301]], "31": [[1355, 1359]], "32": [[1335, 1338]], "33": [[365, 369]], "34": [[572, 576]], "35": [[2216, 2218]], "36": [[2465, 2467]], "37": [[1833, 1835]], "38": [[205, 207], [1648, 1650], [2885, 2887]], "39": [[970, 972], [1239, 1241]], "4": [[34, 38], [336, 339], [687, 690], [799, 803]], "40": [[863, 865], [2621, 2623]], "41": [[1208, 1212]], "42": [[613, 616]], "43": [[1195, 1197], [1289, 1291]], "44": [[605, 607]], "45": [[2557, 2559]], "46": [[125, 126], [2809, 2810]], "47": [[659, 661]], "48": [[179, 181], [2242, 2244]], "49": [[2553, 2555]], "5": [[1495, 1499], [1777, 1781], [2303, 2306]], "50": [[578, 581]], "51": [[624, 626]], "52": [[248, 250]], "53": [[492, 494]], "54": [[993, 994]], "55": [[356, 358]], "56": [[2707, 2712]], "57": [[2614, 2616]], "58": [[2714, 2716]], "59": [[1360, 1361]], "6": [[601, 604], [1485, 1487]], "60": [[556, 557]], "61": [[1875, 1877]], "62": [[2606, 2607]], "7": [[118, 120], [871, 873]], "8": [[528, 533], [617, 621]], "9": [[465, 467], [786, 787], [1697, 1702], [2852, 2855]]}, "doc_id": "0012de6bec1f25599e4f02517637e531a71909b9", "method_subrelations": {"V-Net___Dice-based_loss": [[[0, 5], "V-Net"], [[8, 23], "Dice-based_loss"]]}, "n_ary_relations": [{"Material": "PROMISE_2012", "Method": "V-Net___Dice-based_loss", "Metric": "Dice_Score", "Task": "Volumetric_Medical_Image_Segmentation", "score": "0.869"}], "ner": [[2, 5, "Method"], [11, 15, "Task"], [15, 18, "Method"], [19, 20, "Method"], [31, 33, "Task"], [34, 38, "Task"], [73, 76, "Task"], [79, 86, "Method"], [88, 89, "Method"], [106, 107, "Task"], [118, 120, "Method"], [125, 126, "Task"], [173, 178, "Method"], [179, 181, "Method"], [205, 207, "Metric"], [222, 224, "Task"], [225, 227, "Task"], [232, 235, "Method"], [236, 237, "Method"], [244, 245, "Task"], [246, 247, "Task"], [248, 250, "Task"], [270, 271, "Method"], [274, 276, "Method"], [294, 296, "Method"], [329, 330, "Task"], [336, 339, "Task"], [340, 348, "Task"], [356, 358, "Task"], [359, 362, "Task"], [363, 364, "Task"], [365, 369, "Task"], [376, 377, "Task"], [378, 380, "Task"], [390, 392, "Task"], [465, 467, "Task"], [477, 478, "Task"], [492, 494, "Task"], [507, 508, "Method"], [513, 516, "Task"], [520, 522, "Task"], [528, 533, "Method"], [556, 557, "Task"], [572, 576, "Method"], [578, 581, "Method"], [596, 598, "Method"], [601, 604, "Method"], [605, 607, "Method"], [613, 616, "Method"], [617, 621, "Method"], [624, 626, "Metric"], [635, 636, "Method"], [648, 650, "Metric"], [659, 661, "Method"], [665, 668, "Method"], [684, 686, "Task"], [687, 690, "Task"], [705, 707, "Method"], [732, 735, "Method"], [741, 746, "Method"], [763, 765, "Method"], [768, 773, "Method"], [779, 781, "Task"], [786, 787, "Task"], [792, 794, "Method"], [799, 803, "Task"], [817, 820, "Task"], [826, 830, "Method"], [863, 865, "Task"], [871, 873, "Method"], [875, 878, "Method"], [928, 931, "Method"], [934, 935, "Method"], [970, 972, "Method"], [987, 988, "Method"], [993, 994, "Method"], [1018, 1020, "Method"], [1052, 1054, "Method"], [1072, 1074, "Method"], [1116, 1117, "Method"], [1122, 1124, "Method"], [1149, 1150, "Method"], [1151, 1154, "Method"], [1195, 1197, "Method"], [1208, 1212, "Method"], [1213, 1214, "Method"], [1222, 1224, "Method"], [1239, 1241, "Method"], [1243, 1246, "Method"], [1257, 1259, "Method"], [1264, 1266, "Method"], [1289, 1291, "Method"], [1292, 1294, "Method"], [1335, 1338, "Method"], [1350, 1353, "Method"], [1355, 1359, "Method"], [1360, 1361, "Method"], [1386, 1388, "Method"], [1450, 1454, "Task"], [1464, 1466, "Method"], [1485, 1487, "Method"], [1495, 1499, "Method"], [1509, 1510, "Method"], [1512, 1516, "Method"], [1537, 1539, "Method"], [1572, 1574, "Method"], [1592, 1593, "Method"], [1636, 1638, "Task"], [1648, 1650, "Metric"], [1666, 1668, "Method"], [1678, 1679, "Method"], [1697, 1702, "Task"], [1755, 1757, "Method"], [1777, 1781, "Method"], [1833, 1835, "Method"], [1875, 1877, "Method"], [1879, 1883, "Method"], [1894, 1895, "Task"], [1903, 1905, "Metric"], [1907, 1909, "Method"], [1924, 1926, "Method"], [1958, 1959, "Method"], [2025, 2028, "Method"], [2029, 2033, "Method"], [2045, 2046, "Method"], [2152, 2153, "Metric"], [2155, 2156, "Metric"], [2195, 2199, "Method"], [2216, 2218, "Task"], [2242, 2244, "Method"], [2299, 2301, "Method"], [2303, 2306, "Method"], [2362, 2367, "Material"], [2413, 2415, "Method"], [2465, 2467, "Metric"], [2481, 2484, "Method"], [2518, 2519, "Task"], [2553, 2555, "Metric"], [2557, 2559, "Metric"], [2568, 2569, "Metric"], [2581, 2583, "Material"], [2606, 2607, "Method"], [2614, 2616, "Method"], [2621, 2623, "Task"], [2624, 2626, "Method"], [2707, 2712, "Method"], [2714, 2716, "Method"], [2749, 2751, "Method"], [2787, 2792, "Task"], [2803, 2805, "Metric"], [2809, 2810, "Task"], [2813, 2816, "Method"], [2827, 2830, "Method"], [2833, 2837, "Method"], [2852, 2855, "Task"], [2885, 2887, "Metric"], [2959, 2962, "Material"], [7, 10, "Method"], [129, 130, "Method"], [1751, 1752, "Method"], [2550, 2551, "Method"], [2782, 2785, "Method"]], "sections": [[0, 213], [213, 913], [913, 1749], [1749, 2041], [2041, 2270], [2270, 2340], [2340, 2771], [2771, 2916], [2916, 2973], [2973, 2976]], "sentences": [[0, 15], [15, 39], [39, 65], [65, 87], [87, 114], [114, 132], [132, 155], [155, 182], [182, 213], [213, 219], [219, 261], [261, 287], [287, 307], [307, 329], [329, 340], [340, 372], [372, 408], [408, 420], [420, 449], [449, 465], [465, 507], [507, 517], [517, 534], [534, 572], [572, 617], [617, 627], [627, 653], [653, 665], [665, 691], [691, 727], [727, 766], [766, 809], [809, 843], [843, 858], [858, 867], [867, 885], [885, 913], [913, 916], [916, 932], [932, 961], [961, 987], [987, 995], [995, 1012], [1012, 1021], [1021, 1086], [1086, 1115], [1115, 1128], [1128, 1145], [1145, 1164], [1164, 1188], [1188, 1225], [1225, 1279], [1279, 1288], [1288, 1360], [1360, 1389], [1389, 1419], [1419, 1455], [1455, 1500], [1500, 1551], [1551, 1575], [1575, 1598], [1598, 1611], [1611, 1639], [1639, 1654], [1654, 1689], [1689, 1749], [1749, 1754], [1754, 1796], [1796, 1829], [1829, 1856], [1856, 1870], [1870, 1896], [1896, 1923], [1923, 1955], [1955, 1977], [1977, 2036], [2036, 2041], [2041, 2044], [2044, 2062], [2062, 2079], [2079, 2098], [2098, 2136], [2136, 2161], [2161, 2200], [2200, 2229], [2229, 2270], [2270, 2273], [2273, 2294], [2294, 2317], [2317, 2340], [2340, 2343], [2343, 2368], [2368, 2386], [2386, 2404], [2404, 2431], [2431, 2457], [2457, 2479], [2479, 2496], [2496, 2524], [2524, 2542], [2542, 2585], [2585, 2597], [2597, 2601], [2601, 2627], [2627, 2649], [2649, 2653], [2653, 2673], [2673, 2700], [2700, 2726], [2726, 2759], [2759, 2767], [2767, 2771], [2771, 2774], [2774, 2799], [2799, 2826], [2826, 2856], [2856, 2888], [2888, 2916], [2916, 2919], [2919, 2973], [2973, 2976]], "words": ["document", ":", "V", "-", "Net", ":", "Fully", "Convolutional", "Neural", "Networks", "for", "Volumetric", "Medical", "Image", "Segmentation", "Convolutional", "Neural", "Networks", "(", "CNNs", ")", "have", "been", "recently", "employed", "to", "solve", "problems", "from", "both", "the", "computer", "vision", "and", "medical", "image", "analysis", "fields", ".", "Despite", "their", "popularity", ",", "most", "approaches", "are", "only", "able", "to", "process", "2D", "images", "while", "most", "medical", "data", "used", "in", "clinical", "practice", "consists", "of", "3D", "volumes", ".", "In", "this", "work", "we", "propose", "an", "approach", "to", "3D", "image", "segmentation", "based", "on", "a", "volumetric", ",", "fully", "convolutional", ",", "neural", "network", ".", "Our", "CNN", "is", "trained", "end", "-", "to", "-", "end", "on", "MRI", "volumes", "depicting", "prostate", ",", "and", "learns", "to", "predict", "segmentation", "for", "the", "whole", "volume", "at", "once", ".", "We", "introduce", "a", "novel", "objective", "function", ",", "that", "we", "optimise", "during", "training", ",", "based", "on", "Dice", "coefficient", ".", "In", "this", "way", "we", "can", "deal", "with", "situations", "where", "there", "is", "a", "strong", "imbalance", "between", "the", "number", "of", "foreground", "and", "background", "voxels", ".", "To", "cope", "with", "the", "limited", "number", "of", "annotated", "volumes", "available", "for", "training", ",", "we", "augment", "the", "data", "applying", "random", "non", "-", "linear", "transformations", "and", "histogram", "matching", ".", "We", "show", "in", "our", "experimental", "evaluation", "that", "our", "approach", "achieves", "good", "performances", "on", "challenging", "test", "data", "while", "requiring", "only", "a", "fraction", "of", "the", "processing", "time", "needed", "by", "other", "previous", "methods", ".", "section", ":", "Introduction", "and", "Related", "Work", "Recent", "research", "in", "computer", "vision", "and", "pattern", "recognition", "has", "highlighted", "the", "capabilities", "of", "Convolutional", "Neural", "Networks", "(", "CNNs", ")", "to", "solve", "challenging", "tasks", "such", "as", "classification", ",", "segmentation", "and", "object", "detection", ",", "achieving", "state", "-", "of", "-", "the", "-", "art", "performances", ".", "This", "success", "has", "been", "attributed", "to", "the", "ability", "of", "CNNs", "to", "learn", "a", "hierarchical", "representation", "of", "raw", "input", "data", ",", "without", "relying", "on", "handcrafted", "features", ".", "As", "the", "inputs", "are", "processed", "through", "the", "network", "layers", ",", "the", "level", "of", "abstraction", "of", "the", "resulting", "features", "increases", ".", "Shallower", "layers", "grasp", "local", "information", "while", "deeper", "layers", "use", "filters", "whose", "receptive", "fields", "are", "much", "broader", "that", "therefore", "capture", "global", "information", ".", "Segmentation", "is", "a", "highly", "relevant", "task", "in", "medical", "image", "analysis", ".", "Automatic", "delineation", "of", "organs", "and", "structures", "of", "interest", "is", "often", "necessary", "to", "perform", "tasks", "such", "as", "visual", "augmentation", ",", "computer", "assisted", "diagnosis", ",", "interventions", "and", "extraction", "of", "quantitative", "indices", "from", "images", ".", "In", "particular", ",", "since", "diagnostic", "and", "interventional", "imagery", "often", "consists", "of", "3D", "images", ",", "being", "able", "to", "perform", "volumetric", "segmentations", "by", "taking", "into", "account", "the", "whole", "volume", "content", "at", "once", ",", "has", "a", "particular", "relevance", ".", "In", "this", "work", ",", "we", "aim", "to", "segment", "prostate", "MRI", "volumes", ".", "This", "is", "a", "challenging", "task", "due", "to", "the", "wide", "range", "of", "appearance", "the", "prostate", "can", "assume", "in", "different", "scans", "due", "to", "deformations", "and", "variations", "of", "the", "intensity", "distribution", ".", "Moreover", ",", "MRI", "volumes", "are", "often", "affected", "by", "artefacts", "and", "distortions", "due", "to", "field", "inhomogeneity", ".", "Prostate", "segmentation", "is", "nevertheless", "an", "important", "task", "having", "clinical", "relevance", "both", "during", "diagnosis", ",", "where", "the", "volume", "of", "the", "prostate", "needs", "to", "be", "assessed", ",", "and", "during", "treatment", "planning", ",", "where", "the", "estimate", "of", "the", "anatomical", "boundary", "needs", "to", "be", "accurate", ".", "CNNs", "have", "been", "recently", "used", "for", "medical", "image", "segmentation", ".", "Early", "approaches", "obtain", "anatomy", "delineation", "in", "images", "or", "volumes", "by", "performing", "patch", "-", "wise", "image", "classification", ".", "Such", "segmentations", "are", "obtained", "by", "only", "considering", "local", "context", "and", "therefore", "are", "prone", "to", "failure", ",", "especially", "in", "challenging", "modalities", "such", "as", "ultrasound", ",", "where", "a", "high", "number", "of", "mis", "-", "classified", "voxel", "are", "to", "be", "expected", ".", "Post", "-", "processing", "approaches", "such", "as", "connected", "components", "analysis", "normally", "yield", "no", "improvement", "and", "therefore", ",", "more", "recent", "works", ",", "propose", "to", "use", "the", "network", "predictions", "in", "combination", "with", "Markov", "random", "fields", ",", "voting", "strategies", "or", "more", "traditional", "approaches", "such", "as", "level", "-", "sets", ".", "Patch", "-", "wise", "approaches", "also", "suffer", "from", "efficiency", "issues", ".", "When", "densely", "extracted", "patches", "are", "processed", "in", "a", "CNN", ",", "a", "high", "number", "of", "computations", "is", "redundant", "and", "therefore", "the", "total", "algorithm", "runtime", "is", "high", ".", "In", "this", "case", ",", "more", "efficient", "computational", "schemes", "can", "be", "adopted", ".", "Fully", "convolutional", "network", "trained", "end", "-", "to", "-", "end", "were", "so", "far", "applied", "only", "to", "2D", "images", "both", "in", "computer", "vision", "and", "microscopy", "image", "analysis", ".", "These", "models", ",", "which", "served", "as", "an", "inspiration", "for", "our", "work", ",", "employed", "different", "network", "architectures", "and", "were", "trained", "to", "predict", "a", "segmentation", "mask", ",", "delineating", "the", "structures", "of", "interest", ",", "for", "the", "whole", "image", ".", "In", "a", "pre", "-", "trained", "VGG", "network", "architecture", "was", "used", "in", "conjunction", "with", "its", "mirrored", ",", "de", "-", "convolutional", ",", "equivalent", "to", "segment", "RGB", "images", "by", "leveraging", "the", "descriptive", "power", "of", "the", "features", "extracted", "by", "the", "innermost", "layer", ".", "In", "three", "fully", "convolutional", "deep", "neural", "networks", ",", "pre", "-", "trained", "on", "a", "classification", "task", ",", "were", "refined", "to", "produce", "segmentations", "while", "in", "a", "brand", "new", "CNN", "model", ",", "especially", "tailored", "to", "tackle", "biomedical", "image", "analysis", "problems", "in", "2D", ",", "was", "proposed", ".", "In", "this", "work", "we", "present", "our", "approach", "to", "medical", "image", "segmentation", "that", "leverages", "the", "power", "of", "a", "fully", "convolutional", "neural", "networks", ",", "trained", "end", "-", "to", "-", "end", ",", "to", "process", "MRI", "volumes", ".", "Differently", "from", "other", "recent", "approaches", "we", "refrain", "from", "processing", "the", "input", "volumes", "slice", "-", "wise", "and", "we", "propose", "to", "use", "volumetric", "convolutions", "instead", ".", "We", "propose", "a", "novel", "objective", "function", "based", "on", "Dice", "coefficient", "maximisation", ",", "that", "we", "optimise", "during", "training", ".", "We", "demonstrate", "fast", "and", "accurate", "results", "on", "prostate", "MRI", "test", "volumes", "and", "we", "provide", "direct", "comparison", "with", "other", "methods", "which", "were", "evaluated", "on", "the", "same", "test", "data", ".", "section", ":", "Method", "In", "Figure", "[", "reference", "]", "we", "provide", "a", "schematic", "representation", "of", "our", "convolutional", "neural", "network", ".", "We", "perform", "convolutions", "aiming", "to", "both", "extract", "features", "from", "the", "data", "and", ",", "at", "the", "end", "of", "each", "stage", ",", "to", "reduce", "its", "resolution", "by", "using", "appropriate", "stride", ".", "The", "left", "part", "of", "the", "network", "consists", "of", "a", "compression", "path", ",", "while", "the", "right", "part", "decompresses", "the", "signal", "until", "its", "original", "size", "is", "reached", ".", "Convolutions", "are", "all", "applied", "with", "appropriate", "padding", ".", "The", "left", "side", "of", "the", "network", "is", "divided", "in", "different", "stages", "that", "operate", "at", "different", "resolutions", ".", "Each", "stage", "comprises", "one", "to", "three", "convolutional", "layers", ".", "Similarly", "to", "the", "approach", "presented", "in", ",", "we", "formulate", "each", "stage", "such", "that", "it", "learns", "a", "residual", "function", ":", "the", "input", "of", "each", "stage", "is", "(", "a", ")", "used", "in", "the", "convolutional", "layers", "and", "processed", "through", "the", "non", "-", "linearities", "and", "(", "b", ")", "added", "to", "the", "output", "of", "the", "last", "convolutional", "layer", "of", "that", "stage", "in", "order", "to", "enable", "learning", "a", "residual", "function", ".", "As", "confirmed", "by", "our", "empirical", "observations", ",", "this", "architecture", "ensures", "convergence", "in", "a", "fraction", "of", "the", "time", "required", "by", "a", "similar", "network", "that", "does", "not", "learn", "residual", "functions", ".", "The", "convolutions", "performed", "in", "each", "stage", "use", "volumetric", "kernels", "having", "size", "voxels", ".", "As", "the", "data", "proceeds", "through", "different", "stages", "along", "the", "compression", "path", ",", "its", "resolution", "is", "reduced", ".", "This", "is", "performed", "through", "convolution", "with", "voxels", "wide", "kernels", "applied", "with", "stride", "(", "Figure", "[", "reference", "]", ")", ".", "Since", "the", "second", "operation", "extracts", "features", "by", "considering", "only", "non", "overlapping", "volume", "patches", ",", "the", "size", "of", "the", "resulting", "feature", "maps", "is", "halved", ".", "This", "strategy", "serves", "a", "similar", "purpose", "as", "pooling", "layers", "that", ",", "motivated", "by", "and", "other", "works", "discouraging", "the", "use", "of", "max", "-", "pooling", "operations", "in", "CNNs", ",", "have", "been", "replaced", "in", "our", "approach", "by", "convolutional", "ones", ".", "Moreover", ",", "since", "the", "number", "of", "feature", "channels", "doubles", "at", "each", "stage", "of", "the", "compression", "path", "of", "the", "V", "-", "Net", ",", "and", "due", "to", "the", "formulation", "of", "the", "model", "as", "a", "residual", "network", ",", "we", "resort", "to", "these", "convolution", "operations", "to", "double", "the", "number", "of", "feature", "maps", "as", "we", "reduce", "their", "resolution", ".", "PReLu", "non", "linearities", "are", "applied", "throughout", "the", "network", ".", "Replacing", "pooling", "operations", "with", "convolutional", "ones", "results", "also", "to", "networks", "that", ",", "depending", "on", "the", "specific", "implementation", ",", "can", "have", "a", "smaller", "memory", "footprint", "during", "training", ",", "due", "to", "the", "fact", "that", "no", "switches", "mapping", "the", "output", "of", "pooling", "layers", "back", "to", "their", "inputs", "are", "needed", "for", "back", "-", "propagation", ",", "and", "that", "can", "be", "better", "understood", "and", "analysed", "by", "applying", "only", "de", "-", "convolutions", "instead", "of", "un", "-", "pooling", "operations", ".", "Downsampling", "allows", "us", "to", "reduce", "the", "size", "of", "the", "signal", "presented", "as", "input", "and", "to", "increase", "the", "receptive", "field", "of", "the", "features", "being", "computed", "in", "subsequent", "network", "layers", ".", "Each", "of", "the", "stages", "of", "the", "left", "part", "of", "the", "network", ",", "computes", "a", "number", "of", "features", "which", "is", "two", "times", "higher", "than", "the", "one", "of", "the", "previous", "layer", ".", "The", "right", "portion", "of", "the", "network", "extracts", "features", "and", "expands", "the", "spatial", "support", "of", "the", "lower", "resolution", "feature", "maps", "in", "order", "to", "gather", "and", "assemble", "the", "necessary", "information", "to", "output", "a", "two", "channel", "volumetric", "segmentation", ".", "The", "two", "features", "maps", "computed", "by", "the", "very", "last", "convolutional", "layer", ",", "having", "kernel", "size", "and", "producing", "outputs", "of", "the", "same", "size", "as", "the", "input", "volume", ",", "are", "converted", "to", "probabilistic", "segmentations", "of", "the", "foreground", "and", "background", "regions", "by", "applying", "soft", "-", "max", "voxelwise", ".", "After", "each", "stage", "of", "the", "right", "portion", "of", "the", "CNN", ",", "a", "de", "-", "convolution", "operation", "is", "employed", "in", "order", "increase", "the", "size", "of", "the", "inputs", "(", "Figure", "[", "reference", "]", ")", "followed", "by", "one", "to", "three", "convolutional", "layers", "involving", "half", "the", "number", "of", "kernels", "employed", "in", "the", "previous", "layer", ".", "Similar", "to", "the", "left", "part", "of", "the", "network", ",", "also", "in", "this", "case", "we", "resort", "to", "learn", "residual", "functions", "in", "the", "convolutional", "stages", ".", "Similarly", "to", ",", "we", "forward", "the", "features", "extracted", "from", "early", "stages", "of", "the", "left", "part", "of", "the", "CNN", "to", "the", "right", "part", ".", "This", "is", "schematically", "represented", "in", "Figure", "[", "reference", "]", "by", "horizontal", "connections", ".", "In", "this", "way", "we", "gather", "fine", "grained", "detail", "that", "would", "be", "otherwise", "lost", "in", "the", "compression", "path", "and", "we", "improve", "the", "quality", "of", "the", "final", "contour", "prediction", ".", "We", "also", "observed", "that", "when", "these", "connections", "improve", "the", "convergence", "time", "of", "the", "model", ".", "We", "report", "in", "Table", "[", "reference", "]", "the", "receptive", "fields", "of", "each", "network", "layer", ",", "showing", "the", "fact", "that", "the", "innermost", "portion", "of", "our", "CNN", "already", "captures", "the", "content", "of", "the", "whole", "input", "volume", ".", "We", "believe", "that", "this", "characteristic", "is", "important", "during", "segmentation", "of", "poorly", "visible", "anatomy", ":", "the", "features", "computed", "in", "the", "deepest", "layer", "perceive", "the", "whole", "anatomy", "of", "interest", "at", "once", ",", "since", "they", "are", "computed", "from", "data", "having", "a", "spatial", "support", "much", "larger", "than", "the", "typical", "size", "of", "the", "anatomy", "we", "seek", "to", "delineate", ",", "and", "therefore", "impose", "global", "constraints", ".", "section", ":", "Dice", "loss", "layer", "The", "network", "predictions", ",", "which", "consist", "of", "two", "volumes", "having", "the", "same", "resolution", "as", "the", "original", "input", "data", ",", "are", "processed", "through", "a", "soft", "-", "max", "layer", "which", "outputs", "the", "probability", "of", "each", "voxel", "to", "belong", "to", "foreground", "and", "to", "background", ".", "In", "medical", "volumes", "such", "as", "the", "ones", "we", "are", "processing", "in", "this", "work", ",", "it", "is", "not", "uncommon", "that", "the", "anatomy", "of", "interest", "occupies", "only", "a", "very", "small", "region", "of", "the", "scan", ".", "This", "often", "causes", "the", "learning", "process", "to", "get", "trapped", "in", "local", "minima", "of", "the", "loss", "function", "yielding", "a", "network", "whose", "predictions", "are", "strongly", "biased", "towards", "background", ".", "As", "a", "result", "the", "foreground", "region", "is", "often", "missing", "or", "only", "partially", "detected", ".", "Several", "previous", "approaches", "resorted", "to", "loss", "functions", "based", "on", "sample", "re", "-", "weighting", "where", "foreground", "regions", "are", "given", "more", "importance", "than", "background", "ones", "during", "learning", ".", "In", "this", "work", "we", "propose", "a", "novel", "objective", "function", "based", "on", "dice", "coefficient", ",", "which", "is", "a", "quantity", "ranging", "between", "and", "which", "we", "aim", "to", "maximise", ".", "The", "dice", "coefficient", "between", "two", "binary", "volumes", "can", "be", "written", "as", "where", "the", "sums", "run", "over", "the", "voxels", ",", "of", "the", "predicted", "binary", "segmentation", "volume", "and", "the", "ground", "truth", "binary", "volume", ".", "This", "formulation", "of", "Dice", "can", "be", "differentiated", "yielding", "the", "gradient", "computed", "with", "respect", "to", "the", "-", "th", "voxel", "of", "the", "prediction", ".", "Using", "this", "formulation", "we", "do", "not", "need", "to", "assign", "weights", "to", "samples", "of", "different", "classes", "to", "establish", "the", "right", "balance", "between", "foreground", "and", "background", "voxels", ",", "and", "we", "obtain", "results", "that", "we", "experimentally", "observed", "are", "much", "better", "than", "the", "ones", "computed", "through", "the", "same", "network", "trained", "optimising", "a", "multinomial", "logistic", "loss", "with", "sample", "re", "-", "weighting", "(", "Fig", ".", "[", "reference", "]", ")", ".", "subsection", ":", "Training", "Our", "CNN", "is", "trained", "end", "-", "to", "-", "end", "on", "a", "dataset", "of", "prostate", "scans", "in", "MRI", ".", "An", "example", "of", "the", "typical", "content", "of", "such", "volumes", "is", "shown", "in", "Figure", "[", "reference", "]", ".", "All", "the", "volumes", "processed", "by", "the", "network", "have", "fixed", "size", "of", "voxels", "and", "a", "spatial", "resolution", "of", "millimeters", ".", "Annotated", "medical", "volumes", "are", "not", "easy", "to", "obtain", "due", "to", "the", "fact", "that", "one", "or", "more", "experts", "are", "required", "to", "manually", "trace", "a", "reliable", "ground", "truth", "annotation", "and", "that", "there", "is", "a", "cost", "associated", "with", "their", "acquisition", ".", "In", "this", "work", "we", "found", "necessary", "to", "augment", "the", "original", "training", "dataset", "in", "order", "to", "obtain", "robustness", "and", "increased", "precision", "on", "the", "test", "dataset", ".", "During", "every", "training", "iteration", ",", "we", "fed", "as", "input", "to", "the", "network", "randomly", "deformed", "versions", "of", "the", "training", "images", "by", "using", "a", "dense", "deformation", "field", "obtained", "through", "a", "grid", "of", "control", "-", "points", "and", "B", "-", "spline", "interpolation", ".", "This", "augmentation", "has", "been", "performed", "\u201d", "on", "-", "the", "-", "fly", "\u201d", ",", "prior", "to", "each", "optimisation", "iteration", ",", "in", "order", "to", "alleviate", "the", "otherwise", "excessive", "storage", "requirements", ".", "Additionally", "we", "vary", "the", "intensity", "distribution", "of", "the", "data", "by", "adapting", ",", "using", "histogram", "matching", ",", "the", "intensity", "distributions", "of", "the", "training", "volumes", "used", "in", "each", "iteration", ",", "to", "the", "ones", "of", "other", "randomly", "chosen", "scans", "belonging", "to", "the", "dataset", ".", "subsection", ":", "Testing", "A", "Previously", "unseen", "MRI", "volume", "can", "be", "segmented", "by", "processing", "it", "in", "a", "feed", "-", "forward", "manner", "through", "the", "network", ".", "The", "output", "of", "the", "last", "convolutional", "layer", ",", "after", "soft", "-", "max", ",", "consists", "of", "a", "probability", "map", "for", "background", "and", "foreground", ".", "The", "voxels", "having", "higher", "probability", "(", ")", "to", "belong", "to", "the", "foreground", "than", "to", "the", "background", "are", "considered", "part", "of", "the", "anatomy", ".", "section", ":", "Results", "We", "trained", "our", "method", "on", "MRI", "volumes", ",", "and", "the", "relative", "manual", "ground", "truth", "annotation", ",", "obtained", "from", "the", "\u201d", "PROMISE2012", "\u201d", "challenge", "dataset", ".", "This", "dataset", "contains", "medical", "data", "acquired", "in", "different", "hospitals", ",", "using", "different", "equipment", "and", "different", "acquisition", "protocols", ".", "The", "data", "in", "this", "dataset", "is", "representative", "of", "the", "clinical", "variability", "and", "challenges", "encountered", "in", "clinical", "settings", ".", "As", "previously", "stated", "we", "massively", "augmented", "this", "dataset", "through", "random", "transformation", "performed", "in", "each", "training", "iteration", ",", "for", "each", "mini", "-", "batch", "fed", "to", "the", "network", ".", "The", "mini", "-", "batches", "used", "in", "our", "implementation", "contained", "two", "volumes", "each", ",", "mainly", "due", "to", "the", "high", "memory", "requirement", "of", "the", "model", "during", "training", ".", "We", "used", "a", "momentum", "of", "and", "a", "initial", "learning", "rate", "of", "which", "decreases", "by", "one", "order", "of", "magnitude", "every", "K", "iterations", ".", "We", "tested", "V", "-", "Net", "on", "MRI", "volumes", "depicting", "prostate", "whose", "ground", "truth", "annotation", "was", "secret", ".", "All", "the", "results", "reported", "in", "this", "section", "of", "the", "paper", "were", "obtained", "directly", "from", "the", "organisers", "of", "the", "challenge", "after", "submitting", "the", "segmentation", "obtained", "through", "our", "approach", ".", "The", "test", "set", "was", "representative", "of", "the", "clinical", "variability", "encountered", "in", "prostate", "scans", "in", "real", "clinical", "settings", ".", "We", "evaluated", "the", "approach", "performance", "in", "terms", "of", "Dice", "coefficient", ",", "Hausdorff", "distance", "of", "the", "predicted", "delineation", "to", "the", "ground", "truth", "annotation", "and", "in", "terms", "of", "score", "obtained", "on", "the", "challenge", "data", "as", "computed", "by", "the", "organisers", "of", "\u201d", "PROMISE", "2012", "\u201d", ".", "The", "results", "are", "shown", "in", "Table", "[", "reference", "]", "and", "Fig", ".", "[", "reference", "]", ".", "Our", "implementation", "was", "realised", "in", "python", ",", "using", "a", "custom", "version", "of", "the", "Caffe", "framework", "which", "was", "enabled", "to", "perform", "volumetric", "convolutions", "via", "CuDNN", "v3", ".", "All", "the", "trainings", "and", "experiments", "were", "ran", "on", "a", "standard", "workstation", "equipped", "with", "GB", "of", "memory", ",", "an", "Intel", "(", "R", ")", "Core", "(", "TM", ")", "i7", "-", "5820", "K", "CPU", "working", "at", "3.30GHz", ",", "and", "a", "NVidia", "GTX", "1080", "with", "GB", "of", "video", "memory", ".", "We", "let", "our", "model", "train", "for", "hours", ",", "or", "K", "iterations", "circa", ",", "and", "we", "were", "able", "to", "segment", "a", "previously", "unseen", "volume", "in", "circa", "second", ".", "The", "datasets", "were", "first", "normalised", "using", "the", "N4", "bias", "filed", "correction", "function", "of", "the", "ANTs", "framework", "and", "then", "resampled", "to", "a", "common", "resolution", "of", "mm", ".", "We", "applied", "random", "deformations", "to", "the", "scans", "used", "for", "training", "by", "varying", "the", "position", "of", "the", "control", "points", "with", "random", "quantities", "obtained", "from", "gaussian", "distribution", "with", "zero", "mean", "and", "voxels", "standard", "deviation", ".", "Qualitative", "results", "can", "be", "seen", "in", "Fig", ".", "[", "reference", "]", ".", "section", ":", "Conclusion", "We", "presented", "and", "approach", "based", "on", "a", "volumetric", "convolutional", "neural", "network", "that", "performs", "segmentation", "of", "MRI", "prostate", "volumes", "in", "a", "fast", "and", "accurate", "manner", ".", "We", "introduced", "a", "novel", "objective", "function", "that", "we", "optimise", "during", "training", "based", "on", "the", "Dice", "overlap", "coefficient", "between", "the", "predicted", "segmentation", "and", "the", "ground", "truth", "annotation", ".", "Our", "Dice", "loss", "layer", "does", "not", "need", "sample", "re", "-", "weighting", "when", "the", "amount", "of", "background", "and", "foreground", "pixels", "is", "strongly", "unbalanced", "and", "is", "indicated", "for", "binary", "segmentation", "tasks", ".", "Although", "we", "inspired", "our", "architecture", "to", "the", "one", "proposed", "in", ",", "we", "divided", "it", "into", "stages", "that", "learn", "residuals", "and", ",", "as", "empirically", "observed", ",", "improve", "both", "results", "and", "convergence", "time", ".", "Future", "works", "will", "aim", "at", "segmenting", "volumes", "containing", "multiple", "regions", "in", "other", "modalities", "such", "as", "ultrasound", "and", "at", "higher", "resolutions", "by", "splitting", "the", "network", "over", "multiple", "GPUs", ".", "section", ":", "Acknowledgement", "We", "would", "like", "to", "acknowledge", "NVidia", "corporation", ",", "that", "donated", "a", "Tesla", "K40", "GPU", "to", "our", "group", "enabling", "this", "research", ",", "Dr.", "Geert", "Litjens", "who", "dedicated", "some", "of", "his", "time", "to", "evaluate", "our", "results", "against", "the", "ground", "truth", "of", "the", "PROMISE", "2012", "dataset", "and", "Ms.", "Iro", "Laina", "for", "her", "support", "to", "this", "project", ".", "bibliography", ":", "References"]}