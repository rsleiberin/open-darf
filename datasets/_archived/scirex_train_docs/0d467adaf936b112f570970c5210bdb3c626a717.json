{"coref": {"Dense_Pixel_Correspondence_Estimation": [], "FlowNet2": [[2, 4], [167, 169], [367, 369], [383, 385], [2650, 2651], [2696, 2699], [2739, 2742], [2786, 2789], [2794, 2797], [2803, 2806], [2811, 2814], [2844, 2847], [3094, 3098], [3135, 3142], [3262, 3265], [3281, 3288], [3289, 3292], [3373, 3374], [3474, 3480], [3480, 3487], [3487, 3494], [3494, 3495], [3551, 3552], [3578, 3579], [3641, 3644], [3697, 3702], [3750, 3751], [3801, 3803], [3822, 3824], [3877, 3879], [3931, 3933], [4068, 4069], [4141, 4143], [4187, 4189], [4227, 4229], [4275, 4277], [4360, 4361], [4373, 4374], [4539, 4541], [4715, 4717], [5066, 5070], [5078, 5085], [5432, 5436], [5514, 5520], [5520, 5527], [5573, 5579], [5579, 5586], [5586, 5593], [5593, 5594], [5765, 5766], [5812, 5815], [5846, 5849], [5527, 5534]], "HPatches": [], "Viewpoint_III_AEPE": [], "Viewpoint_II_AEPE": [], "Viewpoint_IV_AEPE": [], "Viewpoint_I_AEPE": [], "Viewpoint_V_AEPE": []}, "coref_non_salient": {"0": [[828, 831], [1024, 1026], [1126, 1128], [1371, 1373], [5144, 5146]], "1": [[2367, 2369], [2392, 2394]], "10": [[736, 737], [795, 796], [958, 959]], "100": [[1383, 1387]], "101": [[3994, 3998]], "102": [[745, 748]], "103": [[4037, 4041]], "104": [[1076, 1081]], "105": [[3119, 3122]], "106": [[520, 522]], "107": [[540, 542]], "108": [[5, 10]], "109": [[1045, 1047]], "11": [[946, 948], [2286, 2288]], "110": [[4610, 4613]], "111": [[740, 743]], "112": [[902, 910]], "113": [[919, 921]], "114": [[4112, 4116]], "115": [[3106, 3108]], "116": [[1104, 1106]], "117": [[999, 1002]], "118": [[824, 827]], "119": [[963, 965]], "12": [[1027, 1029], [5860, 5862], [5877, 5879]], "120": [[1788, 1790]], "121": [[797, 800]], "122": [[2434, 2436]], "123": [[5320, 5322]], "124": [[135, 137], [5350, 5353]], "125": [[2629, 2631]], "126": [[915, 917]], "127": [[762, 771]], "128": [[3713, 3714]], "129": [[159, 162]], "13": [[3450, 3451], [5490, 5491], [5549, 5550]], "130": [[435, 437]], "131": [[1773, 1775]], "132": [[2615, 2616]], "133": [[253, 256]], "134": [[966, 969]], "135": [[859, 862]], "136": [[454, 456]], "14": [[1614, 1615], [2710, 2711], [2614, 2615], [5196, 5197]], "15": [[1015, 1018], [2163, 2164]], "16": [[3554, 3555], [3631, 3632]], "17": [[4925, 4926]], "18": [[3534, 3536], [3781, 3783], [4546, 4548], [5132, 5134], [5608, 5611]], "19": [[205, 208], [681, 684]], "2": [[2442, 2443], [2606, 2607], [3442, 3444], [3537, 3538], [3784, 3786], [5482, 5484], [5541, 5543]], "20": [[1925, 1927], [5843, 5845], [5888, 5890], [5944, 5946]], "21": [[14, 15], [61, 62], [176, 177], [229, 230], [235, 236], [297, 298], [641, 642], [710, 711], [726, 727], [780, 781], [1236, 1237], [1377, 1378], [1401, 1402], [1620, 1621], [1646, 1647], [1683, 1684], [2306, 2307], [2533, 2534], [2684, 2685], [2855, 2856], [2874, 2875], [3497, 3498], [3779, 3780], [4056, 4057], [4130, 4131], [5705, 5706], [5727, 5728], [5755, 5756], [1666, 1667], [1809, 1810], [1989, 1990], [1998, 1999], [3201, 3202], [4241, 4242], [4397, 4398], [5639, 5640]], "22": [[225, 226], [538, 539], [837, 838], [2603, 2605], [2625, 2626], [2851, 2852], [3572, 3573], [4171, 4172]], "23": [[3114, 3115], [4851, 4852], [5121, 5122]], "24": [[2340, 2342], [2538, 2540], [2549, 2551], [4618, 4620], [4660, 4662]], "25": [[1751, 1753], [3740, 3742]], "26": [[354, 358], [2884, 2888], [3934, 3938]], "27": [[4534, 4536]], "28": [[5989, 5991]], "29": [[3182, 3184], [3338, 3340]], "3": [[1420, 1423], [1469, 1471]], "30": [[3248, 3249], [5214, 5215]], "31": [[4733, 4735]], "32": [[5763, 5764]], "33": [[4139, 4140], [18, 19], [42, 43], [86, 87], [147, 148], [218, 219], [244, 245], [263, 264], [343, 344], [695, 696], [722, 723], [733, 734], [790, 791], [926, 927], [1020, 1021], [1054, 1055], [1169, 1170], [1200, 1201], [1287, 1288], [1784, 1785], [1836, 1837], [1876, 1877], [2241, 2242], [2279, 2280], [2839, 2840], [3308, 3309], [3911, 3912], [3956, 3957], [3976, 3977], [4048, 4049], [4090, 4091], [4121, 4122], [4225, 4226], [4314, 4315], [4406, 4407], [4412, 4413], [4476, 4477], [4634, 4635], [4648, 4649], [4666, 4667], [4790, 4791], [4796, 4797], [4917, 4918], [5224, 5225], [5259, 5260], [5295, 5296], [5323, 5324], [5357, 5358], [5460, 5461], [5614, 5615], [5696, 5697], [5724, 5725], [5775, 5776], [5909, 5910], [5968, 5969], [5980, 5981], [6061, 6062]], "34": [[2448, 2450], [5652, 5653]], "35": [[3088, 3089]], "36": [[3223, 3225]], "37": [[2498, 2501], [4820, 4821]], "38": [[180, 182], [3690, 3691]], "39": [[5413, 5416]], "4": [[125, 126], [1186, 1188], [1978, 1984]], "40": [[66, 68], [933, 935]], "41": [[493, 495], [2227, 2229]], "42": [[363, 365], [3412, 3414], [3922, 3924], [3947, 3949], [3979, 3981], [4000, 4002], [4061, 4063], [4215, 4217], [5678, 5680], [5688, 5690]], "43": [[4290, 4291]], "44": [[627, 630], [3084, 3087], [5150, 5153], [5173, 5176]], "45": [[3556, 3557], [3647, 3648]], "46": [[3301, 3303], [5155, 5157], [5217, 5219]], "47": [[1576, 1578]], "48": [[4529, 4531], [5229, 5231]], "49": [[1464, 1467], [3651, 3654], [5823, 5826]], "5": [[487, 489], [2136, 2137], [2212, 2214], [2244, 2245]], "50": [[698, 700], [807, 809], [882, 884], [985, 987]], "51": [[5781, 5786]], "52": [[4117, 4118]], "53": [[2271, 2274]], "54": [[5269, 5273]], "55": [[1364, 1366]], "56": [[4417, 4421]], "57": [[4479, 4480]], "58": [[1098, 1101]], "59": [[5940, 5942]], "6": [[581, 583], [1741, 1743]], "60": [[4165, 4167]], "61": [[3466, 3474], [5506, 5514], [5565, 5573], [1660, 1661]], "62": [[4792, 4793]], "63": [[4423, 4426]], "64": [[1003, 1006]], "65": [[5046, 5056]], "66": [[5471, 5474]], "67": [[2767, 2769]], "68": [[1133, 1136]], "69": [[3112, 3113], [5118, 5119]], "7": [[1389, 1390], [1403, 1404], [1612, 1613], [1638, 1639], [1648, 1649], [1691, 1692], [2304, 2305], [2535, 2536], [2543, 2544], [2707, 2708], [2762, 2763], [1811, 1812], [2571, 2572]], "70": [[360, 362], [3415, 3417], [3925, 3927], [3944, 3946], [4097, 4099], [4218, 4220]], "71": [[757, 759]], "72": [[2669, 2671]], "73": [[953, 956]], "74": [[1606, 1608]], "75": [[5332, 5335]], "76": [[458, 461]], "77": [[3732, 3734]], "78": [[1091, 1094]], "79": [[25, 27]], "8": [[100, 101], [2623, 2624], [4389, 4392], [5645, 5648]], "80": [[803, 805]], "81": [[2176, 2177]], "82": [[3245, 3246]], "83": [[98, 99]], "84": [[3515, 3518]], "85": [[5002, 5004]], "86": [[1148, 1150]], "87": [[1270, 1273]], "88": [[1084, 1086]], "89": [[751, 754]], "9": [[3562, 3563], [3649, 3650]], "90": [[3251, 3253]], "91": [[3705, 3709]], "92": [[11, 13], [1609, 1611], [1792, 1794], [2835, 2837]], "93": [[3169, 3171]], "94": [[623, 625], [1765, 1767], [1949, 1951], [2133, 2135], [2149, 2151], [2182, 2184], [2219, 2221], [2259, 2261], [2427, 2429], [4726, 4728], [5344, 5346], [5881, 5883]], "95": [[886, 891]], "96": [[841, 845]], "97": [[4501, 4502]], "98": [[1797, 1799]], "99": [[3407, 3409]]}, "doc_id": "0d467adaf936b112f570970c5210bdb3c626a717", "method_subrelations": {"FlowNet2": [[[0, 8], "FlowNet2"]]}, "n_ary_relations": [{"Material": "HPatches", "Method": "FlowNet2", "Metric": "Viewpoint_I_AEPE", "Task": "Dense_Pixel_Correspondence_Estimation", "score": "5.99"}, {"Material": "HPatches", "Method": "FlowNet2", "Metric": "Viewpoint_II_AEPE", "Task": "Dense_Pixel_Correspondence_Estimation", "score": "15.55"}, {"Material": "HPatches", "Method": "FlowNet2", "Metric": "Viewpoint_III_AEPE", "Task": "Dense_Pixel_Correspondence_Estimation", "score": "17.09"}, {"Material": "HPatches", "Method": "FlowNet2", "Metric": "Viewpoint_IV_AEPE", "Task": "Dense_Pixel_Correspondence_Estimation", "score": "22.13"}, {"Material": "HPatches", "Method": "FlowNet2", "Metric": "Viewpoint_V_AEPE", "Task": "Dense_Pixel_Correspondence_Estimation", "score": "30.68"}], "ner": [[2, 4, "Method"], [5, 10, "Method"], [11, 13, "Method"], [14, 15, "Method"], [25, 27, "Task"], [61, 62, "Method"], [66, 68, "Method"], [98, 99, "Metric"], [100, 101, "Metric"], [125, 126, "Task"], [135, 137, "Method"], [159, 162, "Method"], [167, 169, "Method"], [176, 177, "Method"], [180, 182, "Metric"], [205, 208, "Metric"], [225, 226, "Metric"], [229, 230, "Method"], [235, 236, "Method"], [253, 256, "Method"], [297, 298, "Method"], [354, 358, "Task"], [360, 362, "Task"], [363, 365, "Task"], [367, 369, "Method"], [383, 385, "Method"], [435, 437, "Method"], [454, 456, "Method"], [458, 461, "Method"], [487, 489, "Method"], [493, 495, "Method"], [520, 522, "Method"], [538, 539, "Metric"], [540, 542, "Metric"], [581, 583, "Method"], [623, 625, "Method"], [627, 630, "Method"], [641, 642, "Method"], [681, 684, "Metric"], [698, 700, "Method"], [710, 711, "Method"], [726, 727, "Method"], [736, 737, "Method"], [740, 743, "Method"], [745, 748, "Method"], [751, 754, "Method"], [757, 759, "Method"], [762, 771, "Method"], [780, 781, "Method"], [795, 796, "Method"], [797, 800, "Task"], [803, 805, "Method"], [807, 809, "Method"], [824, 827, "Method"], [828, 831, "Method"], [837, 838, "Metric"], [841, 845, "Method"], [859, 862, "Method"], [882, 884, "Method"], [886, 891, "Task"], [902, 910, "Task"], [915, 917, "Task"], [919, 921, "Task"], [933, 935, "Method"], [946, 948, "Method"], [953, 956, "Method"], [958, 959, "Method"], [963, 965, "Task"], [966, 969, "Task"], [985, 987, "Method"], [999, 1002, "Task"], [1003, 1006, "Task"], [1015, 1018, "Task"], [1024, 1026, "Method"], [1027, 1029, "Method"], [1045, 1047, "Task"], [1076, 1081, "Method"], [1084, 1086, "Method"], [1091, 1094, "Method"], [1098, 1101, "Task"], [1104, 1106, "Method"], [1126, 1128, "Method"], [1133, 1136, "Task"], [1148, 1150, "Task"], [1186, 1188, "Task"], [1236, 1237, "Method"], [1270, 1273, "Method"], [1364, 1366, "Method"], [1371, 1373, "Method"], [1377, 1378, "Method"], [1383, 1387, "Method"], [1389, 1390, "Method"], [1401, 1402, "Method"], [1403, 1404, "Method"], [1420, 1423, "Metric"], [1464, 1467, "Task"], [1469, 1471, "Metric"], [1576, 1578, "Task"], [1606, 1608, "Task"], [1609, 1611, "Method"], [1612, 1613, "Method"], [1614, 1615, "Method"], [1620, 1621, "Method"], [1638, 1639, "Method"], [1646, 1647, "Method"], [1648, 1649, "Method"], [1683, 1684, "Method"], [1691, 1692, "Method"], [1741, 1743, "Method"], [1751, 1753, "Task"], [1765, 1767, "Method"], [1773, 1775, "Task"], [1788, 1790, "Method"], [1792, 1794, "Method"], [1797, 1799, "Method"], [1925, 1927, "Method"], [1949, 1951, "Method"], [1978, 1984, "Task"], [2133, 2135, "Method"], [2136, 2137, "Method"], [2149, 2151, "Method"], [2163, 2164, "Task"], [2176, 2177, "Method"], [2182, 2184, "Method"], [2212, 2214, "Method"], [2219, 2221, "Method"], [2227, 2229, "Method"], [2244, 2245, "Method"], [2259, 2261, "Method"], [2271, 2274, "Method"], [2286, 2288, "Method"], [2304, 2305, "Method"], [2306, 2307, "Method"], [2340, 2342, "Method"], [2367, 2369, "Method"], [2392, 2394, "Method"], [2427, 2429, "Method"], [2434, 2436, "Metric"], [2442, 2443, "Metric"], [2448, 2450, "Method"], [2498, 2501, "Method"], [2533, 2534, "Method"], [2535, 2536, "Method"], [2538, 2540, "Method"], [2543, 2544, "Method"], [2549, 2551, "Method"], [2603, 2605, "Metric"], [2606, 2607, "Metric"], [2615, 2616, "Method"], [2623, 2624, "Metric"], [2625, 2626, "Metric"], [2629, 2631, "Task"], [2650, 2651, "Method"], [2669, 2671, "Task"], [2684, 2685, "Method"], [2696, 2699, "Method"], [2707, 2708, "Method"], [2710, 2711, "Method"], [2739, 2742, "Method"], [2762, 2763, "Method"], [2767, 2769, "Method"], [2786, 2789, "Method"], [2794, 2797, "Method"], [2803, 2806, "Method"], [2811, 2814, "Method"], [2835, 2837, "Method"], [2844, 2847, "Method"], [2851, 2852, "Metric"], [2855, 2856, "Method"], [2874, 2875, "Method"], [2884, 2888, "Task"], [3084, 3087, "Method"], [3088, 3089, "Task"], [3094, 3098, "Method"], [3106, 3108, "Method"], [3112, 3113, "Method"], [3114, 3115, "Method"], [3119, 3122, "Method"], [3135, 3142, "Method"], [3169, 3171, "Task"], [3182, 3184, "Method"], [3223, 3225, "Method"], [3245, 3246, "Method"], [3248, 3249, "Method"], [3251, 3253, "Task"], [3262, 3265, "Method"], [3281, 3288, "Method"], [3289, 3292, "Method"], [3301, 3303, "Method"], [3338, 3340, "Method"], [3373, 3374, "Method"], [3407, 3409, "Task"], [3412, 3414, "Task"], [3415, 3417, "Task"], [3442, 3444, "Metric"], [3450, 3451, "Method"], [3466, 3474, "Method"], [3474, 3480, "Method"], [3480, 3487, "Method"], [3487, 3494, "Method"], [3494, 3495, "Method"], [3497, 3498, "Method"], [3515, 3518, "Method"], [3534, 3536, "Metric"], [3537, 3538, "Metric"], [3551, 3552, "Method"], [3554, 3555, "Method"], [3556, 3557, "Method"], [3562, 3563, "Method"], [3572, 3573, "Metric"], [3578, 3579, "Method"], [3631, 3632, "Method"], [3641, 3644, "Method"], [3647, 3648, "Method"], [3649, 3650, "Method"], [3651, 3654, "Task"], [3690, 3691, "Metric"], [3697, 3702, "Method"], [3705, 3709, "Method"], [3713, 3714, "Method"], [3732, 3734, "Method"], [3740, 3742, "Task"], [3750, 3751, "Method"], [3779, 3780, "Method"], [3781, 3783, "Metric"], [3784, 3786, "Metric"], [3801, 3803, "Method"], [3822, 3824, "Method"], [3877, 3879, "Method"], [3922, 3924, "Task"], [3925, 3927, "Task"], [3931, 3933, "Method"], [3934, 3938, "Task"], [3944, 3946, "Task"], [3947, 3949, "Task"], [3979, 3981, "Task"], [3994, 3998, "Task"], [4000, 4002, "Task"], [4037, 4041, "Method"], [4056, 4057, "Method"], [4061, 4063, "Task"], [4068, 4069, "Method"], [4097, 4099, "Task"], [4112, 4116, "Method"], [4117, 4118, "Method"], [4130, 4131, "Method"], [4139, 4140, "Method"], [4141, 4143, "Method"], [4165, 4167, "Method"], [4171, 4172, "Metric"], [4187, 4189, "Method"], [4215, 4217, "Task"], [4218, 4220, "Task"], [4227, 4229, "Method"], [4275, 4277, "Method"], [4290, 4291, "Metric"], [4360, 4361, "Method"], [4373, 4374, "Method"], [4389, 4392, "Metric"], [4417, 4421, "Method"], [4423, 4426, "Method"], [4479, 4480, "Task"], [4501, 4502, "Method"], [4529, 4531, "Method"], [4534, 4536, "Method"], [4539, 4541, "Method"], [4546, 4548, "Metric"], [4610, 4613, "Method"], [4618, 4620, "Method"], [4660, 4662, "Method"], [4715, 4717, "Method"], [4726, 4728, "Method"], [4733, 4735, "Method"], [4792, 4793, "Method"], [4820, 4821, "Method"], [4851, 4852, "Method"], [4925, 4926, "Method"], [5002, 5004, "Task"], [5046, 5056, "Task"], [5066, 5070, "Method"], [5078, 5085, "Method"], [5118, 5119, "Method"], [5121, 5122, "Method"], [5132, 5134, "Metric"], [5144, 5146, "Method"], [5150, 5153, "Method"], [5155, 5157, "Method"], [5173, 5176, "Method"], [5214, 5215, "Method"], [5217, 5219, "Method"], [5229, 5231, "Method"], [5269, 5273, "Metric"], [5320, 5322, "Method"], [5332, 5335, "Method"], [5344, 5346, "Method"], [5350, 5353, "Method"], [5413, 5416, "Task"], [5432, 5436, "Method"], [5471, 5474, "Task"], [5482, 5484, "Metric"], [5490, 5491, "Method"], [5506, 5514, "Method"], [5514, 5520, "Method"], [5520, 5527, "Method"], [5541, 5543, "Metric"], [5549, 5550, "Method"], [5565, 5573, "Method"], [5573, 5579, "Method"], [5579, 5586, "Method"], [5586, 5593, "Method"], [5593, 5594, "Method"], [5608, 5611, "Metric"], [5645, 5648, "Metric"], [5652, 5653, "Method"], [5678, 5680, "Task"], [5688, 5690, "Task"], [5705, 5706, "Method"], [5727, 5728, "Method"], [5755, 5756, "Method"], [5763, 5764, "Metric"], [5765, 5766, "Method"], [5781, 5786, "Metric"], [5812, 5815, "Method"], [5823, 5826, "Task"], [5843, 5845, "Method"], [5846, 5849, "Method"], [5860, 5862, "Method"], [5877, 5879, "Method"], [5881, 5883, "Method"], [5888, 5890, "Method"], [5940, 5942, "Method"], [5944, 5946, "Method"], [5989, 5991, "Method"], [18, 19, "Method"], [42, 43, "Method"], [86, 87, "Method"], [147, 148, "Method"], [218, 219, "Method"], [244, 245, "Method"], [263, 264, "Method"], [343, 344, "Method"], [695, 696, "Method"], [722, 723, "Method"], [733, 734, "Method"], [790, 791, "Method"], [926, 927, "Method"], [1020, 1021, "Method"], [1054, 1055, "Method"], [1169, 1170, "Method"], [1200, 1201, "Method"], [1287, 1288, "Method"], [1660, 1661, "Method"], [1666, 1667, "Method"], [1784, 1785, "Method"], [1809, 1810, "Method"], [1811, 1812, "Method"], [1836, 1837, "Method"], [1876, 1877, "Method"], [1989, 1990, "Method"], [1998, 1999, "Method"], [2241, 2242, "Method"], [2279, 2280, "Method"], [2571, 2572, "Method"], [2614, 2615, "Method"], [2839, 2840, "Method"], [3201, 3202, "Method"], [3308, 3309, "Method"], [3911, 3912, "Method"], [3956, 3957, "Method"], [3976, 3977, "Method"], [4048, 4049, "Method"], [4090, 4091, "Method"], [4121, 4122, "Method"], [4225, 4226, "Method"], [4241, 4242, "Method"], [4314, 4315, "Method"], [4397, 4398, "Method"], [4406, 4407, "Method"], [4412, 4413, "Method"], [4476, 4477, "Method"], [4634, 4635, "Method"], [4648, 4649, "Method"], [4666, 4667, "Method"], [4790, 4791, "Method"], [4796, 4797, "Method"], [4917, 4918, "Method"], [5196, 5197, "Method"], [5224, 5225, "Method"], [5259, 5260, "Method"], [5295, 5296, "Method"], [5323, 5324, "Method"], [5357, 5358, "Method"], [5460, 5461, "Method"], [5527, 5534, "Method"], [5614, 5615, "Method"], [5639, 5640, "Method"], [5696, 5697, "Method"], [5724, 5725, "Method"], [5775, 5776, "Method"], [5909, 5910, "Method"], [5968, 5969, "Method"], [5980, 5981, "Method"], [6061, 6062, "Method"]], "sections": [[0, 231], [231, 685], [685, 1172], [1172, 1763], [1763, 1767], [1767, 2282], [2282, 2864], [2864, 2868], [2868, 3082], [3082, 3375], [3375, 3427], [3427, 3835], [3835, 3918], [3918, 4155], [4155, 4317], [4317, 4348], [4348, 4351], [4351, 4403], [4403, 4512], [4512, 4608], [4608, 4764], [4764, 4768], [4768, 5044], [5044, 5142], [5142, 5336], [5336, 5339], [5339, 5594], [5594, 5676], [5676, 5794], [5794, 5858], [5858, 5884], [5884, 5951], [5951, 5987], [5987, 6117]], "sentences": [[0, 13], [13, 28], [28, 51], [51, 69], [69, 94], [94, 130], [130, 149], [149, 167], [167, 188], [188, 209], [209, 231], [231, 234], [234, 247], [247, 275], [275, 305], [305, 327], [327, 346], [346, 380], [380, 403], [403, 413], [413, 432], [432, 445], [445, 468], [468, 479], [479, 504], [504, 528], [528, 543], [543, 554], [554, 569], [569, 584], [584, 605], [605, 635], [635, 666], [666, 685], [685, 689], [689, 706], [706, 725], [725, 772], [772, 782], [782, 801], [801, 818], [818, 832], [832, 846], [846, 857], [857, 882], [882, 898], [898, 936], [936, 970], [970, 993], [993, 1007], [1007, 1023], [1023, 1042], [1042, 1067], [1067, 1087], [1087, 1107], [1107, 1137], [1137, 1172], [1172, 1176], [1176, 1189], [1189, 1208], [1208, 1234], [1234, 1251], [1251, 1270], [1270, 1290], [1290, 1297], [1297, 1319], [1319, 1343], [1343, 1367], [1367, 1399], [1399, 1430], [1430, 1445], [1445, 1472], [1472, 1492], [1492, 1511], [1511, 1530], [1530, 1549], [1549, 1561], [1561, 1592], [1592, 1612], [1612, 1613], [1613, 1614], [1614, 1615], [1615, 1620], [1620, 1621], [1621, 1630], [1630, 1639], [1639, 1655], [1655, 1669], [1669, 1672], [1672, 1695], [1695, 1711], [1711, 1728], [1728, 1763], [1763, 1767], [1767, 1775], [1775, 1791], [1791, 1800], [1800, 1814], [1814, 1828], [1828, 1850], [1850, 1882], [1882, 1900], [1900, 1923], [1923, 1945], [1945, 1957], [1957, 1985], [1985, 2002], [2002, 2008], [2008, 2020], [2020, 2047], [2047, 2076], [2076, 2092], [2092, 2123], [2123, 2156], [2156, 2159], [2159, 2168], [2168, 2190], [2190, 2193], [2193, 2215], [2215, 2237], [2237, 2282], [2282, 2288], [2288, 2309], [2309, 2321], [2321, 2334], [2334, 2353], [2353, 2370], [2370, 2406], [2406, 2422], [2422, 2444], [2444, 2492], [2492, 2522], [2522, 2541], [2541, 2572], [2572, 2597], [2597, 2615], [2615, 2632], [2632, 2652], [2652, 2667], [2667, 2694], [2694, 2708], [2708, 2722], [2722, 2734], [2734, 2764], [2764, 2786], [2786, 2797], [2797, 2806], [2806, 2814], [2814, 2819], [2819, 2841], [2841, 2864], [2864, 2868], [2868, 2871], [2871, 2892], [2892, 2911], [2911, 2944], [2944, 2967], [2967, 3027], [3027, 3053], [3053, 3070], [3070, 3082], [3082, 3089], [3089, 3130], [3130, 3143], [3143, 3164], [3164, 3194], [3194, 3212], [3212, 3232], [3232, 3256], [3256, 3272], [3272, 3292], [3292, 3300], [3300, 3320], [3320, 3334], [3334, 3347], [3347, 3367], [3367, 3375], [3375, 3378], [3378, 3399], [3399, 3418], [3418, 3427], [3427, 3435], [3435, 3441], [3441, 3449], [3449, 3450], [3450, 3451], [3451, 3454], [3454, 3466], [3466, 3474], [3474, 3480], [3480, 3487], [3487, 3494], [3494, 3495], [3495, 3497], [3497, 3499], [3499, 3519], [3519, 3534], [3534, 3546], [3546, 3548], [3548, 3564], [3564, 3574], [3574, 3595], [3595, 3633], [3633, 3635], [3635, 3651], [3651, 3662], [3662, 3675], [3675, 3704], [3704, 3725], [3725, 3743], [3743, 3745], [3745, 3757], [3757, 3770], [3770, 3781], [3781, 3796], [3796, 3814], [3814, 3835], [3835, 3839], [3839, 3859], [3859, 3877], [3877, 3918], [3918, 3927], [3927, 3950], [3950, 3960], [3960, 3978], [3978, 3999], [3999, 4019], [4019, 4029], [4029, 4042], [4042, 4054], [4054, 4064], [4064, 4089], [4089, 4100], [4100, 4124], [4124, 4155], [4155, 4158], [4158, 4195], [4195, 4212], [4212, 4240], [4240, 4254], [4254, 4263], [4263, 4295], [4295, 4317], [4317, 4320], [4320, 4348], [4348, 4351], [4351, 4354], [4354, 4403], [4403, 4410], [4410, 4422], [4422, 4434], [4434, 4453], [4453, 4460], [4460, 4501], [4501, 4512], [4512, 4519], [4519, 4543], [4543, 4556], [4556, 4572], [4572, 4608], [4608, 4617], [4617, 4656], [4656, 4680], [4680, 4699], [4699, 4710], [4710, 4736], [4736, 4745], [4745, 4764], [4764, 4768], [4768, 4773], [4773, 4787], [4787, 4819], [4819, 4837], [4837, 4852], [4852, 4872], [4872, 4895], [4895, 4919], [4919, 4932], [4932, 4948], [4948, 4969], [4969, 4987], [4987, 5022], [5022, 5035], [5035, 5037], [5037, 5041], [5041, 5044], [5044, 5056], [5056, 5087], [5087, 5100], [5100, 5123], [5123, 5142], [5142, 5146], [5146, 5169], [5169, 5189], [5189, 5216], [5216, 5240], [5240, 5298], [5298, 5304], [5304, 5315], [5315, 5336], [5336, 5339], [5339, 5346], [5346, 5369], [5369, 5379], [5379, 5392], [5392, 5409], [5409, 5431], [5431, 5452], [5452, 5463], [5463, 5475], [5475, 5481], [5481, 5489], [5489, 5490], [5490, 5491], [5491, 5493], [5493, 5506], [5506, 5514], [5514, 5520], [5520, 5527], [5527, 5535], [5535, 5537], [5537, 5540], [5540, 5548], [5548, 5549], [5549, 5550], [5550, 5552], [5552, 5565], [5565, 5573], [5573, 5579], [5579, 5586], [5586, 5593], [5593, 5594], [5594, 5601], [5601, 5633], [5633, 5652], [5652, 5662], [5662, 5676], [5676, 5680], [5680, 5704], [5704, 5720], [5720, 5750], [5750, 5761], [5761, 5787], [5787, 5794], [5794, 5800], [5800, 5812], [5812, 5827], [5827, 5846], [5846, 5858], [5858, 5862], [5862, 5884], [5884, 5890], [5890, 5903], [5903, 5912], [5912, 5926], [5926, 5932], [5932, 5951], [5951, 5955], [5955, 5971], [5971, 5987], [5987, 5991], [5991, 6018], [6018, 6029], [6029, 6040], [6040, 6051], [6051, 6067], [6067, 6080], [6080, 6109], [6109, 6117]], "words": ["document", ":", "FlowNet", "2.0", ":", "Evolution", "of", "Optical", "Flow", "Estimation", "with", "Deep", "Networks", "The", "FlowNet", "demonstrated", "that", "optical", "flow", "estimation", "can", "be", "cast", "as", "a", "learning", "problem", ".", "However", ",", "the", "state", "of", "the", "art", "with", "regard", "to", "the", "quality", "of", "the", "flow", "has", "still", "been", "defined", "by", "traditional", "methods", ".", "Particularly", "on", "small", "displacements", "and", "real", "-", "world", "data", ",", "FlowNet", "can", "not", "compete", "with", "variational", "methods", ".", "In", "this", "paper", ",", "we", "advance", "the", "concept", "of", "end", "-", "to", "-", "end", "learning", "of", "optical", "flow", "and", "make", "it", "work", "really", "well", ".", "The", "large", "improvements", "in", "quality", "and", "speed", "are", "caused", "by", "three", "major", "contributions", ":", "first", ",", "we", "focus", "on", "the", "training", "data", "and", "show", "that", "the", "schedule", "of", "presenting", "data", "during", "training", "is", "very", "important", ".", "Second", ",", "we", "develop", "a", "stacked", "architecture", "that", "includes", "warping", "of", "the", "second", "image", "with", "intermediate", "optical", "flow", ".", "Third", ",", "we", "elaborate", "on", "small", "displacements", "by", "introducing", "a", "sub", "-", "network", "specializing", "on", "small", "motions", ".", "FlowNet", "2.0", "is", "only", "marginally", "slower", "than", "the", "original", "FlowNet", "but", "decreases", "the", "estimation", "error", "by", "more", "than", "50", "%", ".", "It", "performs", "on", "par", "with", "state", "-", "of", "-", "the", "-", "art", "methods", ",", "while", "running", "at", "interactive", "frame", "rates", ".", "Moreover", ",", "we", "present", "faster", "variants", "that", "allow", "optical", "flow", "computation", "at", "up", "to", "140fps", "with", "accuracy", "matching", "the", "original", "FlowNet", ".", "section", ":", "Introduction", "The", "FlowNet", "by", "Dosovitskiy", "represented", "a", "paradigm", "shift", "in", "optical", "flow", "estimation", ".", "The", "idea", "of", "using", "a", "simple", "convolutional", "CNN", "architecture", "to", "directly", "learn", "the", "concept", "of", "optical", "flow", "from", "data", "was", "completely", "disjoint", "from", "all", "the", "established", "approaches", ".", "However", ",", "first", "implementations", "of", "new", "ideas", "often", "have", "a", "hard", "time", "competing", "with", "highly", "fine", "-", "tuned", "existing", "methods", ",", "and", "FlowNet", "was", "no", "exception", "to", "this", "rule", ".", "It", "is", "the", "successive", "consolidation", "that", "resolves", "the", "negative", "effects", "and", "helps", "us", "appreciate", "the", "benefits", "of", "new", "ways", "of", "thinking", ".", "At", "the", "same", "time", ",", "it", "resolves", "problems", "with", "small", "displacements", "and", "noisy", "artifacts", "in", "estimated", "flow", "fields", ".", "This", "leads", "to", "a", "dramatic", "performance", "improvement", "on", "real", "-", "world", "applications", "such", "as", "action", "recognition", "and", "motion", "segmentation", ",", "bringing", "FlowNet", "2.0", "to", "the", "state", "-", "of", "-", "the", "-", "art", "level", ".", "The", "way", "towards", "FlowNet", "2.0", "is", "via", "several", "evolutionary", ",", "but", "decisive", "modifications", "that", "are", "not", "trivially", "connected", "to", "the", "observed", "problems", ".", "First", ",", "we", "evaluate", "the", "influence", "of", "dataset", "schedules", ".", "Interestingly", ",", "the", "more", "sophisticated", "training", "data", "provided", "by", "Mayer", "leads", "to", "inferior", "results", "if", "used", "in", "isolation", ".", "However", ",", "a", "learning", "schedule", "consisting", "of", "multiple", "datasets", "improves", "results", "significantly", ".", "In", "this", "scope", ",", "we", "also", "found", "that", "the", "FlowNet", "version", "with", "an", "explicit", "correlation", "layer", "outperforms", "the", "version", "without", "such", "layer", ".", "This", "is", "in", "contrast", "to", "the", "results", "reported", "in", "Dosovitskiy", ".", "As", "a", "second", "contribution", ",", "we", "introduce", "a", "warping", "operation", "and", "show", "how", "stacking", "multiple", "networks", "using", "this", "operation", "can", "significantly", "improve", "the", "results", ".", "By", "varying", "the", "depth", "of", "the", "stack", "and", "the", "size", "of", "individual", "components", "we", "obtain", "many", "network", "variants", "with", "different", "size", "and", "runtime", ".", "This", "allows", "us", "to", "control", "the", "trade", "-", "off", "between", "accuracy", "and", "computational", "resources", ".", "We", "provide", "networks", "for", "the", "spectrum", "between", "fps", "and", "fps", ".", "Finally", ",", "we", "focus", "on", "small", ",", "subpixel", "motion", "and", "real", "-", "world", "data", ".", "To", "this", "end", ",", "we", "created", "a", "special", "training", "dataset", "and", "a", "specialized", "network", ".", "We", "show", "that", "the", "architecture", "trained", "with", "this", "dataset", "performs", "well", "on", "small", "motions", "typical", "for", "real", "-", "world", "videos", ".", "To", "reach", "optimal", "performance", "on", "arbitrary", "displacements", ",", "we", "add", "a", "network", "that", "learns", "to", "fuse", "the", "former", "stacked", "network", "with", "the", "small", "displacement", "network", "in", "an", "optimal", "manner", ".", "The", "final", "network", "outperforms", "the", "previous", "FlowNet", "by", "a", "large", "margin", "and", "performs", "on", "par", "with", "state", "-", "of", "-", "the", "-", "art", "methods", "on", "the", "Sintel", "and", "KITTI", "benchmarks", ".", "It", "can", "estimate", "small", "and", "large", "displacements", "with", "very", "high", "level", "of", "detail", "while", "providing", "interactive", "frame", "rates", ".", "section", ":", "Related", "Work", "End", "-", "to", "-", "end", "optical", "flow", "estimation", "with", "convolutional", "networks", "was", "proposed", "by", "Dosovitskiy", "in", ".", "Their", "model", ",", "dubbed", "FlowNet", ",", "takes", "a", "pair", "of", "images", "as", "input", "and", "outputs", "the", "flow", "field", ".", "Following", "FlowNet", ",", "several", "papers", "have", "studied", "optical", "flow", "estimation", "with", "CNNs", ":", "featuring", "a", "3D", "convolutional", "network", ",", "an", "unsupervised", "learning", "objective", ",", "carefully", "designed", "rotationally", "invariant", "architectures", ",", "or", "a", "pyramidal", "approach", "based", "on", "the", "coarse", "-", "to", "-", "fine", "idea", "of", "variational", "methods", ".", "None", "of", "these", "methods", "significantly", "outperforms", "the", "original", "FlowNet", ".", "An", "alternative", "approach", "to", "learning", "-", "based", "optical", "flow", "estimation", "is", "to", "use", "CNNs", "for", "matching", "image", "patches", ".", "Thewlis", "formulate", "Deep", "Matching", "as", "a", "convolutional", "network", "and", "optimize", "it", "end", "-", "to", "-", "end", ".", "Gadot", "&", "Wolf", "and", "Bailer", "learn", "image", "patch", "descriptors", "using", "Siamese", "network", "architectures", ".", "These", "methods", "can", "reach", "good", "accuracy", ",", "but", "require", "exhaustive", "matching", "of", "patches", ".", "Thus", ",", "they", "are", "restrictively", "slow", "for", "most", "practical", "applications", ".", "Moreover", ",", "patch", "based", "approaches", "lack", "the", "possibility", "to", "use", "the", "larger", "context", "of", "the", "whole", "image", "because", "they", "operate", "on", "small", "image", "patches", ".", "Convolutional", "networks", "trained", "for", "per", "-", "pixel", "prediction", "tasks", "often", "produce", "noisy", "or", "blurry", "results", ".", "As", "a", "remedy", ",", "out", "-", "of", "-", "the", "-", "box", "optimization", "can", "be", "applied", "to", "the", "network", "predictions", "as", "a", "postprocessing", "operation", ",", "for", "example", ",", "optical", "flow", "estimates", "can", "be", "refined", "with", "a", "variational", "approach", ".", "In", "some", "cases", ",", "this", "refinement", "can", "be", "approximated", "by", "neural", "networks", ":", "Chen", "&", "Pock", "formulate", "reaction", "diffusion", "model", "as", "a", "CNN", "and", "apply", "it", "to", "image", "denoising", ",", "deblocking", "and", "superresolution", ".", "Recently", ",", "it", "has", "been", "shown", "that", "similar", "refinement", "can", "be", "obtained", "by", "stacking", "several", "convolutional", "networks", "on", "top", "of", "each", "other", ".", "This", "led", "to", "improved", "results", "in", "human", "pose", "estimation", "and", "semantic", "instance", "segmentation", ".", "In", "this", "paper", "we", "adapt", "the", "idea", "of", "stacking", "multiple", "networks", "to", "optical", "flow", "estimation", ".", "Our", "network", "architecture", "includes", "warping", "layers", "that", "compensate", "for", "some", "already", "estimated", "preliminary", "motion", "in", "the", "second", "image", ".", "The", "concept", "of", "image", "warping", "is", "common", "to", "all", "contemporary", "variational", "optical", "flow", "methods", "and", "goes", "back", "to", "the", "work", "of", "Lucas", "&", "Kanade", ".", "In", "Brox", "it", "was", "shown", "to", "correspond", "to", "a", "numerical", "fixed", "point", "iteration", "scheme", "coupled", "with", "a", "continuation", "method", ".", "The", "strategy", "of", "training", "machine", "learning", "models", "on", "a", "series", "of", "gradually", "increasing", "tasks", "is", "known", "as", "curriculum", "learning", ".", "The", "idea", "dates", "back", "at", "least", "to", "Elman", ",", "who", "showed", "that", "both", "the", "evolution", "of", "tasks", "and", "the", "network", "architectures", "can", "be", "beneficial", "in", "the", "language", "processing", "scenario", ".", "In", "this", "paper", "we", "revisit", "this", "idea", "in", "the", "context", "of", "computer", "vision", "and", "show", "how", "it", "can", "lead", "to", "dramatic", "performance", "improvement", "on", "a", "complex", "real", "-", "world", "task", "of", "optical", "flow", "estimation", ".", "section", ":", "Dataset", "Schedules", "High", "quality", "training", "data", "is", "crucial", "for", "the", "success", "of", "supervised", "training", ".", "We", "investigated", "the", "differences", "in", "the", "quality", "of", "the", "estimated", "optical", "flow", "depending", "on", "the", "presented", "training", "data", ".", "Interestingly", ",", "it", "turned", "out", "that", "not", "only", "the", "kind", "of", "data", "is", "important", "but", "also", "the", "order", "in", "which", "it", "is", "presented", "during", "training", ".", "The", "original", "FlowNets", "were", "trained", "on", "the", "FlyingChairs", "dataset", "(", "we", "will", "call", "it", "Chairs", ")", ".", "This", "rather", "simplistic", "dataset", "contains", "about", "k", "image", "pairs", "of", "chairs", "superimposed", "on", "random", "background", "images", "from", "Flickr", ".", "Random", "affine", "transformations", "are", "applied", "to", "chairs", "and", "background", "to", "obtain", "the", "second", "image", "and", "ground", "truth", "flow", "fields", ".", "The", "dataset", "contains", "only", "planar", "motions", ".", "The", "FlyingThings3D", "(", "Things3D", ")", "dataset", "proposed", "by", "Mayer", "can", "be", "seen", "as", "a", "three", "-", "dimensional", "version", "of", "the", "FlyingChairs", ".", "The", "dataset", "consists", "of", "k", "renderings", "of", "random", "scenes", "showing", "3D", "models", "from", "the", "ShapeNet", "dataset", "moving", "in", "front", "of", "static", "3D", "backgrounds", ".", "In", "contrast", "to", "Chairs", ",", "the", "images", "show", "true", "3D", "motion", "and", "lighting", "effects", "and", "there", "is", "more", "variety", "among", "the", "object", "models", ".", "We", "tested", "the", "two", "network", "architectures", "introduced", "by", "Dosovitskiy", ":", "FlowNetS", ",", "which", "is", "a", "straightforward", "encoder", "-", "decoder", "architecture", ",", "and", "FlowNetC", ",", "which", "includes", "explicit", "correlation", "of", "feature", "maps", ".", "We", "trained", "FlowNetS", "and", "FlowNetC", "on", "Chairs", "and", "Things3D", "and", "an", "equal", "mixture", "of", "samples", "from", "both", "datasets", "using", "the", "different", "learning", "rate", "schedules", "shown", "in", "Figure", "[", "reference", "]", ".", "The", "basic", "schedule", "(", "k", "iterations", ")", "corresponds", "to", "Dosovitskiy", "except", "some", "minor", "changes", ".", "Apart", "from", "this", "basic", "schedule", ",", "we", "investigated", "a", "longer", "schedule", "with", "M", "iterations", ",", "and", "a", "schedule", "for", "fine", "-", "tuning", "with", "smaller", "learning", "rates", ".", "Results", "of", "networks", "trained", "on", "Chairs", "and", "Things3D", "with", "the", "different", "schedules", "are", "given", "in", "Table", "[", "reference", "]", ".", "The", "results", "lead", "to", "the", "following", "observations", ":", "The", "order", "of", "presenting", "training", "data", "with", "different", "properties", "matters", ".", "Although", "Things3D", "is", "more", "realistic", ",", "training", "on", "Things3D", "alone", "leads", "to", "worse", "results", "than", "training", "on", "Chairs", ".", "The", "best", "results", "are", "consistently", "achieved", "when", "first", "training", "on", "Chairs", "and", "only", "then", "fine", "-", "tuning", "on", "Things3D.", "This", "schedule", "also", "outperforms", "training", "on", "a", "mixture", "of", "Chairs", "and", "Things3D.", "We", "conjecture", "that", "the", "simpler", "Chairs", "dataset", "helps", "the", "network", "learn", "the", "general", "concept", "of", "color", "matching", "without", "developing", "possibly", "confusing", "priors", "for", "3D", "motion", "and", "realistic", "lighting", "too", "early", ".", "The", "result", "indicates", "the", "importance", "of", "training", "data", "schedules", "for", "avoiding", "shortcuts", "when", "learning", "generic", "concepts", "with", "deep", "networks", ".", "FlowNetC", "outperforms", "FlowNetS.", "The", "result", "we", "got", "with", "FlowNetS", "and", "corresponds", "to", "the", "one", "reported", "in", "Dosovitskiy", ".", "However", ",", "we", "obtained", "much", "better", "results", "on", "FlowNetC.", "We", "conclude", "that", "Dosovitskiy", "did", "not", "train", "FlowNetS", "and", "FlowNetC", "under", "the", "exact", "same", "conditions", ".", "When", "done", "so", ",", "the", "FlowNetC", "architecture", "compares", "favorably", "to", "the", "FlowNetS", "architecture", ".", "Improved", "results", ".", "Just", "by", "modifying", "datasets", "and", "training", "schedules", ",", "we", "improved", "the", "FlowNetS", "result", "reported", "by", "Dosovitskiy", "by", "and", "the", "FlowNetC", "result", "by", ".", "In", "this", "section", ",", "we", "did", "not", "yet", "use", "specialized", "training", "sets", "for", "specialized", "scenarios", ".", "The", "trained", "network", "is", "rather", "supposed", "to", "be", "generic", "and", "to", "work", "well", "in", "various", "scenarios", ".", "An", "additional", "optional", "component", "in", "dataset", "schedules", "is", "fine", "-", "tuning", "of", "a", "generic", "network", "to", "a", "specific", "scenario", ",", "such", "as", "the", "driving", "scenario", ",", "which", "we", "show", "in", "Section", "[", "reference", "]", ".", "section", ":", "Stacking", "Networks", "subsection", ":", "Stacking", "Two", "Networks", "for", "Flow", "Refinement", "All", "state", "-", "of", "-", "the", "-", "art", "optical", "flow", "approaches", "rely", "on", "iterative", "methods", ".", "Can", "deep", "networks", "also", "benefit", "from", "iterative", "refinement", "?", "To", "answer", "this", ",", "we", "experiment", "with", "stacking", "multiple", "FlowNetS", "and", "FlowNetC", "architectures", ".", "The", "first", "network", "in", "the", "stack", "always", "gets", "the", "images", "and", "as", "input", ".", "Subsequent", "networks", "get", ",", ",", "and", "the", "previous", "flow", "estimate", ",", "where", "denotes", "the", "index", "of", "the", "network", "in", "the", "stack", ".", "To", "make", "assessment", "of", "the", "previous", "error", "and", "computing", "an", "incremental", "update", "easier", "for", "the", "network", ",", "we", "also", "optionally", "warp", "the", "second", "image", "via", "the", "flow", "and", "bilinear", "interpolation", "to", ".", "This", "way", ",", "the", "next", "network", "in", "the", "stack", "can", "focus", "on", "the", "remaining", "increment", "between", "and", ".", "When", "using", "warping", ",", "we", "additionally", "provide", "and", "the", "error", "as", "input", "to", "the", "next", "network", ";", "see", "Figure", "[", "reference", "]", ".", "Thanks", "to", "bilinear", "interpolation", ",", "the", "derivatives", "of", "the", "warping", "operation", "can", "be", "computed", "(", "see", "supplemental", "material", "for", "details", ")", ".", "This", "enables", "training", "of", "stacked", "networks", "end", "-", "to", "-", "end", ".", "Table", "[", "reference", "]", "shows", "the", "effect", "of", "stacking", "two", "networks", ",", "the", "effect", "of", "warping", ",", "and", "the", "effect", "of", "end", "-", "to", "-", "end", "training", ".", "We", "take", "the", "best", "FlowNetS", "from", "Section", "[", "reference", "]", "and", "add", "another", "FlowNetS", "on", "top", ".", "The", "second", "network", "is", "initialized", "randomly", "and", "then", "the", "stack", "is", "trained", "on", "Chairs", "with", "the", "schedule", ".", "We", "experimented", "with", "two", "scenarios", ":", "keeping", "the", "weights", "of", "the", "first", "network", "fixed", ",", "or", "updating", "them", "together", "with", "the", "weights", "of", "the", "second", "network", ".", "In", "the", "latter", "case", ",", "the", "weights", "of", "the", "first", "network", "are", "fixed", "for", "the", "first", "400k", "iterations", "to", "first", "provide", "a", "good", "initialization", "of", "the", "second", "network", ".", "We", "report", "the", "error", "on", "Sintel", "train", "clean", "and", "on", "the", "test", "set", "of", "Chairs", ".", "Since", "the", "Chairs", "test", "set", "is", "much", "more", "similar", "to", "the", "training", "data", "than", "Sintel", ",", "comparing", "results", "on", "both", "datasets", "allows", "us", "to", "detect", "tendencies", "to", "over", "-", "fitting", ".", "We", "make", "the", "following", "observations", ":", "(", "1", ")", "Just", "stacking", "networks", "without", "warping", "improves", "results", "on", "Chairs", "but", "decreases", "performance", "on", "Sintel", ",", "i.e.", "the", "stacked", "network", "is", "over", "-", "fitting", ".", "(", "2", ")", "With", "warping", "included", ",", "stacking", "always", "improves", "results", ".", "(", "3", ")", "Adding", "an", "intermediate", "loss", "after", "Net1", "is", "advantageous", "when", "training", "the", "stacked", "network", "end", "-", "to", "-", "end", ".", "(", "4", ")", "The", "best", "results", "are", "obtained", "when", "keeping", "the", "first", "network", "fixed", "and", "only", "training", "the", "second", "network", "after", "the", "warping", "operation", ".", "Clearly", ",", "since", "the", "stacked", "network", "is", "twice", "as", "big", "as", "the", "single", "network", ",", "over", "-", "fitting", "is", "an", "issue", ".", "The", "positive", "effect", "of", "flow", "refinement", "after", "warping", "can", "counteract", "this", "problem", ",", "yet", "the", "best", "of", "both", "is", "obtained", "when", "the", "stacked", "networks", "are", "trained", "one", "after", "the", "other", ",", "since", "this", "avoids", "over", "-", "fitting", "while", "having", "the", "benefit", "of", "flow", "refinement", ".", "subsection", ":", "Stacking", "Multiple", "Diverse", "Networks", "Rather", "than", "stacking", "identical", "networks", ",", "it", "is", "possible", "to", "stack", "networks", "of", "different", "type", "(", "FlowNetC", "and", "FlowNetS", ")", ".", "Reducing", "the", "size", "of", "the", "individual", "networks", "is", "another", "valid", "option", ".", "We", "now", "investigate", "different", "combinations", "and", "additionally", "also", "vary", "the", "network", "size", ".", "We", "call", "the", "first", "network", "the", "bootstrap", "network", "as", "it", "differs", "from", "the", "second", "network", "by", "its", "inputs", ".", "The", "second", "network", "could", "however", "be", "repeated", "an", "arbitray", "number", "of", "times", "in", "a", "recurrent", "fashion", ".", "We", "conducted", "this", "experiment", "and", "found", "that", "applying", "a", "network", "with", "the", "same", "weights", "multiple", "times", "and", "also", "fine", "-", "tuning", "this", "recurrent", "part", "does", "not", "improve", "results", "(", "see", "supplemental", "material", "for", "details", ")", ".", "As", "also", "done", "in", ",", "we", "therefore", "add", "networks", "with", "different", "weights", "to", "the", "stack", ".", "Compared", "to", "identical", "weights", ",", "stacking", "networks", "with", "different", "weights", "increases", "the", "memory", "footprint", ",", "but", "does", "not", "increase", "the", "runtime", ".", "In", "this", "case", "the", "top", "networks", "are", "not", "constrained", "to", "a", "general", "improvement", "of", "their", "input", ",", "but", "can", "perform", "different", "tasks", "at", "different", "stages", "and", "the", "stack", "can", "be", "trained", "in", "smaller", "pieces", "by", "fixing", "existing", "networks", "and", "adding", "new", "networks", "one", "-", "by", "-", "one", ".", "We", "do", "so", "by", "using", "the", "Chairs", "Things3D", "schedule", "from", "Section", "[", "reference", "]", "for", "every", "new", "network", "and", "the", "best", "configuration", "with", "warping", "from", "Section", "[", "reference", "]", ".", "Furthermore", ",", "we", "experiment", "with", "different", "network", "sizes", "and", "alternatively", "use", "FlowNetS", "or", "FlowNetC", "as", "a", "bootstrapping", "network", ".", "We", "use", "FlowNetC", "only", "in", "case", "of", "the", "bootstrap", "network", ",", "as", "the", "input", "to", "the", "next", "network", "is", "too", "diverse", "to", "be", "properly", "handeled", "by", "the", "Siamese", "structure", "of", "FlowNetC.", "Smaller", "size", "versions", "of", "the", "networks", "were", "created", "by", "taking", "only", "a", "fraction", "of", "the", "number", "of", "channels", "for", "every", "layer", "in", "the", "network", ".", "Figure", "[", "reference", "]", "shows", "the", "network", "accuracy", "and", "runtime", "for", "different", "network", "sizes", "of", "a", "single", "FlowNetS.", "Factor", "yields", "a", "good", "trade", "-", "off", "between", "speed", "and", "accuracy", "when", "aiming", "for", "faster", "networks", ".", "Notation", ":", "We", "denote", "networks", "trained", "by", "the", "Chairs", "Things3D", "schedule", "from", "Section", "[", "reference", "]", "starting", "with", "FlowNet2", ".", "Networks", "in", "a", "stack", "are", "trained", "with", "this", "schedule", "one", "-", "by", "-", "one", ".", "For", "the", "stack", "configuration", "we", "append", "upper", "-", "or", "lower", "-", "case", "letters", "to", "indicate", "the", "original", "FlowNet", "or", "the", "thin", "version", "with", "of", "the", "channels", ".", "E.g", ":", "FlowNet2", "-", "CSS", "stands", "for", "a", "network", "stack", "consisting", "of", "one", "FlowNetC", "and", "two", "FlowNetS.", "FlowNet2", "-", "css", "is", "the", "same", "but", "with", "fewer", "channels", ".", "Table", "[", "reference", "]", "shows", "the", "performance", "of", "different", "network", "stacks", ".", "Most", "notably", ",", "the", "final", "FlowNet2", "-", "CSS", "result", "improves", "by", "over", "the", "single", "network", "FlowNet2", "-", "C", "from", "Section", "[", "reference", "]", "and", "by", "over", "the", "original", "FlowNetC", ".", "Furthermore", ",", "two", "small", "networks", "in", "the", "beginning", "always", "outperform", "one", "large", "network", ",", "despite", "being", "faster", "and", "having", "fewer", "weights", ":", "FlowNet2", "-", "ss", "(", "M", "weights", ")", "over", "FlowNet2", "-", "S", "(", "M", "weights", ")", ",", "and", "FlowNet2", "-", "cs", "(", "M", "weights", ")", "over", "FlowNet2", "-", "C", "(", "M", "weights", ")", ".", "Training", "smaller", "units", "step", "by", "step", "proves", "to", "be", "advantageous", "and", "enables", "us", "to", "train", "very", "deep", "networks", "for", "optical", "flow", ".", "At", "last", ",", "FlowNet2", "-", "s", "provides", "nearly", "the", "same", "accuracy", "as", "the", "original", "FlowNet", ",", "while", "running", "at", "frames", "per", "second", ".", "section", ":", "Small", "Displacements", "subsection", ":", "Datasets", "While", "the", "original", "FlowNet", "performed", "well", "on", "the", "Sintel", "benchmark", ",", "limitations", "in", "real", "-", "world", "applications", "have", "become", "apparent", ".", "In", "particular", ",", "the", "network", "can", "not", "reliably", "estimate", "small", "motions", "(", "see", "Figure", "[", "reference", "]", ")", ".", "This", "is", "counter", "-", "intuitive", ",", "since", "small", "motions", "are", "easier", "for", "traditional", "methods", ",", "and", "there", "is", "no", "obvious", "reason", "why", "networks", "should", "not", "reach", "the", "same", "performance", "in", "this", "setting", ".", "Thus", ",", "we", "examined", "the", "training", "data", "and", "compared", "it", "to", "the", "UCF101", "dataset", "as", "one", "example", "of", "real", "-", "world", "data", ".", "While", "Chairs", "are", "similar", "to", "Sintel", ",", "UCF101", "is", "fundamentally", "different", "(", "we", "refer", "to", "our", "supplemental", "material", "for", "the", "analysis", ")", ":", "Sintel", "is", "an", "action", "movie", "and", "as", "such", "contains", "many", "fast", "movements", "that", "are", "difficult", "for", "traditional", "methods", ",", "while", "the", "displacements", "we", "see", "in", "the", "UCF101", "dataset", "are", "much", "smaller", ",", "mostly", "smaller", "than", "pixel", ".", "Thus", ",", "we", "created", "a", "dataset", "in", "the", "visual", "style", "of", "Chairs", "but", "with", "very", "small", "displacements", "and", "a", "displacement", "histogram", "much", "more", "like", "UCF101", ".", "We", "also", "added", "cases", "with", "a", "background", "that", "is", "homogeneous", "or", "just", "consists", "of", "color", "gradients", ".", "We", "call", "this", "dataset", "ChairsSDHom", "and", "will", "release", "it", "upon", "publication", ".", "subsection", ":", "Small", "Displacement", "Network", "and", "Fusion", "We", "fine", "-", "tuned", "our", "FlowNet2", "-", "CSS", "network", "for", "smaller", "displacements", "by", "further", "training", "the", "whole", "network", "stack", "on", "a", "mixture", "of", "Things3D", "and", "ChairsSDHom", "and", "by", "applying", "a", "non", "-", "linearity", "to", "the", "error", "to", "downweight", "large", "displacements", ".", "We", "denote", "this", "network", "by", "FlowNet2", "-", "CSS", "-", "ft", "-", "sd", ".", "This", "increases", "performance", "on", "small", "displacements", "and", "we", "found", "that", "this", "particular", "mixture", "does", "not", "sacrifice", "performance", "on", "large", "displacements", ".", "However", ",", "in", "case", "of", "subpixel", "motion", ",", "noise", "still", "remains", "a", "problem", "and", "we", "conjecture", "that", "the", "FlowNet", "architecture", "might", "in", "general", "not", "be", "perfect", "for", "such", "motion", ".", "Therefore", ",", "we", "slightly", "modified", "the", "original", "FlowNetS", "architecture", "and", "removed", "the", "stride", "in", "the", "first", "layer", ".", "We", "made", "the", "beginning", "of", "the", "network", "deeper", "by", "exchanging", "the", "and", "kernels", "in", "the", "beginning", "with", "multiple", "kernels", ".", "Because", "noise", "tends", "to", "be", "a", "problem", "with", "small", "displacements", ",", "we", "add", "convolutions", "between", "the", "upconvolutions", "to", "obtain", "smoother", "estimates", "as", "in", ".", "We", "denote", "the", "resulting", "architecture", "by", "FlowNet2", "-", "SD", ";", "see", "Figure", "[", "reference", "]", ".", "Finally", ",", "we", "created", "a", "small", "network", "that", "fuses", "FlowNet2", "-", "CSS", "-", "ft", "-", "sd", "and", "FlowNet2", "-", "SD", "(", "see", "Figure", "[", "reference", "]", ")", ".", "The", "fusion", "network", "receives", "the", "flows", ",", "the", "flow", "magnitudes", "and", "the", "errors", "in", "brightness", "after", "warping", "as", "input", ".", "It", "contracts", "the", "resolution", "two", "times", "by", "a", "factor", "of", "and", "expands", "again", ".", "Contrary", "to", "the", "original", "FlowNet", "architecture", "it", "expands", "to", "the", "full", "resolution", ".", "We", "find", "that", "this", "produces", "crisp", "motion", "boundaries", "and", "performs", "well", "on", "small", "as", "well", "as", "on", "large", "displacements", ".", "We", "denote", "the", "final", "network", "as", "FlowNet2", ".", "section", ":", "Experiments", "We", "compare", "the", "best", "variants", "of", "our", "network", "to", "state", "-", "of", "-", "the", "-", "art", "approaches", "on", "public", "bechmarks", ".", "In", "addition", ",", "we", "provide", "a", "comparison", "on", "application", "tasks", ",", "such", "as", "motion", "segmentation", "and", "action", "recognition", ".", "This", "allows", "benchmarking", "the", "method", "on", "real", "data", ".", "subsection", ":", "Speed", "and", "Performance", "on", "Public", "Benchmarks", "MPI", "Sintel", "(", "train", "final", ")", "Average", "EPE", "Runtime", "(", "milliseconds", "per", "frame", ")", "CPU", "GPU", "Ours", "fps", "fps", "fps", "EpicFlow", "DeepFlow", "FlowField", "LDOF", "LDOF", "(", "GPU", ")", "PCA", "-", "Flow", "PCA", "-", "Layers", "DIS", "-", "Fast", "FlowNetS", "FlowNetC", "FN2", "-", "s", "FN2", "-", "ss", "FN2", "-", "css", "-", "ft", "-", "sd", "FN2", "-", "CSS", "-", "ft", "-", "sd", "FlowNet2", "Accurate", "Fast", "FlowNet", "2.0", "We", "evaluated", "all", "methods", "on", "a", "system", "with", "an", "Intel", "Xeon", "E5", "with", "2.40GHz", "and", "an", "Nvidia", "GTX", "1080", ".", "Where", "applicable", ",", "dataset", "-", "specific", "parameters", "were", "used", ",", "that", "yield", "best", "performance", ".", "Endpoint", "errors", "and", "runtimes", "are", "given", "in", "Table", "[", "reference", "]", ".", "Sintel", ":", "On", "Sintel", ",", "FlowNet2", "consistently", "outperforms", "DeepFlow", "and", "EpicFlow", "and", "is", "on", "par", "with", "FlowFields", ".", "All", "methods", "with", "comparable", "runtimes", "have", "clearly", "inferior", "accuracy", ".", "We", "fine", "-", "tuned", "FlowNet2", "on", "a", "mixture", "of", "Sintel", "clean", "+", "final", "training", "data", "(", "FlowNet2\u2013ft", "-", "sintel", ")", ".", "On", "the", "benchmark", ",", "in", "case", "of", "clean", "data", "this", "slightly", "degraded", "the", "result", ",", "while", "on", "final", "data", "FlowNet2\u2013ft", "-", "sintel", "is", "on", "par", "with", "the", "currently", "published", "state", "-", "of", "-", "the", "art", "method", "DeepDiscreteFlow", ".", "KITTI", ":", "On", "KITTI", ",", "the", "results", "of", "FlowNet2", "-", "CSS", "are", "comparable", "to", "EpicFlow", "and", "FlowFields", ".", "Fine", "-", "tuning", "on", "small", "displacement", "data", "degrades", "the", "result", ".", "This", "is", "probably", "due", "to", "KITTI", "containing", "very", "large", "displacements", "in", "general", ".", "Fine", "-", "tuning", "on", "a", "combination", "of", "the", "KITTI2012", "and", "KITTI2015", "training", "sets", "reduces", "the", "error", "roughly", "by", "a", "factor", "of", "(", "FlowNet2", "-", "ft", "-", "kitti", ")", ".", "Among", "non", "-", "stereo", "methods", "we", "obtain", "the", "best", "EPE", "on", "KITTI2012", "and", "the", "first", "rank", "on", "the", "KITTI2015", "benchmark", ".", "This", "shows", "how", "well", "and", "elegantly", "the", "learning", "approach", "can", "integrate", "the", "prior", "of", "the", "driving", "scenario", ".", "Middlebury", ":", "On", "the", "Middlebury", "training", "set", "FlowNet2", "performs", "comparable", "to", "traditional", "methods", ".", "The", "results", "on", "the", "Middlebury", "test", "set", "are", "unexpectedly", "a", "lot", "worse", ".", "Still", ",", "there", "is", "a", "large", "improvement", "compared", "to", "FlowNetS", ".", "Endpoint", "error", "vs.", "runtime", "evaluations", "for", "Sintel", "are", "provided", "in", "Figure", "[", "reference", "]", ".", "One", "can", "observe", "that", "the", "FlowNet2", "family", "outperforms", "the", "best", "and", "fastest", "existing", "methods", "by", "large", "margins", ".", "Depending", "on", "the", "type", "of", "application", ",", "a", "FlowNet2", "variant", "between", "8", "to", "140", "frames", "per", "second", "can", "be", "used", ".", "subsection", ":", "Qualitative", "Results", "Figures", "[", "reference", "]", "and", "[", "reference", "]", "show", "example", "results", "on", "Sintel", "and", "on", "real", "-", "world", "data", ".", "While", "the", "performance", "on", "Sintel", "is", "similar", "to", "FlowFields", ",", "we", "can", "see", "that", "on", "real", "world", "data", "FlowNet", "2.0", "clearly", "has", "advantages", "in", "terms", "of", "being", "robust", "to", "homogeneous", "regions", "(", "rows", "2", "and", "5", ")", ",", "image", "and", "compression", "artifacts", "(", "rows", "3", "and", "4", ")", "and", "it", "yields", "smooth", "flow", "fields", "with", "sharp", "motion", "boundaries", ".", "subsection", ":", "Performance", "on", "Motion", "Segmentation", "and", "Action", "Recognition", "To", "assess", "performance", "of", "FlowNet", "2.0", "in", "real", "-", "world", "applications", ",", "we", "compare", "the", "performance", "of", "action", "recognition", "and", "motion", "segmentation", ".", "For", "both", "applications", ",", "good", "optical", "flow", "is", "key", ".", "Thus", ",", "a", "good", "performance", "on", "these", "tasks", "also", "serves", "as", "an", "indicator", "for", "good", "optical", "flow", ".", "For", "motion", "segmentation", ",", "we", "rely", "on", "the", "well", "-", "established", "approach", "of", "Ochs", "to", "compute", "long", "term", "point", "trajectories", ".", "A", "motion", "segmentation", "is", "obtained", "from", "these", "using", "the", "state", "-", "of", "-", "the", "-", "art", "method", "from", "Keuper", ".", "The", "results", "are", "shown", "in", "Table", "[", "reference", "]", ".", "The", "original", "model", "in", "Ochs", "was", "built", "on", "Large", "Displacement", "Optical", "Flow", ".", "We", "included", "also", "other", "popular", "optical", "flow", "methods", "in", "the", "comparison", ".", "The", "old", "FlowNet", "was", "not", "useful", "for", "motion", "segmentation", ".", "In", "contrast", ",", "the", "FlowNet2", "is", "as", "reliable", "as", "other", "state", "-", "of", "-", "the", "-", "art", "methods", "while", "being", "orders", "of", "magnitude", "faster", ".", "Optical", "flow", "is", "also", "a", "crucial", "feature", "for", "action", "recognition", ".", "To", "assess", "the", "performance", ",", "we", "trained", "the", "temporal", "stream", "of", "the", "two", "-", "stream", "approach", "from", "Simonyan", "with", "different", "optical", "flow", "inputs", ".", "Table", "[", "reference", "]", "shows", "that", "FlowNetS", "did", "not", "provide", "useful", "results", ",", "while", "the", "flow", "from", "FlowNet", "2.0", "yields", "comparable", "results", "to", "state", "-", "of", "-", "the", "art", "methods", ".", "section", ":", "Conclusions", "We", "have", "presented", "several", "improvements", "to", "the", "FlowNet", "idea", "that", "have", "led", "to", "accuracy", "that", "is", "fully", "on", "par", "with", "state", "-", "of", "-", "the", "-", "art", "methods", "while", "FlowNet", "2.0", "runs", "orders", "of", "magnitude", "faster", ".", "We", "have", "quantified", "the", "effect", "of", "each", "contribution", "and", "showed", "that", "all", "play", "an", "important", "role", ".", "The", "experiments", "on", "motion", "segmentation", "and", "action", "recognition", "show", "that", "the", "estimated", "optical", "flow", "with", "FlowNet", "2.0", "is", "reliable", "on", "a", "large", "variety", "of", "scenes", "and", "applications", ".", "The", "FlowNet", "2.0", "family", "provides", "networks", "running", "at", "speeds", "from", "8", "to", "140fps", ".", "This", "further", "extends", "the", "possible", "range", "of", "applications", ".", "While", "the", "results", "on", "Middlebury", "indicate", "imperfect", "performance", "on", "subpixel", "motion", ",", "FlowNet", "2.0", "results", "highlight", "very", "crisp", "motion", "boundaries", ",", "retrieval", "of", "fine", "structures", ",", "and", "robustness", "to", "compression", "artifacts", ".", "Thus", ",", "we", "expect", "it", "to", "become", "the", "working", "horse", "for", "all", "applications", "that", "require", "accurate", "and", "fast", "optical", "flow", "computation", ".", "section", ":", "Acknowledgements", "We", "acknowledge", "funding", "by", "the", "ERC", "Starting", "Grant", "VideoLearn", ",", "the", "DFG", "Grant", "BR", "-", "3815", "/", "7", "-", "1", ",", "and", "the", "EU", "Horizon2020", "project", "TrimBot2020", ".", "bibliography", ":", "References", "section", ":", "Video", "Please", "see", "the", "supplementary", "video", "for", "FlowNet2", "results", "on", "a", "number", "of", "diverse", "video", "sequences", ",", "a", "comparison", "between", "FlowNet2", "and", "state", "-", "of", "-", "the", "-", "art", "methods", ",", "and", "an", "illustration", "of", "the", "speed", "/", "accuracy", "trade", "-", "off", "of", "the", "FlowNet", "2.0", "family", "of", "models", ".", "paragraph", ":", "Optical", "flow", "color", "coding", ".", "For", "optical", "flow", "visualization", "we", "use", "the", "color", "coding", "of", "Butler", ".", "The", "color", "coding", "scheme", "is", "illustrated", "in", "Figure", "[", "reference", "]", ".", "Hue", "represents", "the", "direction", "of", "the", "displacement", "vector", ",", "while", "the", "intensity", "of", "the", "color", "represents", "its", "magnitude", ".", "White", "color", "corresponds", "to", "no", "motion", ".", "Because", "the", "range", "of", "motions", "is", "very", "different", "in", "different", "image", "sequences", ",", "we", "scale", "the", "flow", "fields", "before", "visualization", ":", "independently", "for", "each", "image", "pair", "shown", "in", "figures", ",", "and", "independently", "for", "each", "video", "fragment", "in", "the", "supplementary", "video", ".", "Scaling", "is", "always", "the", "same", "for", "all", "methods", "being", "compared", ".", "section", ":", "Dataset", "Schedules", ":", "KITTI2015", "Results", "In", "Table", "[", "reference", "]", "we", "show", "more", "results", "of", "training", "networks", "with", "the", "original", "FlowNet", "schedule", "and", "the", "new", "FlowNet2", "schedules", "and", ".", "We", "provide", "the", "endpoint", "error", "when", "testing", "on", "the", "KITTI2015", "train", "dataset", ".", "Table", "1", "in", "the", "main", "paper", "shows", "the", "performance", "of", "the", "same", "networks", "on", "Sintel", ".", "One", "can", "observe", "that", "on", "KITTI2015", ",", "as", "well", "as", "on", "Sintel", ",", "training", "with", "on", "the", "combination", "of", "Chairs", "and", "Things3D", "works", "best", "(", "in", "the", "paper", "referred", "to", "as", "Chairs", "Things3D", "schedule", ")", ".", "section", ":", "Recurrently", "Stacking", "Networks", "with", "the", "Same", "Weights", "The", "bootstrap", "network", "differs", "from", "the", "succeeding", "networks", "by", "its", "task", "(", "it", "needs", "to", "predict", "a", "flow", "field", "from", "scratch", ")", "and", "inputs", "(", "it", "does", "not", "get", "a", "previous", "flow", "estimate", "and", "a", "warped", "image", ")", ".", "The", "network", "after", "the", "bootstrap", "network", "only", "refines", "the", "previous", "flow", "estimate", ",", "so", "it", "can", "be", "applied", "to", "its", "own", "output", "recursively", ".", "We", "took", "the", "best", "network", "from", "Table", "2", "of", "the", "main", "paper", "and", "applied", "Net2", "recursively", "multiple", "times", ".", "We", "then", "continued", "training", "the", "whole", "stack", "with", "multiple", "Net2", ".", "The", "difference", "from", "our", "final", "FlowNet2", "architecture", "is", "that", "here", "the", "weights", "are", "shared", "between", "the", "stacked", "networks", ",", "similar", "to", "a", "standard", "recurrent", "network", ".", "Results", "are", "given", "in", "Table", "[", "reference", "]", ".", "In", "all", "cases", "we", "observe", "no", "or", "negligible", "improvements", "compared", "to", "the", "baseline", "network", "with", "a", "single", "Net2", ".", "section", ":", "Small", "Displacements", "subsection", ":", "The", "ChairsSDHom", "Dataset", "As", "an", "example", "of", "real", "-", "world", "data", "we", "examine", "the", "UCF101", "dataset", ".", "We", "compute", "optical", "flow", "using", "LDOF", "and", "compare", "the", "flow", "magnitude", "distribution", "to", "the", "synthetic", "datasets", "we", "use", "for", "training", "and", "benchmarking", ",", "this", "is", "shown", "in", "Figure", "[", "reference", "]", ".", "While", "Chairs", "are", "similar", "to", "Sintel", ",", "UCF101", "is", "fundamentally", "different", "and", "contains", "much", "more", "small", "displacments", ".", "To", "create", "a", "training", "dataset", "similar", "to", "UCF101", ",", "following", ",", "we", "generated", "our", "ChairsSDHom", "(", "Chairs", "Small", "Displacement", "Homogeneous", ")", "dataset", "by", "randomly", "placing", "and", "moving", "chairs", "in", "front", "of", "randomized", "background", "images", ".", "However", ",", "we", "also", "followed", "Mayer", "in", "that", "our", "chairs", "are", "not", "flat", "2D", "bitmaps", "as", "in", ",", "but", "rendered", "3D", "objects", ".", "Similar", "to", "Mayer", ",", "we", "rendered", "our", "data", "first", "in", "a", "\u2018", "\u2018", "raw", "\u2019", "\u2019", "version", "to", "get", "blend", "-", "free", "flow", "boundaries", "and", "then", "a", "second", "time", "with", "antialiasing", "to", "obtain", "the", "color", "images", ".", "To", "match", "the", "characteristic", "contents", "of", "the", "UCF101", "dataset", ",", "we", "mostly", "applied", "small", "motions", ".", "We", "added", "scenes", "with", "weakly", "textured", "background", "to", "the", "dataset", ",", "being", "monochrome", "or", "containing", "a", "very", "subtle", "color", "gradient", ".", "Such", "monotonous", "backgrounds", "are", "not", "unusual", "in", "natural", "videos", ",", "but", "almost", "never", "appear", "in", "Chairs", "or", "Things3D.", "A", "featureless", "background", "can", "potentially", "move", "in", "any", "direction", "(", "an", "extreme", "case", "of", "the", "aperture", "problem", ")", ",", "so", "we", "kept", "these", "background", "images", "fixed", "to", "introduce", "a", "meaningful", "prior", "into", "the", "dataset", ".", "Example", "images", "from", "the", "dataset", "are", "shown", "in", "Figure", "[", "reference", "]", ".", "fraction", "of", "displacement", "bin", "ChairsSDHom", "UCF101", "FlyingThings3D", "FlyingChairs", "Sintel", "subsection", ":", "Fine", "-", "Tuning", "FlowNet2", "-", "CSS", "-", "ft", "-", "sd", "With", "the", "new", "ChairsSDHom", "dataset", "we", "fine", "-", "tuned", "our", "FlowNet2", "-", "CSS", "network", "for", "smaller", "displacements", "(", "we", "denote", "this", "by", "FlowNet2", "-", "CSS", "-", "ft", "-", "sd", ")", ".", "We", "experimented", "with", "different", "configurations", "to", "avoid", "sacrificing", "performance", "on", "large", "displacements", ".", "We", "found", "the", "best", "performance", "can", "be", "achieved", "by", "training", "with", "mini", "-", "batches", "of", "samples", ":", "from", "Things3D", "and", "from", "ChairsSDHom", ".", "Furthermore", ",", "we", "applied", "a", "nonlinearity", "of", "to", "the", "endpoint", "error", "to", "emphasize", "the", "small", "-", "magnitude", "flows", ".", "subsection", ":", "Network", "Architectures", "The", "architectures", "of", "the", "small", "displacement", "network", "and", "the", "fusion", "network", "are", "shown", "in", "Tables", "[", "reference", "]", "and", "[", "reference", "]", ".", "The", "input", "to", "the", "small", "displacement", "network", "is", "formed", "by", "concatenating", "both", "RGB", "images", ",", "resulting", "in", "input", "channels", ".", "The", "network", "is", "in", "general", "similar", "to", "FlowNetS.", "Differences", "are", "the", "smaller", "strides", "and", "smaller", "kernel", "sizes", "in", "the", "beginning", "and", "the", "convolutions", "between", "the", "upconvolutions", ".", "The", "fusion", "network", "is", "trained", "to", "merge", "the", "flow", "estimates", "of", "two", "previously", "trained", "networks", ",", "and", "this", "task", "dictates", "the", "input", "structure", ".", "We", "feed", "the", "following", "data", "into", "the", "network", ":", "the", "first", "image", "from", "the", "image", "pair", ",", "two", "estimated", "flow", "fields", ",", "their", "magnitudes", ",", "and", "finally", "the", "two", "squared", "Euclidean", "photoconsistency", "errors", ",", "that", "is", ",", "per", "-", "pixel", "squared", "Euclidean", "distance", "between", "the", "first", "image", "and", "the", "second", "image", "warped", "with", "the", "predicted", "flow", "field", ".", "This", "sums", "up", "to", "channels", ".", "Note", "that", "we", "do", "not", "input", "the", "second", "image", "directly", ".", "All", "inputs", "are", "at", "full", "image", "resolution", ",", "flow", "field", "estimates", "from", "previous", "networks", "are", "upsampled", "with", "nearest", "neighbor", "upsampling", ".", "section", ":", "Evaluation", "subsection", ":", "Intermediate", "Results", "in", "Stacked", "Networks", "The", "idea", "of", "the", "stacked", "network", "architecture", "is", "that", "the", "estimated", "flow", "field", "is", "gradually", "improved", "by", "every", "network", "in", "the", "stack", ".", "This", "improvement", "has", "been", "quantitatively", "shown", "in", "the", "paper", ".", "Here", ",", "we", "additionally", "show", "qualitative", "examples", "which", "clearly", "highlight", "this", "effect", ".", "The", "improvement", "is", "especially", "dramatic", "for", "small", "displacements", ",", "as", "illustrated", "in", "Figure", "[", "reference", "]", ".", "The", "initial", "prediction", "of", "FlowNet2", "-", "C", "is", "very", "noisy", ",", "but", "is", "then", "significantly", "refined", "by", "the", "two", "succeeding", "networks", ".", "The", "FlowNet2", "-", "SD", "network", ",", "specifically", "trained", "on", "small", "displacements", ",", "estimates", "small", "displacements", "well", "even", "without", "additional", "refinement", ".", "Best", "results", "are", "obtained", "by", "fusing", "both", "estimated", "flow", "fields", ".", "Figure", "[", "reference", "]", "illustrates", "this", "for", "a", "large", "displacement", "case", ".", "MPI", "Sintel", "(", "train", "final", ")", "Average", "EPE", "Runtime", "(", "milliseconds", "per", "frame", ")", "CPU", "GPU", "Ours", "fps", "fps", "fps", "EpicFlow", "DeepFlow", "FlowFields", "LDOF", "LDOF", "(", "GPU", ")", "PCA", "-", "Flow", "PCA", "-", "Layers", "DIS", "-", "Fast", "FlowNetS", "FlowNetC", "FN2", "-", "s", "FN2", "-", "ss", "FN2", "-", "css", "-", "ft", "-", "sd", "FN2", "-", "CSS", "-", "ft", "-", "sd", "FlowNet2", "KITTI", "2012", "(", "train", ")", "Average", "EPE", "Runtime", "(", "milliseconds", "per", "frame", ")", "CPU", "GPU", "Ours", "fps", "fps", "fps", "EpicFlow", "DeepFlow", "FlowFields", "LDOF", "LDOF", "(", "GPU", ")", "PCA", "-", "Flow", "PCA", "-", "Layers", "DIS", "-", "Fast", "FlowNetS", "FlowNetC", "FN2", "-", "s", "FN2", "-", "ss", "FN2", "-", "css", "-", "ft", "-", "sd", "FN2", "-", "CSS", "-", "ft", "-", "sd", "FlowNet2", "subsection", ":", "Speed", "and", "Performance", "on", "KITTI2012", "Figure", "[", "reference", "]", "shows", "runtime", "vs.", "endpoint", "error", "comparisons", "of", "various", "optical", "flow", "estimation", "methods", "on", "two", "datasets", ":", "Sintel", "(", "also", "shown", "in", "the", "main", "paper", ")", "and", "KITTI2012", ".", "In", "both", "cases", "models", "of", "the", "FlowNet", "2.0", "family", "offer", "an", "excellent", "speed", "/", "accuracy", "trade", "-", "off", ".", "Networks", "fine", "-", "tuned", "on", "KITTI", "are", "not", "shown", ".", "The", "corresponding", "points", "would", "be", "below", "the", "lower", "border", "of", "the", "KITTI2012", "plot", ".", "subsection", ":", "Motion", "Segmentation", "Table", "[", "reference", "]", "shows", "detailed", "results", "on", "motion", "segmentation", "obtained", "using", "the", "algorithms", "from", "with", "flow", "fields", "from", "different", "methods", "as", "input", ".", "For", "FlowNetS", "the", "algorithm", "does", "not", "fully", "converge", "after", "one", "week", "on", "the", "training", "set", ".", "Due", "to", "the", "bad", "flow", "estimations", "of", "FlowNetS", ",", "only", "very", "short", "trajectories", "can", "be", "computed", "(", "on", "average", "about", "frames", ")", ",", "yielding", "an", "excessive", "number", "of", "trajectories", ".", "Therefore", "we", "do", "not", "evaluate", "FlowNetS", "on", "the", "test", "set", ".", "On", "all", "metrics", ",", "FlowNet2", "is", "at", "least", "on", "par", "with", "the", "best", "optical", "flow", "estimation", "methods", "and", "on", "the", "VI", "(", "variation", "of", "information", ")", "metric", "it", "is", "even", "significantly", "better", ".", "subsection", ":", "Qualitative", "results", "on", "KITTI2015", "Figure", "[", "reference", "]", "shows", "qualitative", "results", "on", "the", "KITTI2015", "dataset", ".", "FlowNet2", "-", "kitti", "has", "not", "been", "trained", "on", "these", "images", "during", "fine", "-", "tuning", ".", "KITTI", "ground", "truth", "is", "sparse", ",", "so", "for", "better", "visualization", "we", "interpolated", "the", "ground", "truth", "with", "bilinear", "interpolation", ".", "FlowNet2", "-", "kitti", "significantly", "outperforms", "competing", "approaches", "both", "quantitatively", "and", "qualitatively", ".", "section", ":", "Warping", "Layer", "The", "following", "two", "sections", "give", "the", "mathematical", "details", "of", "forward", "and", "backward", "passes", "through", "the", "warping", "layer", "used", "to", "stack", "networks", ".", "subsection", ":", "Definitions", "and", "Bilinear", "Interpolation", "Let", "the", "image", "coordinates", "be", "and", "the", "set", "of", "valid", "image", "coordinates", ".", "Let", "denote", "the", "image", "and", "the", "flow", "field", ".", "The", "image", "can", "also", "be", "a", "feature", "map", "and", "have", "arbitrarily", "many", "channels", ".", "Let", "channel", "be", "denoted", "with", ".", "We", "define", "the", "coefficients", ":", "and", "compute", "a", "continuous", "version", "of", "using", "bilinear", "interpolation", "in", "the", "usual", "way", ":", "subsection", ":", "Forward", "Pass", "During", "the", "forward", "pass", ",", "we", "compute", "the", "warped", "image", "by", "following", "the", "flow", "vectors", ".", "We", "define", "all", "pixels", "to", "be", "zero", "where", "the", "flow", "points", "outside", "of", "the", "image", ":", "subsection", ":", "Backward", "Pass", "During", "the", "backward", "pass", ",", "we", "need", "to", "compute", "the", "derivative", "of", "with", "respect", "to", "its", "inputs", "and", ",", "where", "and", "are", "different", "integer", "image", "locations", ".", "Let", "if", "is", "true", "and", "0", "otherwise", ",", "and", "let", ".", "For", "brevity", ",", "we", "omit", "the", "dependence", "of", "and", "on", ".", "The", "derivative", "with", "respect", "to", "is", "then", "computed", "as", "follows", ":", "The", "derivative", "with", "respect", "to", "the", "first", "component", "of", "the", "flow", "is", "computed", "as", "follows", ":", "In", "the", "non", "-", "trivial", "case", ",", "the", "derivative", "is", "computed", "as", "follows", ":", "Note", "that", "the", "ceiling", "and", "floor", "functions", "(", ",", ")", "are", "non", "-", "differentiable", "at", "points", "with", "integer", "coordinates", "and", "we", "use", "directional", "derivatives", "in", "these", "cases", ".", "The", "derivative", "with", "respect", "to", "is", "analogous", "."]}