{"coref": {"CIFAR-10": [[4198, 4201], [4926, 4929], [5239, 5242], [5309, 5312]], "Conditional_Image_Generation": [[5052, 5054]], "Inception_score": [[4974, 4976], [5056, 5058], [5075, 5077], [5096, 5098], [5286, 5288]], "SteinGAN": [[1289, 1290], [1574, 1575], [3896, 3897], [4191, 4192], [4952, 4953], [5018, 5019], [5099, 5100], [5133, 5134], [5207, 5208], [5269, 5270], [5336, 5337], [5397, 5398], [4264, 4265], [5196, 5197], [5374, 5375]]}, "coref_non_salient": {"0": [[1696, 1698], [4428, 4432]], "1": [[46, 48], [289, 290], [851, 854]], "10": [[2950, 2952], [3419, 3421]], "100": [[1948, 1951]], "101": [[3550, 3553]], "102": [[1882, 1884], [3068, 3070]], "103": [[3800, 3802]], "104": [[1750, 1754]], "105": [[931, 933]], "106": [[3561, 3564]], "107": [[1504, 1507]], "108": [[351, 354]], "109": [[2543, 2545]], "11": [[1464, 1465], [2323, 2324], [3232, 3233]], "110": [[3037, 3040]], "111": [[2083, 2090]], "112": [[1910, 1912]], "113": [[2524, 2530]], "114": [[3496, 3501]], "115": [[1822, 1825]], "116": [[4070, 4078]], "117": [[195, 197]], "118": [[1533, 1537], [1786, 1790], [4229, 4233], [4274, 4278]], "119": [[130, 133]], "12": [[141, 143], [165, 167], [1272, 1274], [1301, 1303], [1591, 1593], [1618, 1620], [1651, 1653], [1660, 1662], [1678, 1680], [4604, 4606], [5364, 5366], [5391, 5393]], "120": [[21, 25]], "121": [[1180, 1182]], "122": [[697, 701]], "123": [[2958, 2961]], "124": [[322, 324], [2692, 2694]], "125": [[793, 795]], "126": [[4875, 4879]], "13": [[135, 138], [160, 163], [1297, 1299], [1582, 1585], [1600, 1602], [1628, 1631], [4282, 4284], [4774, 4776]], "14": [[703, 705], [3302, 3304], [3335, 3337]], "15": [[1571, 1572], [1638, 1639], [3930, 3931], [4316, 4317], [4741, 4742], [4778, 4779]], "16": [[1885, 1888], [2640, 2645]], "17": [[2136, 2139], [4366, 4368]], "18": [[5303, 5305]], "19": [[1914, 1916], [3383, 3386]], "2": [[2131, 2133], [4393, 4394]], "20": [[1795, 1799], [1802, 1806], [2222, 2225], [2931, 2934], [67, 70], [1151, 1154], [2834, 2837], [3161, 3164], [3275, 3278]], "21": [[4743, 4745]], "22": [[996, 998], [1076, 1078]], "23": [[2637, 2639], [3229, 3231], [3871, 3873]], "24": [[3626, 3629], [3822, 3826], [3910, 3912], [4162, 4165]], "25": [[1768, 1771], [3593, 3596], [4136, 4139]], "26": [[4988, 4989], [5332, 5333]], "27": [[188, 190], [1462, 1463], [1488, 1489]], "28": [[5317, 5319], [5339, 5341]], "29": [[2739, 2742]], "3": [[20, 21], [3507, 3510], [5377, 5380]], "30": [[3124, 3126], [3848, 3850]], "31": [[5334, 5335]], "32": [[17, 19], [3504, 3506], [3541, 3544], [3935, 3937]], "33": [[876, 881]], "34": [[4239, 4240], [4884, 4885], [4906, 4907], [4950, 4951], [5016, 5017], [5109, 5110], [5204, 5205], [5267, 5268], [5342, 5343]], "35": [[3155, 3157]], "36": [[4756, 4757]], "37": [[4594, 4598]], "38": [[3012, 3015]], "39": [[1772, 1774], [4140, 4142]], "4": [[613, 619], [743, 746], [860, 862], [1113, 1115], [3298, 3300]], "40": [[4763, 4765], [4810, 4812]], "41": [[1564, 1565], [1622, 1623], [4739, 4740], [4769, 4770]], "42": [[3546, 3549]], "43": [[4658, 4659]], "44": [[1371, 1375]], "45": [[3751, 3757]], "46": [[1340, 1342], [1358, 1361]], "47": [[156, 158], [1293, 1295], [3906, 3908]], "48": [[4635, 4638]], "49": [[2091, 2092]], "5": [[1033, 1035], [1054, 1057], [1379, 1382]], "50": [[2400, 2401], [4029, 4031]], "51": [[4214, 4215]], "52": [[1212, 1214], [4334, 4336], [4627, 4629]], "53": [[1323, 1326], [3670, 3673]], "54": [[3938, 3942]], "55": [[4984, 4986], [5117, 5119], [5137, 5139]], "56": [[623, 624], [826, 828]], "57": [[4792, 4793], [4880, 4882]], "58": [[4530, 4533], [4572, 4575], [5212, 5214], [5273, 5275]], "59": [[1733, 1735]], "6": [[210, 212], [225, 227]], "60": [[1923, 1924]], "61": [[275, 279], [3597, 3601]], "62": [[327, 329], [1241, 1243]], "63": [[1917, 1920]], "64": [[2549, 2554]], "65": [[1156, 1157], [1515, 1516], [1700, 1701], [1800, 1801], [1807, 1808], [1872, 1873], [1939, 1940], [1971, 1972], [2181, 2182], [2394, 2395], [2632, 2633], [2734, 2735], [2769, 2770], [2783, 2784], [4361, 4362], [1176, 1177], [1208, 1209], [2659, 2660], [2666, 2667], [2750, 2751], [2798, 2799], [4104, 4105]], "66": [[1353, 1355]], "67": [[720, 725]], "68": [[631, 633]], "69": [[4287, 4288], [4375, 4376]], "7": [[428, 432], [3920, 3925], [3946, 3951]], "70": [[2810, 2812]], "71": [[748, 750]], "72": [[2164, 2167]], "73": [[1081, 1091]], "74": [[4208, 4213]], "75": [[1844, 1849]], "76": [[204, 206]], "77": [[2669, 2673]], "78": [[928, 930]], "79": [[4419, 4422]], "8": [[337, 340], [3711, 3719]], "80": [[1327, 1328], [3674, 3675], [1521, 1522], [4303, 4304], [5012, 5013]], "81": [[4798, 4800], [4841, 4843]], "82": [[1263, 1269]], "83": [[1578, 1580], [1658, 1659], [3554, 3555], [3636, 3638], [3943, 3945]], "84": [[781, 786]], "85": [[3517, 3520]], "86": [[1831, 1834]], "87": [[2468, 2473]], "88": [[2649, 2655]], "89": [[1117, 1121]], "9": [[229, 233], [3604, 3605]], "90": [[993, 995]], "91": [[364, 367]], "92": [[1815, 1820]], "93": [[1927, 1928]], "94": [[35, 38]], "95": [[3053, 3055]], "96": [[5169, 5170]], "97": [[1559, 1562]], "98": [[103, 107]], "99": [[1691, 1694]]}, "doc_id": "0fa88943665de1176b0fc6de4ed7469b40cdb08c", "method_subrelations": {"SteinGAN": [[[0, 8], "SteinGAN"]]}, "n_ary_relations": [{"Material": "CIFAR-10", "Method": "SteinGAN", "Metric": "Inception_score", "Task": "Conditional_Image_Generation", "score": "6.35"}], "ner": [[17, 19, "Method"], [20, 21, "Task"], [21, 25, "Method"], [35, 38, "Method"], [46, 48, "Task"], [103, 107, "Method"], [130, 133, "Method"], [135, 138, "Method"], [141, 143, "Method"], [156, 158, "Method"], [160, 163, "Method"], [165, 167, "Method"], [188, 190, "Task"], [195, 197, "Method"], [204, 206, "Task"], [210, 212, "Method"], [225, 227, "Method"], [229, 233, "Method"], [275, 279, "Method"], [289, 290, "Task"], [322, 324, "Task"], [327, 329, "Task"], [337, 340, "Method"], [351, 354, "Method"], [364, 367, "Metric"], [428, 432, "Method"], [613, 619, "Method"], [623, 624, "Method"], [631, 633, "Method"], [697, 701, "Method"], [703, 705, "Method"], [720, 725, "Task"], [743, 746, "Method"], [748, 750, "Method"], [781, 786, "Metric"], [793, 795, "Metric"], [826, 828, "Method"], [851, 854, "Task"], [860, 862, "Method"], [876, 881, "Method"], [928, 930, "Task"], [931, 933, "Task"], [993, 995, "Metric"], [996, 998, "Metric"], [1033, 1035, "Method"], [1054, 1057, "Method"], [1076, 1078, "Metric"], [1081, 1091, "Method"], [1113, 1115, "Method"], [1117, 1121, "Method"], [1156, 1157, "Method"], [1180, 1182, "Method"], [1212, 1214, "Method"], [1241, 1243, "Task"], [1263, 1269, "Method"], [1272, 1274, "Method"], [1289, 1290, "Method"], [1293, 1295, "Method"], [1297, 1299, "Method"], [1301, 1303, "Method"], [1323, 1326, "Method"], [1327, 1328, "Method"], [1340, 1342, "Method"], [1353, 1355, "Task"], [1358, 1361, "Method"], [1371, 1375, "Method"], [1379, 1382, "Method"], [1462, 1463, "Task"], [1464, 1465, "Task"], [1488, 1489, "Task"], [1504, 1507, "Task"], [1515, 1516, "Method"], [1533, 1537, "Task"], [1559, 1562, "Method"], [1564, 1565, "Method"], [1571, 1572, "Method"], [1574, 1575, "Method"], [1578, 1580, "Method"], [1582, 1585, "Method"], [1591, 1593, "Method"], [1600, 1602, "Method"], [1618, 1620, "Method"], [1622, 1623, "Method"], [1628, 1631, "Method"], [1638, 1639, "Method"], [1651, 1653, "Method"], [1658, 1659, "Method"], [1660, 1662, "Method"], [1678, 1680, "Method"], [1691, 1694, "Method"], [1696, 1698, "Method"], [1700, 1701, "Method"], [1733, 1735, "Method"], [1750, 1754, "Method"], [1768, 1771, "Method"], [1772, 1774, "Method"], [1786, 1790, "Task"], [1795, 1799, "Method"], [1800, 1801, "Method"], [1802, 1806, "Method"], [1807, 1808, "Method"], [1815, 1820, "Method"], [1822, 1825, "Method"], [1831, 1834, "Method"], [1844, 1849, "Method"], [1872, 1873, "Method"], [1882, 1884, "Method"], [1885, 1888, "Task"], [1910, 1912, "Task"], [1914, 1916, "Method"], [1917, 1920, "Method"], [1923, 1924, "Method"], [1927, 1928, "Method"], [1939, 1940, "Method"], [1948, 1951, "Method"], [1971, 1972, "Method"], [2083, 2090, "Method"], [2091, 2092, "Method"], [2131, 2133, "Method"], [2136, 2139, "Method"], [2164, 2167, "Method"], [2181, 2182, "Method"], [2222, 2225, "Method"], [2323, 2324, "Task"], [2394, 2395, "Method"], [2400, 2401, "Task"], [2468, 2473, "Method"], [2524, 2530, "Metric"], [2543, 2545, "Method"], [2549, 2554, "Task"], [2632, 2633, "Method"], [2637, 2639, "Method"], [2640, 2645, "Task"], [2649, 2655, "Task"], [2669, 2673, "Method"], [2692, 2694, "Task"], [2734, 2735, "Method"], [2739, 2742, "Method"], [2769, 2770, "Method"], [2783, 2784, "Method"], [2810, 2812, "Method"], [2931, 2934, "Method"], [2950, 2952, "Method"], [2958, 2961, "Method"], [3012, 3015, "Method"], [3037, 3040, "Task"], [3053, 3055, "Method"], [3068, 3070, "Method"], [3124, 3126, "Method"], [3155, 3157, "Method"], [3229, 3231, "Method"], [3232, 3233, "Task"], [3298, 3300, "Method"], [3302, 3304, "Method"], [3335, 3337, "Method"], [3383, 3386, "Method"], [3419, 3421, "Method"], [3496, 3501, "Method"], [3504, 3506, "Method"], [3507, 3510, "Task"], [3517, 3520, "Method"], [3541, 3544, "Method"], [3546, 3549, "Method"], [3550, 3553, "Method"], [3554, 3555, "Method"], [3561, 3564, "Task"], [3593, 3596, "Method"], [3597, 3601, "Method"], [3604, 3605, "Method"], [3626, 3629, "Method"], [3636, 3638, "Method"], [3670, 3673, "Method"], [3674, 3675, "Method"], [3711, 3719, "Method"], [3751, 3757, "Method"], [3800, 3802, "Metric"], [3822, 3826, "Method"], [3848, 3850, "Method"], [3871, 3873, "Method"], [3896, 3897, "Method"], [3906, 3908, "Method"], [3910, 3912, "Method"], [3920, 3925, "Method"], [3930, 3931, "Method"], [3935, 3937, "Method"], [3938, 3942, "Method"], [3943, 3945, "Method"], [3946, 3951, "Method"], [4029, 4031, "Task"], [4070, 4078, "Method"], [4136, 4139, "Method"], [4140, 4142, "Method"], [4162, 4165, "Method"], [4191, 4192, "Method"], [4198, 4201, "Material"], [4208, 4213, "Task"], [4214, 4215, "Task"], [4229, 4233, "Task"], [4239, 4240, "Method"], [4274, 4278, "Task"], [4282, 4284, "Method"], [4287, 4288, "Method"], [4316, 4317, "Method"], [4334, 4336, "Method"], [4361, 4362, "Method"], [4366, 4368, "Method"], [4375, 4376, "Method"], [4393, 4394, "Method"], [4419, 4422, "Method"], [4428, 4432, "Method"], [4530, 4533, "Method"], [4572, 4575, "Method"], [4594, 4598, "Method"], [4604, 4606, "Method"], [4627, 4629, "Method"], [4635, 4638, "Method"], [4658, 4659, "Task"], [4739, 4740, "Method"], [4741, 4742, "Method"], [4743, 4745, "Method"], [4756, 4757, "Method"], [4763, 4765, "Metric"], [4769, 4770, "Method"], [4774, 4776, "Method"], [4778, 4779, "Method"], [4792, 4793, "Task"], [4798, 4800, "Method"], [4810, 4812, "Metric"], [4841, 4843, "Method"], [4875, 4879, "Method"], [4880, 4882, "Task"], [4884, 4885, "Method"], [4906, 4907, "Method"], [4926, 4929, "Material"], [4950, 4951, "Method"], [4952, 4953, "Method"], [4974, 4976, "Metric"], [4984, 4986, "Metric"], [4988, 4989, "Method"], [5016, 5017, "Method"], [5018, 5019, "Method"], [5052, 5054, "Task"], [5056, 5058, "Metric"], [5075, 5077, "Metric"], [5096, 5098, "Metric"], [5099, 5100, "Method"], [5109, 5110, "Method"], [5117, 5119, "Metric"], [5133, 5134, "Method"], [5137, 5139, "Metric"], [5169, 5170, "Method"], [5204, 5205, "Method"], [5207, 5208, "Method"], [5212, 5214, "Method"], [5239, 5242, "Material"], [5267, 5268, "Method"], [5269, 5270, "Method"], [5273, 5275, "Method"], [5286, 5288, "Metric"], [5303, 5305, "Method"], [5309, 5312, "Material"], [5317, 5319, "Metric"], [5332, 5333, "Method"], [5334, 5335, "Task"], [5336, 5337, "Method"], [5339, 5341, "Metric"], [5342, 5343, "Method"], [5364, 5366, "Method"], [5377, 5380, "Task"], [5391, 5393, "Method"], [5397, 5398, "Method"], [67, 70, "Method"], [1151, 1154, "Method"], [1176, 1177, "Method"], [1208, 1209, "Method"], [1521, 1522, "Method"], [2659, 2660, "Method"], [2666, 2667, "Method"], [2750, 2751, "Method"], [2798, 2799, "Method"], [2834, 2837, "Method"], [3161, 3164, "Method"], [3275, 3278, "Method"], [4104, 4105, "Method"], [4264, 4265, "Method"], [4303, 4304, "Method"], [5012, 5013, "Method"], [5196, 5197, "Method"], [5374, 5375, "Method"]], "sections": [[0, 25], [25, 184], [184, 590], [590, 1793], [1793, 3502], [3502, 4184], [4184, 4266], [4266, 4889], [4889, 5193], [5193, 5354], [5354, 5394], [5394, 5398], [5398, 5400]], "sentences": [[0, 11], [11, 14], [14, 21], [21, 25], [25, 28], [28, 49], [49, 85], [85, 120], [120, 152], [152, 184], [184, 187], [187, 202], [202, 222], [222, 244], [244, 274], [274, 302], [302, 341], [341, 377], [377, 413], [413, 424], [424, 500], [500, 540], [540, 578], [578, 590], [590, 594], [594, 620], [620, 660], [660, 712], [712, 805], [805, 846], [846, 866], [866, 922], [922, 959], [959, 968], [968, 1095], [1095, 1123], [1123, 1158], [1158, 1173], [1173, 1201], [1201, 1252], [1252, 1283], [1283, 1329], [1329, 1335], [1335, 1337], [1337, 1379], [1379, 1395], [1395, 1410], [1410, 1416], [1416, 1493], [1493, 1517], [1517, 1524], [1524, 1573], [1573, 1654], [1654, 1710], [1710, 1744], [1744, 1793], [1793, 1802], [1802, 1834], [1834, 1840], [1840, 1872], [1872, 1929], [1929, 1971], [1971, 1990], [1990, 2029], [2029, 2073], [2073, 2116], [2116, 2140], [2140, 2172], [2172, 2177], [2177, 2178], [2178, 2199], [2199, 2203], [2203, 2206], [2206, 2210], [2210, 2212], [2212, 2225], [2225, 2232], [2232, 2248], [2248, 2291], [2291, 2320], [2320, 2330], [2330, 2360], [2360, 2373], [2373, 2402], [2402, 2403], [2403, 2420], [2420, 2445], [2445, 2450], [2450, 2477], [2477, 2480], [2480, 2483], [2483, 2492], [2492, 2497], [2497, 2501], [2501, 2504], [2504, 2509], [2509, 2532], [2532, 2540], [2540, 2576], [2576, 2594], [2594, 2601], [2601, 2615], [2615, 2620], [2620, 2625], [2625, 2657], [2657, 2661], [2661, 2729], [2729, 2760], [2760, 2786], [2786, 2806], [2806, 2826], [2826, 2856], [2856, 2901], [2901, 2903], [2903, 2913], [2913, 2930], [2930, 2934], [2934, 2947], [2947, 2950], [2950, 2961], [2961, 2986], [2986, 2988], [2988, 2998], [2998, 3016], [3016, 3026], [3026, 3041], [3041, 3056], [3056, 3083], [3083, 3134], [3134, 3170], [3170, 3206], [3206, 3208], [3208, 3233], [3233, 3251], [3251, 3286], [3286, 3304], [3304, 3322], [3322, 3333], [3333, 3346], [3346, 3350], [3350, 3356], [3356, 3367], [3367, 3372], [3372, 3376], [3376, 3379], [3379, 3392], [3392, 3415], [3415, 3464], [3464, 3472], [3472, 3487], [3487, 3502], [3502, 3510], [3510, 3532], [3532, 3550], [3550, 3589], [3589, 3620], [3620, 3676], [3676, 3682], [3682, 3690], [3690, 3708], [3708, 3721], [3721, 3737], [3737, 3750], [3750, 3758], [3758, 3761], [3761, 3798], [3798, 3814], [3814, 3828], [3828, 3854], [3854, 3866], [3866, 3888], [3888, 3892], [3892, 3953], [3953, 3961], [3961, 3968], [3968, 3971], [3971, 3973], [3973, 3979], [3979, 3980], [3980, 3981], [3981, 3991], [3991, 4023], [4023, 4029], [4029, 4031], [4031, 4052], [4052, 4054], [4054, 4057], [4057, 4068], [4068, 4129], [4129, 4184], [4184, 4188], [4188, 4216], [4216, 4244], [4244, 4253], [4253, 4266], [4266, 4270], [4270, 4289], [4289, 4295], [4295, 4323], [4323, 4356], [4356, 4384], [4384, 4414], [4414, 4446], [4446, 4453], [4453, 4484], [4484, 4511], [4511, 4523], [4523, 4571], [4571, 4579], [4579, 4599], [4599, 4641], [4641, 4642], [4642, 4658], [4658, 4659], [4659, 4674], [4674, 4691], [4691, 4701], [4701, 4732], [4732, 4781], [4781, 4872], [4872, 4889], [4889, 4892], [4892, 4905], [4905, 4926], [4926, 4942], [4942, 4965], [4965, 5015], [5015, 5042], [5042, 5092], [5092, 5111], [5111, 5151], [5151, 5181], [5181, 5193], [5193, 5197], [5197, 5200], [5200, 5209], [5209, 5228], [5228, 5234], [5234, 5243], [5243, 5244], [5244, 5262], [5262, 5279], [5279, 5284], [5284, 5315], [5315, 5336], [5336, 5344], [5344, 5354], [5354, 5357], [5357, 5381], [5381, 5394], [5394, 5398], [5398, 5400]], "words": ["Under", "review", "as", "a", "conference", "paper", "at", "ICLR", "2017", "LEARNING", "TO", "DRAW", "SAMPLES", ":", "WITH", "APPLICATION", "TO", "AMORTIZED", "MLE", "FOR", "GENERATIVE", "ADVERSAR", "-", "IAL", "LEARNING", "section", ":", "ABSTRACT", "We", "propose", "a", "simple", "algorithm", "to", "train", "stochastic", "neural", "networks", "to", "draw", "samples", "from", "given", "target", "distributions", "for", "probabilistic", "inference", ".", "Our", "method", "is", "based", "on", "iteratively", "adjusting", "the", "neural", "network", "parameters", "so", "that", "the", "output", "changes", "along", "a", "Stein", "variational", "gradient", "[", "reference", "]", ")", "that", "maximumly", "decreases", "the", "KL", "divergence", "with", "the", "target", "distribution", ".", "Our", "method", "works", "for", "any", "target", "distribution", "specified", "by", "their", "unnormalized", "density", "function", ",", "and", "can", "train", "any", "black", "-", "box", "architectures", "that", "are", "differentiable", "in", "terms", "of", "the", "parameters", "we", "want", "to", "adapt", ".", "As", "an", "application", "of", "our", "method", ",", "we", "propose", "an", "amortized", "MLE", "algorithm", "for", "training", "deep", "energy", "model", ",", "where", "a", "neural", "sampler", "is", "adaptively", "trained", "to", "approximate", "the", "likelihood", "function", ".", "Our", "method", "mimics", "an", "adversarial", "game", "between", "the", "deep", "energy", "model", "and", "the", "neural", "sampler", ",", "and", "obtains", "realisticlooking", "images", "competitive", "with", "the", "state", "-", "of", "-", "the", "-", "art", "results", ".", "section", ":", "INTRODUCTION", "Modern", "machine", "learning", "increasingly", "relies", "on", "highly", "complex", "probabilistic", "models", "to", "reason", "about", "uncertainty", ".", "A", "key", "computational", "challenge", "is", "to", "develop", "efficient", "inference", "techniques", "to", "approximate", ",", "or", "draw", "samples", "from", "complex", "distributions", ".", "Currently", ",", "most", "inference", "methods", ",", "including", "MCMC", "and", "variational", "inference", ",", "are", "hand", "-", "designed", "by", "researchers", "or", "domain", "experts", ".", "This", "makes", "it", "difficult", "to", "fully", "optimize", "the", "choice", "of", "different", "methods", "and", "their", "parameters", ",", "and", "exploit", "the", "structures", "in", "the", "problems", "of", "interest", "in", "an", "automatic", "way", ".", "The", "hand", "-", "designed", "algorithm", "can", "also", "be", "inefficient", "when", "it", "requires", "to", "make", "fast", "inference", "repeatedly", "on", "a", "large", "number", "of", "different", "distributions", "with", "similar", "structures", ".", "This", "happens", ",", "for", "example", ",", "when", "we", "need", "to", "reason", "about", "a", "number", "of", "observed", "datasets", "in", "settings", "like", "online", "learning", ",", "or", "need", "fast", "inference", "as", "inner", "loops", "for", "other", "algorithms", "such", "as", "maximum", "likelihood", "training", ".", "Therefore", ",", "it", "is", "highly", "desirable", "to", "develop", "more", "intelligent", "probabilistic", "inference", "systems", "that", "can", "adaptively", "improve", "its", "own", "performance", "to", "fully", "the", "optimize", "computational", "efficiency", ",", "and", "generalize", "to", "new", "tasks", "with", "similar", "structures", ".", "Specifically", ",", "denote", "by", "p", "(", "x", ")", "a", "probability", "density", "of", "interest", "specified", "up", "to", "the", "normalization", "constant", ",", "which", "we", "want", "to", "draw", "sample", "from", ",", "or", "marginalize", "to", "estimate", "its", "normalization", "constant", ".", "We", "want", "to", "study", "the", "following", "problem", ":", "Problem", "1", ".", "Given", "a", "distribution", "with", "density", "p", "(", "x", ")", "and", "a", "function", "f", "(", "\u03b7", ";", "\u03be", ")", "with", "parameter", "\u03b7", "and", "random", "input", "\u03be", ",", "for", "which", "we", "only", "have", "assess", "to", "draws", "of", "the", "random", "input", "\u03be", "(", "without", "knowing", "its", "true", "distribution", "q", "0", ")", ",", "and", "the", "output", "values", "of", "f", "(", "\u03b7", ";", "\u03be", ")", "and", "its", "derivative", "\u2202", "\u03b7", "f", "(", "\u03b7", ";", "\u03be", ")", "given", "\u03b7", "and", "\u03be", ".", "We", "want", "to", "find", "an", "optimal", "parameter", "\u03b7", "so", "that", "the", "density", "of", "the", "random", "output", "variable", "x", "=", "f", "(", "\u03b7", ";", "\u03be", ")", "with", "\u03be", "\u223c", "q", "0", "closely", "matches", "the", "target", "density", "p", "(", "x", ")", ".", "Because", "we", "have", "no", "assumption", "on", "the", "structure", "of", "f", "(", "\u03b7", ";", "\u03be", ")", "and", "the", "distribution", "of", "random", "input", ",", "we", "can", "not", "directly", "calculate", "the", "actual", "distribution", "of", "the", "output", "random", "variable", "x", "=", "f", "(", "\u03b7", ";", "\u03be", ")", ";", "this", "1", "arXiv:1611.01722v2", "[", "reference", "]", "section", ":", "Nov", "2016", "Under", "review", "as", "a", "conference", "paper", "at", "ICLR", "2017", "makes", "it", "difficult", "to", "solve", "Problem", "1", "using", "the", "traditional", "variational", "inference", "(", "VI", ")", "methods", ".", "Recall", "that", "traditional", "VI", "approximates", "p", "(", "x", ")", "using", "simple", "proposal", "distributions", "q", "\u03b7", "(", "x", ")", "indexed", "by", "parameter", "\u03b7", ",", "and", "finds", "the", "optimal", "\u03b7", "by", "minimizing", "KL", "divergence", "KL", "(", "q", "\u03b7", "||", "p", ")", "=", "E", "q\u03b7", "[", "log", "(", "q", "\u03b7", "/", "p", ")", "]", ",", "which", "requires", "to", "calculate", "the", "density", "q", "\u03b7", "(", "x", ")", "or", "its", "derivative", "that", "is", "not", "computable", "by", "our", "assumption", "(", "even", "when", "the", "Monte", "Carlo", "gradient", "estimation", "and", "the", "reparametrization", "trick", "[", "reference", "]", "are", "applied", ")", ".", "In", "fact", ",", "it", "is", "this", "requirement", "of", "calculating", "q", "\u03b7", "(", "x", ")", "that", "has", "been", "the", "major", "constraint", "for", "the", "designing", "of", "state", "-", "of", "-", "the", "-", "art", "variational", "inference", "methods", "with", "rich", "approximation", "families", ";", "the", "recent", "successful", "algorithms", "(", "e.g.", ",", "[", "reference", "][", "reference", "][", "reference", "]", ",", "to", "name", "only", "a", "few", ")", "have", "to", "handcraft", "special", "variational", "families", "to", "ensure", "the", "computational", "tractability", "of", "q", "\u03b7", "(", "x", ")", "and", "simultaneously", "obtain", "high", "approximation", "accuracy", ",", "which", "require", "substantial", "mathematical", "insights", "and", "research", "effects", ".", "Methods", "that", "do", "not", "require", "to", "explicitly", "calculate", "q", "\u03b7", "(", "x", ")", "can", "significantly", "simplify", "the", "design", "and", "applications", "of", "VI", "methods", ",", "allowing", "practical", "users", "to", "focus", "more", "on", "choosing", "proposals", "that", "work", "best", "with", "their", "specific", "tasks", ".", "We", "will", "use", "the", "term", "wild", "variational", "inference", "to", "refer", "to", "new", "variants", "of", "variational", "methods", "that", "require", "no", "tractability", "q", "\u03b7", "(", "x", ")", ",", "to", "distinguish", "with", "the", "black", "-", "box", "variational", "inference", "[", "reference", "]", "which", "refers", "to", "methods", "that", "work", "for", "generic", "target", "distributions", "p", "(", "x", ")", "without", "significant", "model", "-", "by", "-", "model", "consideration", "(", "but", "still", "require", "to", "calculate", "the", "proposal", "density", "q", "\u03b7", "(", "x", ")", ")", ".", "A", "similar", "problem", "also", "appears", "in", "importance", "sampling", "(", "IS", ")", ",", "where", "it", "requires", "to", "calculate", "the", "IS", "proposal", "density", "q", "(", "x", ")", "in", "order", "to", "calculate", "the", "importance", "weight", "w", "(", "x", ")", "=", "p", "(", "x", ")/", "q", "(", "x", ")", ".", "However", ",", "there", "exist", "methods", "that", "use", "no", "explicit", "information", "of", "q", "(", "x", ")", ",", "which", ",", "seemingly", "counter", "-", "intuitively", ",", "give", "better", "asymptotic", "variance", "or", "converge", "rates", "than", "the", "typical", "IS", "that", "uses", "the", "proposal", "information", "(", "e.g.", ",", "[", "reference", "][", "reference", "][", "reference", "]", ".", "Discussions", "on", "this", "phenomenon", "dates", "back", "to", "[", "reference", "]", ",", "who", "argued", "that", "\"", "Monte", "Carlo", "(", "that", "uses", "the", "proposal", "information", ")", "is", "fundamentally", "unsound", "\"", "for", "violating", "the", "Likelihood", "Principle", ",", "and", "developed", "Bayesian", "Monte", "Carlo", "[", "reference", "]", "as", "an", "example", "that", "uses", "no", "information", "on", "q", "(", "x", ")", ",", "yet", "gives", "better", "convergence", "rate", "than", "the", "typical", "Monte", "Carlo", "O", "(", "n", "\u22121", "/", "2", ")", "rate", "[", "reference", "]", ".", "Despite", "the", "substantial", "difference", "between", "IS", "and", "VI", ",", "these", "results", "intuitively", "suggest", "the", "possibility", "of", "developing", "efficient", "variational", "inference", "without", "calculating", "q", "(", "x", ")", "explicitly", ".", "In", "this", "work", ",", "we", "propose", "a", "simple", "algorithm", "for", "Problem", "1", "by", "iteratively", "adjusting", "the", "network", "parameter", "\u03b7", "to", "make", "its", "output", "random", "variable", "changes", "along", "a", "Stein", "variational", "gradient", "direction", "(", "SVGD", ")", "[", "reference", "]", ")", "that", "optimally", "decreases", "its", "KL", "divergence", "with", "the", "target", "distribution", ".", "Critically", ",", "the", "SVGD", "gradient", "includes", "a", "repulsive", "term", "to", "ensure", "that", "the", "generated", "samples", "have", "the", "right", "amount", "of", "variability", "that", "matches", "p", "(", "x", ")", ".", "In", "this", "way", ",", "we", "\"", "amortize", "SVGD", "\"", "using", "a", "neural", "network", ",", "which", "makes", "it", "possible", "for", "our", "method", "to", "adaptively", "improve", "its", "own", "efficiency", "by", "leveraging", "fast", "experience", ",", "especially", "in", "cases", "when", "it", "needs", "to", "perform", "fast", "inference", "repeatedly", "on", "a", "large", "number", "of", "similar", "tasks", ".", "As", "an", "application", ",", "we", "use", "our", "method", "to", "amortize", "the", "MLE", "training", "of", "deep", "energy", "models", ",", "where", "a", "neural", "sampler", "is", "adaptively", "trained", "to", "approximate", "the", "likelihood", "function", ".", "Our", "method", ",", "which", "we", "call", "SteinGAN", ",", "mimics", "an", "adversarial", "game", "between", "the", "energy", "model", "and", "the", "neural", "sampler", ",", "and", "obtains", "realistic", "-", "looking", "images", "competitive", "with", "the", "state", "-", "of", "-", "the", "-", "art", "results", "produced", "by", "generative", "adversarial", "networks", "(", "GAN", ")", "[", "reference", "][", "reference", "]", ".", "Related", "Work", "The", "idea", "of", "amortized", "inference", "[", "reference", "]", "has", "been", "recently", "applied", "in", "various", "domains", "of", "probabilistic", "reasoning", ",", "including", "both", "amortized", "variational", "inference", "(", "e.g.", ",", "[", "reference", "][", "reference", "]", ",", "and", "data", "-", "driven", "proposals", "for", "(", "sequential", ")", "Monte", "Carlo", "methods", "(", "e.g.", ",", "[", "reference", "]", ",", "to", "name", "only", "a", "few", ".", "Most", "of", "these", "methods", ",", "however", ",", "require", "to", "explicitly", "calculate", "q", "(", "x", ")", "(", "or", "its", "gradient", ")", ".", "One", "exception", "is", "a", "very", "recent", "paper", "[", "reference", "]", ")", "that", "avoids", "calculating", "q", "(", "x", ")", "using", "an", "idea", "related", "to", "Stein", "discrepancy", "[", "reference", "][", "reference", "][", "reference", "]", ".", "There", "is", "also", "a", "raising", "interest", "recently", "on", "a", "similar", "problem", "of", "\"", "learning", "to", "optimize", "\"", "(", "e.g.", ",", "[", "reference", "][", "reference", "][", "reference", "]", ",", "which", "is", "technically", "easier", "than", "the", "more", "general", "problem", "of", "\"", "learning", "to", "sample", "\"", ".", "In", "fact", ",", "we", "show", "that", "our", "algorithm", "reduces", "to", "\"", "learning", "to", "optimize", "\"", "when", "only", "one", "particle", "is", "used", "in", "SVGD", ".", "Generative", "adversarial", "network", "(", "GAN", ")", "and", "its", "variants", "have", "recently", "gained", "remarkable", "success", "on", "generating", "realistic", "-", "looking", "images", "[", "reference", "][", "reference", "][", "reference", "][", "reference", "][", "reference", "][", "reference", "]", ".", "All", "these", "methods", "are", "set", "up", "to", "train", "latent", "variable", "models", "(", "the", "generator", ")", "under", "the", "assistant", "of", "the", "discriminator", ".", "Our", "SteinGAN", "instead", "performs", "traditional", "MLE", "training", "for", "a", "deep", "energy", "model", ",", "with", "the", "help", "of", "a", "neural", "sampler", "that", "learns", "to", "draw", "samples", "from", "the", "energy", "model", "to", "approximate", "the", "likelihood", "function", ";", "this", "admits", "an", "adversarial", "interpretation", ":", "we", "can", "view", "the", "neural", "sampler", "as", "a", "generator", "that", "attends", "to", "fool", "the", "deep", "energy", "model", ",", "which", "in", "turn", "serves", "as", "a", "discriminator", "that", "distinguishes", "the", "real", "samples", "and", "the", "simulated", "samples", "given", "by", "the", "neural", "sampler", ".", "This", "idea", "of", "training", "MLE", "with", "neural", "samplers", "was", "first", "discussed", "by", "[", "reference", "]", ";", "one", "of", "the", "key", "differences", "is", "that", "the", "neural", "sampler", "in", "[", "reference", "]", "is", "trained", "with", "the", "help", "of", "a", "heuristic", "diversity", "regularizer", "based", "on", "batch", "normalization", ",", "while", "SVGD", "enforces", "the", "diversity", "in", "a", "more", "principled", "way", ".", "Another", "method", "by", "[", "reference", "]", "also", "trains", "an", "energy", "score", "to", "distinguish", "real", "and", "simulated", "samples", ",", "but", "within", "a", "non", "-", "probabilistic", "framework", "(", "see", "Section", "5", "for", "more", "discussion", ")", ".", "Other", "more", "traditional", "approaches", "for", "training", "energy", "-", "based", "models", "(", "e.g.", ",", "[", "reference", "][", "reference", "]", "are", "often", "based", "on", "variants", "of", "MCMC", "-", "MLE", "or", "contrastive", "divergence", "[", "reference", "][", "reference", "][", "reference", "]", ",", "and", "have", "difficulty", "generating", "realistic", "-", "looking", "images", "from", "scratch", ".", "section", ":", "STEIN", "VARIATIONAL", "GRADIENT", "DESCENT", "(", "SVGD", ")", "Stein", "variational", "gradient", "descent", "(", "SVGD", ")", "[", "reference", "]", ")", "is", "a", "general", "purpose", "Bayesian", "inference", "algorithm", "motivated", "by", "Stein", "'s", "method", "[", "reference", "][", "reference", "]", "and", "kernelized", "Stein", "discrepancy", "[", "reference", "][", "reference", "]", ".", "It", "uses", "an", "efficient", "deterministic", "gradient", "-", "based", "update", "to", "iteratively", "evolve", "a", "set", "of", "particles", "{", "x", "i", "}", "n", "i=1", "to", "minimize", "the", "KL", "divergence", "with", "the", "target", "distribution", ".", "SVGD", "has", "a", "simple", "form", "that", "reduces", "to", "the", "typical", "gradient", "descent", "for", "maximizing", "log", "p", "when", "using", "only", "one", "particle", "(", "n", "=", "1", ")", ",", "and", "hence", "can", "be", "easily", "combined", "with", "the", "successful", "tricks", "for", "gradient", "optimization", ",", "including", "stochastic", "gradient", ",", "adaptive", "learning", "rates", "(", "such", "as", "adagrad", ")", ",", "and", "momentum", ".", "To", "give", "a", "quick", "overview", "of", "the", "main", "idea", "of", "SVGD", ",", "let", "p", "(", "x", ")", "be", "a", "positive", "density", "function", "on", "R", "d", "which", "we", "want", "to", "approximate", "with", "a", "set", "of", "particles", "{", "x", "i", "}", "n", "i=1", ".", "SVGD", "initializes", "the", "particles", "by", "sampling", "from", "some", "simple", "distribution", "q", "0", ",", "and", "updates", "the", "particles", "iteratively", "by", "where", "is", "a", "step", "size", ",", "and", "\u03c6", "(", "x", ")", "is", "a", "\"", "particle", "gradient", "direction", "\"", "chosen", "to", "maximumly", "decrease", "the", "KL", "divergence", "between", "the", "distribution", "of", "particles", "and", "the", "target", "distribution", ",", "in", "the", "sense", "that", "where", "q", "[", "reference", "]", "denotes", "the", "density", "of", "the", "updated", "particle", "x", "=", "x", "+", "\u03c6", "(", "x", ")", "when", "the", "density", "of", "the", "original", "particle", "x", "is", "q", ",", "and", "F", "is", "the", "set", "of", "perturbation", "directions", "that", "we", "optimize", "over", ".", "We", "choose", "F", "to", "be", "the", "unit", "ball", "of", "a", "vector", "-", "valued", "reproducing", "kernel", "Hilbert", "space", "(", "RKHS", ")", "H", "d", "=", "H", "\u00d7", "\u00b7", "\u00b7", "\u00b7", "\u00d7", "H", "with", "each", "H", "associating", "with", "a", "positive", "definite", "kernel", "k", "(", "x", ",", "x", ")", ";", "note", "that", "H", "is", "dense", "in", "the", "space", "of", "continuous", "functions", "with", "universal", "kernels", "such", "as", "the", "Gaussian", "RBF", "kernel", ".", "Critically", ",", "the", "gradient", "of", "KL", "divergence", "in", "(", "2", ")", "equals", "a", "simple", "linear", "functional", "of", "\u03c6", ",", "allowing", "us", "to", "obtain", "a", "closed", "form", "solution", "for", "the", "optimal", "\u03c6", ".", "[", "reference", "]", "showed", "that", "with", "Algorithm", "1", "Amortized", "SVGD", "for", "Problem", "1", "Set", "batch", "size", "m", ",", "step", "-", "size", "scheme", "{", "t", "}", "and", "kernel", "k", "(", "x", ",", "x", ")", ".", ",", "calculate", "x", "i", "=", "f", "(", "\u03b7", "t", ";", "\u03be", "i", ")", ",", "and", "the", "Stein", "variational", "gradient", "\u2206x", "i", "in", "(", "7", ")", ".", "Update", "parameter", "\u03b7", "using", "(", "8", ")", ",", "(", "9", ")", "or", "(", "10", ")", ".", "end", "for", "where", "T", "p", "is", "considered", "as", "a", "linear", "operator", "acting", "on", "function", "\u03c6", "and", "is", "called", "the", "Stein", "operator", "in", "connection", "with", "Stein", "'s", "identity", "which", "shows", "that", "the", "RHS", "of", "(", "3", ")", "equals", "zero", "if", "p", "=", "q", ":", "This", "is", "a", "result", "of", "integration", "by", "parts", "assuming", "the", "value", "of", "p", "(", "x", ")", "\u03c6", "(", "x", ")", "vanishes", "on", "the", "boundary", "of", "the", "integration", "domain", ".", "Therefore", ",", "the", "optimization", "in", "(", "2", ")", "reduces", "to", "where", "D", "(", "q", "||", "p", ")", "is", "the", "kernelized", "Stein", "discrepancy", "defined", "in", ",", "which", "equals", "zero", "if", "and", "only", "if", "p", "=", "q", "under", "mild", "regularity", "conditions", ".", "Importantly", ",", "the", "optimal", "solution", "of", "(", "6", ")", "yields", "a", "closed", "form", "By", "approximating", "the", "expectation", "under", "q", "with", "the", "empirical", "average", "of", "the", "current", "particles", "{", "x", "i", "}", "n", "i=1", ",", "SVGD", "admits", "a", "simple", "form", "of", "update", ":", "where", "The", "two", "terms", "in", "\u2206x", "i", "play", "two", "different", "roles", ":", "the", "term", "with", "the", "gradient", "\u2207", "x", "log", "p", "(", "x", ")", "drives", "the", "particles", "toward", "the", "high", "probability", "regions", "of", "p", "(", "x", ")", ",", "while", "the", "term", "with", "\u2207", "x", "k", "(", "x", ",", "x", "i", ")", "serves", "as", "a", "repulsive", "force", "to", "encourage", "diversity", ";", "to", "see", "this", ",", "consider", "a", "stationary", "kernel", "k", "(", "x", ",", "x", ")", "=", "k", "(", "x", "\u2212", "x", ")", ",", "then", "the", "second", "term", "reduces", "to\u00ca", "x", "\u2207", "x", "k", "(", "x", ",", "x", "i", ")", "=", "\u2212\u00ca", "x", "\u2207", "xi", "k", "(", "x", ",", "x", "i", ")", ",", "which", "can", "be", "treated", "as", "the", "negative", "gradient", "for", "minimizing", "the", "average", "similarity\u00ca", "x", "k", "(", "x", ",", "x", "i", ")", "in", "terms", "of", "x", "i", ".", "Overall", ",", "this", "particle", "update", "produces", "diverse", "points", "for", "distributional", "approximation", "and", "uncertainty", "assessment", ",", "and", "also", "has", "an", "interesting", "\"", "momentum", "\"", "effect", "in", "which", "the", "particles", "move", "collaboratively", "to", "escape", "the", "local", "optima", ".", "It", "is", "easy", "to", "see", "from", "(", "7", ")", "that", "\u2206x", "i", "reduces", "to", "the", "typical", "gradient", "\u2207", "x", "log", "p", "(", "x", "i", ")", "when", "there", "is", "only", "a", "single", "particle", "(", "n", "=", "1", ")", "and", "\u2207", "x", "k", "(", "x", ",", "x", "i", ")", "when", "x", "=", "x", "i", ",", "in", "which", "case", "SVGD", "reduces", "to", "the", "standard", "gradient", "ascent", "for", "maximizing", "log", "p", "(", "x", ")", "(", "i.e.", ",", "maximum", "a", "posteriori", "(", "MAP", ")", ")", ".", "3", "AMORTIZED", "SVGD", ":", "TOWARDS", "AN", "AUTOMATIC", "NEURAL", "SAMPLER", "SVGD", "and", "other", "particle", "-", "based", "methods", "become", "inefficient", "when", "we", "need", "to", "repeatedly", "infer", "a", "large", "number", "different", "target", "distributions", "for", "multiple", "tasks", ",", "including", "online", "learning", "or", "inner", "loops", "of", "other", "algorithms", ",", "because", "they", "can", "not", "improve", "based", "on", "the", "experience", "from", "the", "past", "tasks", ",", "and", "may", "require", "a", "large", "memory", "to", "restore", "a", "large", "number", "of", "particles", ".", "We", "propose", "to", "\"", "amortize", "SVGD", "\"", "by", "training", "a", "neural", "network", "f", "(", "\u03b7", ";", "\u03be", ")", "to", "mimic", "the", "SVGD", "dynamics", ",", "yielding", "a", "solution", "for", "Problem", "1", ".", "One", "straightforward", "way", "to", "achieve", "this", "is", "to", "run", "SVGD", "to", "convergence", "and", "train", "f", "(", "\u03b7", ";", "\u03be", ")", "to", "fit", "the", "SVGD", "results", ".", "This", ",", "however", ",", "requires", "to", "run", "many", "epochs", "of", "fully", "converged", "SVGD", "and", "can", "be", "slow", "in", "practice", ".", "We", "instead", "propose", "an", "incremental", "approach", "in", "which", "\u03b7", "is", "iteratively", "adjusted", "so", "that", "the", "network", "outputs", "x", "=", "f", "(", "\u03b7", ";", "\u03be", ")", "changes", "along", "the", "Stein", "variational", "gradient", "direction", "in", "(", "7", ")", "in", "order", "to", "decrease", "the", "KL", "divergence", "between", "the", "target", "and", "approximation", "distribution", ".", "To", "be", "specific", ",", "denote", "by", "\u03b7", "t", "the", "estimated", "parameter", "at", "the", "t", "-", "th", "iteration", "of", "our", "method", ";", "each", "iteration", "of", "our", "method", "draws", "a", "batch", "of", "random", "inputs", "{", "\u03be", "i", "}", "m", "i=1", "and", "calculate", "their", "corresponding", "output", "x", "i", "=", "f", "(", "\u03b7", ";", "\u03be", "i", ")", "based", "on", "\u03b7", "t", ";", "here", "m", "is", "a", "mini", "-", "batch", "size", "(", "e.g.", ",", "m", "=", "100", ")", ".", "The", "Stein", "variational", "gradient", "\u2206x", "i", "in", "(", "7", ")", "would", "then", "ensure", "that", "x", "i", "=", "x", "i", "+", "\u2206x", "i", "forms", "a", "better", "approximation", "of", "the", "target", "distribution", "p.", "Therefore", ",", "we", "should", "adjust", "\u03b7", "to", "make", "its", "output", "matches", "{", "x", "i", "}", ",", "that", "is", ",", "we", "want", "to", "update", "\u03b7", "by", ",", "where", "See", "Algorithm", "1", "for", "the", "summary", "of", "this", "procedure", ".", "If", "we", "assume", "is", "very", "small", ",", "then", "(", "8", ")", "reduces", "to", "a", "least", "square", "optimization", ".", "To", "see", "this", ",", "note", "that", "f", "(", "\u03b7", ";", "As", "a", "result", ",", "(", "8", ")", "reduces", "to", "the", "following", "least", "square", "optimization", ":", "Update", "(", "9", ")", "can", "still", "be", "computationally", "expensive", "because", "of", "the", "matrix", "inversion", ".", "We", "can", "derive", "a", "further", "approximation", "by", "performing", "only", "one", "step", "of", "gradient", "descent", "of", "(", "8", ")", "(", "or", "(", "9", ")", ")", ",", "which", "gives", "Although", "update", "(", "10", ")", "is", "derived", "as", "an", "approximation", "of", "(", "8", ")-(", "9", ")", ",", "it", "is", "computationally", "faster", "and", "we", "find", "it", "works", "very", "effectively", "in", "practice", ";", "this", "is", "because", "when", "is", "small", ",", "one", "step", "of", "gradient", "update", "can", "be", "sufficiently", "close", "to", "the", "optimum", ".", "Update", "(", "10", ")", "also", "has", "a", "simple", "and", "intuitive", "form", ":", "(", "10", ")", "can", "be", "thought", "as", "a", "\"", "chain", "rule", "\"", "that", "backpropagates", "the", "Stein", "variational", "gradient", "to", "the", "network", "parameter", "\u03b7", ".", "This", "can", "be", "justified", "by", "considering", "the", "special", "case", "when", "we", "use", "only", "a", "single", "particle", "(", "n", "=", "1", ")", "in", "which", "case", "\u2206x", "i", "in", "(", "7", ")", "reduces", "to", "the", "typical", "gradient", "\u2207", "x", "log", "p", "(", "x", "i", ")", "of", "log", "p", "(", "x", ")", ",", "and", "update", "(", "10", ")", "reduces", "to", "the", "typical", "gradient", "ascent", "for", "maximizing", "in", "which", "case", "f", "(", "\u03b7", ";", "\u03be", ")", "is", "trained", "to", "maximize", "log", "p", "(", "x", ")", "(", "that", "is", ",", "learning", "to", "optimize", ")", ",", "instead", "of", "learning", "to", "draw", "samples", "from", "p", "for", "which", "it", "is", "crucial", "to", "use", "Stein", "variational", "gradient", "\u2206x", "i", "to", "diversify", "the", "network", "outputs", ".", "Update", "(", "10", ")", "also", "has", "a", "close", "connection", "with", "the", "typical", "variational", "inference", "with", "the", "reparameterization", "trick", "[", "reference", "]", ".", "Let", "q", "\u03b7", "(", "x", ")", "be", "the", "density", "function", "of", "x", "=", "f", "(", "\u03b7", ";", "\u03be", ")", ",", "\u03be", "\u223c", "q", "0", ".", "Using", "the", "reparameterization", "trick", ",", "the", "gradient", "of", "KL", "(", "q", "\u03b7", "||", "p", ")", "w.r.t", ".", "\u03b7", "can", "be", "shown", "to", "be", "With", "{", "\u03be", "i", "}", "i.i.d", ".", "drawn", "from", "q", "0", "and", "x", "i", "=", "f", "(", "\u03b7", ";", "\u03be", "i", ")", ",", "\u2200i", ",", "the", "standard", "stochastic", "gradient", "descent", "for", "minimizing", "the", "KL", "divergence", "is", "This", "is", "similar", "with", "(", "10", ")", ",", "but", "replaces", "the", "Stein", "gradient", "\u2206x", "i", "defined", "in", "(", "7", ")", "with\u2206x", "i", ".", "The", "advantage", "of", "using", "\u2206x", "i", "is", "that", "it", "does", "not", "require", "to", "explicitly", "calculate", "q", "\u03b7", ",", "and", "hence", "admits", "a", "solution", "to", "Problem", "1", "in", "which", "q", "\u03b7", "is", "not", "computable", "for", "complex", "network", "f", "(", "\u03b7", ";", "\u03be", ")", "and", "unknown", "input", "distribution", "q", "0", ".", "Further", "insights", "can", "be", "obtained", "by", "noting", "that", "where", "(", "12", ")", "is", "obtained", "by", "using", "Stein", "'s", "identity", "(", "5", ")", ".", "Therefore", ",", "\u2206x", "i", "can", "be", "treated", "as", "a", "kernel", "smoothed", "version", "of\u2206x", "i", ".", "section", ":", "AMORTIZED", "MLE", "FOR", "GENERATIVE", "ADVERSARIAL", "TRAINING", "Our", "method", "allows", "us", "to", "design", "efficient", "approximate", "sampling", "methods", "adaptively", "and", "automatically", ",", "and", "enables", "a", "host", "of", "novel", "applications", ".", "In", "this", "paper", ",", "we", "apply", "it", "in", "an", "amortized", "MLE", "method", "for", "training", "deep", "generative", "models", ".", "Maximum", "likelihood", "estimator", "(", "MLE", ")", "provides", "a", "fundamental", "approach", "for", "learning", "probabilistic", "models", "from", "data", ",", "but", "can", "be", "computationally", "prohibitive", "on", "distributions", "for", "which", "drawing", "samples", "or", "computing", "likelihood", "is", "intractable", "due", "to", "the", "normalization", "constant", ".", "Traditional", "methods", "such", "as", "MCMC", "-", "MLE", "use", "hand", "-", "designed", "methods", "(", "e.g.", ",", "MCMC", ")", "to", "approximate", "the", "intractable", "likelihood", "function", "but", "do", "not", "work", "efficiently", "in", "practice", ".", "We", "propose", "to", "adaptively", "train", "a", "generative", "neural", "network", "to", "draw", "samples", "from", "the", "distribution", "during", "MLE", "training", ",", "which", "not", "only", "provides", "computational", "advantage", ",", "and", "also", "allows", "us", "to", "generate", "realistic", "-", "looking", "images", "competitive", "with", ",", "or", "better", "than", "the", "state", "-", "of", "-", "the", "-", "art", "generative", "adversarial", "networks", "(", "GAN", ")", "[", "reference", "][", "reference", "]", ")", "(", "see", "Figure", "1", "-", "5", ")", ".", "To", "be", "specific", ",", "denote", "by", "{", "x", "i", ",", "obs", "}", "a", "set", "of", "observed", "data", ".", "We", "consider", "the", "maximum", "likelihood", "training", "of", "energy", "-", "based", "models", "of", "form", "where", "\u03c6", "(", "x", ";", "\u03b8", ")", "is", "an", "energy", "function", "for", "x", "indexed", "by", "parameter", "\u03b8", "and", "\u03a6", "(", "\u03b8", ")", "is", "the", "log", "-", "normalization", "constant", ".", "The", "log", "-", "likelihood", "function", "of", "\u03b8", "is", "whose", "gradient", "is", "where\u00ca", "obs", "[", "\u00b7", "]", "and", "E", "\u03b8", "[", "\u00b7", "]", "denote", "the", "empirical", "average", "on", "the", "observed", "data", "{", "x", "i", ",", "obs", "}", "and", "the", "expectation", "under", "model", "p", "(", "x|\u03b8", ")", ",", "respectively", ".", "The", "key", "computational", "difficulty", "is", "to", "approximate", "the", "model", "expectation", "E", "\u03b8", "[", "\u00b7", "]", ".", "To", "address", "this", "problem", ",", "we", "use", "a", "generative", "neural", "network", "x", "=", "f", "(", "\u03b7", ";", "\u03be", ")", "trained", "by", "Algorithm", "1", "to", "approximately", "sample", "from", "p", "(", "x|\u03b8", ")", ",", "yielding", "a", "gradient", "update", "for", "\u03b8", "of", "form", "where\u00ca", "\u03b7", "denotes", "the", "empirical", "average", "on", "{", "x", "i", "}", "where", "As", "\u03b8", "is", "updated", "by", "gradient", "ascent", ",", "\u03b7", "is", "successively", "updated", "via", "Algorithm", "1", "to", "follow", "p", "(", "x|\u03b8", ")", ".", "See", "Algorithm", "2", ".", "We", "call", "our", "method", "SteinGAN", ",", "because", "it", "can", "be", "intuitively", "interpreted", "as", "an", "adversarial", "game", "between", "the", "generative", "network", "f", "(", "\u03b7", ";", "\u03be", ")", "and", "the", "energy", "model", "p", "(", "x|\u03b8", ")", "which", "serves", "as", "a", "discriminator", ":", "The", "Algorithm", "2", "Amortized", "MLE", "as", "Generative", "Adversarial", "Learning", "Goal", ":", "MLE", "training", "for", "energy", "model", "p", "(", "x|\u03b8", ")", "=", "exp", "(", "\u2212\u03c6", "(", "x", ",", "\u03b8", ")", "\u2212", "\u03a6", "(", "\u03b8", ")", ")", ".", "Initialize", "\u03b7", "and", "\u03b8", ".", "for", "iteration", "t", "do", "Updating", "\u03b7", ":", "Draw", "\u03be", "i", "\u223c", "q", "0", ",", "x", "i", "=", "f", "(", "\u03b7", ";", "\u03be", "i", ")", ";", "update", "\u03b7", "using", "(", "8", ")", ",", "(", "9", ")", "or", "(", "10", ")", "with", "p", "(", "x", ")", "=", "p", "(", "x|\u03b8", ")", ".", "Repeat", "several", "times", "when", "needed", ".", "Updating", "\u03b8", ":", "Draw", "a", "mini", "-", "batch", "of", "observed", "data", "{", "x", "i", ",", "obs", "}", ",", "and", "simulated", "data", "x", "i", "=", "f", "(", "\u03b7", ";", "\u03be", "i", ")", ",", "update", "\u03b8", "by", "(", "13", ")", ".", "end", "for", "MLE", "gradient", "update", "of", "p", "(", "x|\u03b8", ")", "effectively", "decreases", "the", "energy", "of", "the", "training", "data", "and", "increases", "the", "energy", "of", "the", "simulated", "data", "from", "f", "(", "\u03b7", ";", "\u03be", ")", ",", "while", "the", "SVGD", "update", "of", "f", "(", "\u03b7", ";", "\u03be", ")", "decreases", "the", "energy", "of", "the", "simulated", "data", "to", "fit", "better", "with", "p", "(", "x|\u03b8", ")", ".", "Compared", "with", "the", "traditional", "methods", "based", "on", "MCMC", "-", "MLE", "or", "contrastive", "divergence", ",", "we", "amortize", "the", "sampler", "as", "we", "train", ",", "which", "gives", "much", "faster", "speed", "and", "simultaneously", "provides", "a", "high", "quality", "generative", "neural", "network", "that", "can", "generate", "realistic", "-", "looking", "images", ";", "see", "[", "reference", "]", "for", "a", "similar", "idea", "and", "discussions", ".", "section", ":", "EMPIRICAL", "RESULTS", "We", "evaluated", "our", "SteinGAN", "on", "four", "datasets", ",", "MNIST", ",", "CIFAR", "-", "10", ",", "CelebA", "[", "reference", "]", ",", "and", "Large", "-", "scale", "Scene", "Understanding", "(", "LSUN", ")", "[", "reference", "]", ",", "on", "which", "we", "find", "our", "method", "tends", "to", "generate", "realistic", "-", "looking", "images", "competitive", "with", ",", "sometimes", "better", "than", "DCGAN", "[", "reference", "]", ")", "(", "see", "Figure", "2", "-", "Figure", "3", ")", ".", "Our", "code", "is", "available", "at", "https:", "//", "github.com", "/", "DartML", "/", "SteinGAN", ".", "section", ":", "Model", "Setup", "In", "order", "to", "generate", "realistic", "-", "looking", "images", ",", "we", "define", "our", "energy", "model", "based", "on", "an", "autoencoder", ":", "where", "x", "denotes", "the", "image", ".", "This", "choice", "is", "motivated", "by", "Energy", "-", "based", "GAN", "[", "reference", "]", "in", "which", "the", "autoencoder", "loss", "is", "used", "as", "a", "discriminator", "but", "without", "a", "probabilistic", "interpretation", ".", "We", "assume", "f", "(", "\u03b7", ";", "\u03be", ")", "to", "be", "a", "neural", "network", "whose", "input", "\u03be", "is", "a", "100", "-", "dimensional", "random", "vector", "drawn", "by", "Uniform", "([", "\u22121", ",", "1", "]", ")", ".", "The", "positive", "definite", "kernel", "in", "SVGD", "is", "defined", "by", "the", "RBF", "kernel", "on", "the", "hidden", "representation", "obtained", "by", "the", "autoencoder", "in", "(", "14", ")", ",", "that", "is", ",", "As", "it", "is", "discussed", "in", "Section", "3", ",", "the", "kernel", "provides", "a", "repulsive", "force", "to", "produce", "an", "amount", "of", "variability", "required", "for", "generating", "samples", "from", "p", "(", "x", ")", ".", "This", "is", "similar", "to", "the", "heuristic", "repelling", "regularizer", "in", "[", "reference", "]", "and", "the", "batch", "normalization", "based", "regularizer", "in", "[", "reference", "]", ",", "but", "is", "derived", "in", "a", "more", "principled", "way", ".", "We", "take", "the", "bandwidth", "to", "be", "h", "=", "0.5", "\u00d7", "med", ",", "where", "med", "is", "the", "median", "of", "the", "pairwise", "distances", "between", "E", "(", "x", ")", "on", "the", "image", "simulated", "by", "f", "(", "\u03b7", ";", "\u03be", ")", ".", "This", "makes", "the", "kernel", "change", "adaptively", "based", "on", "both", "\u03b8", "(", "through", "E", "(", "x", ";", "\u03b8", ")", ")", "and", "\u03b7", "(", "through", "bandwidth", "h", ")", ".", "Some", "datasets", "include", "both", "images", "x", "and", "their", "associated", "discrete", "labels", "y.", "In", "these", "cases", ",", "we", "train", "a", "joint", "energy", "model", "on", "(", "x", ",", "y", ")", "to", "capture", "both", "the", "inner", "structure", "of", "the", "images", "and", "its", "predictive", "relation", "with", "the", "label", ",", "allowing", "us", "to", "simulate", "images", "with", "a", "control", "on", "which", "category", "it", "belongs", "to", ".", "Our", "joint", "energy", "model", "is", "defined", "to", "be", "where", "\u03c3", "(", "\u00b7", ",", "\u00b7", ")", "is", "the", "cross", "entropy", "loss", "function", "of", "a", "fully", "connected", "output", "layer", ".", "In", "this", "case", ",", "our", "neural", "sampler", "first", "draws", "a", "label", "y", "randomly", "according", "to", "the", "empirical", "counts", "in", "the", "dataset", ",", "and", "then", "passes", "y", "into", "a", "neural", "network", "together", "with", "a", "100", "\u00d7", "1", "random", "vector", "\u03be", "to", "generate", "image", "x.", "This", "allows", "us", "to", "generate", "images", "for", "particular", "categories", "by", "controlling", "the", "value", "of", "input", "y.", "Stabilization", "In", "practice", ",", "we", "find", "it", "is", "useful", "to", "modify", "(", "13", ")", "to", "be", "where", "\u03b3", "is", "a", "discount", "factor", "(", "which", "we", "take", "to", "be", "\u03b3", "=", "0.7", ")", ".", "This", "is", "equivalent", "to", "maximizing", "a", "regularized", "likelihood", ":", "max", "where", "\u03a6", "(", "\u03b8", ")", "is", "the", "log", "-", "partition", "function", ";", "note", "that", "exp", "(", "\u03b3\u03a6", "(", "\u03b8", ")", ")", "is", "a", "conjugate", "prior", "of", "p", "(", "x|\u03b8", ")", ".", "We", "initialize", "the", "weights", "of", "both", "the", "generator", "and", "discriminator", "from", "Gaussian", "distribution", "N", "(", "0", ",", "0.02", ")", ",", "and", "train", "them", "using", "Adam", "[", "reference", "]", ")", "with", "a", "learning", "rate", "of", "0.001", "for", "the", "generator", "and", "0.0001", "for", "the", "energy", "model", "(", "the", "discriminator", ")", ".", "In", "order", "to", "keep", "the", "generator", "and", "discriminator", "approximately", "aligned", "during", "training", ",", "we", "speed", "up", "the", "MLE", "update", "(", "16", ")", "of", "the", "discriminator", "(", "by", "increasing", "its", "learning", "rate", "to", "0.0005", ")", "when", "the", "energy", "of", "the", "real", "data", "batch", "is", "larger", "than", "the", "energy", "of", "the", "simulated", "images", ",", "while", "slow", "down", "it", "(", "by", "freezing", "the", "MLE", "update", "of", "\u03b8", "in", "(", "16", ")", ")", "if", "the", "magnitude", "of", "the", "energy", "difference", "between", "the", "real", "images", "and", "the", "simulated", "images", "goes", "above", "a", "threshold", "of", "0.5", ".", "We", "used", "the", "bag", "of", "architecture", "guidelines", "for", "stable", "training", "suggested", "in", "DCGAN", "[", "reference", "]", ".", "section", ":", "Discussion", "The", "MNIST", "dataset", "has", "a", "training", "set", "of", "60", ",", "000", "examples", ".", "Both", "DCGAN", "and", "our", "model", "produce", "high", "quality", "images", ",", "both", "visually", "indistinguishable", "from", "real", "images", ";", "see", "figure", "1", ".", "CIFAR", "-", "10", "is", "very", "diverse", ",", "and", "with", "only", "50", ",", "000", "training", "examples", ".", "Figure", "2", "shows", "examples", "of", "simulated", "images", "by", "DCGAN", "and", "SteinGAN", "generated", "conditional", "on", "each", "category", ",", "which", "look", "equally", "well", "visually", ".", "We", "also", "provide", "quantitively", "evaluation", "using", "a", "recently", "proposed", "inception", "score", "[", "reference", "]", ",", "as", "well", "as", "the", "classification", "accuracy", "when", "training", "ResNet", "using", "50", ",", "000", "simulated", "images", "as", "train", "sets", ",", "evaluated", "on", "a", "separate", "held", "-", "out", "testing", "set", "never", "seen", "by", "the", "GAN", "models", ".", "Besides", "DCGAN", "and", "SteinGAN", ",", "we", "also", "evaluate", "another", "simple", "baseline", "obtained", "by", "subsampling", "500", "real", "images", "from", "the", "training", "set", "and", "duplicating", "them", "100", "times", ".", "We", "observe", "that", "these", "scores", "capture", "rather", "different", "perspectives", "of", "image", "generation", ":", "The", "inception", "score", "favors", "images", "that", "look", "realistic", "individually", "and", "have", "uniformly", "distributed", "labels", ";", "as", "a", "result", ",", "the", "inception", "score", "of", "the", "duplicated", "500", "images", "is", "almost", "as", "high", "as", "the", "real", "training", "set", ".", "We", "find", "that", "the", "inception", "score", "of", "SteinGAN", "is", "comparable", ",", "or", "slightly", "lower", "than", "that", "of", "DCGAN", ".", "On", "the", "other", "hand", ",", "the", "classification", "accuracy", "measures", "the", "amount", "information", "captured", "in", "the", "simulated", "image", "sets", ";", "we", "find", "that", "SteinGAN", "achieves", "the", "highest", "classification", "accuracy", ",", "suggesting", "that", "it", "captures", "more", "information", "in", "the", "training", "set", ".", "Figure", "3", "and", "4", "visualize", "the", "results", "on", "CelebA", "(", "with", "more", "than", "200k", "face", "images", ")", "and", "LSUN", "(", "with", "nearly", "3", "M", "bedroom", "images", ")", ",", "respectively", ".", "We", "cropped", "and", "resized", "both", "dataset", "images", "into", "64", "\u00d7", "64", ".", "section", ":", "DCGAN", "SteinGAN", "Figure", "1", ":", "MNIST", "images", "generated", "by", "DCGAN", "and", "our", "SteinGAN", ".", "We", "use", "the", "joint", "model", "in", "(", "15", ")", "to", "allow", "us", "to", "generate", "images", "for", "each", "digit", ".", "We", "set", "m", "=", "0.2", ".", "Figure", "2", ":", "Results", "on", "CIFAR", "-", "10", ".", "\"", "500", "Duplicate", "\"", "denotes", "500", "images", "randomly", "subsampled", "from", "the", "training", "set", ",", "each", "duplicated", "100", "times", ".", "Upper", ":", "images", "simulated", "by", "DCGAN", "and", "SteinGAN", "(", "based", "on", "joint", "model", "(", "15", ")", ")", "conditional", "on", "each", "category", ".", "Middle", ":", "inception", "scores", "for", "samples", "generated", "by", "various", "methods", "(", "all", "with", "50", ",", "000", "images", ")", "on", "inception", "models", "trained", "on", "ImageNet", "and", "CIFAR", "-", "10", ",", "respectively", ".", "Lower", ":", "testing", "accuracy", "on", "real", "testing", "set", "when", "using", "50", ",", "000", "simulated", "images", "to", "train", "ResNets", "for", "classification", ".", "SteinGAN", "achieves", "higher", "testing", "accuracy", "than", "DCGAN", ".", "We", "set", "m", "=", "1", "and", "\u03b3", "=", "0.8", ".", "section", ":", "CONCLUSION", "We", "propose", "a", "new", "method", "to", "train", "neural", "samplers", "for", "given", "distributions", ",", "together", "with", "a", "new", "SteinGAN", "method", "for", "generative", "adversarial", "training", ".", "Future", "directions", "involve", "more", "applications", "and", "theoretical", "understandings", "for", "training", "neural", "samplers", ".", "section", ":", "DCGAN", "SteinGAN", "section", ":"]}