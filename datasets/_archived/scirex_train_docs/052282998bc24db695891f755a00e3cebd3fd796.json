{"coref": {"Atari-57": [[188, 191], [368, 369], [1381, 1384], [1585, 1588], [4002, 4003], [5473, 5474], [6850, 6851], [630, 631], [768, 769], [953, 954], [4386, 4387], [4514, 4515], [4588, 4589], [4649, 4650], [5089, 5090], [5174, 5175], [5450, 5451]], "Atari_Games": [], "Medium_Human-Normalized_Score": [[4469, 4473], [4926, 4929], [5169, 5172], [5245, 5249], [5135, 5139], [5268, 5272]], "Reactor": [[3, 4], [30, 31], [214, 215], [384, 393], [563, 564], [565, 568], [794, 795], [1221, 1222], [1654, 1664], [1828, 1837], [1849, 1850], [1851, 1852], [1880, 1881], [1918, 1919], [2523, 2524], [3987, 3988], [4383, 4384], [4398, 4399], [4403, 4404], [4502, 4503], [4663, 4664], [4747, 4748], [4776, 4777], [4795, 4796], [4813, 4814], [4848, 4849], [4900, 4907], [4914, 4915], [4956, 4961], [5094, 5100], [6098, 6099], [6138, 6139], [6154, 6155], [6206, 6207], [6235, 6236], [6310, 6311], [6343, 6344], [6403, 6404], [6474, 6475], [6576, 6577], [6701, 6702], [6839, 6840], [750, 751], [1897, 1898], [4094, 4095]]}, "coref_non_salient": {"0": [[166, 169], [3191, 3195]], "1": [[6, 15], [376, 380], [420, 425], [730, 734], [1800, 1805]], "10": [[1169, 1170], [1195, 1196], [4695, 4697], [4811, 4812], [4855, 4856], [4860, 4861], [6103, 6106], [6116, 6117], [6136, 6137], [6152, 6153], [6208, 6209], [6223, 6224], [6297, 6298], [6326, 6327], [6426, 6430], [6445, 6446], [6529, 6530], [6653, 6654]], "100": [[2159, 2163], [2346, 2350]], "101": [[5003, 5008]], "102": [[5653, 5655]], "103": [[26, 28], [3742, 3744]], "104": [[3641, 3642], [3643, 3644], [5879, 5880], [5881, 5882]], "105": [[348, 350], [438, 440]], "106": [[4136, 4139]], "107": [[6782, 6784]], "108": [[2128, 2140], [2169, 2176]], "109": [[2947, 2952]], "11": [[558, 561], [1632, 1635]], "110": [[341, 345], [725, 729]], "111": [[3698, 3701]], "112": [[5529, 5531]], "113": [[1726, 1727]], "114": [[3964, 3968]], "115": [[818, 821]], "116": [[3236, 3238]], "117": [[1323, 1325], [3666, 3667], [4441, 4442], [5092, 5093]], "118": [[5513, 5515]], "119": [[2967, 2970]], "12": [[802, 808], [1172, 1178]], "120": [[3037, 3040]], "121": [[6726, 6728]], "122": [[1939, 1942]], "123": [[1732, 1735]], "124": [[706, 712]], "125": [[2808, 2812]], "126": [[2618, 2619]], "127": [[3645, 3647]], "128": [[1529, 1531]], "129": [[2692, 2700]], "13": [[6661, 6664], [6692, 6694]], "130": [[3091, 3094]], "131": [[1742, 1747]], "132": [[3970, 3972]], "133": [[4027, 4029], [6335, 6337]], "134": [[3727, 3730]], "135": [[2401, 2402]], "136": [[4210, 4212]], "137": [[3086, 3089]], "138": [[1275, 1283]], "139": [[6299, 6302], [6379, 6382]], "14": [[1565, 1568], [2607, 2613], [2799, 2802]], "140": [[691, 693], [1315, 1318], [3142, 3144], [3272, 3275], [4431, 4433], [4674, 4679], [6189, 6191]], "141": [[5478, 5483]], "142": [[5545, 5549]], "143": [[528, 530]], "144": [[3041, 3042]], "145": [[2262, 2264]], "146": [[3164, 3166]], "147": [[1126, 1130]], "148": [[2372, 2376]], "149": [[1161, 1163]], "15": [[1396, 1404], [1716, 1720]], "150": [[6697, 6700]], "151": [[787, 789]], "152": [[75, 78]], "153": [[4296, 4300]], "154": [[205, 208]], "155": [[4339, 4341]], "156": [[6713, 6716]], "157": [[1667, 1672]], "158": [[3832, 3834]], "159": [[2354, 2357]], "16": [[254, 260], [274, 278]], "160": [[1391, 1394]], "161": [[3626, 3627]], "162": [[1406, 1408]], "163": [[979, 982]], "164": [[1311, 1314]], "165": [[1752, 1753]], "166": [[2984, 2986]], "167": [[93, 97]], "168": [[2035, 2041]], "169": [[5454, 5458]], "17": [[2044, 2050], [2484, 2487]], "170": [[3103, 3111]], "171": [[486, 489]], "172": [[123, 125]], "173": [[2532, 2535]], "174": [[1596, 1599]], "175": [[1872, 1876]], "176": [[2745, 2748]], "177": [[357, 358]], "178": [[1352, 1356]], "179": [[1500, 1502]], "18": [[2457, 2459], [3715, 3716], [3736, 3739]], "180": [[2919, 2921]], "19": [[4030, 4033], [4067, 4069]], "2": [[109, 115], [670, 680]], "20": [[3168, 3170], [3421, 3424]], "21": [[1320, 1322], [3639, 3640], [5883, 5884]], "22": [[16, 18], [890, 892], [3754, 3755]], "23": [[35, 39], [4996, 4998]], "24": [[54, 56], [360, 361], [961, 962], [1117, 1119], [1244, 1245], [1378, 1379], [4667, 4668], [4670, 4672], [6232, 6233], [6332, 6333], [6656, 6657]], "25": [[1147, 1149], [4681, 4686]], "26": [[1066, 1072], [1328, 1331], [3707, 3711], [6589, 6591]], "27": [[1821, 1825], [2580, 2584], [6482, 6490]], "28": [[4238, 4243], [6066, 6068]], "29": [[3633, 3635], [5556, 5558]], "3": [[183, 185], [1248, 1251], [3114, 3117], [3117, 3120], [3682, 3685]], "30": [[131, 140], [643, 646], [1912, 1915]], "31": [[1012, 1016], [1132, 1135], [6225, 6228]], "32": [[305, 307], [918, 926], [1212, 1214]], "33": [[239, 245], [938, 941], [1531, 1534]], "34": [[991, 995], [4077, 4079], [4308, 4311]], "35": [[2054, 2055], [2385, 2388]], "36": [[4365, 4366], [5054, 5056]], "37": [[1839, 1844], [1990, 1994]], "38": [[490, 494], [694, 700], [2460, 2464], [2813, 2817]], "39": [[1736, 1737], [1767, 1768], [1780, 1781]], "4": [[45, 48], [202, 204], [578, 581], [1371, 1374], [1887, 1891]], "40": [[449, 450], [3915, 3916]], "41": [[1679, 1682], [1771, 1773]], "42": [[2988, 2991], [3025, 3028]], "43": [[1388, 1389], [2595, 2596], [2783, 2784]], "44": [[4597, 4599], [5129, 5131], [5338, 5340], [5392, 5394], [5401, 5403], [5495, 5497]], "45": [[2415, 2416], [2419, 2420], [2452, 2454]], "46": [[3921, 3923], [3935, 3937]], "47": [[1713, 1714], [1810, 1812], [4691, 4692], [6246, 6247], [6349, 6350]], "48": [[582, 587], [2786, 2790], [4950, 4954], [6436, 6440]], "49": [[148, 149], [2092, 2093], [2407, 2409]], "5": [[1866, 1871], [3132, 3135]], "50": [[118, 121], [6827, 6828]], "51": [[61, 64], [453, 457]], "52": [[314, 318], [998, 1002], [1005, 1010], [1902, 1908]], "53": [[4595, 4596], [5127, 5128], [5335, 5337], [5389, 5391], [5398, 5400], [4580, 4582], [5444, 5446]], "54": [[2383, 2384], [4454, 4456]], "55": [[3622, 3625], [5009, 5012], [5518, 5521], [5521, 5524], [6623, 6626]], "56": [[6355, 6357]], "57": [[4098, 4101]], "58": [[79, 81], [681, 683], [2937, 2940], [4424, 4426], [5000, 5002], [6478, 6481]], "59": [[5031, 5033]], "6": [[593, 595], [1796, 1798]], "60": [[5657, 5659], [5665, 5667]], "61": [[4720, 4724]], "62": [[4345, 4347], [5066, 5068]], "63": [[5341, 5345]], "64": [[1446, 1448], [1469, 1471], [1818, 1820], [2504, 2506], [2587, 2589], [2777, 2779], [2821, 2823], [4052, 4054]], "65": [[6614, 6616]], "66": [[896, 898], [2681, 2683], [2888, 2890], [3058, 3060]], "67": [[6313, 6315], [6410, 6412]], "68": [[84, 91], [2573, 2577]], "69": [[3099, 3101], [4458, 4464], [4474, 4476], [4911, 4913]], "7": [[4166, 4168], [4245, 4246], [4248, 4249], [6352, 6353], [6400, 6402]], "70": [[6638, 6641]], "71": [[3670, 3673]], "72": [[3766, 3768]], "73": [[4261, 4266]], "74": [[1806, 1808], [4688, 4689], [4897, 4898], [6108, 6109]], "75": [[5122, 5124]], "76": [[4427, 4430], [4449, 4452]], "77": [[49, 52], [1365, 1367]], "78": [[4194, 4196], [4214, 4216]], "79": [[4044, 4046]], "8": [[1617, 1621], [1627, 1631], [1641, 1645], [6238, 6242]], "80": [[5239, 5243]], "81": [[2825, 2832]], "82": [[4047, 4049]], "83": [[6651, 6652]], "84": [[5885, 5888]], "85": [[4817, 4819], [6686, 6688], [6705, 6707]], "86": [[517, 520], [1207, 1210], [4787, 4790]], "87": [[3383, 3384]], "88": [[4286, 4288]], "89": [[4253, 4256]], "9": [[2561, 2563], [2926, 2933], [6199, 6201]], "90": [[3785, 3787]], "91": [[498, 502]], "92": [[913, 917], [1708, 1712]], "93": [[2623, 2625]], "94": [[3530, 3532]], "95": [[5913, 5916]], "96": [[1252, 1255], [1270, 1272], [1729, 1731], [1814, 1817]], "97": [[3126, 3128]], "98": [[3994, 3996], [6044, 6046]], "99": [[2740, 2742]]}, "doc_id": "052282998bc24db695891f755a00e3cebd3fd796", "method_subrelations": {"Reactor": [[[0, 7], "Reactor"]]}, "n_ary_relations": [{"Material": "Atari-57", "Method": "Reactor", "Metric": "Medium_Human-Normalized_Score", "Task": "Atari_Games", "score": "187.0%"}], "ner": [[3, 4, "Method"], [6, 15, "Method"], [16, 18, "Task"], [26, 28, "Method"], [30, 31, "Method"], [35, 39, "Method"], [45, 48, "Metric"], [49, 52, "Method"], [54, 56, "Method"], [61, 64, "Metric"], [75, 78, "Method"], [79, 81, "Method"], [84, 91, "Task"], [93, 97, "Task"], [109, 115, "Method"], [118, 121, "Task"], [123, 125, "Method"], [131, 140, "Method"], [148, 149, "Metric"], [166, 169, "Method"], [183, 185, "Task"], [188, 191, "Material"], [202, 204, "Metric"], [205, 208, "Metric"], [214, 215, "Method"], [239, 245, "Method"], [254, 260, "Task"], [274, 278, "Task"], [305, 307, "Method"], [314, 318, "Method"], [341, 345, "Method"], [348, 350, "Metric"], [357, 358, "Metric"], [360, 361, "Method"], [368, 369, "Material"], [376, 380, "Method"], [384, 393, "Method"], [420, 425, "Method"], [438, 440, "Metric"], [449, 450, "Task"], [453, 457, "Metric"], [486, 489, "Task"], [490, 494, "Task"], [498, 502, "Task"], [517, 520, "Metric"], [528, 530, "Metric"], [558, 561, "Method"], [563, 564, "Method"], [565, 568, "Method"], [578, 581, "Metric"], [582, 587, "Method"], [593, 595, "Method"], [643, 646, "Method"], [670, 680, "Method"], [681, 683, "Method"], [691, 693, "Method"], [694, 700, "Task"], [706, 712, "Method"], [725, 729, "Method"], [730, 734, "Method"], [787, 789, "Task"], [794, 795, "Method"], [802, 808, "Method"], [818, 821, "Method"], [890, 892, "Task"], [896, 898, "Method"], [913, 917, "Method"], [918, 926, "Method"], [938, 941, "Method"], [961, 962, "Method"], [979, 982, "Method"], [991, 995, "Method"], [998, 1002, "Method"], [1005, 1010, "Method"], [1012, 1016, "Method"], [1066, 1072, "Metric"], [1117, 1119, "Method"], [1126, 1130, "Task"], [1132, 1135, "Method"], [1147, 1149, "Method"], [1161, 1163, "Method"], [1169, 1170, "Method"], [1172, 1178, "Method"], [1195, 1196, "Method"], [1207, 1210, "Metric"], [1212, 1214, "Method"], [1221, 1222, "Method"], [1244, 1245, "Method"], [1248, 1251, "Task"], [1252, 1255, "Method"], [1270, 1272, "Method"], [1275, 1283, "Method"], [1311, 1314, "Method"], [1315, 1318, "Method"], [1320, 1322, "Method"], [1323, 1325, "Method"], [1328, 1331, "Metric"], [1352, 1356, "Method"], [1365, 1367, "Method"], [1371, 1374, "Metric"], [1378, 1379, "Method"], [1381, 1384, "Material"], [1388, 1389, "Method"], [1391, 1394, "Method"], [1396, 1404, "Method"], [1406, 1408, "Method"], [1446, 1448, "Method"], [1469, 1471, "Method"], [1500, 1502, "Method"], [1529, 1531, "Method"], [1531, 1534, "Method"], [1565, 1568, "Method"], [1585, 1588, "Material"], [1596, 1599, "Method"], [1617, 1621, "Method"], [1627, 1631, "Method"], [1632, 1635, "Method"], [1641, 1645, "Method"], [1654, 1664, "Method"], [1667, 1672, "Method"], [1679, 1682, "Method"], [1708, 1712, "Method"], [1713, 1714, "Method"], [1716, 1720, "Method"], [1726, 1727, "Method"], [1729, 1731, "Method"], [1732, 1735, "Method"], [1736, 1737, "Method"], [1742, 1747, "Method"], [1752, 1753, "Method"], [1767, 1768, "Method"], [1771, 1773, "Method"], [1780, 1781, "Method"], [1796, 1798, "Method"], [1800, 1805, "Method"], [1806, 1808, "Method"], [1810, 1812, "Method"], [1814, 1817, "Method"], [1818, 1820, "Method"], [1821, 1825, "Task"], [1828, 1837, "Method"], [1839, 1844, "Task"], [1849, 1850, "Method"], [1851, 1852, "Method"], [1866, 1871, "Method"], [1872, 1876, "Method"], [1880, 1881, "Method"], [1887, 1891, "Metric"], [1902, 1908, "Method"], [1912, 1915, "Method"], [1918, 1919, "Method"], [1939, 1942, "Method"], [1990, 1994, "Task"], [2035, 2041, "Method"], [2044, 2050, "Method"], [2054, 2055, "Method"], [2092, 2093, "Metric"], [2128, 2140, "Method"], [2159, 2163, "Metric"], [2169, 2176, "Method"], [2262, 2264, "Method"], [2346, 2350, "Metric"], [2354, 2357, "Method"], [2372, 2376, "Method"], [2383, 2384, "Method"], [2385, 2388, "Method"], [2401, 2402, "Method"], [2407, 2409, "Metric"], [2415, 2416, "Method"], [2419, 2420, "Method"], [2452, 2454, "Method"], [2457, 2459, "Task"], [2460, 2464, "Task"], [2484, 2487, "Method"], [2504, 2506, "Method"], [2523, 2524, "Method"], [2532, 2535, "Method"], [2561, 2563, "Method"], [2573, 2577, "Task"], [2580, 2584, "Task"], [2587, 2589, "Method"], [2595, 2596, "Method"], [2607, 2613, "Method"], [2618, 2619, "Method"], [2623, 2625, "Task"], [2681, 2683, "Method"], [2692, 2700, "Method"], [2740, 2742, "Method"], [2745, 2748, "Metric"], [2777, 2779, "Method"], [2783, 2784, "Method"], [2786, 2790, "Method"], [2799, 2802, "Method"], [2808, 2812, "Task"], [2813, 2817, "Task"], [2821, 2823, "Method"], [2825, 2832, "Method"], [2888, 2890, "Method"], [2919, 2921, "Method"], [2926, 2933, "Method"], [2937, 2940, "Method"], [2947, 2952, "Method"], [2967, 2970, "Method"], [2984, 2986, "Method"], [2988, 2991, "Method"], [3025, 3028, "Method"], [3037, 3040, "Method"], [3041, 3042, "Method"], [3058, 3060, "Method"], [3086, 3089, "Method"], [3091, 3094, "Method"], [3099, 3101, "Method"], [3103, 3111, "Method"], [3114, 3117, "Task"], [3117, 3120, "Task"], [3126, 3128, "Metric"], [3132, 3135, "Method"], [3142, 3144, "Method"], [3164, 3166, "Method"], [3168, 3170, "Method"], [3191, 3195, "Method"], [3236, 3238, "Task"], [3272, 3275, "Method"], [3383, 3384, "Method"], [3421, 3424, "Method"], [3530, 3532, "Task"], [3622, 3625, "Method"], [3626, 3627, "Method"], [3633, 3635, "Method"], [3639, 3640, "Method"], [3641, 3642, "Method"], [3643, 3644, "Method"], [3645, 3647, "Method"], [3666, 3667, "Method"], [3670, 3673, "Method"], [3682, 3685, "Task"], [3698, 3701, "Method"], [3707, 3711, "Metric"], [3715, 3716, "Task"], [3727, 3730, "Task"], [3736, 3739, "Task"], [3742, 3744, "Method"], [3754, 3755, "Task"], [3766, 3768, "Method"], [3785, 3787, "Method"], [3832, 3834, "Method"], [3915, 3916, "Task"], [3921, 3923, "Method"], [3935, 3937, "Method"], [3964, 3968, "Method"], [3970, 3972, "Method"], [3987, 3988, "Method"], [3994, 3996, "Method"], [4002, 4003, "Material"], [4027, 4029, "Method"], [4030, 4033, "Method"], [4044, 4046, "Metric"], [4047, 4049, "Metric"], [4052, 4054, "Method"], [4067, 4069, "Method"], [4077, 4079, "Method"], [4098, 4101, "Method"], [4136, 4139, "Method"], [4166, 4168, "Method"], [4194, 4196, "Method"], [4210, 4212, "Method"], [4214, 4216, "Method"], [4238, 4243, "Method"], [4245, 4246, "Method"], [4248, 4249, "Method"], [4253, 4256, "Method"], [4261, 4266, "Method"], [4286, 4288, "Method"], [4296, 4300, "Method"], [4308, 4311, "Method"], [4339, 4341, "Method"], [4345, 4347, "Metric"], [4365, 4366, "Task"], [4383, 4384, "Method"], [4398, 4399, "Method"], [4403, 4404, "Method"], [4424, 4426, "Method"], [4427, 4430, "Method"], [4431, 4433, "Method"], [4441, 4442, "Method"], [4449, 4452, "Method"], [4454, 4456, "Method"], [4458, 4464, "Method"], [4469, 4473, "Metric"], [4474, 4476, "Method"], [4502, 4503, "Method"], [4595, 4596, "Metric"], [4597, 4599, "Metric"], [4663, 4664, "Method"], [4667, 4668, "Method"], [4670, 4672, "Method"], [4674, 4679, "Method"], [4681, 4686, "Method"], [4688, 4689, "Method"], [4691, 4692, "Method"], [4695, 4697, "Method"], [4720, 4724, "Method"], [4747, 4748, "Method"], [4776, 4777, "Method"], [4787, 4790, "Metric"], [4795, 4796, "Method"], [4811, 4812, "Method"], [4813, 4814, "Method"], [4817, 4819, "Method"], [4848, 4849, "Method"], [4855, 4856, "Method"], [4860, 4861, "Method"], [4897, 4898, "Method"], [4900, 4907, "Method"], [4911, 4913, "Method"], [4914, 4915, "Method"], [4926, 4929, "Metric"], [4950, 4954, "Method"], [4956, 4961, "Method"], [4996, 4998, "Method"], [5000, 5002, "Method"], [5003, 5008, "Method"], [5009, 5012, "Method"], [5031, 5033, "Method"], [5054, 5056, "Task"], [5066, 5068, "Metric"], [5092, 5093, "Method"], [5094, 5100, "Method"], [5122, 5124, "Method"], [5127, 5128, "Metric"], [5129, 5131, "Metric"], [5169, 5172, "Metric"], [5239, 5243, "Metric"], [5245, 5249, "Metric"], [5335, 5337, "Metric"], [5338, 5340, "Metric"], [5341, 5345, "Metric"], [5389, 5391, "Metric"], [5392, 5394, "Metric"], [5398, 5400, "Metric"], [5401, 5403, "Metric"], [5454, 5458, "Method"], [5473, 5474, "Material"], [5478, 5483, "Metric"], [5495, 5497, "Metric"], [5513, 5515, "Method"], [5518, 5521, "Method"], [5521, 5524, "Method"], [5529, 5531, "Task"], [5545, 5549, "Method"], [5556, 5558, "Method"], [5653, 5655, "Method"], [5657, 5659, "Metric"], [5665, 5667, "Metric"], [5879, 5880, "Method"], [5881, 5882, "Method"], [5883, 5884, "Method"], [5885, 5888, "Method"], [5913, 5916, "Method"], [6044, 6046, "Method"], [6066, 6068, "Method"], [6098, 6099, "Method"], [6103, 6106, "Method"], [6108, 6109, "Method"], [6116, 6117, "Method"], [6136, 6137, "Method"], [6138, 6139, "Method"], [6152, 6153, "Method"], [6154, 6155, "Method"], [6189, 6191, "Method"], [6199, 6201, "Method"], [6206, 6207, "Method"], [6208, 6209, "Method"], [6223, 6224, "Method"], [6225, 6228, "Method"], [6232, 6233, "Method"], [6235, 6236, "Method"], [6238, 6242, "Method"], [6246, 6247, "Method"], [6297, 6298, "Method"], [6299, 6302, "Method"], [6310, 6311, "Method"], [6313, 6315, "Method"], [6326, 6327, "Method"], [6332, 6333, "Method"], [6335, 6337, "Method"], [6343, 6344, "Method"], [6349, 6350, "Method"], [6352, 6353, "Method"], [6355, 6357, "Method"], [6379, 6382, "Method"], [6400, 6402, "Method"], [6403, 6404, "Method"], [6410, 6412, "Method"], [6426, 6430, "Method"], [6436, 6440, "Method"], [6445, 6446, "Method"], [6474, 6475, "Method"], [6478, 6481, "Method"], [6482, 6490, "Task"], [6529, 6530, "Method"], [6576, 6577, "Method"], [6589, 6591, "Metric"], [6614, 6616, "Method"], [6623, 6626, "Method"], [6638, 6641, "Method"], [6651, 6652, "Task"], [6653, 6654, "Method"], [6656, 6657, "Method"], [6661, 6664, "Method"], [6686, 6688, "Method"], [6692, 6694, "Method"], [6697, 6700, "Method"], [6701, 6702, "Method"], [6705, 6707, "Method"], [6713, 6716, "Method"], [6726, 6728, "Method"], [6782, 6784, "Method"], [6827, 6828, "Task"], [6839, 6840, "Method"], [6850, 6851, "Material"], [630, 631, "Material"], [750, 751, "Method"], [768, 769, "Material"], [953, 954, "Material"], [1897, 1898, "Method"], [4094, 4095, "Method"], [4386, 4387, "Material"], [4514, 4515, "Material"], [4580, 4582, "Metric"], [4588, 4589, "Material"], [4649, 4650, "Material"], [5089, 5090, "Material"], [5135, 5139, "Metric"], [5174, 5175, "Material"], [5268, 5272, "Metric"], [5444, 5446, "Metric"], [5450, 5451, "Material"]], "sections": [[0, 236], [236, 796], [796, 911], [911, 1246], [1246, 1386], [1386, 1527], [1527, 1615], [1615, 1846], [1846, 1892], [1892, 2455], [2455, 2605], [2605, 2769], [2769, 3070], [3070, 3112], [3112, 3249], [3249, 3740], [3740, 3992], [3992, 4375], [4375, 4494], [4494, 4940], [4940, 5013], [5013, 5016], [5016, 5020], [5020, 5029], [5029, 5125], [5125, 5516], [5516, 6042], [6042, 6088], [6088, 6848], [6848, 6852]], "sentences": [[0, 18], [18, 69], [69, 98], [98, 126], [126, 159], [159, 186], [186, 209], [209, 236], [236, 239], [239, 282], [282, 294], [294, 340], [340, 371], [371, 398], [398, 419], [419, 441], [441, 458], [458, 486], [486, 510], [510, 531], [531, 550], [550, 596], [596, 634], [634, 713], [713, 735], [735, 753], [753, 796], [796, 799], [799, 816], [816, 833], [833, 887], [887, 902], [902, 911], [911, 917], [917, 960], [960, 1037], [1037, 1063], [1063, 1097], [1097, 1117], [1117, 1146], [1146, 1195], [1195, 1215], [1215, 1228], [1228, 1246], [1246, 1251], [1251, 1267], [1267, 1291], [1291, 1308], [1308, 1333], [1333, 1386], [1386, 1391], [1391, 1410], [1410, 1425], [1425, 1445], [1445, 1523], [1523, 1527], [1527, 1531], [1531, 1557], [1557, 1589], [1589, 1615], [1615, 1621], [1621, 1653], [1653, 1702], [1702, 1732], [1732, 1765], [1765, 1846], [1846, 1850], [1850, 1877], [1877, 1892], [1892, 1896], [1896, 1909], [1909, 1928], [1928, 1956], [1956, 1967], [1967, 2013], [2013, 2030], [2030, 2079], [2079, 2087], [2087, 2157], [2157, 2193], [2193, 2219], [2219, 2269], [2269, 2289], [2289, 2294], [2294, 2301], [2301, 2331], [2331, 2365], [2365, 2390], [2390, 2455], [2455, 2459], [2459, 2479], [2479, 2491], [2491, 2522], [2522, 2549], [2549, 2565], [2565, 2597], [2597, 2605], [2605, 2614], [2614, 2626], [2626, 2654], [2654, 2672], [2672, 2702], [2702, 2769], [2769, 2774], [2774, 2803], [2803, 2838], [2838, 2849], [2849, 2869], [2869, 2881], [2881, 2897], [2897, 2908], [2908, 2934], [2934, 2953], [2953, 2991], [2991, 2997], [2997, 2998], [2998, 3020], [3020, 3032], [3032, 3041], [3041, 3070], [3070, 3074], [3074, 3112], [3112, 3117], [3117, 3137], [3137, 3157], [3157, 3184], [3184, 3204], [3204, 3216], [3216, 3240], [3240, 3249], [3249, 3252], [3252, 3272], [3272, 3299], [3299, 3328], [3328, 3347], [3347, 3362], [3362, 3383], [3383, 3420], [3420, 3439], [3439, 3453], [3453, 3478], [3478, 3508], [3508, 3514], [3514, 3533], [3533, 3551], [3551, 3581], [3581, 3593], [3593, 3611], [3611, 3629], [3629, 3650], [3650, 3664], [3664, 3674], [3674, 3695], [3695, 3740], [3740, 3744], [3744, 3756], [3756, 3808], [3808, 3821], [3821, 3831], [3831, 3853], [3853, 3870], [3870, 3892], [3892, 3915], [3915, 3938], [3938, 3973], [3973, 3992], [3992, 3996], [3996, 4018], [4018, 4034], [4034, 4050], [4050, 4093], [4093, 4129], [4129, 4141], [4141, 4170], [4170, 4191], [4191, 4209], [4209, 4238], [4238, 4247], [4247, 4267], [4267, 4282], [4282, 4312], [4312, 4336], [4336, 4359], [4359, 4375], [4375, 4379], [4379, 4390], [4390, 4414], [4414, 4440], [4440, 4457], [4457, 4494], [4494, 4500], [4500, 4523], [4523, 4551], [4551, 4563], [4563, 4591], [4591, 4595], [4595, 4610], [4610, 4624], [4624, 4661], [4661, 4698], [4698, 4738], [4738, 4766], [4766, 4784], [4784, 4798], [4798, 4808], [4808, 4832], [4832, 4857], [4857, 4896], [4896, 4940], [4940, 4943], [4943, 4987], [4987, 5013], [5013, 5016], [5016, 5019], [5019, 5020], [5020, 5024], [5024, 5029], [5029, 5033], [5033, 5057], [5057, 5101], [5101, 5110], [5110, 5125], [5125, 5131], [5131, 5143], [5143, 5164], [5164, 5198], [5198, 5244], [5244, 5266], [5266, 5325], [5325, 5346], [5346, 5395], [5395, 5433], [5433, 5453], [5453, 5475], [5475, 5498], [5498, 5516], [5516, 5521], [5521, 5538], [5538, 5555], [5555, 5584], [5584, 5616], [5616, 5631], [5631, 5656], [5656, 5682], [5682, 5712], [5712, 5751], [5751, 5793], [5793, 5828], [5828, 5844], [5844, 5879], [5879, 5901], [5901, 5923], [5923, 5946], [5946, 5968], [5968, 5989], [5989, 6022], [6022, 6042], [6042, 6046], [6046, 6069], [6069, 6088], [6088, 6093], [6093, 6107], [6107, 6144], [6144, 6156], [6156, 6166], [6166, 6202], [6202, 6222], [6222, 6249], [6249, 6271], [6271, 6288], [6288, 6297], [6297, 6321], [6321, 6338], [6338, 6361], [6361, 6414], [6414, 6421], [6421, 6441], [6441, 6471], [6471, 6491], [6491, 6507], [6507, 6529], [6529, 6556], [6556, 6576], [6576, 6592], [6592, 6613], [6613, 6642], [6642, 6653], [6653, 6682], [6682, 6701], [6701, 6736], [6736, 6770], [6770, 6810], [6810, 6848], [6848, 6852]], "words": ["document", ":", "The", "Reactor", ":", "A", "fast", "and", "sample", "-", "efficient", "Actor", "-", "Critic", "agent", "for", "Reinforcement", "Learning", "In", "this", "work", ",", "we", "present", "a", "new", "agent", "architecture", ",", "called", "Reactor", ",", "which", "combines", "multiple", "algorithmic", "and", "architectural", "contributions", "to", "produce", "an", "agent", "with", "higher", "sample", "-", "efficiency", "than", "Prioritized", "Dueling", "DQN", "wang2017sample", "and", "Categorical", "DQN", "bellemare2017distributional", ",", "while", "giving", "better", "run", "-", "time", "performance", "than", "A3C", "mnih2016asynchronous", ".", "Our", "first", "contribution", "is", "a", "new", "policy", "evaluation", "algorithm", "called", "Distributional", "Retrace", ",", "which", "brings", "multi", "-", "step", "off", "-", "policy", "updates", "to", "the", "distributional", "reinforcement", "learning", "setting", ".", "The", "same", "approach", "can", "be", "used", "to", "convert", "several", "classes", "of", "multi", "-", "step", "policy", "evaluation", "algorithms", ",", "designed", "for", "expected", "value", "evaluation", ",", "into", "distributional", "algorithms", ".", "Next", ",", "we", "introduce", "the", "-", "leave", "-", "one", "-", "out", "policy", "gradient", "algorithm", ",", "which", "improves", "the", "trade", "-", "off", "between", "variance", "and", "bias", "by", "using", "action", "values", "as", "a", "baseline", ".", "Our", "final", "algorithmic", "contribution", "is", "a", "new", "prioritized", "replay", "algorithm", "for", "sequences", ",", "which", "exploits", "the", "temporal", "locality", "of", "neighboring", "observations", "for", "more", "efficient", "replay", "prioritization", ".", "Using", "the", "Atari", "2600", "benchmarks", ",", "we", "show", "that", "each", "of", "these", "innovations", "contribute", "to", "both", "sample", "efficiency", "and", "final", "agent", "performance", ".", "Finally", ",", "we", "demonstrate", "that", "Reactor", "reaches", "state", "-", "of", "-", "the", "-", "art", "performance", "after", "200", "million", "frames", "and", "less", "than", "a", "day", "of", "training", ".", "section", ":", "Introduction", "Model", "-", "free", "deep", "reinforcement", "learning", "has", "achieved", "several", "remarkable", "successes", "in", "domains", "ranging", "from", "super", "-", "human", "-", "level", "control", "in", "video", "games", "mnih15human", "and", "the", "game", "of", "Go", "silver2016mastering", ",", "agzero", ",", "to", "continuous", "motor", "control", "tasks", "lillicrap2015continuous", ",", "schulman2015trust", ".", "Much", "of", "the", "recent", "work", "can", "be", "divided", "into", "two", "categories", ".", "First", ",", "those", "of", "which", "that", ",", "often", "building", "on", "the", "DQN", "framework", ",", "act", "-", "greedily", "according", "to", "an", "action", "-", "value", "function", "and", "train", "using", "mini", "-", "batches", "of", "transitions", "sampled", "from", "an", "experience", "replay", "buffer", "van2016deep", ",", "wang2015dueling", ",", "he2016learning", ",", "anschel2017averaged", ".", "These", "value", "-", "function", "agents", "benefit", "from", "improved", "sample", "complexity", ",", "but", "tend", "to", "suffer", "from", "long", "runtimes", "(", "e.g.", "DQN", "requires", "approximately", "a", "week", "to", "train", "on", "Atari", ")", ".", "The", "second", "category", "are", "the", "actor", "-", "critic", "agents", ",", "which", "includes", "the", "asynchronous", "advantage", "actor", "-", "critic", "(", "A3C", ")", "algorithm", ",", "introduced", "by", "mnih2016asynchronous", ".", "These", "agents", "train", "on", "transitions", "collected", "by", "multiple", "actors", "running", ",", "and", "often", "training", ",", "in", "parallel", "schulman2017proximal", ",", "vezhnevets2017feudal", ".", "The", "deep", "actor", "-", "critic", "agents", "train", "on", "each", "trajectory", "only", "once", ",", "and", "thus", "tend", "to", "have", "worse", "sample", "complexity", ".", "However", ",", "their", "distributed", "nature", "allows", "significantly", "faster", "training", "in", "terms", "of", "wall", "-", "clock", "time", ".", "Still", ",", "not", "all", "existing", "algorithms", "can", "be", "put", "in", "the", "above", "two", "categories", "and", "various", "hybrid", "approaches", "do", "exist", "zhao2016deep", ",", "o2016combining", ",", "gu2016q", ",", "wang2017sample", ".", "Data", "-", "efficiency", "and", "off", "-", "policy", "learning", "are", "essential", "for", "many", "real", "-", "world", "domains", "where", "interactions", "with", "the", "environment", "are", "expensive", ".", "Similarly", ",", "wall", "-", "clock", "time", "(", "time", "-", "efficiency", ")", "directly", "impacts", "an", "algorithm", "\u2019s", "applicability", "through", "resource", "costs", ".", "The", "focus", "of", "this", "work", "is", "to", "produce", "an", "agent", "that", "is", "sample", "-", "and", "time", "-", "efficient", ".", "To", "this", "end", ",", "we", "introduce", "a", "new", "reinforcement", "learning", "agent", ",", "called", "Reactor", "(", "Retrace", "-", "Actor", ")", ",", "which", "takes", "a", "principled", "approach", "to", "combining", "the", "sample", "-", "efficiency", "of", "off", "-", "policy", "experience", "replay", "with", "the", "time", "-", "efficiency", "of", "asynchronous", "algorithms", ".", "We", "combine", "recent", "advances", "in", "both", "categories", "of", "agents", "with", "novel", "contributions", "to", "produce", "an", "agent", "that", "inherits", "the", "benefits", "of", "both", "and", "reaches", "state", "-", "of", "-", "the", "-", "art", "performance", "over", "57", "Atari", "2600", "games", ".", "Our", "primary", "contributions", "are", "(", "1", ")", "a", "novel", "policy", "gradient", "algorithm", ",", "-", "LOO", ",", "which", "makes", "better", "use", "of", "action", "-", "value", "estimates", "to", "improve", "the", "policy", "gradient", ";", "(", "2", ")", "the", "first", "multi", "-", "step", "off", "-", "policy", "distributional", "reinforcement", "learning", "algorithm", ",", "distributional", "Retrace", "(", ")", ";", "(", "3", ")", "a", "novel", "prioritized", "replay", "for", "off", "-", "policy", "sequences", "of", "transitions", ";", "and", "(", "4", ")", "an", "optimized", "network", "and", "parallel", "training", "architecture", ".", "We", "begin", "by", "reviewing", "background", "material", ",", "including", "relevant", "improvements", "to", "both", "value", "-", "function", "agents", "and", "actor", "-", "critic", "agents", ".", "In", "Section", "[", "reference", "]", "we", "introduce", "each", "of", "our", "primary", "contributions", "and", "present", "the", "Reactor", "agent", ".", "Finally", ",", "in", "Section", "[", "reference", "]", ",", "we", "present", "experimental", "results", "on", "the", "57", "Atari", "2600", "games", "from", "the", "Arcade", "Learning", "Environment", "(", "ALE", ")", "bellemare2013arcade", ",", "as", "well", "as", "a", "series", "of", "ablation", "studies", "for", "the", "various", "components", "of", "Reactor", ".", "section", ":", "Background", "We", "consider", "a", "Markov", "decision", "process", "(", "MDP", ")", "with", "state", "space", "and", "finite", "action", "space", ".", "A", "(", "stochastic", ")", "policy", "is", "a", "mapping", "from", "states", "to", "a", "probability", "distribution", "over", "actions", ".", "We", "consider", "a", "-", "discounted", "infinite", "-", "horizon", "criterion", ",", "with", "the", "discount", "factor", ",", "and", "define", "for", "policy", "the", "action", "-", "value", "of", "a", "state", "-", "action", "pair", "as", "where", "is", "a", "trajectory", "generated", "by", "choosing", "in", "and", "following", "thereafter", ",", "i.e.", ",", "(", "for", ")", ",", "and", "is", "the", "reward", "signal", ".", "The", "objective", "in", "reinforcement", "learning", "is", "to", "find", "an", "optimal", "policy", ",", "which", "maximises", ".", "The", "optimal", "action", "-", "values", "are", "given", "by", ".", "subsection", ":", "Value", "-", "based", "algorithms", "The", "Deep", "Q", "-", "Network", "(", "DQN", ")", "framework", ",", "introduced", "by", "mnih15human", ",", "popularised", "the", "current", "line", "of", "research", "into", "deep", "reinforcement", "learning", "by", "reaching", "human", "-", "level", ",", "and", "beyond", ",", "performance", "across", "57", "Atari", "2600", "games", "in", "the", "ALE", ".", "While", "DQN", "includes", "many", "specific", "components", ",", "the", "essence", "of", "the", "framework", ",", "much", "of", "which", "is", "shared", "by", "Neural", "Fitted", "Q", "-", "Learning", "riedmiller2005neural", ",", "is", "to", "use", "of", "a", "deep", "convolutional", "neural", "network", "to", "approximate", "an", "action", "-", "value", "function", ",", "training", "this", "approximate", "action", "-", "value", "function", "using", "the", "Q", "-", "Learning", "algorithm", "watkins1992", "and", "mini", "-", "batches", "of", "one", "-", "step", "transitions", "(", ")", "drawn", "randomly", "from", "an", "experience", "replay", "buffer", "lin1992self", ".", "Additionally", ",", "the", "next", "-", "state", "action", "-", "values", "are", "taken", "from", "a", "target", "network", ",", "which", "is", "updated", "to", "match", "the", "current", "network", "periodically", ".", "Thus", ",", "the", "temporal", "difference", "(", "TD", ")", "error", "for", "transition", "used", "by", "these", "algorithms", "is", "given", "by", "where", "denotes", "the", "parameters", "of", "the", "network", "and", "are", "the", "parameters", "of", "the", "target", "network", ".", "Since", "this", "seminal", "work", ",", "we", "have", "seen", "numerous", "extensions", "and", "improvements", "that", "all", "share", "the", "same", "underlying", "framework", ".", "Double", "DQN", "van2016deep", ",", "attempts", "to", "correct", "for", "the", "over", "-", "estimation", "bias", "inherent", "in", "Q", "-", "Learning", "by", "changing", "the", "second", "term", "of", "eq", ":", "tderr", "to", ".", "The", "dueling", "architecture", "wang2015dueling", ",", "changes", "the", "network", "to", "estimate", "action", "-", "values", "using", "separate", "network", "heads", "and", "with", "Recently", ",", "rainbow", "introduced", "Rainbow", ",", "a", "value", "-", "based", "reinforcement", "learning", "agent", "combining", "many", "of", "these", "improvements", "into", "a", "single", "agent", "and", "demonstrating", "that", "they", "are", "largely", "complementary", ".", "Rainbow", "significantly", "out", "performs", "previous", "methods", ",", "but", "also", "inherits", "the", "poorer", "time", "-", "efficiency", "of", "the", "DQN", "framework", ".", "We", "include", "a", "detailed", "comparison", "between", "Reactor", "and", "Rainbow", "in", "the", "Appendix", ".", "In", "the", "remainder", "of", "the", "section", "we", "will", "describe", "in", "more", "depth", "other", "recent", "improvements", "to", "DQN", ".", "subsubsection", ":", "Prioritized", "experience", "replay", "The", "experience", "replay", "buffer", "was", "first", "introduced", "by", "lin1992self", "and", "later", "used", "in", "DQN", "mnih15human", ".", "Typically", ",", "the", "replay", "buffer", "is", "essentially", "a", "first", "-", "in", "-", "first", "-", "out", "queue", "with", "new", "transitions", "gradually", "replacing", "older", "transitions", ".", "The", "agent", "would", "then", "sample", "a", "mini", "-", "batch", "uniformly", "at", "random", "from", "the", "replay", "buffer", ".", "Drawing", "inspiration", "from", "prioritized", "sweeping", "moore1993prioritized", ",", "prioritized", "experience", "replay", "replaces", "the", "uniform", "sampling", "with", "prioritized", "sampling", "proportional", "to", "the", "absolute", "TD", "error", "schaul16prioritized", ".", "Specifically", ",", "for", "a", "replay", "buffer", "of", "size", ",", "prioritized", "experience", "replay", "samples", "transition", "with", "probability", ",", "and", "applies", "weighted", "importance", "-", "sampling", "with", "to", "correct", "for", "the", "prioritization", "bias", ",", "where", "Prioritized", "DQN", "significantly", "increases", "both", "the", "sample", "-", "efficiency", "and", "final", "performance", "over", "DQN", "on", "the", "Atari", "2600", "benchmarks", "schaul2015prioritized", ".", "subsubsection", ":", "Retrace", "(", ")", "Retrace", "(", ")", "is", "a", "convergent", "off", "-", "policy", "multi", "-", "step", "algorithm", "extending", "the", "DQN", "agent", "munos2016safe", ".", "Assume", "that", "some", "trajectory", "has", "been", "generated", "according", "to", "behaviour", "policy", ",", "i.e.", ",", ".", "Now", ",", "we", "aim", "to", "evaluate", "the", "value", "of", "a", "different", "target", "policy", ",", "i.e.", "we", "want", "to", "estimate", ".", "The", "Retrace", "algorithm", "will", "update", "our", "current", "estimate", "of", "in", "the", "direction", "of", "where", "is", "the", "temporal", "difference", "at", "time", "under", ",", "and", "The", "Retrace", "algorithm", "comes", "with", "the", "theoretical", "guarantee", "that", "in", "finite", "state", "and", "action", "spaces", ",", "repeatedly", "updating", "our", "current", "estimate", "according", "to", "(", "[", "reference", "]", ")", "produces", "a", "sequence", "of", "Q", "functions", "which", "converges", "to", "for", "a", "fixed", "or", "to", "if", "we", "consider", "a", "sequence", "of", "policies", "which", "become", "increasingly", "greedy", "w.r.t", ".", "the", "estimates", "munos2016safe", ".", "subsubsection", ":", "Distributional", "RL", "Distributional", "reinforcement", "learning", "refers", "to", "a", "class", "of", "algorithms", "that", "directly", "estimate", "the", "distribution", "over", "returns", ",", "whose", "expectation", "gives", "the", "traditional", "value", "function", "bellemare2017distributional", ".", "Such", "approaches", "can", "be", "made", "tractable", "with", "a", "distributional", "Bellman", "equation", ",", "and", "the", "recently", "proposed", "algorithm", "showed", "state", "-", "of", "-", "the", "-", "art", "performance", "in", "the", "Atari", "2600", "benchmarks", ".", "parameterizes", "the", "distribution", "over", "returns", "with", "a", "mixture", "over", "Diracs", "centered", "on", "a", "uniform", "grid", ",", "with", "hyperparameters", "that", "bound", "the", "distribution", "support", "of", "size", ".", "subsection", ":", "Actor", "-", "critic", "algorithms", "In", "this", "section", "we", "review", "the", "actor", "-", "critic", "framework", "for", "reinforcement", "learning", "algorithms", "and", "then", "discuss", "recent", "advances", "in", "actor", "-", "critic", "algorithms", "along", "with", "their", "various", "trade", "-", "offs", ".", "The", "asynchronous", "advantage", "actor", "-", "critic", "(", "A3C", ")", "algorithm", "mnih2016asynchronous", ",", "maintains", "a", "parameterized", "policy", "and", "value", "function", ",", "which", "are", "updated", "with", "A3C", "uses", "parallel", "CPU", "workers", ",", "each", "acting", "independently", "in", "the", "environment", "and", "applying", "the", "above", "updates", "asynchronously", "to", "a", "shared", "set", "of", "parameters", ".", "In", "contrast", "to", "the", "previously", "discussed", "value", "-", "based", "methods", ",", "A3C", "is", "an", "on", "-", "policy", "algorithm", ",", "and", "does", "not", "use", "a", "GPU", "nor", "a", "replay", "buffer", ".", "Proximal", "Policy", "Optimization", "(", "PPO", ")", "is", "a", "closely", "related", "actor", "-", "critic", "algorithm", "schulman2017proximal", ",", "which", "replaces", "the", "advantage", "pgadv", "with", ",", "where", "is", "as", "defined", "in", "Section", "[", "reference", "]", ".", "Although", "both", "PPO", "and", "A3C", "run", "parallel", "workers", "collecting", "trajectories", "independently", "in", "the", "environment", ",", "PPO", "collects", "these", "experiences", "to", "perform", "a", "single", ",", "synchronous", ",", "update", "in", "contrast", "with", "the", "asynchronous", "updates", "of", "A3C.", "Actor", "-", "Critic", "Experience", "Replay", "(", "ACER", ")", "extends", "the", "A3C", "framework", "with", "an", "experience", "replay", "buffer", ",", "Retrace", "algorithm", "for", "off", "-", "policy", "corrections", ",", "and", "the", "Truncated", "Importance", "Sampling", "Likelihood", "Ratio", "(", "TISLR", ")", "algorithm", "used", "for", "off", "-", "policy", "policy", "optimization", "wang2017sample", ".", "section", ":", "The", "Reactor", "The", "Reactor", "is", "a", "combination", "of", "four", "novel", "contributions", "on", "top", "of", "recent", "improvements", "to", "both", "deep", "value", "-", "based", "RL", "and", "policy", "-", "gradient", "algorithms", ".", "Each", "contribution", "moves", "Reactor", "towards", "our", "goal", "of", "achieving", "both", "sample", "and", "time", "efficiency", ".", "subsection", ":", "-", "LOO", "The", "Reactor", "architecture", "represents", "both", "a", "policy", "and", "action", "-", "value", "function", ".", "We", "use", "a", "policy", "gradient", "algorithm", "to", "train", "the", "actor", "which", "makes", "use", "of", "our", "current", "estimate", "of", ".", "Let", "be", "the", "value", "function", "at", "some", "initial", "state", ",", "the", "policy", "gradient", "theorem", "says", "that", ",", "where", "refers", "to", "the", "gradient", "w.r.t", ".", "policy", "parameters", "Sutton00policygradient", ".", "We", "now", "consider", "several", "possible", "ways", "to", "estimate", "this", "gradient", ".", "To", "simplify", "notation", ",", "we", "drop", "the", "dependence", "on", "the", "state", "for", "now", "and", "consider", "the", "problem", "of", "estimating", "the", "quantity", "In", "the", "off", "-", "policy", "case", ",", "we", "consider", "estimating", "using", "a", "single", "action", "drawn", "from", "a", "(", "possibly", "different", "from", ")", "behaviour", "distribution", ".", "Let", "us", "assume", "that", "for", "the", "chosen", "action", "we", "have", "access", "to", "an", "unbiased", "estimate", "of", ".", "Then", ",", "we", "can", "use", "likelihood", "ratio", "(", "LR", ")", "method", "combined", "with", "an", "importance", "sampling", "(", "IS", ")", "ratio", "(", "which", "we", "call", "ISLR", ")", "to", "build", "an", "unbiased", "estimate", "of", ":", "where", "is", "a", "baseline", "that", "depends", "on", "the", "state", "but", "not", "on", "the", "chosen", "action", ".", "However", "this", "estimate", "suffers", "from", "high", "variance", ".", "A", "possible", "way", "for", "reducing", "variance", "is", "to", "estimate", "directly", "from", "(", "[", "reference", "]", ")", "by", "using", "the", "return", "for", "the", "chosen", "action", "and", "our", "current", "estimate", "of", "for", "the", "other", "actions", ",", "which", "leads", "to", "the", "so", "-", "called", "leave", "-", "one", "-", "out", "(", "LOO", ")", "policy", "-", "gradient", "estimate", ":", "This", "estimate", "has", "low", "variance", "but", "may", "be", "biased", "if", "the", "estimated", "values", "differ", "from", ".", "A", "better", "bias", "-", "variance", "tradeoff", "may", "be", "obtained", "by", "the", "more", "general", "-", "LOO", "policy", "-", "gradient", "estimate", ":", "where", "can", "be", "a", "function", "of", "both", "policies", ",", "and", ",", "and", "the", "selected", "action", ".", "Notice", "that", "when", ",", "(", "[", "reference", "]", ")", "reduces", "to", "(", "[", "reference", "]", ")", ",", "and", "when", ",", "then", "(", "[", "reference", "]", ")", "is", "This", "estimate", "is", "unbiased", "and", "can", "be", "seen", "as", "a", "generalization", "of", "where", "instead", "of", "using", "a", "state", "-", "only", "dependent", "baseline", ",", "we", "use", "a", "state", "-", "and", "-", "action", "-", "dependent", "baseline", "(", "our", "current", "estimate", ")", "and", "add", "the", "correction", "term", "to", "cancel", "the", "bias", ".", "Proposition", "[", "reference", "]", "gives", "our", "analysis", "of", "the", "bias", "of", ",", "with", "a", "proof", "left", "to", "the", "Appendix", ".", "propositionpropbias", "Assume", "and", "that", ".", "Then", ",", "the", "bias", "of", "is", ".", "Thus", "the", "bias", "is", "small", "when", "is", "close", "to", ",", "or", "when", "the", "-", "estimates", "are", "close", "to", "the", "true", "values", ",", "and", "unbiased", "regardless", "of", "the", "estimates", "if", ".", "The", "variance", "is", "low", "when", "is", "small", ",", "therefore", ",", "in", "order", "to", "improve", "the", "bias", "-", "variance", "tradeoff", "we", "recommend", "using", "the", "-", "LOO", "estimate", "with", "defined", "as", ":", "for", "some", "constant", ".", "This", "truncated", "coefficient", "shares", "similarities", "with", "the", "truncated", "IS", "gradient", "estimate", "introduced", "in", "wang2017sample", "(", "which", "we", "call", "TISLR", "for", "truncated", "-", "ISLR", ")", ":", "The", "differences", "are", ":", "(", "i", ")", "we", "truncate", "instead", "of", "truncating", ",", "which", "provides", "an", "additional", "variance", "reduction", "due", "to", "the", "variance", "of", "the", "LR", "(", "since", "this", "LR", "may", "be", "large", "when", "a", "low", "probability", "action", "is", "chosen", ")", ",", "and", "(", "ii", ")", "we", "use", "our", "-", "baseline", "instead", "of", "a", "baseline", ",", "reducing", "further", "the", "variance", "of", "the", "LR", "estimate", ".", "subsection", ":", "Distributional", "Retrace", "In", "off", "-", "policy", "learning", "it", "is", "very", "difficult", "to", "produce", "an", "unbiased", "sample", "of", "when", "following", "another", "policy", ".", "This", "would", "require", "using", "full", "importance", "sampling", "correction", "along", "the", "trajectory", ".", "Instead", ",", "we", "use", "the", "off", "-", "policy", "corrected", "return", "computed", "by", "the", "Retrace", "algorithm", ",", "which", "produces", "a", "(", "biased", ")", "estimate", "of", "but", "whose", "bias", "vanishes", "asymptotically", "munos2016safe", ".", "In", "Reactor", ",", "we", "consider", "predicting", "an", "approximation", "of", "the", "return", "distribution", "function", "from", "any", "state", "-", "action", "pair", "in", "a", "similar", "way", "as", "in", "bellemare2017distributional", ".", "The", "original", "algorithm", "C51", "described", "in", "that", "paper", "considered", "single", "-", "step", "Bellman", "updates", "only", ".", "Here", "we", "need", "to", "extend", "this", "idea", "to", "multi", "-", "step", "updates", "and", "handle", "the", "off", "-", "policy", "correction", "performed", "by", "the", "Retrace", "algorithm", ",", "as", "defined", "in", "eq", ":", "retrace", ".", "Next", ",", "we", "describe", "these", "two", "extensions", ".", "paragraph", ":", "Multi", "-", "step", "distributional", "Bellman", "operator", ":", "First", ",", "we", "extend", "C51", "to", "multi", "-", "step", "Bellman", "backups", ".", "We", "consider", "return", "-", "distributions", "from", "of", "the", "form", "(", "where", "denotes", "a", "Dirac", "in", ")", "which", "are", "supported", "on", "a", "finite", "uniform", "grid", ",", ",", ",", ".", "The", "coefficients", "(", "discrete", "distribution", ")", "corresponds", "to", "the", "probabilities", "assigned", "to", "each", "atom", "of", "the", "grid", ".", "From", "an", "observed", "-", "step", "sequence", ",", "generated", "by", "behavior", "policy", "(", "i.e", ",", "for", ")", ",", "we", "build", "the", "-", "step", "backed", "-", "up", "return", "-", "distribution", "from", ".", "The", "-", "step", "distributional", "Bellman", "target", ",", "whose", "expectation", "is", ",", "is", "given", "by", ":", "Since", "this", "distribution", "is", "supported", "on", "the", "set", "of", "atoms", ",", "which", "is", "not", "necessarily", "aligned", "with", "the", "grid", ",", "we", "do", "a", "projection", "step", "and", "minimize", "the", "KL", "-", "loss", "between", "the", "projected", "target", "and", "the", "current", "estimate", ",", "just", "as", "with", "C51", "except", "with", "a", "different", "target", "distribution", "bellemare2017distributional", ".", "paragraph", ":", "Distributional", "Retrace", ":", "Now", ",", "the", "Retrace", "algorithm", "defined", "in", "eq", ":", "retrace", "involves", "an", "off", "-", "policy", "correction", "which", "is", "not", "handled", "by", "the", "previous", "-", "step", "distributional", "Bellman", "backup", ".", "The", "key", "to", "extending", "this", "distributional", "back", "-", "up", "to", "off", "-", "policy", "learning", "is", "to", "rewrite", "the", "Retrace", "algorithm", "as", "a", "linear", "combination", "of", "-", "step", "Bellman", "backups", ",", "weighted", "by", "some", "coefficients", ".", "Indeed", ",", "notice", "that", "eq", ":", "retrace", "rewrites", "as", "where", ".", "These", "coefficients", "depend", "on", "the", "degree", "of", "off", "-", "policy", "-", "ness", "(", "between", "and", ")", "along", "the", "trajectory", ".", "We", "have", "that", ",", "but", "notice", "some", "coefficients", "may", "be", "negative", ".", "However", ",", "in", "expectation", "(", "over", "the", "behavior", "policy", ")", "they", "are", "non", "-", "negative", ".", "Indeed", ",", "by", "definition", "of", "the", "coefficients", "eq", ":", "trace.cut", ".", "Thus", "in", "expectation", "(", "over", "the", "behavior", "policy", ")", ",", "the", "Retrace", "update", "can", "be", "seen", "as", "a", "convex", "combination", "of", "-", "step", "Bellman", "updates", ".", "Then", ",", "the", "distributional", "Retrace", "algorithm", "can", "be", "defined", "as", "backing", "up", "a", "mixture", "of", "-", "step", "distributions", ".", "More", "precisely", ",", "we", "define", "the", "Retrace", "target", "distribution", "as", ":", "where", "is", "a", "linear", "interpolation", "kernel", ",", "projecting", "onto", "the", "support", ":", "We", "update", "the", "current", "probabilities", "by", "performing", "a", "gradient", "step", "on", "the", "KL", "-", "loss", "Again", ",", "notice", "that", "some", "target", "\u2018", "\u2018", "probabilities", "\u2019", "\u2019", "may", "be", "negative", "for", "some", "sample", "trajectory", ",", "but", "in", "expectation", "they", "will", "be", "non", "-", "negative", ".", "Since", "the", "gradient", "of", "a", "KL", "-", "loss", "is", "linear", "w.r.t", ".", "its", "first", "argument", ",", "our", "update", "rule", "eq", ":", "kl.gradient", "provides", "an", "unbiased", "estimate", "of", "the", "gradient", "of", "the", "KL", "between", "the", "expected", "(", "over", "the", "behavior", "policy", ")", "Retrace", "target", "distribution", "and", "the", "current", "predicted", "distribution", ".", "paragraph", ":", "Remark", ":", "The", "same", "method", "can", "be", "applied", "to", "other", "algorithms", "(", "such", "as", "TB", "(", ")", "precup2000eligibility", "and", "importance", "sampling", "precup01offpolicy", ")", "in", "order", "to", "derive", "distributional", "versions", "of", "other", "off", "-", "policy", "multi", "-", "step", "RL", "algorithms", ".", "subsection", ":", "Prioritized", "sequence", "replay", "Prioritized", "experience", "replay", "has", "been", "shown", "to", "boost", "both", "statistical", "efficiency", "and", "final", "performance", "of", "deep", "RL", "agents", "schaul16prioritized", ".", "However", ",", "as", "originally", "defined", "prioritized", "replay", "does", "not", "handle", "sequences", "of", "transitions", "and", "weights", "all", "unsampled", "transitions", "identically", ".", "In", "this", "section", "we", "present", "an", "alternative", "initialization", "strategy", ",", "called", "lazy", "initialization", ",", "and", "argue", "that", "it", "better", "encodes", "prior", "information", "about", "temporal", "difference", "errors", ".", "We", "then", "briefly", "describe", "our", "computationally", "efficient", "prioritized", "sequence", "sampling", "algorithm", ",", "with", "full", "details", "left", "to", "the", "appendix", ".", "It", "is", "widely", "recognized", "that", "TD", "errors", "tend", "to", "be", "temporally", "correlated", ",", "indeed", "the", "need", "to", "break", "this", "temporal", "correlation", "has", "been", "one", "of", "the", "primary", "justifications", "for", "the", "use", "of", "experience", "replay", "mnih15human", ".", "Our", "proposed", "algorithm", "begins", "with", "this", "fundamental", "assumption", ".", "theorem", ":", ".", "Temporal", "differences", "are", "temporally", "correlated", ",", "with", "correlation", "decaying", "on", "average", "with", "the", "time", "-", "difference", "between", "two", "transitions", ".", "Prioritized", "experience", "replay", "adds", "new", "transitions", "to", "the", "replay", "buffer", "with", "a", "constant", "priority", ",", "but", "given", "the", "above", "assumption", "we", "can", "devise", "a", "better", "method", ".", "Specifically", ",", "we", "propose", "to", "add", "experience", "to", "the", "buffer", "with", "no", "priority", ",", "inserting", "a", "priority", "only", "after", "the", "transition", "has", "been", "sampled", "and", "used", "for", "training", ".", "Also", ",", "instead", "of", "sampling", "transitions", ",", "we", "assign", "priorities", "to", "all", "(", "overlapping", ")", "sequences", "of", "length", ".", "When", "sampling", ",", "sequences", "with", "an", "assigned", "priority", "are", "sampled", "proportionally", "to", "that", "priority", ".", "Sequences", "with", "no", "assigned", "priority", "are", "sampled", "proportionally", "to", "the", "average", "priority", "of", "assigned", "priority", "sequences", "within", "some", "local", "neighbourhood", ".", "Averages", "are", "weighted", "to", "compensate", "for", "sampling", "biases", "(", "i.e.", "more", "samples", "are", "made", "in", "areas", "of", "high", "estimated", "priorities", ",", "and", "in", "the", "absence", "of", "weighting", "this", "would", "lead", "to", "overestimation", "of", "unassigned", "priorities", ")", ".", "The", "lazy", "initialization", "scheme", "starts", "with", "priorities", "corresponding", "to", "the", "sequences", "for", "which", "a", "priority", "was", "already", "assigned", ".", "Then", "it", "extrapolates", "a", "priority", "of", "all", "other", "sequences", "in", "the", "following", "way", ".", "Let", "us", "define", "a", "partition", "of", "the", "states", "ordered", "by", "increasing", "time", "such", "that", "each", "cell", "contains", "exactly", "one", "state", "with", "already", "assigned", "priority", ".", "We", "define", "the", "estimated", "priority", "to", "all", "other", "sequences", "as", ",", "where", "is", "a", "collection", "of", "contiguous", "cells", "containing", "time", ",", "and", "is", "the", "length", "of", "the", "cell", "containing", ".", "For", "already", "defined", "priorities", "denote", ".", "Cell", "sizes", "work", "as", "estimates", "of", "inverse", "local", "density", "and", "are", "used", "as", "importance", "weights", "for", "priority", "estimation", ".", "For", "the", "algorithm", "to", "be", "unbiased", ",", "partition", "must", "not", "be", "a", "function", "of", "the", "assigned", "priorities", ".", "So", "far", "we", "have", "defined", "a", "class", "of", "algorithms", "all", "free", "to", "choose", "the", "partition", "and", "the", "collection", "of", "cells", ",", "as", "long", "that", "they", "satisfy", "the", "above", "constraints", ".", "Figure", "[", "reference", "]", "in", "the", "Appendix", "illustrates", "the", "above", "description", ".", "Now", ",", "with", "probability", "we", "sample", "uniformly", "at", "random", ",", "and", "with", "probability", "we", "sample", "proportionally", "to", ".", "We", "implemented", "an", "algorithm", "satisfying", "the", "above", "constraints", "and", "called", "it", "Contextual", "Priority", "Tree", "(", "CPT", ")", ".", "It", "is", "based", "on", "AVL", "trees", "velskii1976avl", "and", "can", "execute", "sampling", ",", "insertion", ",", "deletion", "and", "density", "evaluation", "in", "time", ".", "We", "describe", "CPT", "in", "detail", "in", "the", "Appendix", "in", "Section", "[", "reference", "]", ".", "We", "treated", "prioritization", "as", "purely", "a", "variance", "reduction", "technique", ".", "Importance", "-", "sampling", "weights", "were", "evaluated", "as", "in", "prioritized", "experience", "replay", ",", "with", "fixed", "in", "(", "[", "reference", "]", ")", ".", "We", "used", "simple", "gradient", "magnitude", "estimates", "as", "priorities", ",", "corresponding", "to", "a", "mean", "absolute", "TD", "error", "along", "a", "sequence", "for", "Retrace", ",", "as", "defined", "in", "(", "[", "reference", "]", ")", "for", "the", "classical", "RL", "case", ",", "and", "total", "variation", "in", "the", "distributional", "Retrace", "case", ".", "subsection", ":", "Agent", "architecture", "In", "order", "to", "improve", "CPU", "utilization", "we", "decoupled", "acting", "from", "learning", ".", "This", "is", "an", "important", "aspect", "of", "our", "architecture", ":", "an", "acting", "thread", "receives", "observations", ",", "submits", "actions", "to", "the", "environment", ",", "and", "stores", "transitions", "in", "memory", ",", "while", "a", "learning", "thread", "re", "-", "samples", "sequences", "of", "experiences", "from", "memory", "and", "trains", "on", "them", "(", "Figure", "[", "reference", "]", ",", "left", ")", ".", "We", "typically", "execute", "4", "-", "6", "acting", "steps", "per", "each", "learning", "step", ".", "We", "sample", "sequences", "of", "length", "in", "batches", "of", "4", ".", "A", "moving", "network", "is", "unrolled", "over", "frames", "1", "-", "32", "while", "the", "target", "network", "is", "unrolled", "over", "frames", "2", "-", "33", ".", "We", "allow", "the", "agent", "to", "be", "distributed", "over", "multiple", "machines", "each", "containing", "action", "-", "learner", "pairs", ".", "Each", "worker", "downloads", "the", "newest", "network", "parameters", "before", "each", "learning", "step", "and", "sends", "delta", "-", "updates", "at", "the", "end", "of", "it", ".", "Both", "the", "network", "and", "target", "network", "are", "stored", "on", "a", "shared", "parameter", "server", "while", "each", "machine", "contains", "its", "own", "local", "replay", "memory", ".", "Training", "is", "done", "by", "downloading", "a", "shared", "network", ",", "evaluating", "local", "gradients", "and", "sending", "them", "to", "be", "applied", "on", "the", "shared", "network", ".", "While", "the", "agent", "can", "also", "be", "trained", "on", "a", "single", "machine", ",", "in", "this", "work", "we", "present", "results", "of", "training", "obtained", "with", "either", "10", "or", "20", "actor", "-", "learner", "workers", "and", "one", "parameter", "server", ".", "In", "Figure", "[", "reference", "]", "(", "right", ")", "we", "compare", "resources", "and", "runtimes", "of", "Reactor", "with", "related", "algorithms", ".", "subsubsection", ":", "Network", "architecture", "In", "some", "domains", ",", "such", "as", "Atari", ",", "it", "is", "useful", "to", "base", "decisions", "on", "a", "short", "history", "of", "past", "observations", ".", "The", "two", "techniques", "generally", "used", "to", "achieve", "this", "are", "frame", "stacking", "and", "recurrent", "network", "architectures", ".", "We", "chose", "the", "latter", "over", "the", "former", "for", "reasons", "of", "implementation", "simplicity", "and", "computational", "efficiency", ".", "As", "the", "Retrace", "algorithm", "requires", "evaluating", "action", "-", "values", "over", "contiguous", "sequences", "of", "trajectories", ",", "using", "a", "recurrent", "architecture", "allowed", "each", "frame", "to", "be", "processed", "by", "the", "convolutional", "network", "only", "once", ",", "as", "opposed", "to", "times", "times", "if", "frame", "concatenations", "were", "used", ".", "The", "Reactor", "architecture", "uses", "a", "recurrent", "neural", "network", "which", "takes", "an", "observation", "as", "input", "and", "produces", "two", "outputs", ":", "categorical", "action", "-", "value", "distributions", "(", "here", "is", "a", "bin", "identifier", ")", ",", "and", "policy", "probabilities", ".", "We", "use", "an", "architecture", "inspired", "by", "the", "duelling", "network", "architecture", "wang2015dueling", ".", "We", "split", "action", "-", "value", "-", "distribution", "logits", "into", "state", "-", "value", "logits", "and", "advantage", "logits", ",", "which", "in", "turn", "are", "connected", "to", "the", "same", "LSTM", "network", "hochreiter1997long", ".", "Final", "action", "-", "value", "logits", "are", "produced", "by", "summing", "state", "-", "and", "action", "-", "specific", "logits", ",", "as", "in", "wang2015dueling", ".", "Finally", ",", "a", "softmax", "layer", "on", "top", "for", "each", "action", "produces", "the", "distributions", "over", "discounted", "future", "returns", ".", "The", "policy", "head", "uses", "a", "softmax", "layer", "mixed", "with", "a", "fixed", "uniform", "distribution", "over", "actions", ",", "where", "this", "mixing", "ratio", "is", "a", "hyperparameter", "[", "Section", "5.1.3", "]", "wiering1999explorations", ".", "Policy", "and", "Q", "-", "networks", "have", "separate", "LSTMs", ".", "Both", "LSTMs", "are", "connected", "to", "a", "shared", "linear", "layer", "which", "is", "connected", "to", "a", "shared", "convolutional", "neural", "network", "krizhevsky2012imagenet", ".", "The", "precise", "network", "specification", "is", "given", "in", "Table", "[", "reference", "]", "in", "the", "Appendix", ".", "Gradients", "coming", "from", "the", "policy", "LSTM", "are", "blocked", "and", "only", "gradients", "originating", "from", "the", "Q", "-", "network", "LSTM", "are", "allowed", "to", "back", "-", "propagate", "into", "the", "convolutional", "neural", "network", ".", "We", "block", "gradients", "from", "the", "policy", "head", "for", "increased", "stability", ",", "as", "this", "avoids", "positive", "feedback", "loops", "between", "and", "caused", "by", "shared", "representations", ".", "We", "used", "the", "Adam", "optimiser", "kingma2014adam", ",", "with", "a", "learning", "rate", "of", "and", "zero", "momentum", "because", "asynchronous", "updates", "induce", "implicit", "momentum", "mitliagkas2016asynchrony", ".", "Further", "discussion", "of", "hyperparameters", "and", "their", "optimization", "can", "be", "found", "in", "Appendix", "[", "reference", "]", ".", "section", ":", "Experimental", "Results", "We", "trained", "and", "evaluated", "Reactor", "on", "57", "Atari", "games", "bellemare2013arcade", ".", "Figure", "[", "reference", "]", "compares", "the", "performance", "of", "Reactor", "with", "different", "versions", "of", "Reactor", "each", "time", "leaving", "one", "of", "the", "algorithmic", "improvements", "out", ".", "We", "can", "see", "that", "each", "of", "the", "algorithmic", "improvements", "(", "Distributional", "retrace", ",", "beta", "-", "LOO", "and", "prioritized", "replay", ")", "contributed", "to", "the", "final", "results", ".", "While", "prioritization", "was", "arguably", "the", "most", "important", "component", ",", "Beta", "-", "LOO", "clearly", "outperformed", "TISLR", "algorithm", ".", "Although", "distributional", "and", "non", "-", "distributional", "versions", "performed", "similarly", "in", "terms", "of", "median", "human", "normalized", "scores", ",", "distributional", "version", "of", "the", "algorithm", "generalized", "better", "when", "tested", "with", "random", "human", "starts", "(", "Table", "[", "reference", "]", ")", ".", "subsection", ":", "Comparing", "to", "prior", "work", "We", "evaluated", "Reactor", "with", "target", "update", "frequency", ",", "and", "-", "LOO", "with", "on", "57", "Atari", "games", "trained", "on", "10", "machines", "in", "parallel", ".", "We", "averaged", "scores", "over", "200", "episodes", "using", "30", "random", "human", "starts", "and", "noop", "starts", "(", "Tables", "[", "reference", "]", "and", "[", "reference", "]", "in", "the", "Appendix", ")", ".", "We", "calculated", "mean", "and", "median", "human", "normalised", "scores", "across", "all", "games", ".", "We", "also", "ranked", "all", "algorithms", "(", "including", "random", "and", "human", "scores", ")", "for", "each", "game", "and", "evaluated", "mean", "rank", "of", "each", "algorithm", "across", "all", "57", "Atari", "games", ".", "We", "also", "evaluated", "mean", "Rank", "and", "Elo", "scores", "for", "each", "algorithm", "for", "both", "human", "and", "noop", "start", "settings", ".", "Please", "refer", "to", "Section", "[", "reference", "]", "in", "the", "Appendix", "for", "more", "details", ".", "Tables", "[", "reference", "]", "&", "[", "reference", "]", "compare", "versions", "of", "our", "algorithm", ",", "with", "several", "other", "state", "-", "of", "-", "art", "algorithms", "across", "57", "Atari", "games", "for", "a", "fixed", "random", "seed", "across", "all", "games", "bellemare2013arcade", ".", "We", "compare", "Reactor", "against", "are", ":", "DQN", "mnih15human", ",", "Double", "DQN", "van2016deep", ",", "DQN", "with", "prioritised", "experience", "replay", "schaul2015prioritized", ",", "dueling", "architecture", "and", "prioritised", "dueling", "wang2015dueling", ",", "ACER", "wang2017sample", ",", "A3C", "mnih2016asynchronous", ",", "and", "Rainbow", "rainbow", ".", "Each", "algorithm", "was", "exposed", "to", "200", "million", "frames", "of", "experience", ",", "or", "500", "million", "frames", "when", "followed", "by", ",", "and", "the", "same", "pre", "-", "processing", "pipeline", "including", "4", "action", "repeats", "was", "used", "as", "in", "the", "original", "DQN", "paper", "mnih15human", ".", "In", "Table", "[", "reference", "]", ",", "we", "see", "that", "Reactor", "exceeds", "the", "performance", "of", "all", "algorithms", "across", "all", "metrics", ",", "despite", "requiring", "under", "two", "days", "of", "training", ".", "With", "500", "million", "frames", "and", "four", "days", "training", "we", "see", "Reactor", "\u2019s", "performance", "continue", "to", "improve", "significantly", ".", "The", "difference", "in", "time", "-", "efficiency", "is", "especially", "apparent", "when", "comparing", "Reactor", "and", "Rainbow", "(", "see", "Figure", "[", "reference", "]", ",", "right", ")", ".", "Additionally", ",", "unlike", "Rainbow", ",", "Reactor", "does", "not", "use", "Noisy", "Networks", "fortunato2017noisy", ",", "which", "was", "reported", "to", "have", "contributed", "to", "the", "performance", "gains", ".", "When", "evaluating", "under", "the", "no", "-", "op", "starts", "regime", "(", "Table", "[", "reference", "]", ")", ",", "Reactor", "out", "performs", "all", "methods", "except", "for", "Rainbow", ".", "This", "suggests", "that", "Rainbow", "is", "more", "sample", "-", "efficient", "when", "training", "and", "evaluation", "regimes", "match", "exactly", ",", "but", "may", "be", "overfitting", "to", "particular", "trajectories", "due", "to", "the", "significant", "drop", "in", "performance", "when", "evaluated", "on", "the", "random", "human", "starts", ".", "Regarding", "ACER", ",", "another", "Retrace", "-", "based", "actor", "-", "critic", "architecture", ",", "both", "classical", "and", "distributional", "versions", "of", "Reactor", "(", "Figure", "[", "reference", "]", ")", "exceeded", "the", "best", "reported", "median", "human", "normalized", "score", "of", "1.9", "with", "noop", "starts", "achieved", "in", "500", "million", "steps", ".", "section", ":", "Conclusion", "In", "this", "work", "we", "presented", "a", "new", "off", "-", "policy", "agent", "based", "on", "Retrace", "actor", "-", "critic", "architecture", "and", "show", "that", "it", "achieves", "similar", "performance", "as", "the", "current", "state", "-", "of", "-", "the", "-", "art", "while", "giving", "significant", "real", "-", "time", "performance", "gains", ".", "We", "demonstrate", "the", "benefits", "of", "each", "of", "the", "suggested", "algorithmic", "improvements", ",", "including", "Distributional", "Retrace", ",", "beta", "-", "LOO", "policy", "gradient", "and", "contextual", "priority", "tree", ".", "bibliography", ":", "References", "section", ":", "Appendix", "*", "proof", ":", "Proof", ".", "The", "bias", "of", "is", "\u220e", "subsection", ":", "Hyperparameter", "optimization", "As", "we", "believe", "that", "algorithms", "should", "be", "robust", "with", "respect", "to", "the", "choice", "of", "hyperparameters", ",", "we", "spent", "little", "effort", "on", "parameter", "optimization", ".", "In", "total", ",", "we", "explored", "three", "distinct", "values", "of", "learning", "rates", "and", "two", "values", "of", "ADAM", "momentum", "(", "the", "default", "and", "zero", ")", "and", "two", "values", "of", "on", "a", "subset", "of", "7", "Atari", "games", "without", "prioritization", "using", "non", "-", "distributional", "version", "of", "Reactor", ".", "We", "later", "used", "those", "values", "for", "all", "experiments", ".", "We", "did", "not", "optimize", "for", "batch", "sizes", "and", "sequence", "length", "or", "any", "prioritization", "hyperparamters", ".", "subsection", ":", "Rank", "and", "Elo", "evaluation", "Commonly", "used", "mean", "and", "median", "human", "normalized", "scores", "have", "several", "disadvantages", ".", "A", "mean", "human", "normalized", "score", "implicitly", "puts", "more", "weight", "on", "games", "that", "computers", "are", "good", "and", "humans", "are", "bad", "at", ".", "Comparing", "algorithm", "by", "a", "mean", "human", "normalized", "score", "across", "57", "Atari", "games", "is", "almost", "equivalent", "to", "comparing", "algorithms", "on", "a", "small", "subset", "of", "games", "close", "to", "the", "median", "and", "thus", "dominating", "the", "signal", ".", "Typically", "a", "set", "of", "ten", "most", "score", "-", "generous", "games", ",", "namely", "Assault", ",", "Asterix", ",", "Breakout", ",", "Demon", "Attack", ",", "Double", "Dunk", ",", "Gopher", ",", "Pheonix", ",", "Stargunner", ",", "Up\u2019n", "Down", "and", "Video", "Pinball", "can", "explain", "more", "than", "half", "of", "inter", "-", "algorithm", "variance", ".", "A", "median", "human", "normalized", "score", "has", "the", "opposite", "disadvantage", "by", "effectively", "discarding", "very", "easy", "and", "very", "hard", "games", "from", "the", "comparison", ".", "As", "typical", "median", "human", "normalized", "scores", "are", "within", "the", "range", "of", "1", "-", "2.5", ",", "an", "algorithm", "which", "scores", "zero", "points", "on", "Montezuma", "\u2019s", "Revenge", "is", "evaluated", "equal", "to", "the", "one", "which", "scores", "2500", "points", ",", "as", "both", "performance", "levels", "are", "still", "below", "human", "performance", "making", "incremental", "improvements", "on", "hard", "games", "not", "being", "reflected", "in", "the", "overall", "evaluation", ".", "In", "order", "to", "address", "both", "problem", ",", "we", "also", "evaluated", "mean", "rank", "and", "Elo", "metrics", "for", "inter", "-", "algorithm", "comparison", ".", "Those", "metrics", "implicitly", "assign", "the", "same", "weight", "to", "each", "game", ",", "and", "as", "a", "result", "is", "more", "sensitive", "of", "relative", "performance", "on", "very", "hard", "and", "easy", "games", ":", "swapping", "scores", "of", "two", "algorithms", "on", "any", "game", "would", "result", "in", "the", "change", "of", "both", "mean", "rank", "and", "Elo", "metrics", ".", "We", "calculated", "separate", "mean", "rank", "and", "Elo", "scores", "for", "each", "algorithm", "using", "results", "of", "test", "evaluations", "with", "30", "random", "noop", "-", "starts", "and", "30", "random", "human", "starts", "(", "Tables", "[", "reference", "]", "and", "[", "reference", "]", ")", ".", "All", "algorithms", "were", "ranked", "across", "each", "game", "separately", ",", "and", "a", "mean", "rank", "was", "evaluated", "across", "57", "Atari", "games", ".", "For", "Elo", "score", "evaluation", "algorithm", ",", "was", "considered", "to", "win", "over", "algorithm", "if", "it", "obtained", "more", "scores", "on", "a", "given", "Atari", ".", "We", "produced", "an", "empirical", "win", "-", "probability", "matrix", "by", "summing", "wins", "across", "all", "games", "and", "used", "this", "matrix", "to", "evaluate", "Elo", "scores", ".", "A", "ranking", "difference", "of", "400", "corresponds", "to", "the", "odds", "of", "winning", "of", "10:1", "under", "the", "Gaussian", "assumption", ".", "subsection", ":", "Contextual", "priority", "tree", "Contextual", "priority", "tree", "is", "one", "possible", "implementation", "of", "lazy", "prioritization", "(", "Figure", "[", "reference", "]", ")", ".", "All", "sequence", "keys", "are", "put", "into", "a", "balanced", "binary", "search", "tree", "which", "maintains", "a", "temporal", "order", ".", "An", "AVL", "tree", "(", ")", "was", "chosen", "due", "to", "the", "ease", "of", "implementation", "and", "because", "it", "is", "on", "average", "more", "evenly", "balanced", "than", "a", "Red", "-", "Black", "Tree", ".", "Each", "tree", "node", "has", "up", "to", "two", "children", "(", "left", "and", "right", ")", "and", "contains", "currently", "stored", "key", "and", "a", "priority", "of", "the", "key", "which", "is", "either", "set", "or", "is", "unknown", ".", "Some", "trees", "may", "only", "have", "a", "single", "child", "subtree", "while", "some", "may", "have", "none", ".", "In", "addition", "to", "this", "information", ",", "we", "were", "tracking", "other", "summary", "statistics", "at", "each", "node", "which", "was", "re", "-", "evaluated", "after", "each", "tree", "rotation", ".", "The", "summary", "statistics", "was", "evaluated", "by", "consuming", "previously", "evaluated", "summary", "statistics", "of", "both", "children", "and", "a", "priority", "of", "the", "key", "stored", "within", "the", "current", "node", ".", "In", "particular", ",", "we", "were", "tracking", "a", "total", "number", "of", "nodes", "within", "each", "subtree", "and", "mean", "-", "priority", "estimates", "updated", "according", "to", "rules", "shown", "in", "Figure", "[", "reference", "]", ".", "The", "total", "number", "of", "nodes", "within", "each", "subtree", "was", "always", "known", "(", "in", "Figure", "[", "reference", "]", ")", ",", "while", "mean", "priority", "estimates", "per", "key", "(", "in", "Figure", "[", "reference", "]", ")", "could", "either", "be", "known", "or", "unknown", ".", "If", "a", "mean", "priority", "of", "either", "one", "child", "subtree", "or", "a", "key", "stored", "within", "the", "current", "node", "is", "unknown", "then", "it", "can", "be", "estimated", "to", "by", "exploiting", "information", "coming", "from", "another", "sibling", "subtree", "or", "a", "priority", "stored", "within", "the", "parent", "node", ".", "Sampling", "was", "done", "by", "traversing", "the", "tree", "from", "the", "root", "node", "up", "while", "sampling", "either", "one", "of", "the", "children", "subtrees", "or", "the", "currently", "held", "key", "proportionally", "to", "the", "total", "estimated", "priority", "masses", "contained", "within", ".", "The", "rules", "used", "to", "evaluate", "proportions", "are", "shown", "in", "orange", "in", "Figure", "[", "reference", "]", ".", "Similarly", ",", "probabilities", "of", "arbitrary", "keys", "can", "be", "queried", "by", "traversing", "the", "tree", "from", "the", "root", "node", "towards", "the", "child", "node", "of", "an", "interest", "while", "maintaining", "a", "product", "of", "probabilities", "at", "each", "branching", "point", ".", "Insertion", ",", "deletion", ",", "sampling", "and", "probability", "query", "operations", "can", "be", "done", "in", "O", "(", "ln", "(", "n", ")", ")", "time", ".", "The", "suggested", "algorithm", "has", "the", "desired", "property", "that", "it", "becomes", "a", "simple", "proportional", "sampling", "algorithm", "once", "all", "the", "priorities", "are", "known", ".", "While", "some", "key", "priorities", "are", "unknown", ",", "they", "are", "estimated", "by", "using", "nearby", "known", "key", "priorities", "(", "Figure", "[", "reference", "]", ")", ".", "Each", "time", "when", "a", "new", "sequence", "key", "is", "added", "to", "the", "tree", ",", "it", "was", "set", "to", "have", "an", "unknown", "priority", ".", "Any", "priority", "was", "assigned", "only", "after", "the", "key", "got", "first", "sampled", "and", "the", "corresponding", "sequence", "got", "passed", "through", "the", "learner", ".", "When", "a", "priority", "of", "a", "key", "is", "set", "or", "updated", ",", "the", "key", "node", "is", "deliberately", "removed", "from", "and", "placed", "back", "to", "the", "tree", "in", "order", "to", "become", "a", "leaf", "-", "node", ".", "This", "helped", "to", "set", "priorities", "of", "nodes", "in", "the", "immediate", "vicinity", "more", "accurately", "by", "using", "the", "freshest", "information", "available", ".", "subsection", ":", "Network", "architecture", "The", "value", "of", "is", "the", "minimum", "probability", "of", "choosing", "a", "random", "action", "and", "it", "is", "hard", "-", "coded", "into", "the", "policy", "network", ".", "Figure", "[", "reference", "]", "shows", "the", "overall", "network", "topology", "while", "Table", "[", "reference", "]", "specifies", "network", "layer", "sizes", ".", "subsection", ":", "Comparisons", "with", "Rainbow", "In", "this", "section", "we", "compare", "Reactor", "with", "the", "recently", "published", "Rainbow", "agent", "rainbow", ".", "While", "ACER", "is", "the", "most", "closely", "related", "algorithmically", ",", "Rainbow", "is", "most", "closely", "related", "in", "terms", "of", "performance", "and", "thus", "a", "deeper", "understanding", "of", "the", "trade", "-", "offs", "between", "Rainbow", "and", "Reactor", "may", "benefit", "interested", "readers", ".", "There", "are", "many", "architectural", "and", "algorithmic", "differences", "between", "Rainbow", "and", "Reactor", ".", "We", "will", "therefore", "begin", "by", "highlighting", "where", "they", "agree", ".", "Both", "use", "a", "categorical", "action", "-", "value", "distribution", "critic", "bellemare2017distributional", ",", "factored", "into", "state", "and", "state", "-", "action", "logits", "wang2015dueling", ",", "Both", "use", "prioritized", "replay", ",", "and", "finally", ",", "both", "perform", "-", "step", "Bellman", "updates", ".", "Despite", "these", "similarities", ",", "Reactor", "and", "Rainbow", "are", "fundamentally", "different", "algorithms", "and", "are", "based", "upon", "different", "lines", "of", "research", ".", "While", "Rainbow", "uses", "Q", "-", "Learning", "and", "is", "based", "upon", "DQN", "mnih15human", ",", "Reactor", "is", "an", "actor", "-", "critic", "algorithm", "most", "closely", "based", "upon", "A3C", "mnih2016asynchronous", ".", "Each", "inherits", "some", "design", "choices", "from", "their", "predecessors", ",", "and", "we", "have", "not", "performed", "an", "extensive", "ablation", "comparing", "these", "various", "differences", ".", "Instead", ",", "we", "will", "discuss", "four", "of", "the", "differences", "we", "believe", "are", "important", "but", "less", "obvious", ".", "First", ",", "the", "network", "structures", "are", "substantially", "different", ".", "Rainbow", "uses", "noisy", "linear", "layers", "and", "ReLU", "activations", "throughout", "the", "network", ",", "whereas", "Reactor", "uses", "standard", "linear", "layers", "and", "concatenated", "ReLU", "activations", "throughout", ".", "To", "overcome", "partial", "observability", ",", "Rainbow", ",", "inheriting", "this", "choice", "from", "DQN", ",", "uses", "frame", "stacking", ".", "On", "the", "other", "hand", ",", "Reactor", ",", "inheriting", "its", "choice", "from", "A3C", ",", "uses", "LSTMs", "after", "the", "convolutional", "layers", "of", "the", "network", ".", "It", "is", "also", "difficult", "to", "directly", "compare", "the", "number", "of", "parameters", "in", "each", "network", "because", "the", "use", "of", "noisy", "linear", "layers", "doubles", "the", "number", "of", "parameters", ",", "although", "half", "of", "these", "are", "used", "to", "control", "noise", ",", "while", "the", "LSTM", "units", "in", "Reactor", "require", "more", "parameters", "than", "a", "corresponding", "linear", "layer", "would", ".", "Second", ",", "both", "algorithms", "perform", "-", "step", "updates", ",", "however", ",", "the", "Rainbow", "-", "step", "update", "does", "not", "use", "any", "form", "of", "off", "-", "policy", "correction", ".", "Because", "of", "this", ",", "Rainbow", "is", "restricted", "to", "using", "only", "small", "values", "of", "(", "e.g.", ")", "because", "larger", "values", "would", "make", "sequences", "more", "off", "-", "policy", "and", "hurt", "performance", ".", "By", "comparison", ",", "Reactor", "uses", "our", "proposed", "distributional", "Retrace", "algorithm", "for", "off", "-", "policy", "correction", "of", "-", "step", "updates", ".", "This", "allows", "the", "use", "of", "larger", "values", "of", "(", "e.g.", ")", "without", "loss", "of", "performance", ".", "Third", ",", "while", "both", "agents", "use", "prioritized", "replay", "buffers", "schaul16prioritized", ",", "they", "each", "store", "different", "information", "and", "prioritize", "using", "different", "algorithms", ".", "Rainbow", "stores", "a", "tuple", "containing", "the", "state", ",", "action", ",", "sum", "of", "discounted", "rewards", ",", "product", "of", "discount", "factors", ",", "and", "next", "-", "state", "steps", "away", ".", "Tuples", "are", "prioritized", "based", "upon", "the", "last", "observed", "TD", "error", ",", "and", "inserted", "into", "replay", "with", "a", "maximum", "priority", ".", "Reactor", "stores", "length", "sequences", "of", "tuples", "and", "also", "prioritizes", "based", "upon", "the", "observed", "TD", "error", ".", "However", ",", "when", "inserted", "into", "the", "buffer", "the", "priority", "is", "instead", "inferred", "based", "upon", "the", "known", "priorities", "of", "neighboring", "sequences", ".", "This", "priority", "inference", "was", "made", "efficient", "using", "the", "previously", "introduced", "contextual", "priority", "tree", ",", "and", "anecdotally", "we", "have", "seen", "it", "improve", "performance", "over", "a", "simple", "maximum", "priority", "approach", ".", "Finally", ",", "the", "two", "algorithms", "have", "different", "approaches", "to", "exploration", ".", "Rainbow", ",", "unlike", "DQN", ",", "does", "not", "use", "-", "greedy", "exploration", ",", "but", "instead", "replaces", "all", "linear", "layers", "with", "noisy", "linear", "layers", "which", "induce", "randomness", "throughout", "the", "network", ".", "This", "method", ",", "called", "Noisy", "Networks", "fortunato2017noisy", ",", "creates", "an", "adaptive", "exploration", "integrated", "into", "the", "agent", "\u2019s", "network", ".", "Reactor", "does", "not", "use", "noisy", "networks", ",", "but", "instead", "uses", "the", "same", "entropy", "cost", "method", "used", "by", "A3C", "and", "many", "others", "mnih2016asynchronous", ",", "which", "penalizes", "deterministic", "policies", "thus", "encouraging", "indifference", "between", "similarly", "valued", "actions", ".", "Because", "Rainbow", "can", "essentially", "learn", "not", "to", "explore", ",", "it", "may", "learn", "to", "become", "entirely", "greedy", "in", "the", "early", "parts", "of", "the", "episode", ",", "while", "still", "exploring", "in", "states", "not", "as", "frequently", "seen", ".", "In", "some", "sense", ",", "this", "is", "precisely", "what", "we", "want", "from", "an", "exploration", "technique", ",", "but", "it", "may", "also", "lead", "to", "highly", "deterministic", "trajectories", "in", "the", "early", "part", "of", "the", "episode", "and", "an", "increase", "in", "overfitting", "to", "those", "trajectories", ".", "We", "hypothesize", "that", "this", "may", "be", "the", "explanation", "for", "the", "significant", "difference", "in", "Rainbow", "\u2019s", "performance", "between", "evaluation", "under", "no", "-", "op", "and", "random", "human", "starts", ",", "and", "why", "Reactor", "does", "not", "show", "such", "a", "large", "difference", ".", "subsection", ":", "Atari", "results"]}