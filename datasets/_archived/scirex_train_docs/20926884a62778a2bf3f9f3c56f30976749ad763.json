{"coref": {"Average_Treatment_Effect_Error": [[1480, 1483], [1947, 1950], [5387, 5390], [5716, 5719], [6177, 6179]], "BART": [[74, 77], [1532, 1536], [4465, 4467], [4822, 4824], [5015, 5019], [5020, 5021]], "Balancing_Linear_Regression": [[74, 77], [2165, 2170], [2184, 2187], [2197, 2200]], "Balancing_Neural_Network": [[5051, 5054], [5055, 5056]], "Causal_Forest": [[1353, 1355], [1457, 1459], [5032, 5034], [6089, 6091], [6363, 6365]], "Causal_Inference": [[11, 13], [566, 568], [671, 675], [878, 880], [1390, 1392], [1409, 1411], [1467, 1470], [1679, 1682], [1791, 1794], [29, 31], [1937, 1939], [2140, 2142], [4640, 4642], [5536, 5538]], "Counterfactual_Regression": [[3940, 3941], [3943, 3945], [3986, 3987], [4456, 4458], [4459, 4460], [4556, 4557], [4558, 4560], [4816, 4817], [4837, 4838], [5901, 5902], [6092, 6093], [11236, 11237], [11286, 11287]], "Counterfactual_Regression___WASS": [], "IDHP": [[4703, 4708], [4886, 4887], [5252, 5253], [5263, 5268], [5269, 5271], [5397, 5398], [5910, 5911], [5965, 5966], [6011, 6012], [11221, 11222], [5448, 5449]], "OLS_with_separate_regressors_for_each_treatment": [[5070, 5071], [4975, 4976], [4980, 4981], [4988, 4989]], "OLS_with_separate_regressors_for_each_treatment_": [[1081, 1082], [1651, 1652], [2072, 2073], [2412, 2413], [3480, 3481], [3569, 3570], [3604, 3605], [4593, 4594], [6283, 6284], [7647, 7648], [8475, 8476], [5886, 5887]], "OLS_with_treatments_as_a_feature": [], "Random_Forest": [[5023, 5025]], "TARNet": [[1274, 1279], [1492, 1497], [4470, 4475], [4476, 4477], [4491, 4494], [4822, 4824], [4825, 4826], [5906, 5907]], "WASS": [[1116, 1118], [5902, 5903], [9693, 9695], [10753, 10755], [10764, 10766]], "k-NN": []}, "coref_non_salient": {"0": [[1683, 1685], [1689, 1692]], "1": [[1144, 1146], [1157, 1159], [3082, 3084], [4609, 4611], [7440, 7442]], "10": [[8895, 8899], [9282, 9287], [9587, 9591]], "100": [[11088, 11089]], "101": [[11146, 11149]], "102": [[1739, 1742], [5008, 5011]], "103": [[43, 45]], "104": [[1827, 1833]], "105": [[1590, 1592], [1910, 1912]], "106": [[21, 22]], "107": [[9605, 9608]], "108": [[9622, 9625]], "109": [[6209, 6212]], "11": [[2444, 2450], [3810, 3813]], "110": [[9610, 9613]], "111": [[1413, 1415]], "112": [[1137, 1140]], "113": [[6366, 6367]], "114": [[6242, 6246]], "115": [[4966, 4969]], "116": [[1474, 1476]], "117": [[1221, 1225]], "118": [[2064, 2066]], "119": [[6225, 6227]], "12": [[118, 121], [1604, 1607], [1995, 1998], [8343, 8345], [8382, 8384], [2431, 2434]], "120": [[10882, 10884]], "121": [[2316, 2322]], "122": [[482, 484]], "123": [[2059, 2062]], "124": [[10065, 10067]], "125": [[17, 18]], "126": [[4215, 4217]], "127": [[4849, 4856]], "128": [[5781, 5785]], "129": [[8377, 8380]], "13": [[5060, 5062], [5618, 5621]], "130": [[1334, 1337]], "131": [[5001, 5004]], "132": [[3974, 3976]], "133": [[4634, 4636]], "134": [[5347, 5349]], "135": [[4842, 4847]], "136": [[5179, 5185]], "137": [[10220, 10223]], "138": [[10795, 10801]], "139": [[2191, 2194]], "14": [[1149, 1153], [7771, 7773]], "140": [[1169, 1175]], "141": [[1814, 1818]], "142": [[1386, 1388]], "143": [[682, 688]], "144": [[8756, 8759]], "145": [[19, 20]], "146": [[1229, 1231]], "147": [[4434, 4435]], "148": [[201, 208]], "149": [[1394, 1397]], "15": [[1077, 1080], [2408, 2411], [3078, 3081], [6617, 6621], [7328, 7331]], "150": [[2094, 2097]], "151": [[783, 786]], "152": [[2053, 2056]], "153": [[2042, 2044]], "154": [[1293, 1295]], "155": [[5044, 5047]], "156": [[4584, 4586]], "157": [[1128, 1132]], "158": [[1897, 1901]], "159": [[624, 629]], "16": [[3902, 3904], [2298, 2299], [11078, 11079]], "160": [[1193, 1195]], "161": [[3740, 3743]], "162": [[648, 653]], "163": [[1882, 1885]], "164": [[2453, 2456]], "165": [[11001, 11003]], "166": [[50, 54]], "167": [[1675, 1677]], "168": [[11095, 11100]], "17": [[2179, 2181], [2208, 2211], [11303, 11305]], "18": [[154, 155], [3639, 3640], [3900, 3901], [1288, 1289], [2296, 2297], [3607, 3608], [3698, 3699], [7400, 7401], [8739, 8740], [9556, 9557], [9630, 9631]], "19": [[1014, 1019], [1406, 1408], [6196, 6201]], "2": [[6013, 6017], [6077, 6081]], "20": [[531, 534], [3663, 3666], [4648, 4651]], "21": [[3588, 3590], [4016, 4018]], "22": [[1647, 1649], [11274, 11276]], "23": [[1526, 1528], [1548, 1550]], "24": [[4770, 4774], [4786, 4788], [6150, 6152]], "25": [[96, 100], [618, 622], [2337, 2339]], "26": [[473, 476], [5257, 5260]], "27": [[4789, 4790], [6145, 6146]], "28": [[5771, 5773], [5775, 5777], [6083, 6085]], "29": [[6445, 6447], [6913, 6915], [6983, 6985], [7153, 7155], [8093, 8095], [8849, 8851], [2732, 2734], [3301, 3303], [6652, 6654], [6927, 6929], [8874, 8876], [9984, 9986], [10546, 10548]], "3": [[3618, 3624], [9790, 9794]], "30": [[4503, 4504], [2363, 2364], [2738, 2739], [2987, 2988], [3006, 3007], [3314, 3315], [3981, 3982], [4114, 4115], [4316, 4317], [4863, 4864], [4883, 4884], [4909, 4910], [7163, 7164], [7533, 7534], [7873, 7874], [7881, 7882], [8154, 8155], [8510, 8511], [9329, 9330], [9490, 9491], [10108, 10109], [10583, 10584]], "31": [[160, 161], [3641, 3643], [11124, 11125], [1286, 1287], [3632, 3633], [3722, 3723]], "32": [[10819, 10823], [10995, 10999]], "33": [[7980, 7983], [8430, 8433]], "34": [[4632, 4633], [4893, 4894]], "35": [[10218, 10219]], "36": [[10905, 10911]], "37": [[8486, 8495]], "38": [[4034, 4037], [4130, 4133]], "39": [[5452, 5458]], "4": [[1644, 1645], [10788, 10790]], "40": [[3806, 3808], [6560, 6561], [1217, 1218], [2381, 2382], [2586, 2587], [2748, 2749], [2755, 2756], [2764, 2765], [2772, 2773], [2781, 2782], [2799, 2800], [2807, 2808], [3030, 3031], [3239, 3240], [3348, 3349], [3402, 3403], [3416, 3417], [3431, 3432], [3452, 3453], [3456, 3457], [3703, 3704], [4519, 4520], [4575, 4576], [4618, 4619], [4925, 4926], [4935, 4936], [4947, 4948], [5373, 5374], [6507, 6508], [6526, 6527], [6686, 6687], [6695, 6696], [6709, 6710], [6938, 6939], [7134, 7135], [7140, 7141], [7143, 7144], [7172, 7173], [7192, 7193], [7247, 7248], [7597, 7598], [7914, 7915], [7966, 7967], [7977, 7978], [8025, 8026], [8158, 8159], [8221, 8222], [8402, 8403], [8567, 8568], [8636, 8637], [8689, 8690], [8701, 8702], [8705, 8706], [8708, 8709], [8713, 8714], [9162, 9163], [9311, 9312], [9394, 9395], [9473, 9474], [9507, 9508], [9847, 9848], [10628, 10629], [10639, 10640], [10668, 10669], [10702, 10703], [11158, 11159]], "41": [[1123, 1125], [2348, 2350], [6592, 6594], [6721, 6723]], "42": [[388, 390], [4194, 4195], [4779, 4780], [5544, 5546]], "43": [[11226, 11228]], "44": [[1799, 1803], [1902, 1906], [2239, 2242], [3252, 3256], [6183, 6187], [7892, 7895]], "45": [[1559, 1562], [1632, 1634], [1749, 1751]], "46": [[6648, 6650]], "47": [[3581, 3583], [4386, 4388], [4590, 4592], [8471, 8473]], "48": [[6248, 6254]], "49": [[11136, 11138], [11141, 11143], [11240, 11242]], "5": [[350, 351], [470, 472], [1319, 1321]], "50": [[1824, 1826], [3644, 3646]], "51": [[3625, 3626], [3730, 3731], [3733, 3734], [9786, 9787]], "52": [[6, 8], [1787, 1790], [1841, 1844]], "53": [[2013, 2015], [2045, 2047], [2086, 2088]], "54": [[10949, 10953]], "55": [[55, 56], [1569, 1570], [1636, 1637], [2020, 2021], [2335, 2336], [5192, 5193], [104, 105], [846, 847], [947, 948], [2035, 2036], [2106, 2107], [2977, 2978], [3947, 3948], [5121, 5122], [5170, 5171], [5751, 5752], [5762, 5763], [5794, 5795], [6128, 6129], [6191, 6192], [6812, 6813]], "56": [[9999, 10002]], "57": [[4505, 4507], [4578, 4580], [10918, 10920]], "58": [[3020, 3024]], "59": [[11210, 11218]], "6": [[6051, 6053], [10769, 10771]], "60": [[4995, 4996], [6133, 6134]], "61": [[11005, 11008]], "62": [[6059, 6061]], "63": [[5067, 5069], [6054, 6055]], "64": [[3017, 3019], [7904, 7906]], "65": [[6033, 6035], [11245, 11247]], "66": [[9035, 9037], [9217, 9219]], "67": [[7513, 7518], [8134, 8139]], "68": [[1573, 1574], [4835, 4836], [1524, 1525], [6121, 6122]], "69": [[8478, 8483], [8515, 8520]], "7": [[8884, 8886], [10824, 10826]], "70": [[2134, 2138]], "71": [[9807, 9810]], "72": [[6045, 6046]], "73": [[5961, 5963]], "74": [[2570, 2572]], "75": [[4522, 4524]], "76": [[5076, 5077]], "77": [[7471, 7473]], "78": [[10761, 10762]], "79": [[4436, 4439]], "8": [[5221, 5225], [5236, 5242]], "80": [[5012, 5013]], "81": [[11233, 11235]], "82": [[1778, 1780], [3932, 3934], [4832, 4834]], "83": [[5064, 5066], [6037, 6039]], "84": [[3653, 3656]], "85": [[156, 159], [1110, 1113], [11074, 11077], [7402, 7405]], "86": [[140, 143], [4561, 4564]], "87": [[6307, 6309]], "88": [[4327, 4328]], "89": [[36, 38]], "9": [[1859, 1861], [4628, 4631], [6232, 6234], [10983, 10985], [11062, 11064]], "90": [[5048, 5049]], "91": [[1663, 1669]], "92": [[1107, 1108], [2292, 2293], [3818, 3819], [4391, 4392], [4547, 4548]], "93": [[4324, 4326]], "94": [[46, 49]], "95": [[6142, 6143]], "96": [[9961, 9965]], "97": [[1538, 1542]], "98": [[3966, 3969]], "99": [[2260, 2262]]}, "doc_id": "20926884a62778a2bf3f9f3c56f30976749ad763", "method_subrelations": {"BART": [[[0, 4], "BART"]], "Balancing_Linear_Regression": [[[0, 27], "Balancing_Linear_Regression"]], "Balancing_Neural_Network": [[[0, 24], "Balancing_Neural_Network"]], "Causal_Forest": [[[0, 13], "Causal_Forest"]], "Counterfactual_Regression___WASS": [[[0, 25], "Counterfactual_Regression"], [[28, 32], "WASS"]], "OLS_with_separate_regressors_for_each_treatment_": [[[0, 47], "OLS_with_separate_regressors_for_each_treatment"]], "OLS_with_treatments_as_a_feature": [[[0, 32], "OLS_with_treatments_as_a_feature"]], "Random_Forest": [[[0, 13], "Random_Forest"]], "TARNet": [[[0, 6], "TARNet"]], "k-NN": [[[0, 4], "k-NN"]]}, "n_ary_relations": [{"Material": "IDHP", "Method": "BART", "Metric": "Average_Treatment_Effect_Error", "Task": "Causal_Inference", "score": "0.34"}, {"Material": "IDHP", "Method": "Balancing_Linear_Regression", "Metric": "Average_Treatment_Effect_Error", "Task": "Causal_Inference", "score": "0.93"}, {"Material": "IDHP", "Method": "Balancing_Neural_Network", "Metric": "Average_Treatment_Effect_Error", "Task": "Causal_Inference", "score": "0.42"}, {"Material": "IDHP", "Method": "Causal_Forest", "Metric": "Average_Treatment_Effect_Error", "Task": "Causal_Inference", "score": "0.40"}, {"Material": "IDHP", "Method": "Counterfactual_Regression___WASS", "Metric": "Average_Treatment_Effect_Error", "Task": "Causal_Inference", "score": "0.27"}, {"Material": "IDHP", "Method": "OLS_with_separate_regressors_for_each_treatment_", "Metric": "Average_Treatment_Effect_Error", "Task": "Causal_Inference", "score": "0.31"}, {"Material": "IDHP", "Method": "OLS_with_treatments_as_a_feature", "Metric": "Average_Treatment_Effect_Error", "Task": "Causal_Inference", "score": "0.94"}, {"Material": "IDHP", "Method": "Random_Forest", "Metric": "Average_Treatment_Effect_Error", "Task": "Causal_Inference", "score": "0.96"}, {"Material": "IDHP", "Method": "TARNet", "Metric": "Average_Treatment_Effect_Error", "Task": "Causal_Inference", "score": "0.28"}, {"Material": "IDHP", "Method": "k-NN", "Metric": "Average_Treatment_Effect_Error", "Task": "Causal_Inference", "score": "0.79"}], "ner": [[6, 8, "Method"], [11, 13, "Task"], [17, 18, "Task"], [19, 20, "Task"], [21, 22, "Task"], [36, 38, "Task"], [43, 45, "Method"], [46, 49, "Method"], [50, 54, "Task"], [55, 56, "Task"], [74, 77, "Method"], [96, 100, "Metric"], [118, 121, "Metric"], [140, 143, "Method"], [154, 155, "Metric"], [156, 159, "Metric"], [160, 161, "Metric"], [201, 208, "Task"], [350, 351, "Task"], [388, 390, "Task"], [470, 472, "Task"], [473, 476, "Task"], [482, 484, "Method"], [531, 534, "Task"], [566, 568, "Task"], [618, 622, "Metric"], [624, 629, "Task"], [648, 653, "Method"], [671, 675, "Task"], [682, 688, "Method"], [783, 786, "Task"], [878, 880, "Task"], [1014, 1019, "Task"], [1077, 1080, "Metric"], [1081, 1082, "Metric"], [1107, 1108, "Metric"], [1110, 1113, "Metric"], [1116, 1118, "Metric"], [1123, 1125, "Metric"], [1128, 1132, "Metric"], [1137, 1140, "Metric"], [1144, 1146, "Metric"], [1149, 1153, "Task"], [1157, 1159, "Metric"], [1169, 1175, "Task"], [1193, 1195, "Method"], [1221, 1225, "Metric"], [1229, 1231, "Metric"], [1274, 1279, "Method"], [1293, 1295, "Method"], [1319, 1321, "Task"], [1334, 1337, "Task"], [1353, 1355, "Method"], [1386, 1388, "Metric"], [1390, 1392, "Task"], [1394, 1397, "Task"], [1406, 1408, "Task"], [1409, 1411, "Task"], [1413, 1415, "Task"], [1457, 1459, "Method"], [1467, 1470, "Task"], [1474, 1476, "Task"], [1480, 1483, "Metric"], [1492, 1497, "Method"], [1526, 1528, "Task"], [1532, 1536, "Method"], [1538, 1542, "Method"], [1548, 1550, "Task"], [1559, 1562, "Method"], [1569, 1570, "Task"], [1573, 1574, "Task"], [1590, 1592, "Task"], [1604, 1607, "Metric"], [1632, 1634, "Method"], [1636, 1637, "Task"], [1644, 1645, "Method"], [1647, 1649, "Method"], [1651, 1652, "Metric"], [1663, 1669, "Metric"], [1675, 1677, "Method"], [1679, 1682, "Task"], [1683, 1685, "Method"], [1689, 1692, "Method"], [1739, 1742, "Method"], [1749, 1751, "Method"], [1778, 1780, "Task"], [1787, 1790, "Method"], [1791, 1794, "Task"], [1799, 1803, "Task"], [1814, 1818, "Method"], [1824, 1826, "Method"], [1827, 1833, "Metric"], [1841, 1844, "Method"], [1859, 1861, "Method"], [1882, 1885, "Task"], [1897, 1901, "Metric"], [1902, 1906, "Task"], [1910, 1912, "Task"], [1947, 1950, "Metric"], [1995, 1998, "Metric"], [2013, 2015, "Task"], [2020, 2021, "Task"], [2042, 2044, "Method"], [2045, 2047, "Task"], [2053, 2056, "Metric"], [2059, 2062, "Metric"], [2064, 2066, "Method"], [2072, 2073, "Metric"], [2086, 2088, "Task"], [2094, 2097, "Method"], [2134, 2138, "Task"], [2165, 2170, "Method"], [2179, 2181, "Metric"], [2184, 2187, "Method"], [2191, 2194, "Method"], [2197, 2200, "Method"], [2208, 2211, "Metric"], [2239, 2242, "Task"], [2260, 2262, "Metric"], [2292, 2293, "Metric"], [2316, 2322, "Metric"], [2335, 2336, "Task"], [2337, 2339, "Metric"], [2348, 2350, "Metric"], [2408, 2411, "Metric"], [2412, 2413, "Metric"], [2444, 2450, "Metric"], [2453, 2456, "Method"], [2570, 2572, "Method"], [3017, 3019, "Metric"], [3020, 3024, "Task"], [3078, 3081, "Metric"], [3082, 3084, "Metric"], [3252, 3256, "Task"], [3480, 3481, "Metric"], [3569, 3570, "Metric"], [3581, 3583, "Method"], [3588, 3590, "Method"], [3604, 3605, "Metric"], [3618, 3624, "Method"], [3625, 3626, "Method"], [3639, 3640, "Metric"], [3641, 3643, "Metric"], [3644, 3646, "Method"], [3653, 3656, "Task"], [3663, 3666, "Task"], [3740, 3743, "Metric"], [3806, 3808, "Metric"], [3810, 3813, "Metric"], [3818, 3819, "Metric"], [3900, 3901, "Metric"], [3902, 3904, "Metric"], [3932, 3934, "Task"], [3940, 3941, "Method"], [3943, 3945, "Method"], [3966, 3969, "Method"], [3974, 3976, "Method"], [3986, 3987, "Method"], [4016, 4018, "Method"], [4034, 4037, "Method"], [4130, 4133, "Method"], [4194, 4195, "Task"], [4215, 4217, "Method"], [4324, 4326, "Metric"], [4327, 4328, "Metric"], [4386, 4388, "Method"], [4391, 4392, "Metric"], [4434, 4435, "Method"], [4436, 4439, "Method"], [4456, 4458, "Method"], [4459, 4460, "Method"], [4465, 4467, "Method"], [4470, 4475, "Method"], [4476, 4477, "Method"], [4491, 4494, "Method"], [4503, 4504, "Method"], [4505, 4507, "Method"], [4522, 4524, "Method"], [4556, 4557, "Method"], [4558, 4560, "Method"], [4561, 4564, "Method"], [4578, 4580, "Method"], [4584, 4586, "Method"], [4590, 4592, "Method"], [4593, 4594, "Metric"], [4609, 4611, "Metric"], [4628, 4631, "Method"], [4632, 4633, "Method"], [4634, 4636, "Metric"], [4648, 4651, "Task"], [4703, 4708, "Material"], [4770, 4774, "Method"], [4779, 4780, "Task"], [4786, 4788, "Method"], [4789, 4790, "Task"], [4816, 4817, "Method"], [4822, 4824, "Method"], [4825, 4826, "Method"], [4832, 4834, "Task"], [4835, 4836, "Task"], [4837, 4838, "Method"], [4842, 4847, "Method"], [4849, 4856, "Method"], [4886, 4887, "Material"], [4893, 4894, "Method"], [4966, 4969, "Method"], [4995, 4996, "Method"], [5001, 5004, "Method"], [5008, 5011, "Method"], [5012, 5013, "Method"], [5015, 5019, "Method"], [5020, 5021, "Method"], [5023, 5025, "Method"], [5032, 5034, "Method"], [5044, 5047, "Method"], [5048, 5049, "Method"], [5051, 5054, "Method"], [5055, 5056, "Method"], [5060, 5062, "Task"], [5064, 5066, "Method"], [5067, 5069, "Method"], [5070, 5071, "Method"], [5076, 5077, "Task"], [5179, 5185, "Task"], [5192, 5193, "Task"], [5221, 5225, "Metric"], [5236, 5242, "Metric"], [5252, 5253, "Material"], [5257, 5260, "Task"], [5263, 5268, "Material"], [5269, 5271, "Material"], [5347, 5349, "Method"], [5387, 5390, "Metric"], [5397, 5398, "Material"], [5452, 5458, "Method"], [5544, 5546, "Task"], [5618, 5621, "Task"], [5716, 5719, "Metric"], [5771, 5773, "Metric"], [5775, 5777, "Metric"], [5781, 5785, "Metric"], [5901, 5902, "Method"], [5902, 5903, "Method"], [5906, 5907, "Method"], [5910, 5911, "Material"], [5961, 5963, "Metric"], [5965, 5966, "Material"], [6011, 6012, "Material"], [6013, 6017, "Method"], [6033, 6035, "Material"], [6037, 6039, "Method"], [6045, 6046, "Task"], [6051, 6053, "Method"], [6054, 6055, "Method"], [6059, 6061, "Method"], [6077, 6081, "Method"], [6083, 6085, "Metric"], [6089, 6091, "Method"], [6092, 6093, "Method"], [6133, 6134, "Method"], [6142, 6143, "Task"], [6145, 6146, "Task"], [6150, 6152, "Method"], [6177, 6179, "Metric"], [6183, 6187, "Task"], [6196, 6201, "Task"], [6209, 6212, "Task"], [6225, 6227, "Method"], [6232, 6234, "Method"], [6242, 6246, "Method"], [6248, 6254, "Task"], [6283, 6284, "Metric"], [6307, 6309, "Method"], [6363, 6365, "Method"], [6366, 6367, "Method"], [6445, 6447, "Method"], [6560, 6561, "Metric"], [6592, 6594, "Metric"], [6617, 6621, "Metric"], [6648, 6650, "Task"], [6721, 6723, "Metric"], [6913, 6915, "Method"], [6983, 6985, "Method"], [7153, 7155, "Method"], [7328, 7331, "Metric"], [7440, 7442, "Metric"], [7471, 7473, "Method"], [7513, 7518, "Method"], [7647, 7648, "Metric"], [7771, 7773, "Task"], [7892, 7895, "Task"], [7904, 7906, "Metric"], [7980, 7983, "Metric"], [8093, 8095, "Method"], [8134, 8139, "Method"], [8343, 8345, "Metric"], [8377, 8380, "Metric"], [8382, 8384, "Metric"], [8430, 8433, "Metric"], [8471, 8473, "Method"], [8475, 8476, "Metric"], [8478, 8483, "Method"], [8486, 8495, "Method"], [8515, 8520, "Method"], [8756, 8759, "Metric"], [8849, 8851, "Method"], [8884, 8886, "Method"], [8895, 8899, "Method"], [9035, 9037, "Method"], [9217, 9219, "Method"], [9282, 9287, "Method"], [9587, 9591, "Method"], [9605, 9608, "Metric"], [9610, 9613, "Task"], [9622, 9625, "Method"], [9693, 9695, "Metric"], [9790, 9794, "Method"], [9807, 9810, "Method"], [9961, 9965, "Method"], [9999, 10002, "Method"], [10065, 10067, "Method"], [10218, 10219, "Method"], [10220, 10223, "Method"], [10753, 10755, "Metric"], [10761, 10762, "Task"], [10764, 10766, "Metric"], [10769, 10771, "Method"], [10788, 10790, "Method"], [10795, 10801, "Method"], [10819, 10823, "Method"], [10824, 10826, "Method"], [10882, 10884, "Task"], [10905, 10911, "Method"], [10918, 10920, "Method"], [10949, 10953, "Method"], [10983, 10985, "Method"], [10995, 10999, "Method"], [11001, 11003, "Method"], [11005, 11008, "Method"], [11062, 11064, "Method"], [11074, 11077, "Metric"], [11088, 11089, "Method"], [11095, 11100, "Metric"], [11124, 11125, "Metric"], [11136, 11138, "Method"], [11141, 11143, "Method"], [11146, 11149, "Method"], [11210, 11218, "Method"], [11221, 11222, "Material"], [11226, 11228, "Metric"], [11233, 11235, "Task"], [11236, 11237, "Method"], [11240, 11242, "Method"], [11245, 11247, "Material"], [11274, 11276, "Method"], [11303, 11305, "Metric"], [29, 31, "Task"], [104, 105, "Task"], [846, 847, "Task"], [947, 948, "Task"], [1217, 1218, "Metric"], [1286, 1287, "Metric"], [1288, 1289, "Metric"], [1524, 1525, "Task"], [1937, 1939, "Task"], [2035, 2036, "Task"], [2106, 2107, "Task"], [2140, 2142, "Task"], [2296, 2297, "Metric"], [2298, 2299, "Metric"], [2363, 2364, "Method"], [2381, 2382, "Metric"], [2431, 2434, "Metric"], [2586, 2587, "Metric"], [2732, 2734, "Method"], [2738, 2739, "Method"], [2748, 2749, "Metric"], [2755, 2756, "Metric"], [2764, 2765, "Metric"], [2772, 2773, "Metric"], [2781, 2782, "Metric"], [2799, 2800, "Metric"], [2807, 2808, "Metric"], [2977, 2978, "Task"], [2987, 2988, "Method"], [3006, 3007, "Method"], [3030, 3031, "Metric"], [3239, 3240, "Metric"], [3301, 3303, "Method"], [3314, 3315, "Method"], [3348, 3349, "Metric"], [3402, 3403, "Metric"], [3416, 3417, "Metric"], [3431, 3432, "Metric"], [3452, 3453, "Metric"], [3456, 3457, "Metric"], [3607, 3608, "Metric"], [3632, 3633, "Metric"], [3698, 3699, "Metric"], [3703, 3704, "Metric"], [3722, 3723, "Metric"], [3730, 3731, "Method"], [3733, 3734, "Method"], [3947, 3948, "Task"], [3981, 3982, "Method"], [4114, 4115, "Method"], [4316, 4317, "Method"], [4519, 4520, "Metric"], [4547, 4548, "Metric"], [4575, 4576, "Metric"], [4618, 4619, "Metric"], [4640, 4642, "Task"], [4863, 4864, "Method"], [4883, 4884, "Method"], [4909, 4910, "Method"], [4925, 4926, "Metric"], [4935, 4936, "Metric"], [4947, 4948, "Metric"], [4975, 4976, "Method"], [4980, 4981, "Method"], [4988, 4989, "Method"], [5121, 5122, "Task"], [5170, 5171, "Task"], [5373, 5374, "Metric"], [5448, 5449, "Material"], [5536, 5538, "Task"], [5751, 5752, "Task"], [5762, 5763, "Task"], [5794, 5795, "Task"], [5886, 5887, "Metric"], [6121, 6122, "Task"], [6128, 6129, "Task"], [6191, 6192, "Task"], [6507, 6508, "Metric"], [6526, 6527, "Metric"], [6652, 6654, "Method"], [6686, 6687, "Metric"], [6695, 6696, "Metric"], [6709, 6710, "Metric"], [6812, 6813, "Task"], [6927, 6929, "Method"], [6938, 6939, "Metric"], [7134, 7135, "Metric"], [7140, 7141, "Metric"], [7143, 7144, "Metric"], [7163, 7164, "Method"], [7172, 7173, "Metric"], [7192, 7193, "Metric"], [7247, 7248, "Metric"], [7400, 7401, "Metric"], [7402, 7405, "Metric"], [7533, 7534, "Method"], [7597, 7598, "Metric"], [7873, 7874, "Method"], [7881, 7882, "Method"], [7914, 7915, "Metric"], [7966, 7967, "Metric"], [7977, 7978, "Metric"], [8025, 8026, "Metric"], [8154, 8155, "Method"], [8158, 8159, "Metric"], [8221, 8222, "Metric"], [8402, 8403, "Metric"], [8510, 8511, "Method"], [8567, 8568, "Metric"], [8636, 8637, "Metric"], [8689, 8690, "Metric"], [8701, 8702, "Metric"], [8705, 8706, "Metric"], [8708, 8709, "Metric"], [8713, 8714, "Metric"], [8739, 8740, "Metric"], [8874, 8876, "Method"], [9162, 9163, "Metric"], [9311, 9312, "Metric"], [9329, 9330, "Method"], [9394, 9395, "Metric"], [9473, 9474, "Metric"], [9490, 9491, "Method"], [9507, 9508, "Metric"], [9556, 9557, "Metric"], [9630, 9631, "Metric"], [9786, 9787, "Method"], [9847, 9848, "Metric"], [9984, 9986, "Method"], [10108, 10109, "Method"], [10546, 10548, "Method"], [10583, 10584, "Method"], [10628, 10629, "Metric"], [10639, 10640, "Metric"], [10668, 10669, "Metric"], [10702, 10703, "Metric"], [11078, 11079, "Metric"], [11158, 11159, "Metric"], [11286, 11287, "Method"]], "sections": [[0, 198], [198, 1398], [1398, 2332], [2332, 2457], [2457, 2566], [2566, 2646], [2646, 2802], [2802, 2949], [2949, 2970], [2970, 2997], [2997, 3013], [3013, 3194], [3194, 3228], [3228, 3288], [3288, 3390], [3390, 3928], [3928, 4636], [4636, 5247], [5247, 5518], [5518, 5870], [5870, 6165], [6165, 6319], [6319, 6378], [6378, 6381], [6381, 6384], [6384, 6790], [6790, 6817], [6817, 6876], [6876, 6923], [6923, 6978], [6978, 7083], [7083, 7095], [7095, 7145], [7145, 7186], [7186, 7229], [7229, 7274], [7274, 7300], [7300, 7437], [7437, 7456], [7456, 7576], [7576, 7852], [7852, 7888], [7888, 7900], [7900, 7919], [7919, 7984], [7984, 8027], [8027, 8080], [8080, 8223], [8223, 8512], [8512, 8584], [8584, 8632], [8632, 8760], [8760, 8842], [8842, 8887], [8887, 8948], [8948, 9122], [9122, 9211], [9211, 9250], [9250, 9336], [9336, 9382], [9382, 9401], [9401, 9626], [9626, 9681], [9681, 9777], [9777, 9858], [9858, 9900], [9900, 9934], [9934, 9975], [9975, 10098], [10098, 10209], [10209, 10502], [10502, 10641], [10641, 10690], [10690, 10709], [10709, 10734], [10734, 10749], [10749, 11070], [11070, 11130], [11130, 11134], [11134, 11272], [11272, 11301], [11301, 11333]], "sentences": [[0, 23], [23, 39], [39, 69], [69, 88], [88, 138], [138, 164], [164, 186], [186, 198], [198, 201], [201, 216], [216, 258], [258, 275], [275, 306], [306, 347], [347, 402], [402, 416], [416, 446], [446, 468], [468, 499], [499, 522], [522, 559], [559, 600], [600, 639], [639, 676], [676, 692], [692, 721], [721, 760], [760, 812], [812, 817], [817, 825], [825, 849], [849, 874], [874, 896], [896, 922], [922, 939], [939, 959], [959, 988], [988, 1008], [1008, 1023], [1023, 1064], [1064, 1101], [1101, 1119], [1119, 1147], [1147, 1176], [1176, 1242], [1242, 1265], [1265, 1306], [1306, 1316], [1316, 1353], [1353, 1370], [1370, 1373], [1373, 1376], [1376, 1398], [1398, 1402], [1402, 1431], [1431, 1455], [1455, 1485], [1485, 1503], [1503, 1515], [1515, 1543], [1543, 1557], [1557, 1580], [1580, 1612], [1612, 1638], [1638, 1670], [1670, 1686], [1686, 1713], [1713, 1739], [1739, 1759], [1759, 1786], [1786, 1810], [1810, 1834], [1834, 1859], [1859, 1886], [1886, 1931], [1931, 1970], [1970, 2005], [2005, 2016], [2016, 2034], [2034, 2050], [2050, 2077], [2077, 2112], [2112, 2144], [2144, 2175], [2175, 2205], [2205, 2224], [2224, 2252], [2252, 2266], [2266, 2301], [2301, 2332], [2332, 2339], [2339, 2369], [2369, 2424], [2424, 2457], [2457, 2461], [2461, 2470], [2470, 2483], [2483, 2492], [2492, 2497], [2497, 2503], [2503, 2521], [2521, 2541], [2541, 2559], [2559, 2566], [2566, 2569], [2569, 2585], [2585, 2625], [2625, 2646], [2646, 2649], [2649, 2651], [2651, 2729], [2729, 2745], [2745, 2751], [2751, 2776], [2776, 2802], [2802, 2805], [2805, 2847], [2847, 2904], [2904, 2905], [2905, 2949], [2949, 2952], [2952, 2970], [2970, 2973], [2973, 2989], [2989, 2997], [2997, 3000], [3000, 3013], [3013, 3016], [3016, 3024], [3024, 3035], [3035, 3041], [3041, 3059], [3059, 3070], [3070, 3095], [3095, 3131], [3131, 3154], [3154, 3194], [3194, 3197], [3197, 3199], [3199, 3208], [3208, 3225], [3225, 3228], [3228, 3231], [3231, 3257], [3257, 3264], [3264, 3273], [3273, 3281], [3281, 3288], [3288, 3291], [3291, 3316], [3316, 3326], [3326, 3375], [3375, 3390], [3390, 3393], [3393, 3429], [3429, 3433], [3433, 3458], [3458, 3473], [3473, 3482], [3482, 3493], [3493, 3507], [3507, 3530], [3530, 3553], [3553, 3575], [3575, 3591], [3591, 3612], [3612, 3637], [3637, 3657], [3657, 3670], [3670, 3696], [3696, 3720], [3720, 3744], [3744, 3764], [3764, 3784], [3784, 3817], [3817, 3829], [3829, 3861], [3861, 3873], [3873, 3888], [3888, 3918], [3918, 3928], [3928, 3934], [3934, 3956], [3956, 3986], [3986, 4041], [4041, 4061], [4061, 4075], [4075, 4086], [4086, 4091], [4091, 4106], [4106, 4120], [4120, 4150], [4150, 4166], [4166, 4179], [4179, 4196], [4196, 4234], [4234, 4261], [4261, 4289], [4289, 4307], [4307, 4338], [4338, 4355], [4355, 4375], [4375, 4389], [4389, 4414], [4414, 4429], [4429, 4443], [4443, 4479], [4479, 4516], [4516, 4535], [4535, 4553], [4553, 4555], [4555, 4558], [4558, 4564], [4564, 4595], [4595, 4611], [4611, 4620], [4620, 4636], [4636, 4639], [4639, 4669], [4669, 4679], [4679, 4710], [4710, 4726], [4726, 4751], [4751, 4775], [4775, 4791], [4791, 4812], [4812, 4837], [4837, 4865], [4865, 4888], [4888, 4895], [4895, 4905], [4905, 4918], [4918, 4937], [4937, 4961], [4961, 4993], [4993, 4995], [4995, 5028], [5028, 5037], [5037, 5059], [5059, 5072], [5072, 5100], [5100, 5109], [5109, 5141], [5141, 5158], [5158, 5175], [5175, 5200], [5200, 5221], [5221, 5247], [5247, 5253], [5253, 5294], [5294, 5311], [5311, 5334], [5334, 5350], [5350, 5363], [5363, 5377], [5377, 5391], [5391, 5409], [5409, 5430], [5430, 5451], [5451, 5469], [5469, 5497], [5497, 5504], [5504, 5518], [5518, 5526], [5526, 5557], [5557, 5579], [5579, 5598], [5598, 5615], [5615, 5639], [5639, 5664], [5664, 5680], [5680, 5698], [5698, 5730], [5730, 5735], [5735, 5753], [5753, 5774], [5774, 5797], [5797, 5823], [5823, 5840], [5840, 5870], [5870, 5873], [5873, 5917], [5917, 5951], [5951, 5967], [5967, 6009], [6009, 6031], [6031, 6047], [6047, 6071], [6071, 6094], [6094, 6110], [6110, 6131], [6131, 6133], [6133, 6165], [6165, 6168], [6168, 6188], [6188, 6216], [6216, 6239], [6239, 6274], [6274, 6295], [6295, 6319], [6319, 6322], [6322, 6335], [6335, 6366], [6366, 6378], [6378, 6381], [6381, 6384], [6384, 6393], [6393, 6410], [6410, 6429], [6429, 6430], [6430, 6443], [6443, 6643], [6643, 6647], [6647, 6651], [6651, 6658], [6658, 6668], [6668, 6693], [6693, 6703], [6703, 6720], [6720, 6733], [6733, 6747], [6747, 6761], [6761, 6775], [6775, 6781], [6781, 6790], [6790, 6793], [6793, 6817], [6817, 6820], [6820, 6838], [6838, 6848], [6848, 6876], [6876, 6879], [6879, 6910], [6910, 6916], [6916, 6923], [6923, 6926], [6926, 6937], [6937, 6978], [6978, 6981], [6981, 7009], [7009, 7070], [7070, 7083], [7083, 7086], [7086, 7095], [7095, 7099], [7099, 7111], [7111, 7124], [7124, 7130], [7130, 7145], [7145, 7148], [7148, 7156], [7156, 7170], [7170, 7186], [7186, 7189], [7189, 7229], [7229, 7232], [7232, 7257], [7257, 7267], [7267, 7274], [7274, 7277], [7277, 7300], [7300, 7303], [7303, 7315], [7315, 7357], [7357, 7393], [7393, 7402], [7402, 7409], [7409, 7437], [7437, 7442], [7442, 7456], [7456, 7466], [7466, 7478], [7478, 7492], [7492, 7500], [7500, 7519], [7519, 7535], [7535, 7563], [7563, 7576], [7576, 7580], [7580, 7605], [7605, 7626], [7626, 7639], [7639, 7649], [7649, 7650], [7650, 7667], [7667, 7688], [7688, 7716], [7716, 7735], [7735, 7756], [7756, 7767], [7767, 7782], [7782, 7800], [7800, 7815], [7815, 7852], [7852, 7855], [7855, 7870], [7870, 7888], [7888, 7891], [7891, 7900], [7900, 7903], [7903, 7919], [7919, 7922], [7922, 7939], [7939, 7950], [7950, 7963], [7963, 7968], [7968, 7984], [7984, 7987], [7987, 8027], [8027, 8031], [8031, 8039], [8039, 8046], [8046, 8079], [8079, 8080], [8080, 8083], [8083, 8100], [8100, 8113], [8113, 8121], [8121, 8140], [8140, 8156], [8156, 8170], [8170, 8223], [8223, 8227], [8227, 8235], [8235, 8247], [8247, 8291], [8291, 8297], [8297, 8313], [8313, 8320], [8320, 8353], [8353, 8385], [8385, 8405], [8405, 8434], [8434, 8453], [8453, 8496], [8496, 8512], [8512, 8520], [8520, 8532], [8532, 8549], [8549, 8571], [8571, 8584], [8584, 8587], [8587, 8632], [8632, 8635], [8635, 8638], [8638, 8664], [8664, 8685], [8685, 8715], [8715, 8748], [8748, 8760], [8760, 8763], [8763, 8835], [8835, 8842], [8842, 8845], [8845, 8868], [8868, 8887], [8887, 8890], [8890, 8907], [8907, 8948], [8948, 8952], [8952, 8971], [8971, 8991], [8991, 9002], [9002, 9028], [9028, 9058], [9058, 9065], [9065, 9094], [9094, 9121], [9121, 9122], [9122, 9125], [9125, 9178], [9178, 9211], [9211, 9215], [9215, 9249], [9249, 9250], [9250, 9253], [9253, 9271], [9271, 9288], [9288, 9303], [9303, 9322], [9322, 9333], [9333, 9334], [9334, 9336], [9336, 9340], [9340, 9349], [9349, 9363], [9363, 9381], [9381, 9382], [9382, 9385], [9385, 9401], [9401, 9405], [9405, 9425], [9425, 9436], [9436, 9465], [9465, 9482], [9482, 9494], [9494, 9520], [9520, 9526], [9526, 9547], [9547, 9567], [9567, 9583], [9583, 9609], [9609, 9626], [9626, 9629], [9629, 9643], [9643, 9654], [9654, 9661], [9661, 9666], [9666, 9679], [9679, 9681], [9681, 9685], [9685, 9696], [9696, 9715], [9715, 9719], [9719, 9740], [9740, 9749], [9749, 9755], [9755, 9763], [9763, 9776], [9776, 9777], [9777, 9787], [9787, 9800], [9800, 9816], [9816, 9829], [9829, 9837], [9837, 9858], [9858, 9861], [9861, 9869], [9869, 9896], [9896, 9900], [9900, 9903], [9903, 9923], [9923, 9934], [9934, 9937], [9937, 9959], [9959, 9971], [9971, 9975], [9975, 9978], [9978, 9994], [9994, 10027], [10027, 10048], [10048, 10074], [10074, 10098], [10098, 10101], [10101, 10140], [10140, 10167], [10167, 10183], [10183, 10209], [10209, 10213], [10213, 10247], [10247, 10254], [10254, 10265], [10265, 10285], [10285, 10293], [10293, 10328], [10328, 10343], [10343, 10351], [10351, 10367], [10367, 10378], [10378, 10395], [10395, 10409], [10409, 10424], [10424, 10467], [10467, 10501], [10501, 10502], [10502, 10505], [10505, 10523], [10523, 10560], [10560, 10576], [10576, 10614], [10614, 10630], [10630, 10641], [10641, 10645], [10645, 10654], [10654, 10671], [10671, 10689], [10689, 10690], [10690, 10693], [10693, 10709], [10709, 10713], [10713, 10733], [10733, 10734], [10734, 10738], [10738, 10749], [10749, 10755], [10755, 10782], [10782, 10809], [10809, 10831], [10831, 10841], [10841, 10861], [10861, 10878], [10878, 10900], [10900, 10903], [10903, 10911], [10911, 10916], [10916, 10935], [10935, 10946], [10946, 10959], [10959, 10986], [10986, 11043], [11043, 11070], [11070, 11077], [11077, 11094], [11094, 11109], [11109, 11130], [11130, 11134], [11134, 11138], [11138, 11174], [11174, 11204], [11204, 11220], [11220, 11243], [11243, 11258], [11258, 11272], [11272, 11276], [11276, 11289], [11289, 11301], [11301, 11309], [11309, 11333]], "words": ["There", "is", "intense", "interest", "in", "applying", "machine", "learning", "to", "problems", "of", "causal", "inference", "in", "fields", "such", "as", "healthcare", ",", "economics", "and", "education", ".", "In", "particular", ",", "individual", "-", "level", "causal", "inference", "has", "important", "applications", "such", "as", "precision", "medicine", ".", "We", "give", "a", "new", "theoretical", "analysis", "and", "family", "of", "algorithms", "for", "predicting", "individual", "treatment", "effect", "(", "ITE", ")", "from", "observational", "data", ",", "under", "the", "assumption", "known", "as", "strong", "ignorability", ".", "The", "algorithms", "learn", "a", "\u201c", "balanced", "\u201d", "representation", "such", "that", "the", "induced", "treated", "and", "control", "distributions", "look", "similar", ".", "We", "give", "a", "novel", ",", "simple", "and", "intuitive", "generalization", "-", "error", "bound", "showing", "that", "the", "expected", "ITE", "estimation", "error", "of", "a", "representation", "is", "bounded", "by", "a", "sum", "of", "the", "standard", "generalization", "-", "error", "of", "that", "representation", "and", "the", "distance", "between", "the", "treated", "and", "control", "distributions", "induced", "by", "the", "representation", ".", "We", "use", "Integral", "Probability", "Metrics", "to", "measure", "distances", "between", "distributions", ",", "deriving", "explicit", "bounds", "for", "the", "Wasserstein", "and", "Maximum", "Mean", "Discrepancy", "(", "MMD", ")", "distances", ".", "Experiments", "on", "real", "and", "simulated", "data", "show", "the", "new", "algorithms", "match", "or", "outperform", "the", "state", "-", "of", "-", "the", "-", "art", ".", "inline", ",", "nomargin", ",", "theme", "=", "color", "ufxuanfx", "blueUri", "Estimatingindividualtreatmenteffect", ":", "generalizationboundsandalgorithms", "section", ":", "Introduction", "Making", "predictions", "about", "causal", "effects", "of", "actions", "is", "a", "central", "problem", "in", "many", "domains", ".", "For", "example", ",", "a", "doctor", "deciding", "which", "medication", "will", "cause", "better", "outcomes", "for", "a", "patient", ";", "a", "government", "deciding", "who", "would", "benefit", "most", "from", "subsidized", "job", "training", ";", "or", "a", "teacher", "deciding", "which", "study", "program", "would", "most", "benefit", "a", "specific", "student", ".", "In", "this", "paper", "we", "focus", "on", "the", "problem", "of", "making", "these", "predictions", "based", "on", "observational", "data", ".", "Observational", "data", "is", "data", "which", "contains", "past", "actions", ",", "their", "outcomes", ",", "and", "possibly", "more", "context", ",", "but", "without", "direct", "access", "to", "the", "mechanism", "which", "gave", "rise", "to", "the", "action", ".", "For", "example", "we", "might", "have", "access", "to", "records", "of", "patients", "(", "context", ")", ",", "their", "medications", "(", "actions", ")", ",", "and", "outcomes", ",", "but", "we", "do", "not", "have", "complete", "knowledge", "of", "why", "a", "specific", "action", "was", "applied", "to", "a", "patient", ".", "The", "hallmark", "of", "learning", "from", "observational", "data", "is", "that", "the", "actions", "observed", "in", "the", "data", "depend", "on", "variables", "which", "might", "also", "affect", "the", "outcome", ",", "resulting", "in", "confounding", ":", "For", "example", ",", "richer", "patients", "might", "better", "afford", "certain", "medications", ",", "and", "job", "training", "might", "only", "be", "given", "to", "those", "motivated", "enough", "to", "seek", "it", ".", "The", "challenge", "is", "how", "to", "untangle", "these", "confounding", "factors", "and", "make", "valid", "predictions", ".", "Specifically", ",", "we", "work", "under", "the", "common", "simplifying", "assumption", "of", "\u201c", "no", "-", "hidden", "confounding", "\u201d", ",", "assuming", "that", "all", "the", "factors", "determining", "which", "actions", "were", "taken", "are", "observed", ".", "In", "the", "examples", "above", ",", "it", "would", "mean", "that", "we", "have", "measured", "a", "patient", "\u2019s", "wealth", "or", "an", "employee", "\u2019s", "motivation", ".", "As", "a", "learning", "problem", ",", "estimating", "causal", "effects", "from", "observational", "data", "is", "different", "from", "classic", "learning", "in", "that", "in", "our", "training", "data", "we", "never", "see", "the", "individual", "-", "level", "effect", ".", "For", "each", "unit", ",", "we", "only", "see", "their", "response", "to", "one", "of", "the", "possible", "actions", "-", "the", "one", "they", "had", "actually", "received", ".", "This", "is", "close", "to", "what", "is", "known", "in", "the", "machine", "learning", "literature", "as", "\u201c", "learning", "from", "logged", "bandit", "feedback", "\u201d", ",", "with", "the", "distinction", "that", "we", "do", "not", "have", "access", "to", "the", "model", "generating", "the", "action", ".", "Our", "work", "differs", "from", "much", "work", "in", "causal", "inference", "in", "that", "we", "focus", "on", "the", "individual", "-", "level", "causal", "effect", "(", "also", "known", "as", "\u201c", "c", "-", "specific", "treatment", "effects", "\u201d", ")", ",", "rather", "that", "the", "average", "or", "population", "level", ".", "Our", "main", "contribution", "is", "to", "give", "what", "is", ",", "to", "the", "best", "of", "our", "knowledge", ",", "the", "first", "generalization", "-", "error", "bound", "for", "estimating", "individual", "-", "level", "causal", "effect", ",", "where", "each", "individual", "is", "identified", "by", "its", "features", ".", "The", "bound", "leads", "naturally", "to", "a", "new", "family", "of", "representation", "-", "learning", "based", "algorithms", ",", "which", "we", "show", "to", "match", "or", "outperform", "state", "-", "of", "-", "the", "-", "art", "methods", "on", "several", "causal", "effect", "inference", "tasks", ".", "We", "frame", "our", "results", "using", "the", "Rubin", "-", "Neyman", "potential", "outcomes", "framework", ",", "as", "follows", ".", "We", "assume", "that", "for", "a", "unit", "with", "features", ",", "and", "an", "action", "(", "also", "known", "as", "treatment", "or", "intervention", ")", ",", "there", "are", "two", "potential", "outcomes", ":", "and", ".", "In", "our", "data", ",", "for", "each", "unit", "we", "only", "see", "one", "of", "the", "potential", "outcomes", ",", "depending", "on", "the", "treatment", "assignment", ":", "if", "we", "observe", ",", "if", ",", "we", "observe", ";", "this", "is", "known", "as", "the", "Consistency", "assumption", ".", "For", "example", ",", "can", "denote", "the", "set", "of", "lab", "tests", "and", "demographic", "factors", "of", "a", "diabetic", "patient", ",", "denote", "the", "standard", "medication", "for", "controlling", "blood", "sugar", ",", "denotes", "a", "new", "medication", ",", "and", "and", "indicate", "the", "patient", "\u2019s", "blood", "sugar", "level", "if", "they", "were", "to", "be", "given", "medications", "and", ",", "respectively", ".", "We", "will", "denote", ",", ".", "We", "are", "interested", "in", "learning", "the", "function", ".", "is", "the", "expected", "treatment", "effect", "of", "relative", "to", "on", "an", "individual", "unit", "with", "characteristics", ",", "or", "the", "Individual", "Treatment", "Effect", "(", "ITE", ")", ".", "For", "example", ",", "for", "a", "patient", "with", "features", ",", "we", "can", "use", "this", "to", "predict", "which", "of", "two", "treatments", "will", "have", "a", "better", "outcome", ".", "The", "fundamental", "problem", "of", "causal", "inference", "is", "that", "for", "any", "in", "our", "data", "we", "only", "observe", "or", ",", "but", "never", "both", ".", "As", "mentioned", "above", ",", "we", "make", "an", "important", "\u201c", "no", "-", "hidden", "confounders", "\u201d", "assumption", ",", "in", "order", "to", "make", "the", "conditional", "causal", "effect", "identifiable", ".", "We", "formalize", "this", "assumption", "by", "using", "the", "standard", "strong", "ignorability", "condition", ":", ",", "and", "for", "all", ".", "Strong", "ignorability", "is", "a", "sufficient", "condition", "for", "the", "ITE", "function", "to", "be", "identifiable", ":", "see", "proof", "in", "the", "supplement", ".", "The", "validity", "of", "strong", "ignorability", "can", "not", "be", "assessed", "from", "data", ",", "and", "must", "be", "determined", "by", "domain", "knowledge", "and", "understanding", "of", "the", "causal", "relationships", "between", "the", "variables", ".", "One", "approach", "to", "the", "problem", "of", "estimating", "the", "function", "is", "by", "learning", "the", "two", "functions", "and", "using", "samples", "from", ".", "This", "is", "similar", "to", "a", "standard", "machine", "learning", "problem", "of", "learning", "from", "finite", "samples", ".", "However", ",", "there", "is", "an", "additional", "source", "of", "variance", "at", "work", "here", ":", "For", "example", ",", "if", "mostly", "rich", "patients", "received", "treatment", ",", "and", "mostly", "poor", "patients", "received", "treatment", ",", "we", "might", "have", "an", "unreliable", "estimation", "of", "for", "poor", "patients", ".", "In", "this", "paper", "we", "upper", "bound", "this", "additional", "source", "of", "variance", "using", "an", "Integral", "Probability", "Metric", "(", "IPM", ")", "measure", "of", "distance", "between", "two", "distributions", ",", "and", ",", "also", "known", "as", "the", "control", "and", "treated", "distributions", ".", "In", "practice", "we", "use", "two", "specific", "IPMs", ":", "the", "Maximum", "Mean", "Discrepancy", ",", "and", "the", "Wasserstein", "distance", ".", "We", "show", "that", "the", "expected", "error", "in", "learning", "the", "individual", "treatment", "effect", "function", "is", "upper", "bounded", "by", "the", "error", "of", "learning", "and", ",", "plus", "the", "IPM", "term", ".", "In", "the", "randomized", "controlled", "trial", "setting", ",", "where", ",", "the", "IPM", "term", "is", ",", "and", "our", "bound", "naturally", "reduces", "to", "a", "standard", "learning", "problem", "of", "learning", "two", "functions", ".", "The", "bound", "we", "derive", "points", "the", "way", "to", "a", "family", "of", "algorithms", "based", "on", "the", "idea", "of", "representation", "learning", ":", "Jointly", "learn", "hypotheses", "for", "both", "treated", "and", "control", "on", "top", "of", "a", "representation", "which", "minimizes", "a", "weighted", "sum", "of", "the", "factual", "loss", "(", "the", "standard", "supervised", "machine", "learning", "objective", ")", ",", "and", "the", "IPM", "distance", "between", "the", "control", "and", "treated", "distributions", "induced", "by", "the", "representation", ".", "This", "can", "be", "viewed", "as", "learning", "the", "functions", "and", "under", "a", "constraint", "that", "encourages", "better", "generalization", "across", "the", "treated", "and", "control", "populations", ".", "In", "the", "Experiments", "section", "we", "apply", "algorithms", "based", "on", "multi", "-", "layer", "neural", "nets", "as", "representations", "and", "hypotheses", ",", "along", "with", "MMD", "or", "Wasserstein", "distributional", "distances", "over", "the", "representation", "layer", ";", "see", "Figure", "[", "reference", "]", "for", "the", "basic", "architecture", ".", "In", "his", "foundational", "text", "about", "causality", ",", "writes", ":", "\u201c", "Whereas", "in", "traditional", "learning", "tasks", "we", "attempt", "to", "generalize", "from", "one", "set", "of", "instances", "to", "another", ",", "the", "causal", "modeling", "task", "is", "to", "generalize", "from", "behavior", "under", "one", "set", "of", "conditions", "to", "behavior", "under", "another", "set", ".", "Causal", "models", "should", "therefore", "be", "chosen", "by", "a", "criterion", "that", "challenges", "their", "stability", "against", "changing", "conditions", "\u2026", "\u201d", "[", "emphasis", "ours", "]", ".", "We", "believe", "our", "work", "points", "the", "way", "to", "one", "such", "stability", "criterion", ",", "for", "causal", "inference", "in", "the", "strongly", "ignorable", "case", ".", "section", ":", "Related", "work", "Much", "recent", "work", "in", "machine", "learning", "for", "causal", "inference", "focuses", "on", "causal", "discovery", ",", "with", "the", "goal", "of", "discovering", "the", "underlying", "causal", "graph", "or", "causal", "direction", "from", "data", ".", "We", "focus", "on", "the", "case", "when", "the", "causal", "graph", "is", "simple", "and", "known", "to", "be", "of", "the", "form", ",", "with", "no", "hidden", "confounders", ".", "Under", "the", "causal", "model", "we", "assume", ",", "the", "most", "common", "goal", "of", "causal", "effect", "inference", "as", "used", "in", "the", "applied", "sciences", "is", "to", "obtain", "the", "average", "treatment", "effect", ":", ".", "We", "will", "briefly", "discuss", "how", "some", "standard", "statistical", "causal", "effect", "inference", "methods", "relate", "to", "our", "proposed", "method", ".", "Note", "that", "most", "of", "these", "approaches", "assume", "some", "form", "of", "ignorability", ".", "One", "of", "the", "most", "widely", "used", "approaches", "to", "estimating", "ATE", "is", "covariate", "adjustment", ",", "also", "known", "as", "back", "-", "door", "adjustment", "or", "the", "G", "-", "computation", "formula", ".", "In", "its", "basic", "version", ",", "covariate", "adjustment", "amounts", "to", "estimating", "the", "functions", ",", ".", "Therefore", ",", "covariate", "adjustment", "methods", "are", "the", "most", "natural", "candidates", "for", "estimating", "ITE", "as", "well", "as", "ATE", ",", "using", "the", "estimates", "of", ".", "However", ",", "most", "previous", "work", "on", "this", "subject", "focused", "on", "asymptotic", "consistency", ",", "and", "so", "far", "there", "has", "not", "been", "much", "work", "on", "the", "generalization", "-", "error", "of", "such", "a", "procedure", ".", "One", "way", "to", "view", "our", "results", "is", "that", "we", "point", "out", "a", "previously", "unaccounted", "for", "source", "of", "variance", "when", "using", "covariate", "adjustment", "to", "estimate", "ITE", ".", "We", "suggest", "a", "new", "type", "of", "regularization", ",", "by", "learning", "representations", "with", "reduced", "IPM", "distance", "between", "treated", "and", "control", ",", "enabling", "a", "new", "type", "of", "bias", "-", "variance", "trade", "-", "off", ".", "Another", "widely", "used", "family", "of", "statistical", "methods", "used", "in", "causal", "effect", "inference", "are", "weighting", "methods", ".", "Methods", "such", "as", "propensity", "score", "weighting", "re", "-", "weight", "the", "units", "in", "the", "observational", "data", "so", "as", "to", "make", "the", "treated", "and", "control", "populations", "more", "comparable", ".", "These", "methods", "do", "not", "yield", "themselves", "immediately", "to", "estimating", "an", "individual", "level", "effect", ",", "and", "adapting", "them", "for", "that", "purpose", "is", "an", "interesting", "research", "question", ".", "Doubly", "robust", "methods", "combine", "re", "-", "weighting", "the", "samples", "and", "covariate", "adjustment", "in", "clever", "ways", "to", "reduce", "model", "bias", ".", "Again", ",", "we", "believe", "that", "finding", "how", "to", "adapt", "the", "concept", "of", "double", "robustness", "to", "the", "problem", "of", "effectively", "estimating", "ITE", "is", "an", "interesting", "open", "question", ".", "Adapting", "machine", "learning", "methods", "for", "causal", "effect", "inference", ",", "and", "in", "particular", "for", "individual", "level", "treatment", "effect", ",", "has", "gained", "much", "interest", "recently", ".", "For", "example", "discuss", "how", "tree", "-", "based", "methods", "can", "be", "adapted", "to", "obtain", "a", "consistent", "estimator", "with", "semi", "-", "parametric", "asymptotic", "convergence", "rate", ".", "Recent", "work", "has", "also", "looked", "into", "how", "machine", "learning", "method", "can", "help", "detect", "heterogeneous", "treatment", "effects", "when", "some", "data", "from", "randomized", "experiments", "is", "available", ".", "Neural", "nets", "have", "also", "been", "used", "for", "this", "purpose", ",", "exemplified", "in", "early", "work", "by", ",", "and", "more", "recently", "by", "\u2019s", "work", "on", "deep", "instrumental", "variables", ".", "Our", "work", "differs", "from", "all", "the", "above", "by", "focusing", "on", "the", "generalization", "-", "error", "aspects", "of", "estimating", "individual", "treatment", "effect", ",", "as", "opposed", "to", "asymptotic", "consistency", ",", "and", "by", "focusing", "solely", "on", "the", "observational", "study", "case", ",", "with", "no", "randomized", "components", "or", "instrumental", "variables", ".", "Another", "line", "of", "work", "in", "the", "causal", "inference", "community", "relates", "to", "bounding", "the", "estimate", "of", "the", "average", "treatment", "effect", "given", "an", "instrumental", "variable", ",", "or", "under", "hidden", "confounding", ",", "for", "example", "when", "the", "ignorability", "assumption", "does", "not", "hold", ".", "Our", "work", "differs", ",", "in", "that", "we", "only", "deal", "with", "the", "ignorable", "case", ",", "and", "in", "that", "we", "bound", "a", "very", "different", "quantity", ":", "the", "generalization", "-", "error", "of", "estimating", "individual", "level", "treatment", "effect", ".", "Our", "work", "has", "strong", "connections", "with", "work", "on", "domain", "adaptation", ".", "In", "particular", ",", "estimating", "ITE", "requires", "prediction", "of", "outcomes", "over", "a", "different", "distribution", "from", "the", "observed", "one", ".", "Our", "ITE", "error", "upper", "bound", "has", "similarities", "with", "generalization", "bounds", "in", "domain", "adaptation", "given", "by", ".", "These", "bounds", "employ", "distribution", "distance", "metrics", "such", "as", "the", "A", "-", "distance", "or", "the", "discrepancy", "metric", ",", "which", "are", "related", "to", "the", "IPM", "distance", "we", "use", ".", "Our", "algorithm", "is", "similar", "to", "a", "recent", "algorithm", "for", "domain", "adaptation", "by", ",", "and", "in", "principle", "other", "domain", "adaptation", "methods", "(", "e.g.", ")", "could", "be", "adapted", "for", "use", "in", "ITE", "estimation", "as", "presented", "here", ".", "Finally", ",", "our", "paper", "builds", "on", "work", "by", ",", "where", "the", "authors", "show", "a", "connection", "between", "covariate", "shift", "and", "the", "task", "of", "estimating", "the", "counterfactual", "outcome", "in", "a", "causal", "inference", "scenario", ".", "They", "proposed", "learning", "a", "representation", "of", "the", "data", "that", "makes", "the", "treated", "and", "control", "distributions", "more", "similar", ",", "and", "fitting", "a", "linear", "ridge", "-", "regression", "model", "on", "top", "of", "it", ".", "They", "then", "bounded", "the", "relative", "error", "of", "fitting", "a", "ridge", "-", "regression", "using", "the", "distribution", "with", "reverse", "treatment", "assignment", "versus", "fitting", "a", "ridge", "-", "regression", "using", "the", "factual", "distribution", ".", "Unfortunately", ",", "the", "relative", "error", "bound", "is", "not", "at", "all", "informative", "regarding", "the", "absolute", "quality", "of", "the", "representation", ".", "In", "this", "paper", "we", "focus", "on", "a", "related", "but", "more", "substantive", "task", ":", "estimating", "the", "individual", "treatment", "effect", ",", "building", "on", "top", "of", "the", "counterfactual", "error", "term", ".", "We", "further", "provide", "an", "informative", "bound", "on", "the", "absolute", "quality", "of", "the", "representation", ".", "We", "also", "derive", "a", "much", "more", "flexible", "family", "of", "algorithms", ",", "including", "non", "-", "linear", "hypotheses", "and", "much", "more", "powerful", "distribution", "metrics", "in", "the", "form", "of", "IPMs", "such", "as", "the", "Wasserstein", "and", "MMD", "distances", ".", "Finally", ",", "we", "conduct", "significantly", "more", "thorough", "experiments", "including", "a", "real", "-", "world", "dataset", "and", "out", "-", "of", "-", "sample", "performance", ",", "and", "show", "our", "methods", "outperform", "previously", "proposed", "ones", ".", "section", ":", "Estimating", "ITE", ":", "Error", "bounds", "In", "this", "section", "we", "prove", "a", "bound", "on", "the", "expected", "error", "in", "estimating", "the", "individual", "treatment", "effect", "for", "a", "given", "representation", ",", "and", "a", "hypothesis", "defined", "over", "that", "representation", ".", "The", "bound", "is", "expressed", "in", "terms", "of", "(", "1", ")", "the", "expected", "loss", "of", "the", "model", "when", "learning", "the", "observed", "outcomes", "as", "a", "function", "of", "and", ",", "denoted", ",", "standing", "for", "\u201c", "Factual", "\u201d", ";", "(", "2", ")", "an", "Integral", "Probability", "Metric", "(", "IPM", ")", "distance", "between", "the", "distribution", "of", "treated", "and", "control", "units", ".", "The", "term", "is", "the", "classic", "machine", "learning", "generalization", "-", "error", ",", "and", "in", "turn", "can", "be", "upper", "bounded", "using", "the", "empirical", "error", "and", "model", "complexity", "terms", ",", "applying", "standard", "machine", "learning", "theory", ".", "subsection", ":", "Problem", "setup", "We", "will", "employ", "the", "following", "assumptions", "and", "notations", ".", "The", "most", "important", "notations", "are", "in", "the", "Notation", "box", "in", "the", "supplement", ".", "The", "space", "of", "covariates", "is", "a", "bounded", "subset", ".", "The", "outcome", "space", "is", ".", "Treatment", "is", "a", "binary", "variable", ".", "We", "assume", "there", "exists", "a", "joint", "distribution", ",", "such", "that", "and", "for", "all", "(", "strong", "ignorability", ")", ".", "The", "treated", "and", "control", "distributions", "are", "the", "distribution", "of", "the", "features", "conditioned", "on", "treatment", ":", ",", "and", ",", "respectively", ".", "Throughout", "this", "paper", "we", "will", "discuss", "representation", "functions", "of", "the", "form", ",", "where", "is", "the", "representation", "space", ".", "We", "make", "the", "following", "assumption", "about", ":", "theorem", ":", ".", "The", "representation", "\u03a6", "is", "a", "twice", "-", "differentiable", ",", "one", "-", "to", "-", "one", "function", ".", "Without", "loss", "of", "generality", "we", "will", "assume", "that", "R", "is", "the", "image", "of", "X", "under", "\u03a6.", "We", "then", "have", ":", "\u03a8\u2192RX", "as", "the", "inverse", "of", "\u03a6", ",", "such", "that", "=", "\u2062\u03a8", "(", "\u2062\u03a6", "(", "x", "))", "x", "for", "all", "\u2208xX.", "The", "representation", "pushes", "forward", "the", "treated", "and", "control", "distributions", "into", "the", "new", "space", ";", "we", "denote", "the", "induced", "distribution", "by", ".", "theorem", ":", ".", "Define", "p", "=", "t1\u03a6", "(", "r", ")", ":=p\u03a6", "(", "r|t=1", ")", ",", "p", "=", "t0\u03a6", "(", "r", ")", ":=p\u03a6", "(", "r|t=0", ")", ",", "to", "be", "the", "treated", "and", "control", "distributions", "induced", "over", "R.", "For", "a", "one", "-", "to", "-", "one", "\u03a6", ",", "the", "distributions", "\u2062p", "=", "t1\u03a6", "(", "r", ")", "and", "\u2062p", "=", "t0\u03a6", "(", "r", ")", "can", "be", "obtained", "by", "the", "standard", "change", "of", "variables", "formula", ",", "using", "the", "determinant", "of", "the", "Jacobian", "of", "\u2062\u03a8", "(", "r", ")", ".", "Let", "be", "a", "representation", "function", ",", "and", "be", "an", "hypothesis", "defined", "over", "the", "representation", "space", ".", "Let", "be", "a", "loss", "function", ".", "We", "define", "two", "complimentary", "loss", "functions", ":", "one", "is", "the", "standard", "machine", "learning", "loss", ",", "which", "we", "will", "call", "the", "factual", "loss", "and", "denote", ".", "The", "other", "is", "the", "expected", "loss", "with", "respect", "to", "the", "distribution", "where", "the", "treatment", "assignment", "is", "flipped", ",", "which", "we", "call", "the", "counterfactual", "loss", ",", ".", "theorem", ":", ".", "The", "expected", "loss", "for", "the", "unit", "and", "treatment", "pair", "(", "x", ",", "t", ")", "is", ":", "\u2113h", ",", "\u03a6", "(", "x", ",", "t", ")", "=\u222bYL", "(", "Yt", ",", "h", "(", "\u03a6", "(", "x", "),", "t", "))", "p", "(", "Yt|x", ")", "dYt", ".", "The", "expected", "factual", "and", "counterfactual", "losses", "of", "h", "and", "\u03a6", "are", ":", "If", "denotes", "patients", "\u2019", "features", ",", "a", "treatment", ",", "and", "a", "potential", "outcome", "such", "as", "mortality", ",", "we", "think", "of", "as", "measuring", "how", "well", "do", "and", "predict", "mortality", "for", "the", "patients", "and", "doctors", "\u2019", "actions", "sampled", "from", "the", "same", "distribution", "as", "our", "data", "sample", ".", "measures", "how", "well", "our", "prediction", "with", "and", "would", "do", "in", "a", "\u201c", "topsy", "-", "turvy", "\u201d", "world", "where", "the", "patients", "are", "the", "same", "but", "the", "doctors", "are", "inclined", "to", "prescribe", "exactly", "the", "opposite", "treatment", "than", "the", "one", "the", "real", "-", "world", "doctors", "would", "prescribe", ".", "theorem", ":", ".", "The", "expected", "factual", "treated", "and", "control", "losses", "are", ":", "For", ",", "it", "is", "immediate", "to", "show", "that", ".", "theorem", ":", ".", "The", "treatment", "effect", "(", "ITE", ")", "for", "unit", "x", "is", ":", "Let", "by", "an", "hypothesis", ".", "For", "example", ",", "we", "could", "have", "that", ".", "theorem", ":", ".", "The", "treatment", "effect", "estimate", "of", "the", "hypothesis", "f", "for", "unit", "x", "is", ":", "theorem", ":", ".", "The", "expected", "Precision", "in", "Estimation", "of", "Heterogeneous", "Effect", "(", "PEHE", ",", "(", ")", ")", "loss", "of", "f", "is", ":", "When", "=", "\u2062f", "(", "x", ",", "t", ")", "\u2062h", "(", "\u2062\u03a6", "(", "x", "),", "t", ")", ",", "we", "will", "also", "use", "the", "notation", "=", "\u2062\u03f5PEHE", "(", "h", ",", "\u03a6", ")", "\u2062\u03f5PEHE", "(", "f", ")", ".", "Our", "proof", "relies", "on", "the", "notion", "of", "an", "Integral", "Probability", "Metric", "(", "IPM", ")", ",", "which", "is", "a", "class", "of", "metrics", "between", "probability", "distributions", ".", "For", "two", "probability", "density", "functions", ",", "defined", "over", ",", "and", "for", "a", "function", "family", "of", "functions", ",", "we", "have", "that", "Integral", "probability", "metrics", "are", "always", "symmetric", "and", "obey", "the", "triangle", "inequality", ",", "and", "trivially", "satisfy", ".", "For", "rich", "enough", "function", "families", ",", "we", "also", "have", "that", "and", "then", "is", "a", "true", "metric", "over", "the", "corresponding", "set", "of", "probabilities", ".", "Examples", "of", "function", "families", "for", "which", "is", "a", "true", "metric", "are", "the", "family", "of", "bounded", "continuous", "functions", ",", "the", "family", "of", "-", "Lipschitz", "functions", ",", "and", "the", "unit", "-", "ball", "of", "functions", "in", "a", "universal", "reproducing", "Hilbert", "kernel", "space", ".", "theorem", ":", ".", "Recall", "that", "mt", "(", "x", ")", "=E", "[", "Yt|x", "]", ".", "The", "expected", "variance", "of", "Yt", "with", "respect", "to", "a", "distribution", "\u2062p", "(", "x", ",", "t", ")", ":", "We", "define", ":", "subsection", ":", "Bounds", "We", "first", "state", "a", "Lemma", "bounding", "the", "counterfactual", "loss", ",", "a", "key", "step", "in", "obtaining", "the", "bound", "on", "the", "error", "in", "estimating", "individual", "treatment", "effect", ".", "We", "then", "give", "the", "main", "Thoerem", ".", "The", "proofs", "and", "details", "are", "in", "the", "supplement", ".", "Let", "be", "the", "marginal", "probability", "of", "treatment", ".", "By", "the", "strong", "ignorability", "assumption", ",", ".", "theorem", ":", ".", "Let", ":", "\u03a6\u2192XR", "be", "a", "one", "-", "to", "-", "one", "representation", "function", ",", "with", "inverse", "\u03a8.", "Let", ":", "h\u2192\u00d7R{0", ",", "1}Y", "be", "an", "hypothesis", ".", "Let", "G", "be", "a", "family", "of", "functions", ":", "g\u2192RY", ".", "Assume", "there", "exists", "a", "constant", ">", "B\u03a60", ",", "such", "that", "for", "fixed", "\u2208t{0", ",", "1", "}", ",", "the", "per", "-", "unit", "expected", "loss", "functions", "\u2062\u2113h", ",", "\u03a6", "(", "\u2062\u03a8", "(", "r", "),", "t", ")", "(", "Definition", ")", "obey", "\u2208\u2062\u22c51B\u03a6\u2113h", ",", "\u03a6", "(", "\u2062\u03a8", "(", "r", "),", "t", ")", "G.", "We", "have", ":", "where", "\u03f5\u2062CF", ",", "\u03f5=t0F", "and", "\u03f5=t1F", "are", "as", "in", "Definitions", "and", ".", "theorem", ":", ".", "Under", "the", "conditions", "of", "Lemma", ",", "and", "assuming", "the", "loss", "L", "used", "to", "define", "\u2113h", ",", "\u03a6", "in", "Definitions", "and", "is", "the", "squared", "loss", ",", "we", "have", ":", "where", "\u03f5F", "and", "\u03f5\u2062CF", "are", "defined", "w.r.t", ".", "the", "squared", "loss", ".", "The", "main", "idea", "of", "the", "proof", "is", "showing", "that", "is", "upper", "bounded", "by", "the", "sum", "of", "the", "expected", "factual", "loss", "and", "expected", "counterfactual", "loss", ".", "However", ",", "we", "can", "not", "estimate", ",", "since", "we", "only", "have", "samples", "relevant", "to", ".", "We", "therefore", "bound", "the", "difference", "using", "an", "IPM", ".", "Choosing", "a", "small", "function", "family", "will", "make", "the", "bound", "tighter", ".", "However", ",", "choosing", "too", "small", "a", "family", "could", "result", "in", "an", "incomputable", "bound", ".", "For", "example", ",", "for", "the", "minimal", "choice", ",", "we", "will", "have", "to", "evaluate", "an", "expectation", "term", "of", "over", ",", "and", "of", "over", ".", "We", "can", "not", "in", "general", "evaluate", "these", "expectations", ",", "since", "by", "assumption", "when", "we", "only", "observe", ",", "and", "the", "same", "for", "and", ".", "In", "addition", ",", "for", "some", "function", "families", "there", "is", "no", "known", "way", "to", "efficiently", "compute", "the", "IPM", "distance", "or", "its", "gradients", ".", "In", "this", "paper", "we", "use", "two", "function", "families", "for", "which", "there", "are", "available", "optimization", "tools", ".", "The", "first", "is", "the", "family", "of", "-", "Lipschitz", "functions", ",", "which", "leads", "to", "IPM", "being", "the", "Wasserstein", "distance", ",", "denoted", ".", "The", "second", "is", "the", "family", "of", "norm", "-", "reproducing", "kernel", "Hilbert", "space", "(", "RKHS", ")", "functions", ",", "leading", "to", "the", "MMD", "metric", ",", "denoted", ".", "Both", "the", "Wasserstein", "and", "MMD", "metrics", "have", "consistent", "estimators", "which", "can", "be", "efficiently", "computed", "in", "the", "finite", "sample", "case", ".", "Both", "have", "been", "used", "for", "various", "machine", "learning", "tasks", "in", "recent", "years", ".", "In", "order", "to", "explicitly", "evaluate", "the", "constant", "in", "Theorem", "[", "reference", "]", ",", "we", "have", "to", "make", "some", "assumptions", "about", "the", "elements", "of", "the", "problem", ".", "For", "the", "Wasserstein", "case", "these", "are", "the", "loss", ",", "the", "Lipschitz", "constants", "of", "and", ",", "and", "the", "condition", "number", "of", "the", "Jacobian", "of", ".", "For", "the", "MMD", "case", ",", "we", "make", "assumptions", "about", "the", "RKHS", "representability", "and", "RKHS", "norms", "of", ",", ",", "and", "the", "standard", "deviation", "of", ".", "The", "full", "details", "are", "given", "in", "the", "supplement", ",", "with", "the", "major", "results", "stated", "in", "Theorems", "2", "and", "3", ".", "In", "all", "cases", "we", "obtain", "that", "making", "smaller", "increases", "the", "constant", "precluding", "trivial", "solutions", "such", "as", "making", "arbitrarily", "small", ".", "For", "an", "empirical", "sample", ",", "and", "a", "family", "of", "representations", "and", "hypotheses", ",", "we", "can", "further", "upper", "bound", "and", "by", "their", "respective", "empirical", "losses", "and", "a", "model", "complexity", "term", "using", "standard", "arguments", ".", "The", "IPMs", "we", "use", "can", "be", "consistently", "estimated", "from", "finite", "samples", ".", "The", "negative", "variance", "term", "arises", "from", "the", "fact", "that", ",", "following", ",", "we", "define", "the", "error", "in", "terms", "of", "the", "conditional", "mean", "functions", ",", "as", "opposed", "to", "fitting", "the", "random", "variables", ".", "Our", "results", "hold", "for", "any", "given", "and", "obeying", "the", "Theorem", "conditions", ".", "This", "immediately", "suggest", "an", "algorithm", "in", "which", "we", "minimize", "the", "upper", "bound", "in", "Eq", ".", "(", "[", "reference", "]", ")", "with", "respect", "to", "and", "and", "either", "the", "Wasserstein", "or", "MMD", "IPM", ",", "in", "order", "to", "minimize", "the", "error", "in", "estimating", "the", "individual", "treatment", "effect", ".", "This", "leads", "us", "to", "Algorithm", "[", "reference", "]", "below", ".", "section", ":", "Algorithm", "for", "estimating", "ITE", "We", "propose", "a", "general", "framework", "called", "CFR", "(", "for", "Counterfactual", "Regression", ")", "for", "ITE", "estimation", "based", "on", "the", "theoretical", "results", "above", ".", "Our", "algorithm", "is", "an", "end", "-", "to", "-", "end", ",", "regularized", "minimization", "procedure", "which", "simultaneously", "fits", "both", "a", "balanced", "representation", "of", "the", "data", "and", "a", "hypothesis", "for", "the", "outcome", ".", "CFR", "draws", "on", "the", "same", "intuition", "as", "the", "approach", "proposed", "by", ",", "but", "overcomes", "the", "following", "limitations", "of", "their", "method", ":", "a", ")", "Their", "theory", "requires", "a", "two", "-", "step", "optimization", "procedure", "and", "is", "specific", "to", "linear", "hypotheses", "of", "the", "learned", "representation", "(", "and", "does", "not", "support", "e.g.", "deep", "neural", "networks", ")", ",", "b", ")", "The", "treatment", "indicator", "might", "get", "lost", "if", "the", "learned", "representation", "is", "high", "-", "dimensional", "(", "see", "discussion", "below", ")", ".", "We", "assume", "there", "exists", "a", "distribution", "over", ",", "such", "that", "strong", "ignorability", "holds", ".", "We", "further", "assume", "we", "have", "a", "sample", "from", "that", "distribution", ",", "where", "if", ",", "if", ".", "This", "standard", "assumption", "means", "that", "the", "treatment", "assignment", "determines", "which", "potential", "outcome", "we", "see", ".", "Our", "goal", "is", "to", "find", "a", "representation", "and", "hypothesis", "that", "will", "minimize", "for", ".", "In", "this", "work", ",", "we", "let", "and", "be", "parameterized", "by", "deep", "neural", "networks", "trained", "jointly", "in", "an", "end", "-", "to", "-", "end", "fashion", ",", "see", "Figure", "[", "reference", "]", ".", "This", "model", "allows", "for", "learning", "complex", "non", "-", "linear", "representations", "and", "hypotheses", "with", "large", "flexibility", ".", "parameterized", "with", "a", "single", "network", "using", "the", "concatenation", "of", "and", "as", "input", ".", "When", "the", "dimension", "of", "is", "high", ",", "this", "risks", "losing", "the", "influence", "of", "on", "during", "training", ".", "To", "combat", "this", ",", "our", "first", "contribution", "is", "to", "parameterize", "and", "as", "two", "separate", "\u201c", "heads", "\u201d", "of", "the", "joint", "network", ",", "the", "former", "used", "to", "estimate", "the", "outcome", "under", "treatment", ",", "and", "the", "latter", "under", "control", ".", "This", "means", "that", "statistical", "power", "is", "shared", "in", "the", "representation", "layers", "of", "the", "network", ",", "while", "the", "effect", "of", "treatment", "is", "retained", "in", "the", "separate", "heads", ".", "Note", "that", "each", "sample", "is", "used", "to", "update", "only", "the", "head", "corresponding", "to", "the", "observed", "treatment", ";", "for", "example", ",", "an", "observation", "is", "only", "used", "to", "update", ".", "Our", "second", "contribution", "is", "to", "excplicitly", "account", "and", "adjust", "for", "the", "bias", "induced", "by", "treatment", "group", "imbalance", ".", "To", "this", "end", ",", "we", "seek", "a", "representation", "and", "hypothesis", "that", "minimizes", "a", "trade", "-", "off", "between", "predictive", "accuracy", "and", "imbalance", "in", "the", "representation", "space", ",", "using", "the", "following", "objective", ":", "Note", "that", "in", "the", "definition", "of", "is", "simply", "the", "proportion", "of", "treated", "units", "in", "the", "population", ".", "The", "weights", "compensate", "for", "the", "difference", "in", "treatment", "group", "size", "in", "our", "sample", ",", "see", "Theorem", "[", "reference", "]", ".", "is", "the", "(", "empirical", ")", "integral", "probability", "metric", "defined", "by", "the", "function", "family", ".", "For", "most", "IPMs", ",", "we", "can", "not", "compute", "the", "factor", "in", "Equation", "[", "reference", "]", ",", "but", "treat", "it", "as", "part", "of", "the", "hyperparameter", ".", "This", "makes", "our", "objective", "sensitive", "to", "the", "scaling", "of", ",", "even", "for", "a", "constant", ".", "We", "therefore", "normalize", "through", "either", "projection", "or", "batch", "-", "normalization", "with", "fixed", "scale", ".", "We", "refer", "to", "the", "model", "minimizing", "(", "[", "reference", "]", ")", "with", "as", "Counterfactual", "Regression", "(", "CFR", ")", "and", "the", "variant", "without", "balance", "regularization", "(", ")", "as", "Treatment", "-", "Agnostic", "Representation", "Network", "(", "TARNet", ")", ".", "We", "train", "our", "models", "by", "minimizing", "(", "[", "reference", "]", ")", "using", "stochastic", "gradient", "descent", ",", "where", "we", "backpropagate", "the", "error", "through", "both", "the", "hypothesis", "and", "representation", "networks", ",", "as", "described", "in", "Algorithm", "[", "reference", "]", ".", "Both", "the", "prediction", "loss", "and", "the", "penalty", "term", "are", "computed", "for", "one", "mini", "-", "batch", "at", "a", "time", ".", "Details", "of", "how", "to", "obtain", "the", "gradient", "with", "respect", "to", "the", "empirical", "IPMs", "are", "in", "the", "supplement", ".", "[", "tbp", "]", "CFR", ":", "Counterfactual", "regression", "with", "integral", "probability", "metrics", "[", "1", "]", "Input", ":", "Factual", "sample", ",", "scaling", "parameter", ",", "loss", "function", ",", "representation", "network", "with", "initial", "weights", ",", "outcome", "network", "with", "initial", "weights", ",", "function", "family", "for", "IPM", ".", "Compute", "Compute", "for", "not", "converged", "Sample", "mini", "-", "batch", "Calculate", "the", "gradient", "of", "the", "IPM", "term", ":", "Calculate", "the", "gradients", "of", "the", "empirical", "loss", ":", "Obtain", "step", "size", "scalar", "or", "matrix", "with", "standard", "neural", "net", "methods", "e.g.", "Adam", "Check", "convergence", "criterion", "section", ":", "Experiments", "Evaluating", "causal", "inference", "algorithms", "is", "more", "difficult", "than", "many", "machine", "learning", "tasks", ",", "since", "for", "real", "-", "world", "data", "we", "rarely", "have", "access", "to", "the", "ground", "truth", "treatment", "effect", ".", "Existing", "literature", "mostly", "deals", "with", "this", "in", "two", "ways", ".", "One", "is", "by", "using", "synthetic", "or", "semi", "-", "synthetic", "datasets", ",", "where", "the", "outcome", "or", "treatment", "assignment", "are", "fully", "known", ";", "we", "use", "the", "semi", "-", "synthetic", "IHDP", "dataset", "from", ".", "The", "other", "is", "using", "real", "-", "world", "data", "from", "randomized", "controlled", "trials", "(", "RCT", ")", ".", "The", "problem", "in", "using", "data", "from", "RCTs", "is", "that", "there", "is", "no", "imbalance", "between", "the", "treated", "and", "control", "distributions", ",", "making", "our", "method", "redundant", ".", "We", "partially", "overcome", "this", "problem", "by", "using", "the", "Jobs", "dataset", "from", ",", "which", "includes", "both", "a", "randomized", "and", "a", "non", "-", "randomized", "component", ".", "We", "use", "both", "for", "training", ",", "but", "can", "only", "use", "the", "randomized", "component", "for", "evaluation", ".", "This", "alleviates", ",", "but", "does", "not", "solve", ",", "the", "issue", "of", "a", "completely", "balanced", "dataset", "being", "unsuited", "for", "our", "method", ".", "We", "evaluate", "our", "framework", "CFR", ",", "and", "its", "variant", "without", "balancing", "regularization", "(", "TARNet", ")", ",", "in", "the", "task", "of", "estimating", "ITE", "and", "ATE", ".", "CFR", "is", "implemented", "as", "a", "feed", "-", "forward", "neural", "network", "with", "3", "fully", "-", "connected", "exponential", "-", "linear", "layers", "for", "the", "representation", "and", "3", "for", "the", "hypothesis", ".", "Layer", "sizes", "were", "200", "for", "all", "layers", "used", "for", "Jobs", "and", "200", "and", "100", "for", "the", "representation", "and", "hypothesis", "used", "for", "IHDP", ".", "The", "model", "is", "trained", "using", "Adam", ".", "For", "an", "overview", ",", "see", "Figure", "[", "reference", "]", ".", "Layers", "corresponding", "to", "the", "hypothesis", "are", "regularized", "with", "a", "small", "weight", "decay", ".", "For", "continuous", "data", "we", "use", "mean", "squared", "loss", "and", "for", "binary", "data", ",", "we", "use", "log", "-", "loss", ".", "While", "our", "theory", "does", "not", "immediately", "apply", "to", "log", "-", "loss", ",", "we", "were", "curious", "to", "see", "how", "our", "model", "performs", "with", "it", ".", "We", "compare", "our", "method", "to", "Ordinary", "Least", "Squares", "with", "treatment", "as", "a", "feature", "(", "OLS", "-", "1", ")", ",", "OLS", "with", "separate", "regressors", "for", "each", "treatment", "(", "OLS", "-", "2", ")", ",", "-", "nearest", "neighbor", "(", "-", "NN", ")", ",", "Targeted", "Maximum", "Likelihood", ",", "which", "is", "a", "doubly", "robust", "method", "(", "TMLE", ")", ",", "Bayesian", "Additive", "Regression", "Trees", "(", "BART", ")", ",", "Random", "Forests", "(", "Rand", ".", "For", ".", ")", ",", "Causal", "Forests", "(", "Caus", ".", "For", ".", ")", "as", "well", "as", "the", "Balancing", "Linear", "Regression", "(", "BLR", ")", "and", "Balancing", "Neural", "Network", "(", "BNN", ")", "by", ".", "For", "classification", "tasks", "we", "substitute", "Logistic", "Regression", "(", "LR", ")", "for", "OLS", ".", "Choosing", "hyperparameters", "for", "estimating", "PEHE", "is", "non", "-", "trivial", ";", "we", "detail", "our", "selection", "procedure", ",", "applied", "to", "all", "methods", ",", "in", "subsection", "C.1", "of", "the", "supplement", ".", "We", "evaluate", "our", "model", "in", "two", "different", "settings", ".", "One", "is", "within", "-", "sample", ",", "where", "the", "task", "is", "to", "estimate", "ITE", "for", "all", "units", "in", "a", "sample", "for", "which", "the", "(", "factual", ")", "outcome", "of", "one", "treatment", "is", "observed", ".", "This", "corresponds", "to", "the", "common", "scenario", "in", "which", "a", "cohort", "is", "selected", "once", "and", "not", "changed", ".", "This", "task", "is", "non", "-", "trivial", ",", "as", "we", "never", "observe", "the", "ITE", "for", "any", "unit", ".", "The", "other", "is", "the", "out", "-", "of", "-", "sample", "setting", ",", "where", "the", "goal", "is", "to", "estimate", "ITE", "for", "units", "with", "no", "observed", "outcomes", ".", "This", "corresponds", "to", "the", "case", "where", "a", "new", "patient", "arrives", "and", "the", "goal", "is", "to", "select", "the", "best", "possible", "treatment", ".", "Within", "-", "sample", "error", "is", "computed", "over", "both", "the", "training", "and", "validation", "sets", ",", "and", "out", "-", "of", "-", "sample", "error", "over", "the", "test", "set", ".", "subsection", ":", "Simulated", "outcome", ":", "IHDP", "compiled", "a", "dataset", "for", "causal", "effect", "estimation", "based", "on", "the", "Infant", "Health", "and", "Development", "Program", "(", "IHDP", ")", ",", "in", "which", "the", "covariates", "come", "from", "a", "randomized", "experiment", "studying", "the", "effects", "of", "specialist", "home", "visits", "on", "future", "cognitive", "test", "scores", ".", "The", "treatment", "groups", "have", "been", "made", "imbalanced", "by", "removing", "a", "biased", "subset", "of", "the", "treated", "population", ".", "The", "dataset", "comprises", "747", "units", "(", "139", "treated", ",", "608", "control", ")", "and", "25", "covariates", "measuring", "aspects", "of", "children", "and", "their", "mothers", ".", "We", "use", "the", "simulated", "outcome", "implemented", "as", "setting", "\u201c", "A", "\u201d", "in", "the", "NPCI", "package", ".", "Following", ",", "we", "use", "the", "noiseless", "outcome", "to", "compute", "the", "true", "effect", ".", "We", "report", "the", "estimated", "(", "finite", "-", "sample", ")", "PEHE", "loss", "(", "Eq", ".", "[", "reference", "]", ")", ",", "and", "the", "absolute", "error", "in", "average", "treatment", "effect", ".", "The", "results", "of", "the", "experiments", "on", "IHDP", "are", "presented", "in", "Table", "[", "reference", "]", "(", "left", ")", ".", "We", "average", "over", "1000", "realizations", "of", "the", "outcomes", "with", "63", "/", "27", "/", "10", "train", "/", "validation", "/", "test", "splits", ".", "We", "investigate", "the", "effects", "of", "increasing", "imbalance", "between", "the", "original", "treatment", "groups", "by", "constructing", "biased", "subsamples", "of", "the", "IHDP", "dataset", ".", "A", "logistic", "-", "regression", "propensity", "score", "model", "is", "fit", "to", "form", "estimates", "of", "the", "conditional", "treatment", "probability", ".", "Then", ",", "repeatedly", ",", "with", "probability", "we", "remove", "the", "remaining", "control", "observation", "that", "has", "closest", "to", ",", "and", "with", "probability", ",", "we", "remove", "a", "random", "control", "observation", ".", "The", "higher", ",", "the", "more", "imbalance", ".", "For", "each", "value", "of", ",", "we", "remove", "observations", "from", "each", "set", ",", "leaving", ".", "subsection", ":", "Real", "-", "world", "outcome", ":", "Jobs", "The", "study", "by", "is", "a", "widely", "used", "benchmark", "in", "the", "causal", "inference", "community", ",", "where", "the", "treatment", "is", "job", "training", "and", "the", "outcomes", "are", "income", "and", "employment", "status", "after", "training", ".", "This", "dataset", "combines", "a", "randomized", "study", "based", "on", "the", "National", "Supported", "Work", "program", "with", "observational", "data", "to", "form", "a", "larger", "dataset", ".", "The", "presence", "of", "the", "randomized", "subgroup", "gives", "a", "way", "to", "estimate", "the", "\u201c", "ground", "truth", "\u201d", "causal", "effect", ".", "The", "study", "includes", "8", "covariates", "such", "as", "age", "and", "education", ",", "as", "well", "as", "previous", "earnings", ".", "We", "construct", "a", "binary", "classification", "task", ",", "called", "Jobs", ",", "where", "the", "goal", "is", "to", "predict", "unemployment", ",", "using", "the", "feature", "set", "of", ".", "Following", ",", "we", "use", "the", "LaLonde", "experimental", "sample", "(", "297", "treated", ",", "425", "control", ")", "and", "the", "PSID", "comparison", "group", "(", "2490", "control", ")", ".", "There", "were", "482", "(", "15", "%", ")", "subjects", "unemployed", "by", "the", "end", "of", "the", "study", ".", "We", "average", "over", "10", "train", "/", "validation", "/", "test", "splits", "with", "ratios", "56", "/", "24", "/", "20", ".", "Because", "all", "the", "treated", "subjects", "were", "part", "of", "the", "original", "randomized", "sample", ",", "we", "can", "compute", "the", "true", "average", "treatment", "effect", "on", "the", "treated", "by", ",", "where", "is", "the", "control", "group", ".", "We", "report", "the", "error", ".", "We", "can", "not", "evaluate", "on", "this", "dataset", ",", "since", "there", "is", "no", "ground", "truth", "for", "the", "ITE", ".", "Instead", ",", "in", "order", "to", "evaluate", "the", "quality", "of", "ITE", "estimation", ",", "we", "use", "a", "measure", "we", "call", "policy", "risk", ".", "The", "policy", "risk", "is", "defined", "as", "the", "average", "loss", "in", "value", "when", "treating", "according", "to", "the", "policy", "implied", "by", "an", "ITE", "estimator", ".", "In", "our", "case", ",", "for", "a", "model", ",", "we", "let", "the", "policy", "be", "to", "treat", ",", ",", "if", ",", "and", "to", "not", "treat", ",", "otherwise", ".", "The", "policy", "risk", "is", "which", "we", "can", "estimate", "for", "the", "randomized", "trial", "subset", "of", "Jobs", "by", ".", "See", "figure", "[", "reference", "]", "for", "risk", "as", "a", "function", "of", "treatment", "threshold", ",", "aligned", "by", "proportion", "of", "treated", ",", "and", "Table", "[", "reference", "]", "for", "the", "risk", "when", ".", "subsection", ":", "Results", "We", "begin", "by", "noting", "that", "indeed", "imbalance", "confers", "an", "advantage", "to", "using", "the", "IPM", "regularization", "term", ",", "as", "our", "theoretical", "results", "indicate", ",", "see", "e.g.", "the", "results", "for", "CFR", "Wass", "(", ")", "and", "TARNet", "(", ")", "on", "IHDP", "in", "Table", "[", "reference", "]", ".", "We", "also", "see", "in", "Figure", "[", "reference", "]", "that", "even", "for", "the", "harder", "case", "of", "increased", "imbalance", "(", ")", "between", "treated", "and", "control", ",", "the", "relative", "gain", "from", "using", "our", "method", "remains", "significant", ".", "On", "Jobs", ",", "we", "see", "a", "smaller", "gain", "from", "using", "IPM", "penalties", "than", "on", "IHDP", ".", "We", "believe", "this", "is", "the", "case", "because", ",", "while", "we", "are", "minimizing", "our", "bound", "over", "observational", "data", "and", "accounting", "for", "this", "bias", ",", "we", "are", "evaluating", "the", "predictions", "only", "on", "a", "randomized", "subset", ",", "where", "the", "treatment", "groups", "are", "distributed", "identically", ".", "For", "both", "IHDP", ",", "non", "-", "linear", "estimators", "do", "significantly", "better", "than", "linear", "ones", "in", "terms", "of", "individual", "effect", "(", ")", ".", "On", "the", "Jobs", "dataset", ",", "straightforward", "logistic", "regression", "does", "remarkably", "well", "in", "estimating", "the", "ATT", ".", "However", ",", "being", "a", "linear", "model", ",", "LR", "can", "only", "ascribe", "a", "uniform", "policy", "-", "in", "this", "case", ",", "\u201c", "treat", "everyone", "\u201d", ".", "The", "more", "nuanced", "policies", "offered", "by", "non", "-", "linear", "methods", "achieve", "lower", "policy", "risk", "in", "the", "case", "of", "Causal", "Forests", "and", "CFR", ".", "This", "emphasizes", "the", "fact", "that", "estimating", "average", "effect", "and", "individual", "effect", "can", "require", "different", "models", ".", "Specifically", ",", "while", "smoothing", "over", "many", "units", "may", "yield", "a", "good", "ATE", "estimate", ",", "this", "might", "significantly", "hurt", "ITE", "estimation", ".", "-", "nearest", "neighbors", "has", "very", "good", "within", "-", "sample", "results", "on", "Jobs", ",", "because", "evaluation", "is", "performed", "over", "the", "randomized", "component", ",", "but", "suffers", "heavily", "in", "generalizing", "out", "of", "sample", ",", "as", "expected", ".", "section", ":", "Conclusion", "In", "this", "paper", "we", "give", "a", "meaningful", "and", "intuitive", "error", "bound", "for", "the", "problem", "of", "estimating", "individual", "treatment", "effect", ".", "Our", "bound", "relates", "ITE", "estimation", "to", "the", "classic", "machine", "learning", "problem", "of", "learning", "from", "finite", "samples", ",", "along", "with", "methods", "for", "measuring", "distributional", "distances", "from", "finite", "samples", ".", "The", "bound", "lends", "itself", "naturally", "to", "the", "creation", "of", "learning", "algorithms", ";", "we", "focus", "on", "using", "neural", "nets", "as", "representations", "and", "hypotheses", ".", "We", "apply", "our", "theory", "-", "guided", "approach", "to", "both", "synthetic", "and", "real", "-", "world", "tasks", ",", "showing", "that", "in", "every", "case", "our", "method", "matches", "or", "outperforms", "the", "state", "-", "of", "-", "the", "-", "art", ".", "Important", "open", "questions", "are", "theoretical", "considerations", "in", "choosing", "the", "IPM", "weight", ",", "how", "to", "best", "derive", "confidence", "intervals", "for", "our", "model", "\u2019s", "predictions", ",", "and", "how", "to", "integrate", "our", "work", "with", "more", "complicated", "causal", "models", "such", "as", "those", "with", "hidden", "confounding", "or", "instrumental", "variables", ".", "subsubsection", ":", "Acknowledgments", "We", "wish", "to", "thank", "Aahlad", "Manas", "for", "his", "assistance", "with", "the", "experiments", ".", "We", "also", "thank", "Jennifer", "Hill", ",", "Marco", "Cuturi", ",", "Esteban", "Tabak", "and", "Sanjong", "Misra", "for", "fruitful", "conversations", ",", "and", "Stefan", "Wager", "for", "his", "help", "with", "the", "code", "for", "Causal", "Forests", ".", "DS", "and", "US", "were", "supported", "by", "NSF", "CAREER", "award", "#", "1350965", ".", "bibliography", ":", "References", "appendix", ":", "Proofs", "subsection", ":", "Definitions", ",", "assumptions", ",", "and", "auxiliary", "lemmas", "Notation:\u2062p", "(", "x", ",", "t", ")", ":", "distribution", "on", "\u00d7X{0", ",", "1}u", "=", "p", "(", "t=1", ")", ":", "the", "marginal", "probability", "of", "treatment.p", "=", "t1", "(", "x", ")", "=p", "(", "x|t=1", ")", ":", "treated", "distribution", ".", "p", "=", "t0", "(", "x", ")", "=p", "(", "x|t=0", ")", ":", "control", "distribution", ".", "\u03a6", ":", "representation", "function", "mapping", "from", "X", "to", "R.\u03a8", ":", "the", "inverse", "function", "of", "\u03a6", ",", "mapping", "from", "R", "to", "X.\u2062p\u03a6", "(", "r", ",", "t", ")", ":", "the", "distribution", "induced", "by", "\u03a6", "on", "\u00d7R{0", ",", "1}.\u2062p", "=", "t1\u03a6", "(", "r", ")", ",", "\u2062p", "=", "t0\u03a6", "(", "r", ")", ":", "treated", "and", "control", "distributions", "induced", "by", "\u03a6", "on", "R.\u2062L", "(", "\u22c5", ",", "\u22c5", ")", ":", "loss", "function", ",", "from", "\u00d7YY", "to", "R", "+", ".\u2062\u2113h", ",", "\u03a6", "(", "x", ",", "t", ")", ":", "the", "expected", "loss", "of", "\u2062h", "(", "\u2062\u03a6", "(", "x", "),", "t", ")", "for", "the", "unit", "x", "and", "treatment", "t.\u2062\u03f5F", "(", "h", ",", "\u03a6", ")", ",", "\u2062\u03f5\u2062CF", "(", "h", ",", "\u03a6", ")", ":", "expected", "factual", "and", "counterfactual", "loss", "of", "\u2062h", "(", "\u2062\u03a6", "(", "x", "),", "t", ")", ".\u03c4", "(", "x", ")", ":=E", "[", "Y1", "-", "Y0|x", "]", ",", "the", "expected", "treatment", "effect", "for", "unit", "x.\u2062\u03f5PEHE", "(", "f", ")", ":", "expected", "error", "in", "estimating", "the", "individual", "treatment", "effect", "of", "a", "function", "\u2062f", "(", "x", ",", "t", ")", ".\u2062IPMG", "(", "p", ",", "q", ")", ":", "the", "integral", "probability", "metric", "distance", "induced", "by", "function", "family", "G", "between", "distributions", "p", "and", "q.", "Notation", ":", ":", "distribution", "on", ":", "the", "marginal", "probability", "of", "treatment", ".", ":", "treated", "distribution", ".", ":", "control", "distribution", ".", ":", "representation", "function", "mapping", "from", "to", ".", ":", "the", "inverse", "function", "of", ",", "mapping", "from", "to", ".", ":", "the", "distribution", "induced", "by", "on", ".", ",", ":", "treated", "and", "control", "distributions", "induced", "by", "on", ".", ":", "loss", "function", ",", "from", "to", ".", ":", "the", "expected", "loss", "of", "for", "the", "unit", "and", "treatment", ".", ",", ":", "expected", "factual", "and", "counterfactual", "loss", "of", ".", ",", "the", "expected", "treatment", "effect", "for", "unit", ".", ":", "expected", "error", "in", "estimating", "the", "individual", "treatment", "effect", "of", "a", "function", ".", ":", "the", "integral", "probability", "metric", "distance", "induced", "by", "function", "family", "between", "distributions", "and", ".", "We", "first", "define", "the", "necessary", "distributions", "and", "prove", "some", "simple", "results", "about", "them", ".", "We", "assume", "a", "joint", "distribution", "function", ",", "such", "that", ",", "and", "for", "all", ".", "Recall", "that", "we", "assume", "Consistency", ",", "that", "is", "we", "assume", "that", "we", "observe", "and", ".", "theorem", ":", ".", "The", "treatment", "effect", "for", "unit", "x", "is", ":", "We", "first", "show", "that", "under", "consistency", "and", "strong", "ignorability", ",", "the", "ITE", "function", "is", "identifiable", ":", "theorem", ":", ".", "We", "have", ":", "Equality", "(", ")", "is", "because", "we", "assume", "that", "Yt", "and", "t", "are", "independent", "conditioned", "on", "x.", "Equality", "(", ")", "follows", "from", "the", "consistency", "assumption", ".", "Finally", ",", "the", "last", "equation", "is", "composed", "entirely", "of", "observable", "quantities", "and", "can", "be", "estimated", "from", "data", "since", "we", "assume", "0<p", "(", "t=1|x", ")", "<1", "for", "all", "x.", "theorem", ":", ".", "Let", "p", "=", "t1", "(", "x", ")", ":=p", "(", "x|t=1", ")", ",", "and", "p", "=", "t0", "(", "x", ")", ":=p", "(", "x|t=0", ")", "denote", "respectively", "the", "treatment", "and", "control", "distributions", ".", "Let", "be", "a", "representation", "function", ".", "We", "will", "assume", "that", "is", "differentiable", ".", "theorem", ":", ".", "The", "representation", "function", "\u03a6", "is", "one", "-", "to", "-", "one", ".", "Without", "loss", "of", "generality", "we", "will", "assume", "that", "R", "is", "the", "image", "of", "X", "under", "\u03a6", ",", "and", "define", ":", "\u03a8\u2192RX", "to", "be", "the", "inverse", "of", "\u03a6", ",", "such", "that", "=", "\u2062\u03a8", "(", "\u2062\u03a6", "(", "x", "))", "x", "for", "all", "\u2208xX.", "theorem", ":", ".", "For", "a", "representation", "function", ":", "\u03a6\u2192XR", ",", "and", "for", "a", "distribution", "p", "defined", "over", "X", ",", "let", "p\u03a6", "be", "the", "distribution", "induced", "by", "\u03a6", "over", "R.", "Define", "p", "=", "t1\u03a6", "(", "r", ")", ":=p\u03a6", "(", "r|t=1", ")", ",", "p", "=", "t0\u03a6", "(", "r", ")", ":=p\u03a6", "(", "r|t=0", ")", ",", "to", "be", "the", "treatment", "and", "control", "distributions", "induced", "over", "R.", "For", "a", "one", "-", "to", "-", "one", ",", "the", "distribution", "over", "can", "be", "obtained", "by", "the", "standard", "change", "of", "variables", "formula", ",", "using", "the", "determinant", "of", "the", "Jacobian", "of", ".", "See", "for", "the", "case", "of", "a", "mapping", "between", "spaces", "of", "different", "dimensions", ".", "theorem", ":", ".", "For", "all", "\u2208rR", ",", "\u2208t{0", ",", "1", "}", ":", "proof", ":", "Proof", ".", "Let", "be", "the", "absolute", "of", "the", "determinant", "of", "the", "Jacobian", "of", ".", "where", "equality", "(", "a", ")", "is", "by", "the", "change", "of", "variable", "formula", ".", "The", "proof", "is", "identical", "for", ".", "\u220e", "Let", "be", "a", "loss", "function", ",", "e.g.", "the", "absolute", "loss", "or", "squared", "loss", ".", "theorem", ":", ".", "Let", ":", "\u03a6\u2192XR", "be", "a", "representation", "function", ".", "Let", ":", "h\u2192\u00d7R{0", ",", "1}Y", "be", "an", "hypothesis", "defined", "over", "the", "representation", "space", "R.", "The", "expected", "loss", "for", "the", "unit", "and", "treatment", "pair", "(", "x", ",", "t", ")", "is", ":", "theorem", ":", ".", "The", "expected", "factual", "loss", "and", "counterfactual", "losses", "of", "h", "and", "\u03a6", "are", ",", "respectively", ":", "When", "it", "is", "clear", "from", "the", "context", ",", "we", "will", "sometimes", "use", "and", "for", "the", "expected", "factual", "and", "counterfactual", "losses", "of", "an", "arbitrary", "function", ".", "theorem", ":", ".", "The", "expected", "treated", "and", "control", "losses", "are", ":", "The", "four", "losses", "above", "are", "simply", "the", "loss", "conditioned", "on", "either", "the", "control", "or", "treated", "set", ".", "Let", "be", "the", "proportion", "of", "treated", "in", "the", "population", ".", "We", "then", "have", "the", "immediate", "result", ":", "theorem", ":", ".", "The", "proof", "is", "immediate", ",", "noting", "that", ",", "and", "from", "the", "Definitions", "[", "reference", "]", "and", "[", "reference", "]", "of", "the", "losses", ".", "theorem", ":", ".", "Let", "G", "be", "a", "function", "family", "consisting", "of", "functions", ":", "g\u2192SR", ".", "For", "a", "pair", "of", "distributions", "p1", ",", "p2", "over", "S", ",", "define", "the", "Integral", "Probability", "Metric", ":", "defines", "a", "pseudo", "-", "metric", "on", "the", "space", "of", "probability", "functions", "over", ",", "and", "for", "sufficiently", "large", "function", "families", ",", "is", "a", "proper", "metric", ".", "Examples", "of", "sufficiently", "large", "functions", "families", "includes", "the", "set", "of", "bounded", "continuous", "functions", ",", "the", "set", "of", "-", "Lipschitz", "functions", ",", "and", "the", "set", "of", "unit", "norm", "functions", "in", "a", "universal", "Reproducing", "Norm", "Hilbert", "Space", ".", "The", "latter", "two", "give", "rise", "to", "the", "Wasserstein", "and", "Maximum", "Mean", "Discrepancy", "metrics", ",", "respectively", ".", "We", "note", "that", "for", "function", "families", "such", "as", "the", "three", "mentioned", "above", ",", "for", "which", ",", "the", "absolute", "value", "can", "be", "omitted", "from", "definition", "[", "reference", "]", ".", "subsection", ":", "General", "IPM", "bound", "We", "now", "state", "and", "prove", "the", "most", "important", "technical", "lemma", "of", "this", "section", ".", "theorem", ":", "(", "Lemma", "1", ",", "main", "text", ")", ".", "Let", ":", "\u03a6\u2192XR", "be", "an", "invertible", "representation", "with", "\u03a8", "its", "inverse", ".", "Let", "p", "=", "t1\u03a6", ",", "p", "=", "t0\u03a6", "be", "defined", "as", "in", "Definition", ".", "Let", "u", "=", "p", "(", "t=1", ")", ".", "Let", "G", "be", "a", "family", "of", "functions", ":", "g\u2192RR", ",", "and", "denote", "by", "\u2062IPMG", "(", "\u22c5", ",", "\u22c5", ")", "the", "integral", "probability", "metric", "induced", "by", "G.", "Let", ":", "h\u2192\u00d7R{0", ",", "1}Y", "be", "an", "hypothesis", ".", "Assume", "there", "exists", "a", "constant", ">", "B\u03a60", ",", "such", "that", "for", "=", "t0", ",", "1", ",", "the", "function", "\u2062g\u03a6", ",", "h", "(", "r", ",", "t", ")", ":=\u2062\u22c51B\u03a6\u2113h", ",", "\u03a6", "(", "\u2062\u03a8", "(", "r", "),", "t", ")", "\u2208G.", "Then", "we", "have", ":", "proof", ":", "Proof", ".", "Equality", "(", "[", "reference", "]", ")", "is", "by", "Definition", "[", "reference", "]", "of", "the", "treated", "and", "control", "loss", ",", "equality", "(", "[", "reference", "]", ")", "is", "by", "the", "change", "of", "variables", "formula", "and", "Definition", "[", "reference", "]", "of", "and", ",", "inequality", "(", "[", "reference", "]", ")", "is", "by", "the", "premise", "that", "for", ",", "and", "(", "[", "reference", "]", ")", "is", "by", "Definition", "[", "reference", "]", "of", "an", "IPM", ".", "\u220e", "The", "essential", "point", "in", "the", "proof", "of", "Lemma", "[", "reference", "]", "is", "inequality", "[", "reference", "]", ".", "Note", "that", "on", "the", "l.h.s", ".", "of", "the", "inequality", ",", "we", "need", "to", "evaluate", "the", "expectations", "of", "over", "and", "over", ".", "Both", "of", "these", "expectations", "are", "in", "general", "unavailable", ",", "since", "they", "require", "us", "to", "evaluate", "treatment", "outcomes", "on", "the", "control", ",", "and", "control", "outcomes", "on", "the", "treated", ".", "We", "therefore", "upper", "bound", "these", "unknowable", "quantities", "by", "taking", "a", "supremum", "over", "a", "function", "family", "which", "includes", "and", ".", "The", "upper", "bound", "ignores", "most", "of", "the", "details", "of", "the", "outcome", ",", "and", "amounts", "to", "measuring", "a", "distance", "between", "two", "distributions", "we", "have", "samples", "from", ":", "the", "control", "and", "treated", "distribution", ".", "Note", "that", "for", "a", "randomized", "trial", "(", "i.e.", "when", ")", "with", "we", "have", "that", ".", "Indeed", ",", "it", "is", "straightforward", "to", "show", "that", "in", "that", "case", "we", "actually", "have", "an", "equality", ":", ".", "The", "crucial", "condition", "in", "Lemma", "[", "reference", "]", "is", "that", "the", "function", "is", "in", ".", "In", "subsections", "[", "reference", "]", "and", "[", "reference", "]", "below", "we", "look", "into", "two", "specific", "function", "families", ",", "and", "evaluate", "what", "does", "this", "inclusion", "condition", "entail", ",", "and", "in", "particular", "we", "will", "derive", "specific", "bounds", "for", ".", "theorem", ":", ".", "For", "=", "t0", ",", "1", "define", ":", "Obviously", "for", "the", "treatment", "effect", "we", "have", ".", "Let", "by", "an", "hypothesis", ",", "such", "that", "for", "a", "representation", "and", "hypothesis", "defined", "over", "the", "output", "of", ".", "theorem", ":", ".", "The", "treatment", "effect", "estimate", "for", "unit", "x", "is", ":", "theorem", ":", ".", "The", "expected", "Precision", "in", "Estimation", "of", "Heterogeneous", "Effect", "(", "PEHE", ")", "loss", "of", "g", "is", ":", "theorem", ":", ".", "The", "expected", "variance", "of", "Yt", "with", "respect", "to", "a", "distribution", "\u2062p", "(", "x", ",", "t", ")", ":", "We", "define", ":", "If", "are", "deterministic", "functions", "of", ",", "then", ".", "We", "now", "show", "that", "is", "upper", "bounded", "by", "where", "and", "are", "w.r.t", ".", "to", "the", "squared", "loss", ".", "An", "analogous", "result", "can", "be", "obtained", "for", "the", "absolute", "loss", ",", "using", "mean", "absolute", "deviation", ".", "theorem", ":", ".", "For", "any", "function", ":", "f\u2192\u00d7X{0", ",", "1}Y", ",", "and", "distribution", "\u2062p", "(", "x", ",", "t", ")", "over", "\u00d7X{0", ",", "1", "}", ":", "where", "\u2062\u03f5F", "(", "f", ")", "and", "\u2062\u03f5\u2062CF", "(", "f", ")", "are", "w.r.t", ".", "to", "the", "squared", "loss", ".", "proof", ":", "Proof", ".", "For", "simplicity", "we", "will", "prove", "for", "and", ".", "The", "proof", "for", "and", "is", "identical", ".", "where", "the", "equality", "(", "[", "reference", "]", ")", "is", "by", "the", "Definition", "[", "reference", "]", "of", ",", "and", "because", "the", "integral", "in", "(", "[", "reference", "]", ")", "evaluates", "to", "zero", ",", "since", ".", "\u220e", "theorem", ":", ".", "Let", ":", "\u03a6\u2192XR", "be", "a", "one", "-", "to", "-", "one", "representation", "function", ",", "with", "inverse", "\u03a8.", "Let", "p", "=", "t1\u03a6", ",", "p", "=", "t0\u03a6", "be", "defined", "as", "in", "Definition", ".", "Let", "u", "=", "p", "(", "t=1", ")", ".", "Let", "G", "be", "a", "family", "of", "functions", ":", "g\u2192RR", ",", "and", "denote", "by", "\u2062IPMG", "(", "\u22c5", ",", "\u22c5", ")", "the", "integral", "probability", "metric", "induced", "by", "G.", "Let", ":", "h\u2192\u00d7R{0", ",", "1}Y", "be", "an", "hypothesis", ".", "Let", "the", "loss", "=", "\u2062L", "(", "y1", ",", "y2", ")(-", "y1y2", ")", "2", ".", "Assume", "there", "exists", "a", "constant", ">", "B\u03a60", ",", "such", "that", "for", "\u2208t{0", ",", "1", "}", ",", "the", "functions", "\u2062g\u03a6", ",", "h", "(", "r", ",", "t", ")", ":=\u2062\u22c51B\u03a6\u2113h", ",", "\u03a6", "(", "\u2062\u03a8", "(", "r", "),", "t", ")", "\u2208G.", "We", "then", "have", ":", "where", "\u03f5F", "and", "\u03f5\u2062CF", "are", "with", "respect", "to", "the", "squared", "loss", ".", "proof", ":", "Proof", ".", "We", "will", "prove", "the", "first", "inequality", ",", ".", "The", "second", "inequality", "is", "then", "immediate", "by", "Lemma", "[", "reference", "]", ".", "Recall", "that", "we", "denote", "for", ".", "where", "(", "[", "reference", "]", ")", "is", "because", ",", "(", "[", "reference", "]", ")", "is", "because", "and", "(", "[", "reference", "]", ")", "is", "by", "Lemma", "[", "reference", "]", "and", "Definition", "[", "reference", "]", "of", "the", "losses", ",", "and", "Definition", "[", "reference", "]", "of", ".", "Having", "established", "the", "first", "inequality", "in", "the", "Theorem", "statement", ",", "we", "now", "show", "the", "second", ".", "We", "have", "by", "Lemma", "[", "reference", "]", "that", ":", "We", "further", "have", "by", "Lemma", "[", "reference", "]", "that", ":", "Therefore", "\u220e", "The", "upper", "bound", "is", "in", "terms", "of", "the", "standard", "generalization", "error", "on", "the", "treated", "and", "control", "distributions", "separately", ".", "Note", "that", "in", "some", "cases", "we", "might", "have", "very", "different", "sample", "sizes", "for", "treated", "and", "control", ",", "and", "that", "will", "show", "up", "in", "the", "finite", "sample", "bounds", "of", "these", "generalization", "errors", ".", "We", "also", "note", "that", "the", "upper", "bound", "can", "be", "easily", "adapted", "to", "the", "case", "of", "the", "absolute", "loss", "PEHE", ".", "In", "that", "case", "the", "upper", "bound", "in", "the", "Theorem", "will", "have", "a", "factor", "instead", "of", "the", "stated", "above", ",", "and", "the", "standard", "deviation", "replaced", "by", "mean", "absolute", "deviation", ".", "The", "proof", "is", "straightforward", "where", "one", "simply", "applies", "the", "triangle", "inequality", "in", "inequality", "(", "[", "reference", "]", ")", ".", "We", "will", "now", "give", "specific", "upper", "bounds", "for", "the", "constant", "in", "Theorem", "[", "reference", "]", ",", "using", "two", "function", "families", "in", "the", "IPM", ":", "the", "family", "of", "-", "Lipschitz", "functions", ",", "and", "the", "family", "of", "-", "norm", "reproducing", "kernel", "Hilbert", "space", "functions", ".", "Each", "one", "will", "have", "different", "assumptions", "about", "the", "distribution", "and", "about", "the", "representation", "and", "hypothesis", ".", "subsection", ":", "The", "family", "of", "-", "Lipschitz", "functions", "For", ",", "a", "function", "has", "Lipschitz", "constant", "if", "for", "all", ",", ".", "If", "is", "differentiable", ",", "then", "a", "sufficient", "condition", "for", "-", "Lipschitz", "constant", "is", "if", "for", "all", ".", "For", "simplicity", "\u2019s", "sake", "we", "assume", "throughout", "this", "subsection", "that", "the", "true", "labeling", "functions", "the", "densities", "and", "the", "loss", "are", "differentiable", ".", "However", ",", "this", "assumption", "could", "be", "relaxed", "to", "a", "mere", "Lipschitzness", "assumption", ".", "theorem", ":", ".", "There", "exists", "a", "constant", ">", "K0", "such", "that", "for", "all", "\u2208xX", ",", "\u2208t{0", ",", "1", "}", ",", "\u2264\u2225p", "(", "Yt|x", ")", "\u2202x\u2225K.", "Assumption", "[", "reference", "]", "entails", "that", "each", "of", "the", "potential", "outcomes", "change", "smoothly", "as", "a", "function", "of", "the", "covariates", "(", "context", ")", ".", "theorem", ":", ".", "The", "loss", "function", "L", "is", "differentiable", ",", "and", "there", "exists", "a", "constant", ">", "KL0", "such", "that", "\u2264|\u2062dL", "(", "y1", ",", "y2", ")", "\u2062dyi|KL", "for", "=", "i1", ",", "2", ".", "Additionally", ",", "there", "exists", "a", "constant", "M", "such", "that", "for", "all", "\u2208y2Y", ",", "\u2265M\u222bY\u2062L", "(", "y1", ",", "y2", ")", "dy1", ".", "Assuming", "is", "compact", ",", "loss", "functions", "which", "obey", "Assumption", "[", "reference", "]", "include", "the", "log", "-", "loss", ",", "hinge", "-", "loss", ",", "absolute", "loss", ",", "and", "the", "squared", "loss", ".", "When", "we", "let", "in", "Definition", "[", "reference", "]", "be", "the", "family", "of", "-", "Lipschitz", "functions", ",", "we", "obtain", "the", "so", "-", "called", "1", "-", "Wasserstein", "distance", "between", "distributions", ",", "which", "we", "denote", ".", "It", "is", "well", "known", "that", "is", "indeed", "a", "metric", "between", "distributions", ".", "theorem", ":", ".", "Let", "\u2062\u2202\u03a6", "(", "x", ")", "\u2202x", "be", "the", "Jacobian", "matrix", "of", "\u03a6", "at", "point", "x", ",", "i.e.", "the", "matrix", "of", "the", "partial", "derivatives", "of", "\u03a6.", "Let", "\u2062\u03c3\u2062max", "(", "A", ")", "and", "\u2062\u03c3\u2062min", "(", "A", ")", "denote", "respectively", "the", "largest", "and", "smallest", "singular", "values", "of", "a", "matrix", "A.", "Define", "=", "\u2062\u03c1", "(", "\u03a6", ")", "sup\u2208xX\u2062", "/", "\u2062\u03c3\u2062max", "(", "\u2062\u2202\u03a6", "(", "x", ")", "\u2202x", ")", "\u03c3\u2062min", "(", "\u2062\u2202\u03a6", "(", "x", ")", "\u2202x", ")", ".", "It", "is", "an", "immediate", "result", "that", ".", "theorem", ":", ".", "We", "will", "call", "a", "representation", "function", ":", "\u03a6\u2192XR", "Jacobian", "-", "normalized", "if", "=", "sup\u2208xX\u2062\u03c3\u2062max", "(", "\u2062\u2202\u03a6", "(", "x", ")", "\u2202x", ")", "1", ".", "Note", "that", "any", "non", "-", "constant", "representation", "function", "can", "be", "Jacobian", "-", "normalized", "by", "a", "simple", "scalar", "multiplication", ".", "theorem", ":", ".", "Assume", "that", "\u03a6", "is", "a", "Jacobian", "-", "normalized", "representation", ",", "and", "let", "\u03a8", "be", "its", "inverse", ".", "For", "=", "t0", ",", "1", ",", "the", "Lipschitz", "constant", "of", "p", "(", "Yt|\u03a8", "(", "r", ")", ")", "is", "bounded", "by", "\u2062\u03c1", "(", "\u03a6", ")", "K", ",", "where", "K", "is", "from", "Assumption", ",", "and", "\u2062\u03c1", "(", "\u03a6", ")", "as", "in", "Definition", ".", "proof", ":", "Proof", ".", "Let", "be", "the", "inverse", "of", ",", "which", "exists", "by", "the", "assumption", "that", "is", "one", "-", "to", "-", "one", ".", "Let", "be", "the", "Jacobian", "matrix", "of", "evaluated", "at", ",", "and", "similarly", "let", "be", "the", "Jacobian", "matrix", "of", "evaluated", "at", ".", "Note", "that", "for", ",", "since", "is", "the", "identity", "function", "on", ".", "Therefore", "for", "any", "and", ":", "where", "and", "are", "respectively", "the", "largest", "and", "smallest", "singular", "values", "of", "the", "matrix", ",", "i.e.", "is", "the", "spectral", "norm", "of", ".", "For", "and", ",", "we", "have", "by", "the", "chain", "rule", ":", "where", "inequality", "(", "[", "reference", "]", ")", "is", "by", "the", "matrix", "norm", "inequality", ",", "equality", "(", "[", "reference", "]", ")", "is", "by", "(", "[", "reference", "]", ")", ",", "inequality", "(", "[", "reference", "]", ")", "is", "by", "assumption", "[", "reference", "]", "on", "the", "norms", "of", "the", "gradient", "of", "w.r.t", ",", "and", "inequality", "(", "[", "reference", "]", ")", "is", "by", "Definition", "[", "reference", "]", "of", ",", "the", "assumption", "that", "is", "Jacobian", "-", "normalized", ",", "and", "noting", "that", "singular", "values", "are", "necessarily", "non", "-", "negative", ".", "\u220e", "theorem", ":", ".", "Under", "the", "conditions", "of", "Lemma", ",", "further", "assume", "that", "for", "=", "t0", ",", "1", ",", "p", "(", "Yt|x", ")", "has", "gradients", "bounded", "by", "K", "as", "in", ",", "that", "h", "has", "bounded", "gradient", "norm", "\u2062bK", ",", "that", "the", "loss", "L", "has", "bounded", "gradient", "norm", "KL", ",", "and", "that", "\u03a6", "is", "Jacobian", "-", "normalized", ".", "Then", "the", "Lipschitz", "constant", "of", "\u2062\u2113h", ",", "\u03a6", "(", "\u2062\u03a8", "(", "r", "),", "t", ")", "is", "upper", "bounded", "by", "\u2062\u22c5KLK", "(+", "\u2062M\u03c1", "(", "\u03a6", ")", "b", ")", "for", "=", "t0", ",", "1", ".", "proof", ":", "Proof", ".", "Using", "the", "chain", "rule", ",", "we", "have", "that", ":", "where", "inequality", "[", "reference", "]", "is", "due", "to", "Assumption", "[", "reference", "]", "and", "inequality", "[", "reference", "]", "is", "due", "to", "Lemma", "[", "reference", "]", ".", "\u220e", "theorem", ":", ".", "Let", "u", "=", "p", "(", "t=1", ")", "be", "the", "marginal", "probability", "of", "treatment", ",", "and", "assume", "0<u<1", ".", "Let", ":", "\u03a6\u2192XR", "be", "a", "one", "-", "to", "-", "one", ",", "Jacobian", "-", "normalized", "representation", "function", ".", "Let", "K", "be", "the", "Lipschitz", "constant", "of", "the", "functions", "p", "(", "Yt|x", ")", "on", "X.", "Let", "KL", "be", "the", "Lipschitz", "constant", "of", "the", "loss", "function", "L", ",", "and", "M", "be", "as", "in", "Assumption", ".", "Let", ":", "h\u2192\u00d7R{0", ",", "1}R", "be", "an", "hypothesis", "with", "Lipschitz", "constant", "\u2062bK.", "Then", ":", "proof", ":", "Proof", ".", "We", "will", "apply", "Lemma", "[", "reference", "]", "with", ".", "By", "Lemma", "[", "reference", "]", ",", "we", "have", "that", "for", ",", "the", "function", ".", "Inequality", "(", "[", "reference", "]", ")", "then", "holds", "as", "a", "special", "case", "of", "Lemma", "[", "reference", "]", ".", "\u220e", "theorem", ":", ".", "Under", "the", "assumptions", "of", "Lemma", ",", "using", "the", "squared", "loss", "for", "\u03f5F", ",", "we", "have", ":", "proof", ":", "Proof", ".", "Plug", "in", "the", "upper", "bound", "of", "Lemma", "[", "reference", "]", "into", "the", "upper", "bound", "of", "Theorem", "[", "reference", "]", ".", "\u220e", "We", "examine", "the", "constant", "in", "Theorem", "[", "reference", "]", ".", ",", "the", "Lipschitz", "constant", "of", "and", ",", "is", "not", "under", "our", "control", "and", "measures", "an", "aspect", "of", "the", "complexity", "of", "the", "true", "underlying", "functions", "we", "wish", "to", "approximate", ".", "The", "terms", "and", "depend", "on", "our", "choice", "of", "loss", "function", "and", "the", "size", "of", "the", "space", ".", "The", "term", "comes", "from", "our", "assumption", "that", "the", "hypothesis", "has", "norm", ".", "Note", "that", "smaller", ",", "while", "reducing", "the", "bound", ",", "might", "force", "the", "factual", "loss", "term", "to", "be", "larger", "since", "a", "small", "implies", "a", "less", "flexible", ".", "Finally", ",", "consider", "the", "term", ".", "The", "assumption", "that", "is", "normalized", "is", "rather", "natural", ",", "as", "we", "do", "not", "expect", "a", "certain", "scale", "from", "a", "representation", ".", "Furthermore", ",", "below", "we", "show", "that", "in", "fact", "the", "Wasserstein", "distance", "is", "positively", "homogeneous", "with", "respect", "to", "the", "representation", ".", "Therefore", ",", "in", "Lemma", "[", "reference", "]", ",", "we", "can", "indeed", "assume", "that", "is", "normalized", ".", "The", "specific", "choice", "of", "Jacobian", "-", "normalized", "scaling", "yields", "what", "is", "in", "our", "opinion", "a", "more", "interpretable", "result", "in", "terms", "of", "the", "inverse", "condition", "number", ".", "For", "twice", "-", "differentiable", ",", "is", "minimized", "if", "and", "only", "if", "is", "a", "linear", "orthogonal", "transformation", ".", "theorem", ":", ".", "The", "Wasserstein", "distance", "is", "positive", "homogeneous", "for", "scalar", "transformations", "of", "the", "underlying", "space", ".", "Let", "p", ",", "q", "be", "probability", "density", "functions", "defined", "over", "X.", "For", ">", "\u03b10", "and", "the", "mapping", "=", "\u2062\u03a6", "(", "x", ")", "\u2062\u03b1x", ",", "let", "p\u03b1", "and", "q\u03b1", "be", "the", "distributions", "on", "\u2062\u03b1X", "induced", "by", "\u03a6.", "Then", ":", "proof", ":", "Proof", ".", "Following", ",", "we", "use", "another", "characterization", "of", "the", "Wasserstein", "distance", ".", "Let", "be", "the", "set", "of", "mass", "preserving", "maps", "from", "to", "itself", "which", "map", "the", "distribution", "to", "the", "distribution", ".", "That", "is", ",", ".", "We", "then", "have", "that", ":", "It", "is", "known", "that", "the", "infimum", "in", "(", "[", "reference", "]", ")", "is", "actually", "achievable", ".", "Denote", "by", "the", "map", "achieving", "the", "infimum", "for", ".", "Define", ",", "by", ",", "where", ".", "maps", "to", ",", "and", "we", "have", "that", ".", "Therefore", "achieves", "the", "infimum", "for", "the", "pair", ",", "and", "we", "have", "that", ".", "\u220e", "subsection", ":", "Functions", "in", "the", "unit", "ball", "of", "a", "RKHS", "Let", "be", "a", "reproducing", "kernel", "Hilbert", "space", ",", "with", "corresponding", "kernels", ",", ".", "We", "have", "for", "all", "that", "is", "its", "Hilbert", "space", "mapping", ",", "and", "similarly", "for", "all", ".", "Recall", "that", "the", "major", "condition", "in", "Lemma", "[", "reference", "]", "is", "that", ".", "The", "function", "space", "we", "use", "here", "is", ".", "We", "will", "focus", "on", "the", "case", "where", "is", "the", "squared", "loss", ",", "and", "we", "will", "make", "the", "following", "two", "assumptions", ":", "theorem", ":", ".", "There", "exist", "\u2208fY0", ",", "fY1Hx", "such", "that", "=", "\u2062mt", "(", "x", ")", "\u27e8fYt", ",", "\u2062kx", "(", "x", ",", "\u22c5", ")", "\u27e9Hx", ",", "i.e.", "the", "mean", "potential", "outcome", "functions", "m0", ",", "m1", "are", "in", "Hx", ".", "Further", "assume", "that", "\u2264\u2225fYt\u2225HxK.", "theorem", ":", ".", "Define", ":", "=", "\u2062\u03b7Yt", "(", "x", ")", "\u222bY", "(", "Yt", "-", "mt", "(", "x", "))", "2p", "(", "Yt|x", ")", ".", "\u2062\u03b7Yt", "(", "x", ")", "is", "the", "standard", "deviation", "of", "Yt|x", ".", "theorem", ":", ".", "There", "exists", "\u2208f\u03b70", ",", "f\u03b71Hx", "such", "that", "=", "\u2062\u03b7Yt", "(", "x", ")", "\u27e8f\u03b7t", ",", "\u2062kx", "(", "x", ",", "\u22c5", ")", "\u27e9Hx", ",", "i.e.", "the", "conditional", "standard", "deviation", "functions", "of", "Yt|x", "are", "in", "Hx", ".", "Further", "assume", "that", "\u2264\u2225f\u03b7t\u2225HxM.", "theorem", ":", ".", "Let", ":", "\u03a6\u2192XY", "be", "an", "invertible", "representation", "function", ",", "and", "let", "\u03a8", "be", "its", "inverse", ".", "We", "assume", "there", "exists", "a", "bounded", "linear", "operator", ":", "\u0393\u03a6\u2192HrHx", "such", "that", "=", "\u27e8fYt", ",", "\u2062kx", "(", "\u2062\u03a8", "(", "r", "),", "\u22c5", ")", "\u27e9Hx\u27e8fYt", ",", "\u2062\u0393\u03a6kr", "(", "r", ",", "\u22c5", ")", "\u27e9Hx", ".", "We", "further", "assume", "that", "the", "Hilbert", "-", "Schmidt", "norm", "(", "operator", "norm", ")", "\u2225\u0393\u03a6\u2225\u2062HS", "of", "\u0393\u03a6", "is", "bounded", "by", "K\u03a6", ".", "The", "two", "assumptions", "above", "amount", "to", "assuming", "that", "can", "be", "represented", "as", "one", "-", "to", "-", "one", "linear", "map", "between", "the", "two", "Hilbert", "spaces", "and", ".", "Under", "Assumptions", "[", "reference", "]", "and", "[", "reference", "]", "about", ",", "and", ",", "we", "have", "that", ",", "where", "is", "the", "adjoint", "operator", "of", ".", "theorem", ":", ".", "Let", ":", "h\u2192\u00d7R{0", ",", "1}R", "be", "an", "hypothesis", ",", "and", "assume", "that", "there", "exist", "\u2208fhtHr", "such", "that", "=", "\u2062h", "(", "r", ",", "t", ")", "\u27e8fht", ",", "\u2062kr", "(", "r", ",", "\u22c5", ")", "\u27e9Hr", ",", "and", "such", "that", "\u2264\u2225fht\u2225Hrb", ".", "Under", "Assumption", "about", "m0", ",", "m1", ",", "we", "have", "that", "\u2113h", ",", "\u03a6", "(", "\u03a8", "(", "r", "),", "t", ")", "=\u222bY", "(", "Yt", "-", "h", "(", "r", ",", "t", "))", "2p", "(", "Yt|r", ")", "dYt", "is", "in", "the", "tensor", "Hilbert", "space", "\u2297HrHr", ".", "Moreover", ",", "the", "norm", "of", "\u2062\u2113h", ",", "\u03a6", "(", "\u2062\u03a8", "(", "r", "),", "t", ")", "in", "\u2297HrHr", "is", "upper", "bounded", "by", "\u20624", "(+", "\u2062K\u03a62K2b2", ")", ".", "proof", ":", "Proof", ".", "We", "first", "decompose", "into", "a", "noise", "and", "mean", "fitting", "term", ",", "using", ":", "where", "equality", "(", "[", "reference", "]", ")", "is", "by", "Definition", "[", "reference", "]", "of", ",", "and", "because", "by", "definition", "of", ".", "Moving", "to", ",", "recall", "that", ",", ".", "By", "linearity", "of", "the", "Hilbert", "space", ",", "we", "have", "that", ".", "By", "a", "well", "known", "result", ",", "the", "product", "lies", "in", "the", "tensor", "product", "space", ",", "and", "is", "equal", "to", ".", "The", "norm", "of", "this", "function", "in", "is", ".", "This", "is", "the", "general", "Hilbert", "space", "version", "of", "the", "fact", "that", "for", "a", "vector", "one", "has", "that", ",", "where", "is", "the", "matrix", "Frobenius", "norm", ",", "and", "is", "the", "square", "of", "the", "standard", "Euclidean", "norm", ".", "We", "therefore", "have", "a", "similar", "result", "for", ",", "using", "Assumption", "[", "reference", "]", ":", ".", "The", "norm", "of", "this", "function", "in", "is", ".", "Overall", "this", "leads", "us", "to", "conclude", ",", "using", "Equation", "(", "[", "reference", "]", ")", "that", ".", "Now", "we", "have", ",", "using", "(", "[", "reference", "]", ")", ":", "Inequality", "(", "[", "reference", "]", ")", "is", "by", "the", "norms", "given", "above", "and", "the", "triangle", "inequality", ".", "Inequality", "(", "[", "reference", "]", ")", "is", "because", "for", "any", "Hilbert", "space", ",", ".", "Inequality", "(", "[", "reference", "]", ")", "is", "by", "the", "definition", "of", "the", "operator", "norm", ".", "Equality", "(", "[", "reference", "]", ")", "is", "because", "the", "norm", "of", "the", "adjoint", "operator", "is", "equal", "to", "the", "norm", "of", "the", "original", "operator", ",", "where", "we", "abused", "the", "notation", "to", "mean", "both", "the", "norm", "of", "operators", "from", "to", "and", "vice", "-", "versa", ".", "Finally", ",", "inequality", "(", "[", "reference", "]", ")", "is", "by", "Assumptions", "[", "reference", "]", ",", "[", "reference", "]", "and", "[", "reference", "]", ",", "and", "by", "the", "Lemma", "\u2019s", "premise", "on", "the", "norm", "of", ".", "\u220e", "theorem", ":", ".", "Let", "u", "=", "p", "(", "t=1", ")", "be", "the", "marginal", "probability", "of", "treatment", ",", "and", "assume", "0<u<1", ".", "Assume", "the", "distribution", "of", "Yt", "conditioned", "on", "x", "follows", "Assumptions", "with", "constant", "M.", "Let", ":", "\u03a6\u2192XR", "be", "a", "one", "-", "to", "-", "one", "representation", "function", "which", "obeys", "Assumption", "with", "corresponding", "operator", "\u0393\u03a6", "with", "operator", "norm", "K\u03a6", ".", "Let", "the", "functions", "Y0", ",", "Y1", "obey", "Assumption", ",", "with", "bounded", "Hilbert", "space", "norm", "K", ".", "Let", ":", "h\u2192\u00d7R{0", ",", "1}R", "be", "an", "hypothesis", ",", "and", "assume", "that", "there", "exist", "\u2208fhtHr", "such", "that", "=", "\u2062h", "(", "r", ",", "t", ")", "\u27e8fht", ",", "\u2062kr", "(", "r", ",", "\u22c5", ")", "\u27e9Hr", ",", "such", "that", "\u2264\u2225fht\u2225Hrb", ".", "Assume", "that", "\u03f5F", "and", "\u03f5\u2062CF", "are", "defined", "with", "respect", "to", "L", "being", "the", "squared", "loss", ".", "Then", ":", "where", "\u03f5\u2062CF", "and", "\u03f5F", "use", "the", "squared", "loss", ".", "proof", ":", "Proof", ".", "We", "will", "apply", "Lemma", "[", "reference", "]", "with", ".", "By", "Lemma", "[", "reference", "]", ",", "we", "have", "that", "for", "and", "being", "the", "squared", "loss", ",", ".", "Inequality", "(", "[", "reference", "]", ")", "then", "holds", "as", "a", "special", "case", "of", "Lemma", "[", "reference", "]", ".", "\u220e", "theorem", ":", ".", "Under", "the", "assumptions", "of", "Lemma", ",", "using", "the", "squared", "loss", "for", "\u03f5F", ",", "we", "have", ":", "proof", ":", "Proof", ".", "Plug", "in", "the", "upper", "bound", "of", "Lemma", "[", "reference", "]", "into", "the", "upper", "bound", "of", "Theorem", "[", "reference", "]", ".", "\u220e", "appendix", ":", "Algorithmic", "details", "We", "give", "details", "about", "the", "algorithms", "used", "in", "our", "framework", ".", "subsection", ":", "Minimizing", "the", "Wasserstein", "distance", "In", "general", ",", "computing", "(", "and", "minimizing", ")", "the", "Wasserstein", "distance", "involves", "solving", "a", "linear", "program", ",", "which", "may", "be", "prohibitively", "expensive", "for", "many", "practical", "applications", ".", "showed", "that", "an", "approximation", "based", "on", "entropic", "regularization", "can", "be", "obtained", "through", "the", "Sinkhorn", "-", "Knopp", "matrix", "scaling", "algorithm", ",", "at", "orders", "of", "magnitude", "faster", "speed", ".", "Dubbed", "Sinkhorn", "distances", ",", "the", "approximation", "is", "computed", "using", "a", "fixed", "-", "point", "iteration", "involving", "repeated", "multiplication", "with", "a", "kernel", "matrix", ".", "We", "can", "use", "the", "algorithm", "of", "in", "our", "framework", ".", "See", "Algorithm", "[", "reference", "]", "for", "an", "overview", "of", "how", "to", "compute", "the", "gradient", "in", "Algorithm", "[", "reference", "]", ".", "When", "computing", ",", "disregarding", "the", "gradient", "amounts", "to", "minimizing", "an", "upper", "bound", "on", "the", "Sinkhorn", "transport", ".", "More", "advanced", "ideas", "for", "stochastic", "optimization", "of", "this", "distance", "have", "recently", "proposed", "by", ",", "and", "might", "be", "used", "in", "future", "work", ".", "[", "tbp", "]", "Computing", "the", "stochastic", "gradient", "of", "the", "Wasserstein", "distance", "[", "1", "]", "Input", ":", "Factual", ",", "representation", "network", "with", "current", "weights", "by", "Randomly", "sample", "a", "mini", "-", "batch", "with", "treated", "and", "control", "units", "Calculate", "the", "pairwise", "distance", "matrix", "between", "all", "treatment", "and", "control", "pairs", ":", "Calculate", "the", "approximate", "optimal", "transport", "matrix", "using", "Algorithm", "3", "of", ",", "with", "input", "Calculate", "the", "gradient", ":", "While", "our", "framework", "is", "agnostic", "to", "the", "parameterization", "of", ",", "our", "experiments", "focus", "on", "the", "case", "where", "is", "a", "neural", "network", ".", "For", "convenience", "of", "implementation", ",", "we", "may", "represent", "the", "fixed", "-", "point", "iterations", "of", "the", "Sinkhorn", "algorithm", "as", "a", "recurrent", "neural", "network", ",", "where", "the", "states", "evolve", "according", "to", "Here", ",", "is", "a", "kernel", "matrix", "corresponding", "to", "a", "metric", "such", "as", "the", "euclidean", "distance", ",", ",", "and", "are", "the", "sizes", "of", "the", "control", "and", "treatment", "groups", ".", "In", "this", "way", ",", "we", "can", "minimize", "our", "entire", "objective", "with", "most", "of", "the", "frameworks", "commonly", "used", "for", "training", "neural", "networks", ",", "out", "of", "the", "box", ".", "subsection", ":", "Minimizing", "the", "maximum", "mean", "discrepancy", "The", "MMD", "of", "treatment", "populations", "in", "the", "representation", ",", "for", "a", "kernel", "can", "be", "written", "as", ",", "The", "linear", "maximum", "-", "mean", "discrepancy", "can", "be", "written", "as", "a", "distance", "between", "means", ".", "In", "the", "notation", "of", "Algorithm", "[", "reference", "]", ",", "Let", "Then", "the", "gradient", "of", "the", "MMD", "with", "respect", "to", "is", ",", "appendix", ":", "Experimental", "details", "subsection", ":", "Hyperparameter", "selection", "Standard", "methods", "for", "hyperparameter", "selection", ",", "such", "as", "cross", "-", "validation", ",", "are", "not", "generally", "applicable", "for", "estimating", "the", "PEHE", "loss", "since", "only", "one", "potential", "outcome", "is", "observed", "(", "unless", "the", "outcome", "is", "simulated", ")", ".", "For", "real", "-", "world", "data", ",", "we", "may", "use", "the", "observed", "outcome", "of", "the", "nearest", "neighbor", "to", "in", "the", "opposite", "treatment", "group", ",", "as", "surrogate", "for", "the", "counterfactual", "outcome", ".", "We", "use", "this", "to", "define", "a", "nearest", "-", "neighbor", "approximation", "of", "the", "PEHE", "loss", ",", ".", "On", "IHDP", ",", "we", "use", "the", "objective", "value", "on", "the", "validation", "set", "for", "early", "stopping", "in", "CFR", ",", "and", "for", "hyperparameter", "selection", ".", "On", "the", "Jobs", "dataset", ",", "we", "use", "the", "policy", "risk", "on", "the", "validation", "set", ".", "See", "Table", "[", "reference", "]", "for", "a", "description", "of", "hyperparameters", "and", "search", "ranges", ".", "subsection", ":", "Learned", "representations", "Figure", "[", "reference", "]", "show", "the", "representations", "learned", "by", "our", "CFR", "algorithm", ".", "[", "b", "]", "0.3", "[", "b", "]", "0.3", "[", "b", "]", "0.3", "subsection", ":", "Absolute", "error", "for", "increasingly", "imbalanced", "data", "Figure", "[", "reference", "]", "shows", "the", "results", "of", "the", "same", "experiment", "as", "Figure", "2", "of", "the", "main", "paper", ",", "but", "in", "absolute", "terms", "."]}