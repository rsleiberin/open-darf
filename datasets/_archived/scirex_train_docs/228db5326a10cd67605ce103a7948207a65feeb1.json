{"coref": {"COCO_Visual_Question_Answering__VQA__real_images_1_0_open_ended": [[1014, 1018], [2880, 2883], [2890, 2894], [2988, 2989], [3002, 3007], [3327, 3330], [3453, 3456], [3512, 3514], [3637, 3640], [3641, 3642], [3955, 3956], [4051, 4054], [4055, 4056], [4074, 4077], [4138, 4139], [4201, 4202], [4242, 4245], [4247, 4250], [4389, 4392], [4455, 4456], [4572, 4577], [4854, 4859], [3892, 3895]], "Percentage_correct": [], "SAN": [[2, 5], [12, 15], [16, 17], [103, 104], [127, 128], [458, 461], [462, 463], [474, 475], [501, 502], [512, 513], [574, 577], [610, 611], [717, 720], [778, 779], [785, 786], [1240, 1243], [1266, 1267], [1307, 1308], [1348, 1351], [1352, 1353], [1359, 1360], [1376, 1377], [1391, 1394], [2113, 2116], [2127, 2128], [2237, 2238], [2746, 2747], [3138, 3139], [3417, 3418], [3554, 3555], [3588, 3591], [3663, 3664], [3669, 3672], [3754, 3755], [3783, 3787], [3900, 3904], [4006, 4007], [4031, 4032], [4261, 4262], [4374, 4376], [4396, 4400], [4402, 4406], [4446, 4447], [4603, 4605], [4861, 4862], [5049, 5052], [5053, 5054], [5059, 5060], [5092, 5093], [5128, 5129], [76, 77], [744, 745], [3736, 3737], [3848, 3849], [3976, 3977], [4098, 4099], [4163, 4164], [4384, 4385], [4470, 4471], [4477, 4478]], "Visual_Question_Answering": [[6, 9], [55, 58], [59, 60], [166, 169], [170, 171], [471, 473], [721, 724], [733, 736], [809, 811], [939, 941], [970, 972], [1004, 1006], [1059, 1061], [1083, 1085], [1303, 1305], [1313, 1315], [2079, 2080], [3182, 3184], [3222, 3224], [5056, 5058], [95, 97], [197, 199], [230, 232], [323, 325], [1109, 1111], [1342, 1344], [2749, 2751], [5111, 5113]]}, "coref_non_salient": {"0": [[841, 842], [858, 861]], "1": [[2754, 2757], [2841, 2844], [3451, 3452], [3629, 3632], [3768, 3769]], "10": [[1415, 1416], [3409, 3410], [3427, 3428]], "11": [[1478, 1480], [3438, 3440]], "12": [[1637, 1641], [1904, 1909]], "13": [[3241, 3243], [3320, 3322], [3811, 3812], [3885, 3886], [3934, 3935]], "14": [[551, 553], [1386, 1388], [1606, 1608], [3471, 3473], [3700, 3702], [3750, 3752]], "15": [[1629, 1631], [1898, 1900]], "16": [[1978, 1979], [2001, 2002]], "17": [[4346, 4350], [3985, 3989], [4154, 4158]], "18": [[904, 905], [923, 924]], "19": [[3800, 3806], [3868, 3874]], "2": [[1032, 1033], [2910, 2912]], "20": [[483, 485], [854, 856], [1285, 1287], [1310, 1312]], "21": [[1252, 1254], [1930, 1932]], "22": [[1646, 1648], [1665, 1667]], "23": [[523, 525], [1382, 1384], [1397, 1399], [1400, 1402], [3403, 3405]], "24": [[1552, 1555]], "25": [[4505, 4509]], "26": [[3527, 3529]], "27": [[3226, 3228]], "28": [[3917, 3920], [4085, 4088]], "29": [[344, 348], [466, 470], [582, 586], [1336, 1340], [2132, 2136], [4525, 4529]], "3": [[2012, 2015], [2028, 2031]], "30": [[3140, 3141], [548, 549], [3677, 3678], [3850, 3851], [3861, 3862], [3921, 3922], [3978, 3979], [4089, 4090], [4100, 4101], [4165, 4166]], "31": [[1408, 1411]], "32": [[491, 493], [815, 817], [935, 937], [1295, 1297]], "33": [[163, 164], [194, 195]], "34": [[4185, 4186]], "35": [[3397, 3399]], "36": [[3604, 3606]], "37": [[3253, 3257]], "38": [[1122, 1125]], "39": [[4351, 4353]], "4": [[277, 278], [560, 561], [838, 839], [920, 921], [1152, 1153], [1163, 1164], [1230, 1231], [1611, 1612], [1777, 1778], [1832, 1833], [1858, 1859], [3531, 3532], [1198, 1199], [1203, 1204]], "40": [[3314, 3315], [3826, 3827]], "41": [[4191, 4194]], "42": [[4362, 4365]], "43": [[3609, 3611]], "44": [[1941, 1943]], "45": [[3312, 3313], [3824, 3825]], "46": [[1448, 1451]], "47": [[1650, 1652]], "48": [[956, 958]], "49": [[1218, 1222]], "5": [[257, 258], [529, 530], [557, 558], [872, 873], [926, 927], [1246, 1247], [1404, 1405], [1613, 1614], [1894, 1895], [3142, 3143], [3424, 3425], [3534, 3535], [4102, 4103], [4167, 4168], [1880, 1881], [2068, 2069], [2076, 2077], [3476, 3477], [3696, 3697], [3758, 3759], [3796, 3797], [3858, 3859], [3913, 3914], [3980, 3981]], "50": [[982, 984]], "51": [[991, 993]], "52": [[1878, 1879]], "53": [[2548, 2552]], "54": [[3258, 3261]], "55": [[1812, 1814]], "56": [[2273, 2277]], "57": [[253, 256]], "58": [[3616, 3617]], "59": [[831, 832]], "6": [[3316, 3318], [3822, 3823]], "60": [[1248, 1250]], "61": [[653, 655], [660, 662], [689, 691], [774, 776], [1330, 1332], [2496, 2498], [2554, 2556], [2682, 2684], [2706, 2708], [3559, 3561], [4562, 4564], [4668, 4670], [4676, 4678], [4703, 4705], [4793, 4795], [4812, 4814]], "62": [[2090, 2094]], "63": [[1182, 1186]], "64": [[182, 187]], "65": [[494, 496]], "66": [[2056, 2059]], "67": [[2280, 2282]], "68": [[883, 887]], "69": [[3592, 3593]], "7": [[1691, 1693], [1746, 1748]], "70": [[1119, 1121]], "71": [[159, 162]], "72": [[155, 157]], "73": [[2036, 2041]], "74": [[1189, 1194]], "75": [[66, 67]], "76": [[2465, 2467]], "77": [[236, 238]], "78": [[899, 903]], "79": [[3612, 3615]], "8": [[954, 955], [131, 132], [624, 625], [797, 798], [1595, 1596], [2440, 2441], [2478, 2479], [2563, 2564], [4296, 4297], [5077, 5078], [5135, 5136]], "80": [[3263, 3265]], "81": [[597, 599], [2507, 2509], [2567, 2569]], "82": [[1064, 1066], [1088, 1090], [2992, 2994]], "83": [[1438, 1441]], "84": [[4109, 4113]], "85": [[270, 276]], "86": [[1695, 1697]], "87": [[30, 32]], "88": [[1136, 1140]], "89": [[930, 933]], "9": [[2833, 2836], [3633, 3636], [3834, 3837]], "90": [[1177, 1179]], "91": [[5062, 5067]], "92": [[1794, 1796]], "93": [[917, 918]]}, "doc_id": "228db5326a10cd67605ce103a7948207a65feeb1", "method_subrelations": {"SAN": [[[0, 3], "SAN"]]}, "n_ary_relations": [{"Material": "COCO_Visual_Question_Answering__VQA__real_images_1_0_open_ended", "Method": "SAN", "Metric": "Percentage_correct", "Task": "Visual_Question_Answering", "score": 58.9}], "ner": [[2, 5, "Method"], [6, 9, "Task"], [12, 15, "Method"], [16, 17, "Method"], [30, 32, "Method"], [55, 58, "Task"], [59, 60, "Task"], [66, 67, "Task"], [103, 104, "Method"], [127, 128, "Method"], [155, 157, "Task"], [159, 162, "Task"], [163, 164, "Task"], [166, 169, "Task"], [170, 171, "Task"], [182, 187, "Method"], [236, 238, "Method"], [253, 256, "Method"], [257, 258, "Method"], [270, 276, "Method"], [277, 278, "Method"], [344, 348, "Method"], [458, 461, "Method"], [462, 463, "Method"], [466, 470, "Method"], [471, 473, "Task"], [474, 475, "Method"], [483, 485, "Method"], [491, 493, "Task"], [494, 496, "Task"], [501, 502, "Method"], [512, 513, "Method"], [523, 525, "Method"], [529, 530, "Method"], [551, 553, "Method"], [557, 558, "Method"], [560, 561, "Method"], [574, 577, "Method"], [582, 586, "Method"], [597, 599, "Task"], [610, 611, "Method"], [653, 655, "Method"], [660, 662, "Method"], [689, 691, "Method"], [717, 720, "Method"], [721, 724, "Task"], [733, 736, "Task"], [774, 776, "Method"], [778, 779, "Method"], [785, 786, "Method"], [809, 811, "Task"], [815, 817, "Task"], [831, 832, "Method"], [838, 839, "Method"], [841, 842, "Task"], [854, 856, "Method"], [858, 861, "Task"], [872, 873, "Method"], [883, 887, "Method"], [899, 903, "Method"], [904, 905, "Method"], [917, 918, "Method"], [920, 921, "Method"], [923, 924, "Method"], [926, 927, "Method"], [930, 933, "Task"], [935, 937, "Task"], [939, 941, "Task"], [954, 955, "Method"], [956, 958, "Method"], [970, 972, "Task"], [982, 984, "Task"], [991, 993, "Method"], [1004, 1006, "Task"], [1014, 1018, "Material"], [1032, 1033, "Method"], [1059, 1061, "Task"], [1064, 1066, "Task"], [1083, 1085, "Task"], [1088, 1090, "Task"], [1119, 1121, "Method"], [1122, 1125, "Method"], [1136, 1140, "Method"], [1152, 1153, "Method"], [1163, 1164, "Method"], [1177, 1179, "Method"], [1182, 1186, "Method"], [1189, 1194, "Method"], [1218, 1222, "Method"], [1230, 1231, "Method"], [1240, 1243, "Method"], [1246, 1247, "Method"], [1248, 1250, "Task"], [1252, 1254, "Method"], [1266, 1267, "Method"], [1285, 1287, "Method"], [1295, 1297, "Task"], [1303, 1305, "Task"], [1307, 1308, "Method"], [1310, 1312, "Method"], [1313, 1315, "Task"], [1330, 1332, "Method"], [1336, 1340, "Method"], [1348, 1351, "Method"], [1352, 1353, "Method"], [1359, 1360, "Method"], [1376, 1377, "Method"], [1382, 1384, "Method"], [1386, 1388, "Method"], [1391, 1394, "Method"], [1397, 1399, "Method"], [1400, 1402, "Method"], [1404, 1405, "Method"], [1408, 1411, "Task"], [1415, 1416, "Method"], [1438, 1441, "Method"], [1448, 1451, "Method"], [1478, 1480, "Method"], [1552, 1555, "Method"], [1606, 1608, "Method"], [1611, 1612, "Method"], [1613, 1614, "Method"], [1629, 1631, "Task"], [1637, 1641, "Method"], [1646, 1648, "Method"], [1650, 1652, "Method"], [1665, 1667, "Method"], [1691, 1693, "Method"], [1695, 1697, "Method"], [1746, 1748, "Method"], [1777, 1778, "Method"], [1794, 1796, "Method"], [1812, 1814, "Method"], [1832, 1833, "Method"], [1858, 1859, "Method"], [1878, 1879, "Method"], [1894, 1895, "Method"], [1898, 1900, "Task"], [1904, 1909, "Method"], [1930, 1932, "Method"], [1941, 1943, "Method"], [1978, 1979, "Method"], [2001, 2002, "Method"], [2012, 2015, "Method"], [2028, 2031, "Method"], [2036, 2041, "Method"], [2056, 2059, "Method"], [2079, 2080, "Task"], [2090, 2094, "Method"], [2113, 2116, "Method"], [2127, 2128, "Method"], [2132, 2136, "Method"], [2237, 2238, "Method"], [2273, 2277, "Method"], [2280, 2282, "Method"], [2465, 2467, "Method"], [2496, 2498, "Method"], [2507, 2509, "Task"], [2548, 2552, "Method"], [2554, 2556, "Method"], [2567, 2569, "Task"], [2682, 2684, "Method"], [2706, 2708, "Method"], [2746, 2747, "Method"], [2754, 2757, "Material"], [2833, 2836, "Material"], [2841, 2844, "Material"], [2880, 2883, "Material"], [2890, 2894, "Material"], [2910, 2912, "Method"], [2988, 2989, "Material"], [2992, 2994, "Task"], [3002, 3007, "Material"], [3138, 3139, "Method"], [3140, 3141, "Method"], [3142, 3143, "Method"], [3182, 3184, "Task"], [3222, 3224, "Task"], [3226, 3228, "Task"], [3241, 3243, "Metric"], [3253, 3257, "Metric"], [3258, 3261, "Metric"], [3263, 3265, "Method"], [3312, 3313, "Method"], [3314, 3315, "Method"], [3316, 3318, "Metric"], [3320, 3322, "Metric"], [3327, 3330, "Material"], [3397, 3399, "Method"], [3403, 3405, "Method"], [3409, 3410, "Method"], [3417, 3418, "Method"], [3424, 3425, "Method"], [3427, 3428, "Method"], [3438, 3440, "Method"], [3451, 3452, "Material"], [3453, 3456, "Material"], [3471, 3473, "Method"], [3512, 3514, "Material"], [3527, 3529, "Metric"], [3531, 3532, "Method"], [3534, 3535, "Method"], [3554, 3555, "Method"], [3559, 3561, "Method"], [3588, 3591, "Method"], [3592, 3593, "Method"], [3604, 3606, "Metric"], [3609, 3611, "Method"], [3612, 3615, "Method"], [3616, 3617, "Method"], [3629, 3632, "Material"], [3633, 3636, "Material"], [3637, 3640, "Material"], [3641, 3642, "Material"], [3663, 3664, "Method"], [3669, 3672, "Method"], [3700, 3702, "Method"], [3750, 3752, "Method"], [3754, 3755, "Method"], [3783, 3787, "Method"], [3800, 3806, "Method"], [3811, 3812, "Metric"], [3822, 3823, "Metric"], [3824, 3825, "Method"], [3826, 3827, "Method"], [3834, 3837, "Material"], [3868, 3874, "Method"], [3885, 3886, "Metric"], [3900, 3904, "Method"], [3917, 3920, "Method"], [3934, 3935, "Metric"], [3955, 3956, "Material"], [4006, 4007, "Method"], [4031, 4032, "Method"], [4051, 4054, "Material"], [4055, 4056, "Material"], [4074, 4077, "Material"], [4085, 4088, "Method"], [4102, 4103, "Method"], [4109, 4113, "Metric"], [4138, 4139, "Material"], [4167, 4168, "Method"], [4185, 4186, "Metric"], [4191, 4194, "Metric"], [4201, 4202, "Material"], [4242, 4245, "Material"], [4247, 4250, "Material"], [4261, 4262, "Method"], [4346, 4350, "Method"], [4351, 4353, "Method"], [4362, 4365, "Method"], [4374, 4376, "Method"], [4389, 4392, "Material"], [4396, 4400, "Method"], [4402, 4406, "Method"], [4446, 4447, "Method"], [4455, 4456, "Material"], [4505, 4509, "Task"], [4525, 4529, "Method"], [4562, 4564, "Method"], [4572, 4577, "Material"], [4603, 4605, "Method"], [4668, 4670, "Method"], [4676, 4678, "Method"], [4703, 4705, "Method"], [4793, 4795, "Method"], [4812, 4814, "Method"], [4854, 4859, "Material"], [4861, 4862, "Method"], [5049, 5052, "Method"], [5053, 5054, "Method"], [5056, 5058, "Task"], [5059, 5060, "Method"], [5062, 5067, "Method"], [5092, 5093, "Method"], [5128, 5129, "Method"], [76, 77, "Method"], [95, 97, "Task"], [131, 132, "Method"], [194, 195, "Task"], [197, 199, "Task"], [230, 232, "Task"], [323, 325, "Task"], [548, 549, "Method"], [624, 625, "Method"], [744, 745, "Method"], [797, 798, "Method"], [1109, 1111, "Task"], [1198, 1199, "Method"], [1203, 1204, "Method"], [1342, 1344, "Task"], [1595, 1596, "Method"], [1880, 1881, "Method"], [2068, 2069, "Method"], [2076, 2077, "Method"], [2440, 2441, "Method"], [2478, 2479, "Method"], [2563, 2564, "Method"], [2749, 2751, "Task"], [3476, 3477, "Method"], [3677, 3678, "Method"], [3696, 3697, "Method"], [3736, 3737, "Method"], [3758, 3759, "Method"], [3768, 3769, "Material"], [3796, 3797, "Method"], [3848, 3849, "Method"], [3850, 3851, "Method"], [3858, 3859, "Method"], [3861, 3862, "Method"], [3892, 3895, "Material"], [3913, 3914, "Method"], [3921, 3922, "Method"], [3976, 3977, "Method"], [3978, 3979, "Method"], [3980, 3981, "Method"], [3985, 3989, "Method"], [4089, 4090, "Method"], [4098, 4099, "Method"], [4100, 4101, "Method"], [4154, 4158, "Method"], [4163, 4164, "Method"], [4165, 4166, "Method"], [4296, 4297, "Method"], [4384, 4385, "Method"], [4470, 4471, "Method"], [4477, 4478, "Method"], [5077, 5078, "Method"], [5111, 5113, "Task"], [5135, 5136, "Method"]], "sections": [[0, 147], [147, 805], [805, 1346], [1346, 1395], [1395, 1604], [1604, 1635], [1635, 1878], [1878, 2111], [2111, 2736], [2736, 2739], [2739, 3164], [3164, 3395], [3395, 3620], [3620, 4503], [4503, 4843], [4843, 5038], [5038, 5151], [5151, 5154]], "sentences": [[0, 9], [9, 28], [28, 52], [52, 68], [68, 91], [91, 116], [116, 147], [147, 150], [150, 181], [181, 217], [217, 239], [239, 288], [288, 320], [320, 349], [349, 357], [357, 364], [364, 382], [382, 452], [452, 474], [474, 497], [497, 507], [507, 511], [511, 600], [600, 605], [605, 608], [608, 656], [656, 679], [679, 701], [701, 712], [712, 725], [725, 760], [760, 805], [805, 809], [809, 818], [818, 843], [843, 862], [862, 913], [913, 934], [934, 963], [963, 1000], [1000, 1019], [1019, 1057], [1057, 1067], [1067, 1080], [1080, 1091], [1091, 1108], [1108, 1118], [1118, 1134], [1134, 1148], [1148, 1169], [1169, 1180], [1180, 1207], [1207, 1226], [1226, 1244], [1244, 1263], [1263, 1273], [1273, 1277], [1277, 1306], [1306, 1346], [1346, 1354], [1354, 1365], [1365, 1369], [1369, 1395], [1395, 1399], [1399, 1412], [1412, 1461], [1461, 1493], [1493, 1497], [1497, 1517], [1517, 1533], [1533, 1544], [1544, 1578], [1578, 1604], [1604, 1608], [1608, 1635], [1635, 1641], [1641, 1660], [1660, 1690], [1690, 1698], [1698, 1711], [1711, 1725], [1725, 1744], [1744, 1768], [1768, 1785], [1785, 1815], [1815, 1834], [1834, 1839], [1839, 1843], [1843, 1860], [1860, 1878], [1878, 1884], [1884, 1901], [1901, 1938], [1938, 1965], [1965, 1987], [1987, 1996], [1996, 2042], [2042, 2073], [2073, 2085], [2085, 2089], [2089, 2111], [2111, 2116], [2116, 2137], [2137, 2153], [2153, 2159], [2159, 2163], [2163, 2192], [2192, 2227], [2227, 2257], [2257, 2314], [2314, 2335], [2335, 2349], [2349, 2376], [2376, 2401], [2401, 2405], [2405, 2422], [2422, 2450], [2450, 2488], [2488, 2510], [2510, 2518], [2518, 2542], [2542, 2570], [2570, 2595], [2595, 2615], [2615, 2637], [2637, 2652], [2652, 2666], [2666, 2668], [2668, 2679], [2679, 2703], [2703, 2724], [2724, 2732], [2732, 2736], [2736, 2739], [2739, 2743], [2743, 2754], [2754, 2761], [2761, 2769], [2769, 2778], [2778, 2785], [2785, 2799], [2799, 2807], [2807, 2822], [2822, 2833], [2833, 2845], [2845, 2853], [2853, 2867], [2867, 2880], [2880, 2887], [2887, 2928], [2928, 2940], [2940, 2949], [2949, 2965], [2965, 2978], [2978, 2988], [2988, 2995], [2995, 3008], [3008, 3036], [3036, 3048], [3048, 3061], [3061, 3070], [3070, 3084], [3084, 3100], [3100, 3116], [3116, 3127], [3127, 3131], [3131, 3160], [3160, 3164], [3164, 3170], [3170, 3185], [3185, 3214], [3214, 3236], [3236, 3247], [3247, 3262], [3262, 3282], [3282, 3305], [3305, 3323], [3323, 3356], [3356, 3395], [3395, 3401], [3401, 3414], [3414, 3431], [3431, 3450], [3450, 3474], [3474, 3498], [3498, 3511], [3511, 3548], [3548, 3562], [3562, 3578], [3578, 3594], [3594, 3602], [3602, 3612], [3612, 3620], [3620, 3625], [3625, 3647], [3647, 3656], [3656, 3673], [3673, 3692], [3692, 3706], [3706, 3708], [3708, 3709], [3709, 3717], [3717, 3723], [3723, 3764], [3764, 3774], [3774, 3778], [3778, 3815], [3815, 3828], [3828, 3840], [3840, 3889], [3889, 3938], [3938, 3943], [3943, 3945], [3945, 3967], [3967, 4001], [4001, 4021], [4021, 4060], [4060, 4070], [4070, 4131], [4131, 4140], [4140, 4145], [4145, 4193], [4193, 4195], [4195, 4212], [4212, 4215], [4215, 4221], [4221, 4246], [4246, 4260], [4260, 4273], [4273, 4283], [4283, 4305], [4305, 4326], [4326, 4328], [4328, 4335], [4335, 4353], [4353, 4366], [4366, 4386], [4386, 4436], [4436, 4450], [4450, 4459], [4459, 4463], [4463, 4500], [4500, 4503], [4503, 4509], [4509, 4553], [4553, 4578], [4578, 4616], [4616, 4618], [4618, 4625], [4625, 4633], [4633, 4647], [4647, 4681], [4681, 4692], [4692, 4751], [4751, 4780], [4780, 4783], [4783, 4787], [4787, 4806], [4806, 4843], [4843, 4847], [4847, 4865], [4865, 4897], [4897, 4900], [4900, 4931], [4931, 4969], [4969, 4974], [4974, 5002], [5002, 5012], [5012, 5017], [5017, 5038], [5038, 5041], [5041, 5059], [5059, 5086], [5086, 5116], [5116, 5151], [5151, 5154]], "words": ["document", ":", "Stacked", "Attention", "Networks", "for", "Image", "Question", "Answering", "This", "paper", "presents", "stacked", "attention", "networks", "(", "SANs", ")", "that", "learn", "to", "answer", "natural", "language", "questions", "from", "images", ".", "SANs", "use", "semantic", "representation", "of", "a", "question", "as", "query", "to", "search", "for", "the", "regions", "in", "an", "image", "that", "are", "related", "to", "the", "answer", ".", "We", "argue", "that", "image", "question", "answering", "(", "QA", ")", "often", "requires", "multiple", "steps", "of", "reasoning", ".", "Thus", ",", "we", "develop", "a", "multiple", "-", "layer", "SAN", "in", "which", "we", "query", "an", "image", "multiple", "times", "to", "infer", "the", "answer", "progressively", ".", "Experiments", "conducted", "on", "four", "image", "QA", "data", "sets", "demonstrate", "that", "the", "proposed", "SANs", "significantly", "outperform", "previous", "state", "-", "of", "-", "the", "-", "art", "approaches", ".", "The", "visualization", "of", "the", "attention", "layers", "illustrates", "the", "progress", "that", "the", "SAN", "locates", "the", "relevant", "visual", "clues", "that", "lead", "to", "the", "answer", "of", "the", "question", "layer", "-", "by", "-", "layer", ".", "section", ":", "Introduction", "With", "the", "recent", "advancement", "in", "computer", "vision", "and", "in", "natural", "language", "processing", "(", "NLP", ")", ",", "image", "question", "answering", "(", "QA", ")", "becomes", "one", "of", "the", "most", "active", "research", "areas", ".", "Unlike", "pure", "language", "based", "QA", "systems", "that", "have", "been", "studied", "extensively", "in", "the", "NLP", "community", ",", "image", "QA", "systems", "are", "designed", "to", "automatically", "answer", "natural", "language", "questions", "according", "to", "the", "content", "of", "a", "reference", "image", ".", "[", "t", "]", "1.0", "[", "t", "]", "1.0", "Most", "of", "the", "recently", "proposed", "image", "QA", "models", "are", "based", "on", "neural", "networks", ".", "A", "commonly", "used", "approach", "was", "to", "extract", "a", "global", "image", "feature", "vector", "using", "a", "convolution", "neural", "network", "(", "CNN", ")", "and", "encode", "the", "corresponding", "question", "as", "a", "feature", "vector", "using", "a", "long", "short", "-", "term", "memory", "network", "(", "LSTM", ")", "and", "then", "combine", "them", "to", "infer", "the", "answer", ".", "Though", "impressive", "results", "have", "been", "reported", ",", "these", "models", "often", "fail", "to", "give", "precise", "answers", "when", "such", "answers", "are", "related", "to", "a", "set", "of", "fine", "-", "grained", "regions", "in", "an", "image", ".", "By", "examining", "the", "image", "QA", "data", "sets", ",", "we", "find", "that", "it", "is", "often", "that", "case", "that", "answering", "a", "question", "from", "an", "image", "requires", "multi", "-", "step", "reasoning", ".", "Take", "the", "question", "and", "image", "in", "Fig", ".", "[", "reference", "]", "as", "an", "example", ".", "There", "are", "several", "objects", "in", "the", "image", ":", "bicycles", ",", "window", ",", "street", ",", "baskets", "and", "dogs", ".", "To", "answer", "the", "question", "what", "are", "sitting", "in", "the", "basket", "on", "a", "bicycle", ",", "we", "need", "to", "first", "locate", "those", "objects", "(", "e.g.", "basket", ",", "bicycle", ")", "and", "concepts", "(", "e.g.", ",", "sitting", "in", ")", "referred", "in", "the", "question", ",", "then", "gradually", "rule", "out", "irrelevant", "objects", ",", "and", "finally", "pinpoint", "to", "the", "region", "that", "are", "most", "indicative", "to", "infer", "the", "answer", "(", "i.e.", ",", "dogs", "in", "the", "example", ")", ".", "In", "this", "paper", ",", "we", "propose", "stacked", "attention", "networks", "(", "SANs", ")", "that", "allow", "multi", "-", "step", "reasoning", "for", "image", "QA", ".", "SANs", "can", "be", "viewed", "as", "an", "extension", "of", "the", "attention", "mechanism", "that", "has", "been", "successfully", "applied", "in", "image", "captioning", "and", "machine", "translation", ".", "The", "overall", "architecture", "of", "SAN", "is", "illustrated", "in", "Fig", ".", "[", "reference", "]", ".", "The", "SAN", "consists", "of", "three", "major", "components", ":", "(", "1", ")", "the", "image", "model", ",", "which", "uses", "a", "CNN", "to", "extract", "high", "level", "image", "representations", ",", "e.g.", "one", "vector", "for", "each", "region", "of", "the", "image", ";", "(", "2", ")", "the", "question", "model", ",", "which", "uses", "a", "CNN", "or", "a", "LSTM", "to", "extract", "a", "semantic", "vector", "of", "the", "question", "and", "(", "3", ")", "the", "stacked", "attention", "model", ",", "which", "locates", ",", "via", "multi", "-", "step", "reasoning", ",", "the", "image", "regions", "that", "are", "relevant", "to", "the", "question", "for", "answer", "prediction", ".", "As", "illustrated", "in", "Fig", ".", "[", "reference", "]", ",", "the", "SAN", "first", "uses", "the", "question", "vector", "to", "query", "the", "image", "vectors", "in", "the", "first", "visual", "attention", "layer", ",", "then", "combine", "the", "question", "vector", "and", "the", "retrieved", "image", "vectors", "to", "form", "a", "refined", "query", "vector", "to", "query", "the", "image", "vectors", "again", "in", "the", "second", "attention", "layer", ".", "The", "higher", "-", "level", "attention", "layer", "gives", "a", "sharper", "attention", "distribution", "focusing", "on", "the", "regions", "that", "are", "more", "relevant", "to", "the", "answer", ".", "Finally", ",", "we", "combine", "the", "image", "features", "from", "the", "highest", "attention", "layer", "with", "the", "last", "query", "vector", "to", "predict", "the", "answer", ".", "The", "main", "contributions", "of", "our", "work", "are", "three", "-", "fold", ".", "First", ",", "we", "propose", "a", "stacked", "attention", "network", "for", "image", "QA", "tasks", ".", "Second", ",", "we", "perform", "comprehensive", "evaluations", "on", "four", "image", "QA", "benchmarks", ",", "demonstrating", "that", "the", "proposed", "multiple", "-", "layer", "SAN", "outperforms", "previous", "state", "-", "of", "-", "the", "-", "art", "approaches", "by", "a", "substantial", "margin", ".", "Third", ",", "we", "perform", "a", "detailed", "analysis", "where", "we", "visualize", "the", "outputs", "of", "different", "attention", "layers", "of", "the", "SAN", "and", "demonstrate", "the", "process", "that", "the", "SAN", "takes", "multiple", "steps", "to", "progressively", "focus", "the", "attention", "on", "the", "relevant", "visual", "clues", "that", "lead", "to", "the", "answer", ".", "section", ":", "Related", "Work", "Image", "QA", "is", "closely", "related", "to", "image", "captioning", ".", "In", ",", "the", "system", "first", "extracted", "a", "high", "level", "image", "feature", "vector", "from", "GoogleNet", "and", "then", "fed", "it", "into", "a", "LSTM", "to", "generate", "captions", ".", "The", "method", "proposed", "in", "went", "one", "step", "further", "to", "use", "an", "attention", "mechanism", "in", "the", "caption", "generation", "process", ".", "Different", "from", ",", "the", "approach", "proposed", "in", "first", "used", "a", "CNN", "to", "detect", "words", "given", "the", "images", ",", "then", "used", "a", "maximum", "entropy", "language", "model", "to", "generate", "a", "list", "of", "caption", "candidates", ",", "and", "finally", "used", "a", "deep", "multimodal", "similarity", "model", "(", "DMSM", ")", "to", "re", "-", "rank", "the", "candidates", ".", "Instead", "of", "using", "a", "RNN", "or", "a", "LSTM", ",", "the", "DMSM", "uses", "a", "CNN", "to", "model", "the", "semantics", "of", "captions", ".", "Unlike", "image", "captioning", ",", "in", "image", "QA", ",", "the", "question", "is", "given", "and", "the", "task", "is", "to", "learn", "the", "relevant", "visual", "and", "text", "representation", "to", "infer", "the", "answer", ".", "In", "order", "to", "facilitate", "the", "research", "of", "image", "QA", ",", "several", "data", "sets", "have", "been", "constructed", "in", "either", "through", "automatic", "generation", "based", "on", "image", "caption", "data", "or", "by", "human", "labeling", "of", "questions", "and", "answers", "given", "images", ".", "Among", "them", ",", "the", "image", "QA", "data", "set", "in", "is", "generated", "based", "on", "the", "COCO", "caption", "data", "set", ".", "Given", "a", "sentence", "that", "describes", "an", "image", ",", "the", "authors", "first", "used", "a", "parser", "to", "parse", "the", "sentence", ",", "then", "replaced", "the", "key", "word", "in", "the", "sentence", "using", "question", "words", "and", "the", "key", "word", "became", "the", "answer", ".", "created", "an", "image", "QA", "data", "set", "through", "human", "labeling", ".", "The", "initial", "version", "was", "in", "Chinese", "and", "then", "was", "translated", "to", "English", ".", "also", "created", "an", "image", "QA", "data", "set", "through", "human", "labeling", ".", "They", "collected", "questions", "and", "answers", "not", "only", "for", "real", "images", ",", "but", "also", "for", "abstract", "scenes", ".", "Several", "image", "QA", "models", "were", "proposed", "in", "the", "literature", ".", "used", "semantic", "parsers", "and", "image", "segmentation", "methods", "to", "predict", "answers", "based", "on", "images", "and", "questions", ".", "both", "used", "encoder", "-", "decoder", "framework", "to", "generate", "answers", "given", "images", "and", "questions", ".", "They", "first", "used", "a", "LSTM", "to", "encoder", "the", "images", "and", "questions", "and", "then", "used", "another", "LSTM", "to", "decode", "the", "answers", ".", "They", "both", "fed", "the", "image", "feature", "to", "every", "LSTM", "cell", ".", "proposed", "several", "neural", "network", "based", "models", ",", "including", "the", "encoder", "-", "decoder", "based", "models", "that", "use", "single", "direction", "LSTMs", "and", "bi", "-", "direction", "LSTMs", ",", "respectively", ".", "However", ",", "the", "authors", "found", "the", "concatenation", "of", "image", "features", "and", "bag", "of", "words", "features", "worked", "the", "best", ".", "first", "encoded", "questions", "with", "LSTMs", "and", "then", "combined", "question", "vectors", "with", "image", "vectors", "by", "element", "wise", "multiplication", ".", "used", "a", "CNN", "for", "question", "modeling", "and", "used", "convolution", "operations", "to", "combine", "question", "vectors", "and", "image", "feature", "vectors", ".", "We", "compare", "the", "SAN", "with", "these", "models", "in", "Sec", ".", "[", "reference", "]", ".", "To", "the", "best", "of", "our", "knowledge", ",", "the", "attention", "mechanism", ",", "which", "has", "been", "proved", "very", "successful", "in", "image", "captioning", ",", "has", "not", "been", "explored", "for", "image", "QA", ".", "The", "SAN", "adapt", "the", "attention", "mechanism", "to", "image", "QA", ",", "and", "can", "be", "viewed", "as", "a", "significant", "extension", "to", "previous", "models", "in", "that", "multiple", "attention", "layers", "are", "used", "to", "support", "multi", "-", "step", "reasoning", "for", "the", "image", "QA", "task", ".", "section", ":", "Stacked", "Attention", "Networks", "(", "SANs", ")", "The", "overall", "architecture", "of", "the", "SAN", "is", "shown", "in", "Fig", ".", "[", "reference", "]", ".", "We", "describe", "the", "three", "major", "components", "of", "SAN", "in", "this", "section", ":", "the", "image", "model", ",", "the", "question", "model", ",", "and", "the", "stacked", "attention", "model", ".", "subsection", ":", "Image", "Model", "The", "image", "model", "uses", "a", "CNN", "to", "get", "the", "representation", "of", "images", ".", "Specifically", ",", "the", "VGGNet", "is", "used", "to", "extract", "the", "image", "feature", "map", "from", "a", "raw", "image", ":", "Unlike", "previous", "studies", "that", "use", "features", "from", "the", "last", "inner", "product", "layer", ",", "we", "choose", "the", "features", "from", "the", "last", "pooling", "layer", ",", "which", "retains", "spatial", "information", "of", "the", "original", "images", ".", "We", "first", "rescale", "the", "images", "to", "be", "pixels", ",", "and", "then", "take", "the", "features", "from", "the", "last", "pooling", "layer", ",", "which", "therefore", "have", "a", "dimension", "of", ",", "as", "shown", "in", "Fig", ".", "[", "reference", "]", ".", "is", "the", "number", "of", "regions", "in", "the", "image", "and", "is", "the", "dimension", "of", "the", "feature", "vector", "for", "each", "region", ".", "Accordingly", ",", "each", "feature", "vector", "in", "corresponds", "to", "a", "pixel", "region", "of", "the", "input", "images", ".", "We", "denote", "by", "the", "feature", "vector", "of", "each", "image", "region", ".", "Then", "for", "modeling", "convenience", ",", "we", "use", "a", "single", "layer", "perceptron", "to", "transform", "each", "feature", "vector", "to", "a", "new", "vector", "that", "has", "the", "same", "dimension", "as", "the", "question", "vector", "(", "described", "in", "Sec", ".", "[", "reference", "]", ")", ":", "where", "is", "a", "matrix", "and", "its", "i", "-", "th", "column", "is", "the", "visual", "feature", "vector", "for", "the", "region", "indexed", "by", ".", "subsection", ":", "Question", "Model", "As", "show", "that", "LSTMs", "and", "CNNs", "are", "powerful", "to", "capture", "the", "semantic", "meaning", "of", "texts", ",", "we", "explore", "both", "models", "for", "question", "representations", "in", "this", "study", ".", "subsubsection", ":", "LSTM", "based", "question", "model", "The", "essential", "structure", "of", "a", "LSTM", "unit", "is", "a", "memory", "cell", "which", "reserves", "the", "state", "of", "a", "sequence", ".", "At", "each", "step", ",", "the", "LSTM", "unit", "takes", "one", "input", "vector", "(", "word", "vector", "in", "our", "case", ")", "and", "updates", "the", "memory", "cell", ",", "then", "output", "a", "hidden", "state", ".", "The", "update", "process", "uses", "the", "gate", "mechanism", ".", "A", "forget", "gate", "controls", "how", "much", "information", "from", "past", "state", "is", "preserved", ".", "An", "input", "gate", "controls", "how", "much", "the", "current", "input", "updates", "the", "memory", "cell", ".", "An", "output", "gate", "controls", "how", "much", "information", "of", "the", "memory", "is", "fed", "to", "the", "output", "as", "hidden", "state", ".", "The", "detailed", "update", "process", "is", "as", "follows", ":", "where", "are", "input", "gate", ",", "forget", "gate", ",", "output", "gate", "and", "memory", "cell", ",", "respectively", ".", "The", "weight", "matrix", "and", "bias", "are", "parameters", "of", "the", "LSTM", "and", "are", "learned", "on", "training", "data", ".", "Given", "the", "question", ",", "where", "is", "the", "one", "hot", "vector", "representation", "of", "word", "at", "position", ",", "we", "first", "embed", "the", "words", "to", "a", "vector", "space", "through", "an", "embedding", "matrix", ".", "Then", "for", "every", "time", "step", ",", "we", "feed", "the", "embedding", "vector", "of", "words", "in", "the", "question", "to", "LSTM", ":", "As", "shown", "in", "Fig", ".", "[", "reference", "]", ",", "the", "question", "what", "are", "sitting", "in", "the", "basket", "on", "a", "bicycle", "is", "fed", "into", "the", "LSTM", ".", "Then", "the", "final", "hidden", "layer", "is", "taken", "as", "the", "representation", "vector", "for", "the", "question", ",", "i.e.", ",", ".", "subsubsection", ":", "CNN", "based", "question", "model", "In", "this", "study", ",", "we", "also", "explore", "to", "use", "a", "CNN", "similar", "to", "for", "question", "representation", ".", "Similar", "to", "the", "LSTM", "-", "based", "question", "model", ",", "we", "first", "embed", "words", "to", "vectors", "and", "get", "the", "question", "vector", "by", "concatenating", "the", "word", "vectors", ":", "Then", "we", "apply", "convolution", "operation", "on", "the", "word", "embedding", "vectors", ".", "We", "use", "three", "convolution", "filters", ",", "which", "have", "the", "size", "of", "one", "(", "unigram", ")", ",", "two", "(", "bigram", ")", "and", "three", "(", "trigram", ")", "respectively", ".", "The", "-", "th", "convolution", "output", "using", "window", "size", "is", "given", "by", ":", "The", "filter", "is", "applied", "only", "to", "window", "of", "size", ".", "is", "the", "convolution", "weight", "and", "is", "the", "bias", ".", "The", "feature", "map", "of", "the", "filter", "with", "convolution", "size", "is", "given", "by", ":", "Then", "we", "apply", "max", "-", "pooling", "over", "the", "feature", "maps", "of", "the", "convolution", "size", "and", "denote", "it", "as", "The", "max", "-", "pooling", "over", "these", "vectors", "is", "a", "coordinate", "-", "wise", "max", "operation", ".", "For", "convolution", "feature", "maps", "of", "different", "sizes", ",", "we", "concatenate", "them", "to", "form", "the", "feature", "representation", "vector", "of", "the", "whole", "question", "sentence", ":", "hence", "is", "the", "CNN", "based", "question", "vector", ".", "The", "diagram", "of", "CNN", "model", "for", "question", "is", "shown", "in", "Fig", ".", "[", "reference", "]", ".", "The", "convolutional", "and", "pooling", "layers", "for", "unigrams", ",", "bigrams", "and", "trigrams", "are", "drawn", "in", "red", ",", "blue", "and", "orange", ",", "respectively", ".", "subsection", ":", "Stacked", "Attention", "Networks", "Given", "the", "image", "feature", "matrix", "and", "the", "question", "feature", "vector", ",", "SAN", "predicts", "the", "answer", "via", "multi", "-", "step", "reasoning", ".", "In", "many", "cases", ",", "an", "answer", "only", "related", "to", "a", "small", "region", "of", "an", "image", ".", "For", "example", ",", "in", "Fig", ".", "[", "reference", "]", ",", "although", "there", "are", "multiple", "objects", "in", "the", "image", ":", "bicycles", ",", "baskets", ",", "window", ",", "street", "and", "dogs", "and", "the", "answer", "to", "the", "question", "only", "relates", "to", "dogs", ".", "Therefore", ",", "using", "the", "one", "global", "image", "feature", "vector", "to", "predict", "the", "answer", "could", "lead", "to", "sub", "-", "optimal", "results", "due", "to", "the", "noises", "introduced", "from", "regions", "that", "are", "irrelevant", "to", "the", "potential", "answer", ".", "Instead", ",", "reasoning", "via", "multiple", "attention", "layers", "progressively", ",", "the", "SAN", "are", "able", "to", "gradually", "filter", "out", "noises", "and", "pinpoint", "the", "regions", "that", "are", "highly", "relevant", "to", "the", "answer", ".", "Given", "the", "image", "feature", "matrix", "and", "the", "question", "vector", ",", "we", "first", "feed", "them", "through", "a", "single", "layer", "neural", "network", "and", "then", "a", "softmax", "function", "to", "generate", "the", "attention", "distribution", "over", "the", "regions", "of", "the", "image", ":", "where", ",", "is", "the", "image", "representation", "dimension", "and", "is", "the", "number", "of", "image", "regions", ",", "is", "a", "dimensional", "vector", ".", "Suppose", "and", ",", "then", "is", "an", "dimensional", "vector", ",", "which", "corresponds", "to", "the", "attention", "probability", "of", "each", "image", "region", "given", ".", "Note", "that", "we", "denote", "by", "the", "addition", "of", "a", "matrix", "and", "a", "vector", ".", "Since", "and", "both", "are", "vectors", ",", "the", "addition", "between", "a", "matrix", "and", "a", "vector", "is", "performed", "by", "adding", "each", "column", "of", "the", "matrix", "by", "the", "vector", ".", "Based", "on", "the", "attention", "distribution", ",", "we", "calculate", "the", "weighted", "sum", "of", "the", "image", "vectors", ",", "each", "from", "a", "region", ",", "as", "in", "Eq", ".", "[", "reference", "]", ".", "We", "then", "combine", "with", "the", "question", "vector", "to", "form", "a", "refined", "query", "vector", "as", "in", "Eq", ".", "[", "reference", "]", ".", "is", "regarded", "as", "a", "refined", "query", "since", "it", "encodes", "both", "question", "information", "and", "the", "visual", "information", "that", "is", "relevant", "to", "the", "potential", "answer", ":", "Compared", "to", "models", "that", "simply", "combine", "the", "question", "vector", "and", "the", "global", "image", "vector", ",", "attention", "models", "construct", "a", "more", "informative", "since", "higher", "weights", "are", "put", "on", "the", "visual", "regions", "that", "are", "more", "relevant", "to", "the", "question", ".", "However", ",", "for", "complicated", "questions", ",", "a", "single", "attention", "layer", "is", "not", "sufficient", "to", "locate", "the", "correct", "region", "for", "answer", "prediction", ".", "For", "example", ",", "the", "question", "in", "Fig", ".", "[", "reference", "]", "what", "are", "sitting", "in", "the", "basket", "on", "a", "bicycle", "refers", "to", "some", "subtle", "relationships", "among", "multiple", "objects", "in", "an", "image", ".", "Therefore", ",", "we", "iterate", "the", "above", "query", "-", "attention", "process", "using", "multiple", "attention", "layers", ",", "each", "extracting", "more", "fine", "-", "grained", "visual", "attention", "information", "for", "answer", "prediction", ".", "Formally", ",", "the", "SANs", "take", "the", "following", "formula", ":", "for", "the", "-", "th", "attention", "layer", ",", "we", "compute", ":", "where", "is", "initialized", "to", "be", ".", "Then", "the", "aggregated", "image", "feature", "vector", "is", "added", "to", "the", "previous", "query", "vector", "to", "form", "a", "new", "query", "vector", ":", "That", "is", ",", "in", "every", "layer", ",", "we", "use", "the", "combined", "question", "and", "image", "vector", "as", "the", "query", "for", "the", "image", ".", "After", "the", "image", "region", "is", "picked", ",", "we", "update", "the", "new", "query", "vector", "as", ".", "We", "repeat", "this", "times", "and", "then", "use", "the", "final", "to", "infer", "the", "answer", ":", "Fig", ".", "[", "reference", "]", "illustrates", "the", "reasoning", "process", "by", "an", "example", ".", "In", "the", "first", "attention", "layer", ",", "the", "model", "identifies", "roughly", "the", "area", "that", "are", "relevant", "to", "basket", ",", "bicycle", ",", "and", "sitting", "in", ".", "In", "the", "second", "attention", "layer", ",", "the", "model", "focuses", "more", "sharply", "on", "the", "region", "that", "corresponds", "to", "the", "answer", "dogs", ".", "More", "examples", "can", "be", "found", "in", "Sec", ".", "[", "reference", "]", ".", "section", ":", "Experiments", "subsection", ":", "Data", "sets", "We", "evaluate", "the", "SAN", "on", "four", "image", "QA", "data", "sets", ".", "DAQUAR", "-", "ALL", "is", "proposed", "in", ".", "There", "are", "training", "questions", "and", "test", "questions", ".", "These", "questions", "are", "generated", "on", "and", "images", "respectively", ".", "The", "images", "are", "mainly", "indoor", "scenes", ".", "The", "questions", "are", "categorized", "into", "three", "types", "including", "Object", ",", "Color", "and", "Number", ".", "Most", "of", "the", "answers", "are", "single", "words", ".", "Following", "the", "setting", "in", ",", "we", "exclude", "data", "samples", "that", "have", "multiple", "words", "answers", ".", "The", "remaining", "data", "set", "covers", "of", "the", "original", "data", "set", ".", "DAQUAR", "-", "REDUCED", "is", "a", "reduced", "version", "of", "DAQUAR", "-", "ALL", ".", "There", "are", "training", "samples", "and", "test", "samples", ".", "This", "data", "set", "is", "constrained", "to", "object", "categories", "and", "uses", "only", "test", "images", ".", "The", "single", "word", "answers", "data", "set", "covers", "of", "the", "original", "data", "set", ".", "COCO", "-", "QA", "is", "proposed", "in", ".", "Based", "on", "the", "Microsoft", "COCO", "data", "set", ",", "the", "authors", "first", "parse", "the", "caption", "of", "the", "image", "with", "an", "off", "-", "the", "-", "shelf", "parser", ",", "then", "replace", "the", "key", "components", "in", "the", "caption", "with", "question", "words", "for", "form", "questions", ".", "There", "are", "training", "samples", "and", "test", "samples", "in", "the", "data", "set", ".", "These", "questions", "are", "based", "on", "and", "images", "respectively", ".", "There", "are", "four", "types", "of", "questions", "including", "Object", ",", "Number", ",", "Color", ",", "and", "Location", ".", "Each", "type", "takes", ",", "and", "of", "the", "whole", "data", "set", ",", "respectively", ".", "All", "answers", "in", "this", "data", "set", "are", "single", "word", ".", "VQA", "is", "created", "through", "human", "labeling", ".", "The", "data", "set", "uses", "images", "in", "the", "COCO", "image", "caption", "data", "set", ".", "Unlike", "the", "other", "data", "sets", ",", "for", "each", "image", ",", "there", "are", "three", "questions", "and", "for", "each", "question", ",", "there", "are", "ten", "answers", "labeled", "by", "human", "annotators", ".", "There", "are", "training", "questions", "and", "validation", "questions", "in", "the", "data", "set", ".", "Following", ",", "we", "use", "the", "top", "most", "frequent", "answer", "as", "possible", "outputs", "and", "this", "set", "of", "answers", "covers", "of", "all", "answers", ".", "We", "first", "studied", "the", "performance", "of", "the", "proposed", "model", "on", "the", "validation", "set", ".", "Following", ",", "we", "split", "the", "validation", "data", "set", "into", "two", "halves", ",", "val1", "and", "val2", ".", "We", "use", "training", "set", "and", "val1", "to", "train", "and", "validate", "and", "val2", "to", "test", "locally", ".", "The", "results", "on", "the", "val2", "set", "are", "reported", "in", "Table", ".", "[", "reference", "]", ".", "We", "also", "evaluated", "the", "best", "model", ",", "SAN", "(", "2", ",", "CNN", ")", ",", "on", "the", "standard", "test", "server", "as", "provided", "in", "and", "report", "the", "results", "in", "Table", ".", "[", "reference", "]", ".", "subsection", ":", "Baselines", "and", "evaluation", "methods", "We", "compare", "our", "models", "with", "a", "set", "of", "baselines", "proposed", "recently", "on", "image", "QA", ".", "Since", "the", "results", "of", "these", "baselines", "are", "reported", "on", "different", "data", "sets", "in", "different", "literature", ",", "we", "present", "the", "experimental", "results", "on", "different", "data", "sets", "in", "different", "tables", ".", "For", "all", "four", "data", "sets", ",", "we", "formulate", "image", "QA", "as", "a", "classification", "problem", "since", "most", "of", "answers", "are", "single", "words", ".", "We", "evaluate", "the", "model", "using", "classification", "accuracy", "as", "reported", "in", ".", "The", "reference", "models", "also", "report", "the", "Wu", "-", "Palmer", "similarity", "(", "WUPS", ")", "measure", ".", "The", "WUPS", "measure", "calculates", "the", "similarity", "between", "two", "words", "based", "on", "their", "longest", "common", "subsequence", "in", "the", "taxonomy", "tree", ".", "We", "can", "set", "a", "threshold", "for", "WUPS", ",", "if", "the", "similarity", "is", "less", "than", "the", "threshold", ",", "then", "it", "is", "zeroed", "out", ".", "Following", "the", "reference", "models", ",", "we", "use", "WUPS0.9", "and", "WUPS0.0", "as", "evaluation", "metrics", "besides", "the", "classification", "accuracy", ".", "The", "evaluation", "on", "the", "VQA", "data", "set", "is", "different", "from", "other", "three", "data", "sets", ",", "since", "for", "each", "question", "there", "are", "ten", "answer", "labels", "that", "may", "or", "may", "not", "be", "the", "same", ".", "We", "follow", "to", "use", "the", "following", "metric", ":", ",", "which", "basically", "gives", "full", "credit", "to", "the", "answer", "when", "three", "or", "more", "of", "the", "ten", "human", "labels", "match", "the", "answer", "and", "gives", "partial", "credit", "if", "there", "are", "less", "matches", ".", "subsection", ":", "Model", "configuration", "and", "training", "For", "the", "image", "model", ",", "we", "use", "the", "VGGNet", "to", "extract", "features", ".", "When", "training", "the", "SAN", ",", "the", "parameter", "set", "of", "the", "CNN", "of", "the", "VGGNet", "is", "fixed", ".", "We", "take", "the", "output", "from", "the", "last", "pooling", "layer", "as", "our", "image", "feature", "which", "has", "a", "dimension", "of", ".", "For", "DAQUAR", "and", "COCO", "-", "QA", ",", "we", "set", "the", "word", "embedding", "dimension", "and", "LSTM", "\u2019s", "dimension", "to", "be", "in", "the", "question", "model", ".", "For", "the", "CNN", "based", "question", "model", ",", "we", "set", "the", "unigram", ",", "bigram", "and", "trigram", "convolution", "filter", "size", "to", "be", ",", ",", "respectively", ".", "The", "combination", "of", "these", "filters", "makes", "the", "question", "vector", "size", "to", "be", ".", "For", "VQA", "dataset", ",", "since", "it", "is", "larger", "than", "other", "data", "sets", ",", "we", "double", "the", "model", "size", "of", "the", "LSTM", "and", "the", "CNN", "to", "accommodate", "the", "large", "data", "set", "and", "the", "large", "number", "of", "classes", ".", "In", "evaluation", ",", "we", "experiment", "with", "SAN", "with", "one", "and", "two", "attention", "layers", ".", "We", "find", "that", "using", "three", "or", "more", "attention", "layers", "does", "not", "further", "improve", "the", "performance", ".", "In", "our", "experiments", ",", "all", "the", "models", "are", "trained", "using", "stochastic", "gradient", "descent", "with", "momentum", ".", "The", "batch", "size", "is", "fixed", "to", "be", ".", "The", "best", "learning", "rate", "is", "picked", "using", "grid", "search", ".", "Gradient", "clipping", "technique", "and", "dropout", "are", "used", ".", "subsection", ":", "Results", "and", "analysis", "The", "experimental", "results", "on", "DAQUAR", "-", "ALL", ",", "DAQUAR", "-", "REDUCED", ",", "COCO", "-", "QA", "and", "VQA", "are", "presented", "in", "Table", ".", "[", "reference", "]", "to", "[", "reference", "]", "respectively", ".", "Our", "model", "names", "explain", "their", "settings", ":", "SAN", "is", "short", "for", "the", "proposed", "stacked", "attention", "networks", ",", "the", "value", "1", "or", "2", "in", "the", "brackets", "refer", "to", "using", "one", "or", "two", "attention", "layers", ",", "respectively", ".", "The", "keyword", "LSTM", "or", "CNN", "refers", "to", "the", "question", "model", "that", "SANs", "use", ".", "Yes", "/", "No", "36", "%", "Number", "10", "%", "Other", "54", "%", "The", "experimental", "results", "in", "Table", ".", "[", "reference", "]", "to", "[", "reference", "]", "show", "that", "the", "two", "-", "layer", "SAN", "gives", "the", "best", "results", "across", "all", "data", "sets", "and", "the", "two", "kinds", "of", "question", "models", "in", "the", "SAN", ",", "LSTM", "and", "CNN", ",", "give", "similar", "performance", ".", "For", "example", ",", "on", "DAQUAR", "-", "ALL", "(", "Table", ".", "[", "reference", "]", ")", ",", "both", "of", "the", "proposed", "two", "-", "layer", "SANs", "outperform", "the", "two", "best", "baselines", ",", "the", "IMG", "-", "CNN", "in", "and", "the", "Ask", "-", "Your", "-", "Neuron", "in", ",", "by", "and", "absolute", "in", "accuracy", ",", "respectively", ".", "Similar", "range", "of", "improvements", "are", "observed", "in", "metrics", "of", "WUPS0.9", "and", "WUPS0.0", ".", "We", "also", "observe", "significant", "improvements", "on", "DAQUAR", "-", "REDUCED", "(", "Table", ".", "[", "reference", "]", ")", ",", "i.e.", ",", "our", "SAN", "(", "2", ",", "LSTM", ")", "outperforms", "the", "IMG", "-", "CNN", ",", "the", "2", "-", "VIS", "+", "BLSTM", ",", "the", "Ask", "-", "Your", "-", "Neurons", "approach", "and", "the", "Multi", "-", "World", "by", ",", ",", "and", "absolute", "in", "accuracy", ",", "respectively", ".", "On", "the", "larger", "COCO", "-", "QA", "data", "set", ",", "the", "proposed", "two", "-", "layer", "SANs", "significantly", "outperform", "the", "best", "baselines", "from", "(", "IMG", "-", "CNN", ")", "and", "(", "IMG", "+", "BOW", "and", "2", "-", "VIS", "+", "BLSTM", ")", "by", "5.1", "%", "and", "6.6", "%", "in", "accuracy", "(", "Table", ".", "[", "reference", "]", ")", ".", "Table", ".", "[", "reference", "]", "summarizes", "the", "performance", "of", "various", "models", "on", "VQA", ",", "which", "is", "the", "largest", "among", "the", "four", "data", "sets", ".", "The", "overall", "results", "show", "that", "our", "best", "model", ",", "SAN", "(", "2", ",", "CNN", ")", ",", "outperforms", "the", "LSTM", "Q", "+", "I", "model", ",", "the", "best", "baseline", "from", ",", "by", "4.8", "%", "absolute", ".", "The", "superior", "performance", "of", "the", "SANs", "across", "all", "four", "benchmarks", "demonstrate", "the", "effectiveness", "of", "using", "multiple", "layers", "of", "attention", ".", "In", "order", "to", "study", "the", "strength", "and", "weakness", "of", "the", "SAN", "in", "detail", ",", "we", "report", "performance", "at", "the", "question", "-", "type", "level", "on", "the", "two", "large", "data", "sets", ",", "COCO", "-", "QA", "and", "VQA", ",", "in", "Table", ".", "[", "reference", "]", "and", "[", "reference", "]", ",", "respectively", ".", "We", "observe", "that", "on", "COCO", "-", "QA", ",", "compared", "to", "the", "two", "best", "baselines", ",", "IMG", "+", "BOW", "and", "2", "-", "VIS", "+", "BLSTM", ",", "out", "best", "model", "SAN", "(", "2", ",", "CNN", ")", "improves", "7.2", "%", "in", "the", "question", "type", "of", "Color", ",", "followed", "by", "6.1", "%", "in", "Objects", ",", "5.7", "%", "in", "Location", "and", "4.2", "%", "in", "Number", ".", "We", "observe", "similar", "trend", "of", "improvements", "on", "VQA", ".", "As", "shown", "in", "Table", ".", "[", "reference", "]", ",", "compared", "to", "the", "best", "baseline", "LSTM", "Q", "+", "I", ",", "the", "biggest", "improvement", "of", "SAN", "(", "2", ",", "CNN", ")", "is", "in", "the", "Other", "type", ",", "9.7", "%", ",", "followed", "by", "the", "1.4", "%", "improvement", "in", "Number", "and", "0.4", "%", "improvement", "in", "Yes", "/", "No", ".", "Note", "that", "the", "Other", "type", "in", "VQA", "refers", "to", "questions", "that", "usually", "have", "the", "form", "of", "\u201c", "what", "color", ",", "what", "kind", ",", "what", "are", ",", "what", "type", ",", "where", "\u201d", "etc", ".", ",", "which", "are", "similar", "to", "question", "types", "of", "Color", ",", "Objects", "and", "Location", "in", "COCO", "-", "QA", ".", "The", "VQA", "data", "set", "has", "a", "special", "Yes", "/", "No", "type", "of", "questions", ".", "The", "SAN", "only", "improves", "the", "performance", "of", "this", "type", "of", "questions", "slightly", ".", "This", "could", "due", "to", "that", "the", "answer", "for", "a", "Yes", "/", "No", "question", "is", "very", "question", "dependent", ",", "so", "better", "modeling", "of", "the", "visual", "information", "does", "not", "provide", "much", "additional", "gains", ".", "This", "also", "confirms", "the", "similar", "observation", "reported", "in", ",", "e.g.", ",", "using", "additional", "image", "information", "only", "slightly", "improves", "the", "performance", "in", "Yes", "/", "No", ",", "as", "shown", "in", "Table", ".", "[", "reference", "]", ",", "Q", "+", "I", "vs", "Question", ",", "and", "LSTM", "Q", "+", "I", "vs", "LSTM", "Q.", "Our", "results", "demonstrate", "clearly", "the", "positive", "impact", "of", "using", "multiple", "attention", "layers", ".", "In", "all", "four", "data", "sets", ",", "two", "-", "layer", "SANs", "always", "perform", "better", "than", "the", "one", "-", "layer", "SAN", ".", "Specifically", ",", "on", "COCO", "-", "QA", ",", "on", "average", "the", "two", "-", "layer", "SANs", "outperform", "the", "one", "-", "layer", "SANs", "by", "2.2", "%", "in", "the", "type", "of", "Color", ",", "followed", "by", "1.3", "%", "and", "1.0", "%", "in", "the", "Location", "and", "Objects", "categories", ",", "and", "then", "0.4", "%", "in", "Number", ".", "This", "aligns", "to", "the", "order", "of", "the", "improvements", "of", "the", "SAN", "over", "baselines", ".", "Similar", "trends", "are", "observed", "on", "VQA", "(", "Table", ".", "[", "reference", "]", ")", ",", "e.g.", ",", "the", "two", "-", "layer", "SAN", "improve", "over", "the", "one", "-", "layer", "SAN", "by", "1.4", "%", "for", "the", "Other", "type", "of", "question", ",", "followed", "by", "0.2", "%", "improvement", "for", "Number", ",", "and", "flat", "for", "Yes", "/", "No", ".", "subsection", ":", "Visualization", "of", "attention", "layers", "In", "this", "section", ",", "we", "present", "analysis", "to", "demonstrate", "that", "using", "multiple", "attention", "layers", "to", "perform", "multi", "-", "step", "reasoning", "leads", "to", "more", "fine", "-", "grained", "attention", "layer", "-", "by", "-", "layer", "in", "locating", "the", "regions", "that", "are", "relevant", "to", "the", "potential", "answers", ".", "We", "do", "so", "by", "visualizing", "the", "outputs", "of", "the", "attention", "layers", "of", "a", "sample", "set", "of", "images", "from", "the", "COCO", "-", "QA", "test", "set", ".", "Note", "the", "attention", "probability", "distribution", "is", "of", "size", "and", "the", "original", "image", "is", ",", "we", "up", "-", "sample", "the", "attention", "probability", "distribution", "and", "apply", "a", "Gaussian", "filter", "to", "make", "it", "the", "same", "size", "as", "the", "original", "image", ".", "Fig", ".", "[", "reference", "]", "presents", "six", "examples", ".", "More", "examples", "are", "presented", "in", "the", "appendix", ".", "They", "cover", "types", "as", "broad", "as", "Object", ",", "Numbers", ",", "Color", "and", "Location", ".", "For", "each", "example", ",", "the", "three", "images", "from", "left", "to", "right", "are", "the", "original", "image", ",", "the", "output", "of", "the", "first", "attention", "layer", "and", "the", "output", "of", "the", "second", "attention", "layer", ",", "respectively", ".", "The", "bright", "part", "of", "the", "image", "is", "the", "detected", "attention", ".", "Across", "all", "those", "examples", ",", "we", "see", "that", "in", "the", "first", "attention", "layer", ",", "the", "attention", "is", "scattered", "on", "many", "objects", "in", "the", "image", ",", "largely", "corresponds", "to", "the", "objects", "and", "concepts", "referred", "in", "the", "question", ",", "whereas", "in", "the", "second", "layer", ",", "the", "attention", "is", "far", "more", "focused", "on", "the", "regions", "that", "lead", "to", "the", "correct", "answer", ".", "For", "example", ",", "consider", "the", "question", "what", "is", "the", "color", "of", "the", "horns", ",", "which", "asks", "the", "color", "of", "the", "horn", "on", "the", "woman", "\u2019s", "head", "in", "Fig", ".", "[", "reference", "]", "(", "f", ")", ".", "In", "the", "output", "of", "the", "first", "attention", "layer", ",", "the", "model", "first", "recognizes", "a", "woman", "in", "the", "image", ".", "In", "the", "output", "of", "the", "second", "attention", "layer", ",", "the", "attention", "is", "focused", "on", "the", "head", "of", "the", "woman", ",", "which", "leads", "to", "the", "answer", "of", "the", "question", ":", "the", "color", "of", "the", "horn", "is", "red", ".", "subsection", ":", "Errors", "analysis", "We", "randomly", "sample", "100", "images", "from", "the", "COCO", "-", "QA", "test", "set", "that", "the", "SAN", "make", "mistakes", ".", "We", "group", "the", "errors", "into", "four", "categories", ":", "(", "i", ")", "the", "SANs", "focus", "the", "attention", "on", "the", "wrong", "regions", "(", "22", "%", ")", ",", "e.g.", ",", "the", "example", "in", "Fig", ".", "[", "reference", "]", "(", "a", ")", ";", "(", "ii", ")", "the", "SANs", "focus", "on", "the", "right", "region", "but", "predict", "a", "wrong", "answer", "(", "42", "%", ")", ",", "e.g.", ",", "the", "examples", "in", "Fig", ".", "[", "reference", "]", "(", "b", ")(", "c", ")(", "d", ")", ";", "(", "iii", ")", "the", "answer", "is", "ambiguous", ",", "the", "SANs", "give", "answers", "that", "are", "different", "from", "labels", ",", "but", "might", "be", "acceptable", "(", "31", "%", ")", ".", "E.g.", ",", "in", "Fig", ".", "[", "reference", "]", "(", "e", ")", ",", "the", "answer", "label", "is", "pot", ",", "but", "out", "model", "predicts", "vase", ",", "which", "is", "also", "visually", "reasonable", ";", "(", "iv", ")", "the", "labels", "are", "clearly", "wrong", "(", "5", "%", ")", ".", "E.g.", ",", "in", "Fig", ".", "[", "reference", "]", "(", "f", ")", ",", "our", "model", "gives", "the", "correct", "answer", "trains", "while", "the", "label", "cars", "is", "wrong", ".", "section", ":", "Conclusion", "In", "this", "paper", ",", "we", "propose", "a", "new", "stacked", "attention", "network", "(", "SAN", ")", "for", "image", "QA", ".", "SAN", "uses", "a", "multiple", "-", "layer", "attention", "mechanism", "that", "queries", "an", "image", "multiple", "times", "to", "locate", "the", "relevant", "visual", "region", "and", "to", "infer", "the", "answer", "progressively", ".", "Experimental", "results", "demonstrate", "that", "the", "proposed", "SAN", "significantly", "outperforms", "previous", "state", "-", "of", "-", "the", "-", "art", "approaches", "by", "a", "substantial", "margin", "on", "all", "four", "image", "QA", "data", "sets", ".", "The", "visualization", "of", "the", "attention", "layers", "further", "illustrates", "the", "process", "that", "the", "SAN", "focuses", "the", "attention", "to", "the", "relevant", "visual", "clues", "that", "lead", "to", "the", "answer", "of", "the", "question", "layer", "-", "by", "-", "layer", ".", "bibliography", ":", "References"]}