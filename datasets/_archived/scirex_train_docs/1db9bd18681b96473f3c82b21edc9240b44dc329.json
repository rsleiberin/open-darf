{"coref": {"CIFAR-10": [[948, 953], [3076, 3079], [3179, 3182], [3275, 3278], [3512, 3515], [4351, 4354], [4364, 4369], [3207, 3210], [3242, 3245]], "Image_Generation": [[0, 2], [58, 60], [121, 123], [773, 778], [1012, 1014], [1088, 1089], [1435, 1439], [735, 737], [765, 767], [866, 868]], "Image_Transformer": [[50, 51], [541, 543], [618, 620], [769, 771], [817, 819], [1521, 1523], [1568, 1570], [3158, 3160], [3194, 3196], [3669, 3671], [3746, 3749], [4472, 4474], [4544, 4546], [3510, 3511]], "Model_Entropy": []}, "coref_non_salient": {"0": [[928, 930], [2769, 2771]], "1": [[8, 11], [832, 836]], "10": [[879, 881], [2738, 2740]], "100": [[4101, 4104]], "101": [[935, 937]], "102": [[1097, 1098]], "103": [[401, 405]], "104": [[269, 273]], "105": [[718, 719]], "106": [[451, 452]], "107": [[1540, 1541], [3685, 3688]], "108": [[1915, 1917], [2230, 2232]], "109": [[985, 986]], "11": [[3795, 3800], [4015, 4016], [4017, 4020]], "110": [[4037, 4039]], "111": [[249, 253]], "112": [[1029, 1031]], "113": [[4027, 4031]], "114": [[883, 887]], "115": [[1112, 1113]], "116": [[1095, 1096]], "117": [[12, 14]], "118": [[2716, 2718]], "119": [[211, 213]], "12": [[1727, 1731], [3110, 3114], [3131, 3135], [3250, 3256], [3309, 3313], [3801, 3805], [3952, 3956], [3964, 3968]], "120": [[2112, 2114]], "121": [[1554, 1556]], "122": [[2849, 2851]], "123": [[3595, 3598]], "124": [[3909, 3915]], "125": [[3200, 3201]], "126": [[1558, 1564]], "127": [[2918, 2920]], "128": [[3888, 3892]], "129": [[714, 717]], "13": [[1371, 1373], [3440, 3443]], "130": [[1019, 1022]], "14": [[1549, 1551], [1925, 1927]], "15": [[2027, 2029], [2308, 2310]], "16": [[2485, 2489], [3903, 3906], [3976, 3979]], "17": [[640, 643], [3519, 3522], [3844, 3849]], "18": [[3055, 3061], [3163, 3169]], "19": [[124, 125], [135, 136], [3263, 3264], [3350, 3351], [4494, 4495], [633, 634], [3187, 3188], [3288, 3289]], "2": [[945, 947], [4486, 4489]], "20": [[1583, 1586], [1605, 1608], [1770, 1776], [2076, 2080], [2211, 2214], [2398, 2401]], "21": [[3387, 3391], [3402, 3406], [3788, 3794], [4450, 4454]], "22": [[146, 150], [710, 713], [794, 797], [1090, 1095], [2972, 2975], [3582, 3586], [3586, 3589], [3840, 3842], [4498, 4501]], "23": [[1358, 1363], [1616, 1619]], "24": [[110, 112], [3049, 3052], [3284, 3286]], "25": [[3063, 3066], [4380, 4383]], "26": [[1474, 1476], [2921, 2922]], "27": [[2382, 2384], [2496, 2498], [3500, 3502], [3708, 3711]], "28": [[558, 568], [1762, 1766]], "29": [[231, 232], [361, 362], [607, 608], [679, 680], [502, 503], [3237, 3238], [3323, 3324]], "3": [[4177, 4178], [4200, 4202]], "30": [[28, 31], [525, 527]], "31": [[20, 23], [45, 48], [68, 72], [468, 471], [550, 554], [1526, 1529], [1852, 1856], [2033, 2036], [2104, 2108], [3420, 3423], [3948, 3951], [4436, 4439]], "32": [[4010, 4012]], "33": [[681, 683]], "34": [[1457, 1458], [1511, 1512], [1516, 1519], [1546, 1547], [2117, 2118], [2142, 2143], [3680, 3681], [3682, 3683], [3691, 3692], [3762, 3763], [3783, 3784]], "35": [[1060, 1061], [4539, 4541]], "36": [[3900, 3902], [3921, 3923], [2362, 2364]], "37": [[4603, 4608]], "38": [[376, 377], [432, 433], [2681, 2682], [2959, 2961], [3454, 3455], [3528, 3530], [4152, 4154]], "39": [[3015, 3016]], "4": [[179, 183], [1443, 1447], [2120, 2124], [4221, 4226], [4358, 4362]], "40": [[2908, 2909]], "41": [[1222, 1224], [1352, 1354], [1506, 1508]], "42": [[2816, 2817], [3096, 3097], [3120, 3121], [3247, 3248], [3457, 3458]], "43": [[2759, 2763], [2811, 2815]], "44": [[101, 104], [316, 319], [355, 358], [2164, 2167]], "45": [[4580, 4586]], "46": [[153, 155], [798, 801]], "47": [[1530, 1537], [2038, 2045]], "48": [[381, 382], [3392, 3393]], "49": [[615, 616], [3831, 3833]], "5": [[3081, 3083], [3346, 3349]], "50": [[3931, 3932]], "51": [[3469, 3471]], "52": [[1460, 1472]], "53": [[229, 230], [374, 375], [2394, 2395], [3150, 3151], [491, 492], [909, 910], [910, 911], [2756, 2757]], "54": [[4041, 4044]], "55": [[2019, 2020], [3971, 3972]], "56": [[314, 315], [331, 332], [533, 534]], "57": [[4385, 4388]], "58": [[2962, 2969]], "59": [[4188, 4191], [4251, 4256]], "6": [[2366, 2369], [2622, 2625]], "60": [[1068, 1071], [4516, 4519]], "61": [[956, 958], [3152, 3154]], "62": [[158, 162], [821, 825], [1572, 1576], [3673, 3677]], "63": [[130, 134], [3927, 3930], [4374, 4378]], "64": [[2303, 2307]], "65": [[303, 306]], "66": [[2712, 2714]], "67": [[54, 57]], "68": [[384, 385]], "69": [[3053, 3054], [3289, 3290], [3524, 3525], [3543, 3544]], "7": [[3177, 3178], [4180, 4181]], "70": [[1451, 1455], [3835, 3839]], "71": [[4520, 4526]], "72": [[1072, 1073], [1103, 1104], [1159, 1160], [1207, 1208], [4547, 4548]], "73": [[4227, 4229]], "74": [[2772, 2773]], "75": [[1983, 1986]], "76": [[3340, 3342]], "77": [[1063, 1067]], "78": [[3021, 3023]], "79": [[1334, 1336]], "8": [[3087, 3090], [3336, 3339], [4280, 4284], [4306, 4310]], "80": [[2223, 2225]], "81": [[575, 581]], "82": [[730, 733]], "83": [[1906, 1908], [1989, 1991]], "84": [[3611, 3612]], "85": [[1037, 1039]], "86": [[1015, 1017]], "87": [[41, 43]], "88": [[206, 210]], "89": [[514, 517]], "9": [[2061, 2064], [2216, 2218]], "90": [[704, 708]], "91": [[1137, 1139]], "92": [[3173, 3174]], "93": [[1971, 1982]], "94": [[4013, 4014]], "95": [[689, 692]], "96": [[1610, 1614], [1702, 1713], [3293, 3301], [3752, 3759]], "97": [[266, 268]], "98": [[3552, 3556]], "99": [[351, 353]]}, "doc_id": "1db9bd18681b96473f3c82b21edc9240b44dc329", "method_subrelations": {"Image_Transformer": [[[0, 17], "Image_Transformer"]]}, "n_ary_relations": [{"Material": "CIFAR-10", "Method": "Image_Transformer", "Metric": "Model_Entropy", "Task": "Image_Generation", "score": "2.89"}], "ner": [[0, 2, "Task"], [8, 11, "Task"], [12, 14, "Task"], [20, 23, "Method"], [28, 31, "Task"], [41, 43, "Method"], [45, 48, "Method"], [50, 51, "Method"], [54, 57, "Method"], [58, 60, "Task"], [68, 72, "Method"], [101, 104, "Method"], [110, 112, "Method"], [121, 123, "Task"], [124, 125, "Material"], [130, 134, "Metric"], [135, 136, "Material"], [146, 150, "Task"], [153, 155, "Metric"], [158, 162, "Method"], [179, 183, "Method"], [206, 210, "Task"], [211, 213, "Method"], [229, 230, "Method"], [231, 232, "Method"], [249, 253, "Task"], [266, 268, "Task"], [269, 273, "Task"], [303, 306, "Task"], [314, 315, "Method"], [316, 319, "Method"], [351, 353, "Method"], [355, 358, "Method"], [361, 362, "Method"], [374, 375, "Method"], [376, 377, "Metric"], [381, 382, "Method"], [384, 385, "Method"], [401, 405, "Task"], [432, 433, "Metric"], [451, 452, "Metric"], [468, 471, "Method"], [514, 517, "Method"], [525, 527, "Task"], [541, 543, "Method"], [550, 554, "Method"], [558, 568, "Task"], [575, 581, "Method"], [607, 608, "Method"], [615, 616, "Task"], [618, 620, "Method"], [640, 643, "Metric"], [679, 680, "Method"], [681, 683, "Method"], [689, 692, "Method"], [704, 708, "Task"], [710, 713, "Task"], [714, 717, "Task"], [718, 719, "Task"], [730, 733, "Task"], [769, 771, "Method"], [773, 778, "Task"], [794, 797, "Task"], [798, 801, "Metric"], [817, 819, "Method"], [821, 825, "Method"], [832, 836, "Task"], [879, 881, "Method"], [883, 887, "Method"], [928, 930, "Method"], [935, 937, "Method"], [945, 947, "Task"], [948, 953, "Material"], [956, 958, "Method"], [985, 986, "Method"], [1012, 1014, "Task"], [1015, 1017, "Method"], [1019, 1022, "Method"], [1029, 1031, "Method"], [1037, 1039, "Method"], [1060, 1061, "Method"], [1063, 1067, "Method"], [1068, 1071, "Method"], [1072, 1073, "Method"], [1088, 1089, "Task"], [1090, 1095, "Task"], [1095, 1096, "Method"], [1097, 1098, "Method"], [1103, 1104, "Method"], [1112, 1113, "Method"], [1137, 1139, "Task"], [1159, 1160, "Method"], [1207, 1208, "Method"], [1222, 1224, "Method"], [1334, 1336, "Method"], [1352, 1354, "Method"], [1358, 1363, "Method"], [1371, 1373, "Method"], [1435, 1439, "Task"], [1443, 1447, "Method"], [1451, 1455, "Method"], [1457, 1458, "Method"], [1460, 1472, "Method"], [1474, 1476, "Method"], [1506, 1508, "Method"], [1511, 1512, "Method"], [1516, 1519, "Method"], [1521, 1523, "Method"], [1526, 1529, "Method"], [1530, 1537, "Method"], [1540, 1541, "Method"], [1546, 1547, "Method"], [1549, 1551, "Method"], [1554, 1556, "Method"], [1558, 1564, "Task"], [1568, 1570, "Method"], [1572, 1576, "Method"], [1583, 1586, "Task"], [1605, 1608, "Task"], [1610, 1614, "Method"], [1616, 1619, "Method"], [1702, 1713, "Method"], [1727, 1731, "Method"], [1762, 1766, "Task"], [1770, 1776, "Task"], [1852, 1856, "Method"], [1906, 1908, "Method"], [1915, 1917, "Method"], [1925, 1927, "Method"], [1971, 1982, "Method"], [1983, 1986, "Method"], [1989, 1991, "Method"], [2019, 2020, "Method"], [2027, 2029, "Method"], [2033, 2036, "Method"], [2038, 2045, "Method"], [2061, 2064, "Method"], [2076, 2080, "Task"], [2104, 2108, "Method"], [2112, 2114, "Metric"], [2117, 2118, "Method"], [2120, 2124, "Method"], [2142, 2143, "Method"], [2164, 2167, "Method"], [2211, 2214, "Task"], [2216, 2218, "Method"], [2223, 2225, "Task"], [2230, 2232, "Method"], [2303, 2307, "Method"], [2308, 2310, "Method"], [2366, 2369, "Task"], [2382, 2384, "Method"], [2394, 2395, "Method"], [2398, 2401, "Task"], [2485, 2489, "Method"], [2496, 2498, "Method"], [2622, 2625, "Task"], [2681, 2682, "Metric"], [2712, 2714, "Method"], [2716, 2718, "Method"], [2738, 2740, "Method"], [2759, 2763, "Method"], [2769, 2771, "Method"], [2772, 2773, "Method"], [2811, 2815, "Method"], [2816, 2817, "Method"], [2849, 2851, "Method"], [2908, 2909, "Task"], [2918, 2920, "Method"], [2921, 2922, "Method"], [2959, 2961, "Metric"], [2962, 2969, "Task"], [2972, 2975, "Task"], [3015, 3016, "Method"], [3021, 3023, "Metric"], [3049, 3052, "Method"], [3053, 3054, "Method"], [3055, 3061, "Method"], [3063, 3066, "Method"], [3076, 3079, "Material"], [3081, 3083, "Method"], [3087, 3090, "Metric"], [3096, 3097, "Method"], [3110, 3114, "Method"], [3120, 3121, "Method"], [3131, 3135, "Method"], [3150, 3151, "Method"], [3152, 3154, "Method"], [3158, 3160, "Method"], [3163, 3169, "Method"], [3173, 3174, "Metric"], [3177, 3178, "Metric"], [3179, 3182, "Material"], [3194, 3196, "Method"], [3200, 3201, "Method"], [3247, 3248, "Method"], [3250, 3256, "Method"], [3263, 3264, "Material"], [3275, 3278, "Material"], [3284, 3286, "Method"], [3293, 3301, "Method"], [3309, 3313, "Method"], [3336, 3339, "Metric"], [3340, 3342, "Method"], [3346, 3349, "Method"], [3350, 3351, "Material"], [3387, 3391, "Method"], [3392, 3393, "Method"], [3402, 3406, "Method"], [3420, 3423, "Method"], [3440, 3443, "Method"], [3454, 3455, "Metric"], [3457, 3458, "Method"], [3469, 3471, "Task"], [3500, 3502, "Method"], [3512, 3515, "Material"], [3519, 3522, "Metric"], [3528, 3530, "Metric"], [3552, 3556, "Method"], [3582, 3586, "Task"], [3586, 3589, "Task"], [3595, 3598, "Task"], [3611, 3612, "Method"], [3669, 3671, "Method"], [3673, 3677, "Method"], [3680, 3681, "Method"], [3682, 3683, "Method"], [3685, 3688, "Method"], [3691, 3692, "Method"], [3708, 3711, "Method"], [3746, 3749, "Method"], [3752, 3759, "Method"], [3762, 3763, "Method"], [3783, 3784, "Method"], [3788, 3794, "Method"], [3795, 3800, "Method"], [3801, 3805, "Method"], [3831, 3833, "Task"], [3835, 3839, "Method"], [3840, 3842, "Task"], [3844, 3849, "Metric"], [3888, 3892, "Method"], [3900, 3902, "Method"], [3903, 3906, "Method"], [3909, 3915, "Material"], [3921, 3923, "Method"], [3927, 3930, "Metric"], [3931, 3932, "Metric"], [3948, 3951, "Method"], [3952, 3956, "Method"], [3964, 3968, "Method"], [3971, 3972, "Method"], [3976, 3979, "Method"], [4010, 4012, "Metric"], [4013, 4014, "Method"], [4015, 4016, "Method"], [4017, 4020, "Method"], [4027, 4031, "Metric"], [4037, 4039, "Task"], [4041, 4044, "Material"], [4101, 4104, "Method"], [4152, 4154, "Metric"], [4177, 4178, "Metric"], [4180, 4181, "Metric"], [4188, 4191, "Method"], [4200, 4202, "Metric"], [4221, 4226, "Method"], [4227, 4229, "Method"], [4251, 4256, "Method"], [4280, 4284, "Metric"], [4306, 4310, "Metric"], [4351, 4354, "Material"], [4358, 4362, "Method"], [4364, 4369, "Material"], [4374, 4378, "Metric"], [4380, 4383, "Method"], [4385, 4388, "Method"], [4436, 4439, "Method"], [4450, 4454, "Method"], [4472, 4474, "Method"], [4486, 4489, "Task"], [4494, 4495, "Material"], [4498, 4501, "Task"], [4516, 4519, "Method"], [4520, 4526, "Method"], [4539, 4541, "Method"], [4544, 4546, "Method"], [4547, 4548, "Method"], [4580, 4586, "Method"], [4603, 4608, "Method"], [331, 332, "Method"], [491, 492, "Method"], [502, 503, "Method"], [533, 534, "Method"], [633, 634, "Material"], [735, 737, "Task"], [765, 767, "Task"], [866, 868, "Task"], [909, 910, "Method"], [910, 911, "Method"], [2362, 2364, "Method"], [2756, 2757, "Method"], [3187, 3188, "Material"], [3207, 3210, "Material"], [3237, 3238, "Method"], [3242, 3245, "Material"], [3288, 3289, "Material"], [3289, 3290, "Method"], [3323, 3324, "Method"], [3510, 3511, "Method"], [3524, 3525, "Method"], [3543, 3544, "Method"]], "sections": [[0, 198], [198, 855], [855, 1216], [1216, 1220], [1220, 1429], [1429, 2074], [2074, 2360], [2360, 2479], [2479, 2710], [2710, 2906], [2906, 2987], [2987, 3047], [3047, 3465], [3465, 3580], [3580, 3893], [3893, 4349], [4349, 4424], [4424, 4609], [4609, 4612]], "sentences": [[0, 15], [15, 32], [32, 65], [65, 105], [105, 141], [141, 166], [166, 198], [198, 201], [201, 223], [223, 238], [238, 274], [274, 297], [297, 330], [330, 349], [349, 378], [378, 393], [393, 423], [423, 435], [435, 462], [462, 508], [508, 521], [521, 555], [555, 582], [582, 609], [609, 644], [644, 663], [663, 686], [686, 729], [729, 752], [752, 772], [772, 793], [793, 826], [826, 855], [855, 858], [858, 873], [873, 908], [908, 938], [938, 987], [987, 1005], [1005, 1023], [1023, 1051], [1051, 1095], [1095, 1099], [1099, 1108], [1108, 1131], [1131, 1154], [1154, 1170], [1170, 1185], [1185, 1191], [1191, 1216], [1216, 1220], [1220, 1224], [1224, 1249], [1249, 1279], [1279, 1298], [1298, 1322], [1322, 1350], [1350, 1367], [1367, 1396], [1396, 1429], [1429, 1434], [1434, 1456], [1456, 1473], [1473, 1493], [1493, 1513], [1513, 1542], [1542, 1557], [1557, 1577], [1577, 1609], [1609, 1632], [1632, 1664], [1664, 1689], [1689, 1721], [1721, 1743], [1743, 1767], [1767, 1780], [1780, 1808], [1808, 1833], [1833, 1839], [1839, 1851], [1851, 1878], [1878, 1903], [1903, 1928], [1928, 1963], [1963, 1992], [1992, 2009], [2009, 2049], [2049, 2074], [2074, 2080], [2080, 2116], [2116, 2141], [2141, 2162], [2162, 2193], [2193, 2233], [2233, 2261], [2261, 2288], [2288, 2302], [2302, 2318], [2318, 2351], [2351, 2360], [2360, 2365], [2365, 2375], [2375, 2396], [2396, 2427], [2427, 2444], [2444, 2479], [2479, 2484], [2484, 2509], [2509, 2528], [2528, 2548], [2548, 2580], [2580, 2618], [2618, 2648], [2648, 2671], [2671, 2710], [2710, 2714], [2714, 2741], [2741, 2768], [2768, 2787], [2787, 2805], [2805, 2836], [2836, 2874], [2874, 2906], [2906, 2909], [2909, 2927], [2927, 2951], [2951, 2971], [2971, 2987], [2987, 2990], [2990, 3009], [3009, 3027], [3027, 3047], [3047, 3052], [3052, 3075], [3075, 3100], [3100, 3119], [3119, 3140], [3140, 3155], [3155, 3183], [3183, 3202], [3202, 3240], [3240, 3263], [3263, 3287], [3287, 3318], [3318, 3343], [3343, 3364], [3364, 3378], [3378, 3416], [3416, 3431], [3431, 3456], [3456, 3465], [3465, 3471], [3471, 3503], [3503, 3527], [3527, 3546], [3546, 3580], [3580, 3586], [3586, 3610], [3610, 3664], [3664, 3689], [3689, 3718], [3718, 3737], [3737, 3760], [3760, 3781], [3781, 3806], [3806, 3825], [3825, 3850], [3850, 3865], [3865, 3893], [3893, 3896], [3896, 3919], [3919, 3974], [3974, 3999], [3999, 4009], [4009, 4032], [4032, 4063], [4063, 4090], [4090, 4105], [4105, 4120], [4120, 4144], [4144, 4160], [4160, 4197], [4197, 4212], [4212, 4248], [4248, 4300], [4300, 4349], [4349, 4354], [4354, 4370], [4370, 4393], [4393, 4424], [4424, 4427], [4427, 4462], [4462, 4502], [4502, 4549], [4549, 4587], [4587, 4609], [4609, 4612]], "words": ["Image", "generation", "has", "been", "successfully", "cast", "as", "an", "autoregressive", "sequence", "generation", "or", "transformation", "problem", ".", "Recent", "work", "has", "shown", "that", "self", "-", "attention", "is", "an", "effective", "way", "of", "modeling", "textual", "sequences", ".", "In", "this", "work", ",", "we", "generalize", "a", "recently", "proposed", "model", "architecture", "based", "on", "self", "-", "attention", ",", "the", "Transformer", ",", "to", "a", "sequence", "modeling", "formulation", "of", "image", "generation", "with", "a", "tractable", "likelihood", ".", "By", "restricting", "the", "self", "-", "attention", "mechanism", "to", "attend", "to", "local", "neighborhoods", "we", "significantly", "increase", "the", "size", "of", "images", "the", "model", "can", "process", "in", "practice", ",", "despite", "maintaining", "significantly", "larger", "receptive", "fields", "per", "layer", "than", "typical", "convolutional", "neural", "networks", ".", "While", "conceptually", "simple", ",", "our", "generative", "models", "significantly", "outperform", "the", "current", "state", "of", "the", "art", "in", "image", "generation", "on", "ImageNet", ",", "improving", "the", "best", "published", "negative", "log", "-", "likelihood", "on", "ImageNet", "from", "3.83", "to", "3.77", ".", "We", "also", "present", "results", "on", "image", "super", "-", "resolution", "with", "a", "large", "magnification", "ratio", ",", "applying", "an", "encoder", "-", "decoder", "configuration", "of", "our", "architecture", ".", "In", "a", "human", "evaluation", "study", ",", "we", "find", "that", "images", "generated", "by", "our", "super", "-", "resolution", "model", "fool", "human", "observers", "three", "times", "more", "often", "than", "the", "previous", "state", "of", "the", "art", ".", "section", ":", "Introduction", "Recent", "advances", "in", "modeling", "the", "distribution", "of", "natural", "images", "with", "neural", "networks", "allow", "them", "to", "generate", "increasingly", "natural", "-", "looking", "images", ".", "Some", "models", ",", "such", "as", "the", "PixelRNN", "and", "PixelCNN", ",", "have", "a", "tractable", "likelihood", ".", "Beyond", "licensing", "the", "comparatively", "simple", "and", "stable", "training", "regime", "of", "directly", "maximizing", "log", "-", "likelihood", ",", "this", "enables", "the", "straightforward", "application", "of", "these", "models", "in", "problems", "such", "as", "image", "compression", "and", "probabilistic", "planning", "and", "exploration", ".", "The", "likelihood", "is", "made", "tractable", "by", "modeling", "the", "joint", "distribution", "of", "the", "pixels", "in", "the", "image", "as", "the", "product", "of", "conditional", "distributions", ".", "Thus", "turning", "the", "problem", "into", "a", "sequence", "modeling", "problem", ",", "the", "state", "of", "the", "art", "approaches", "apply", "recurrent", "or", "convolutional", "neural", "networks", "to", "predict", "each", "next", "pixel", "given", "all", "previously", "generated", "pixels", ".", "Training", "recurrent", "neural", "networks", "to", "sequentially", "predict", "each", "pixel", "of", "even", "a", "small", "image", "is", "computationally", "very", "challenging", ".", "Thus", ",", "parallelizable", "models", "that", "use", "convolutional", "neural", "networks", "such", "as", "the", "PixelCNN", "have", "recently", "received", "much", "more", "attention", ",", "and", "have", "now", "surpassed", "the", "PixelRNN", "in", "quality", ".", "One", "disadvantage", "of", "CNNs", "compared", "to", "RNNs", "is", "their", "typically", "fairly", "limited", "receptive", "field", ".", "This", "can", "adversely", "affect", "their", "ability", "to", "model", "long", "-", "range", "phenomena", "common", "in", "images", ",", "such", "as", "symmetry", "and", "occlusion", ",", "especially", "with", "a", "small", "number", "of", "layers", ".", "Growing", "the", "receptive", "field", "has", "been", "shown", "to", "improve", "quality", "significantly", ".", "Doing", "so", ",", "however", ",", "comes", "at", "a", "significant", "cost", "in", "number", "of", "parameters", "and", "consequently", "computational", "performance", "and", "can", "make", "training", "such", "models", "more", "challenging", ".", "In", "this", "work", "we", "show", "that", "self", "-", "attention", "can", "achieve", "a", "better", "balance", "in", "the", "trade", "-", "off", "between", "the", "virtually", "unlimited", "receptive", "field", "of", "the", "necessarily", "sequential", "PixelRNN", "and", "the", "limited", "receptive", "field", "of", "the", "much", "more", "parallelizable", "PixelCNN", "and", "its", "various", "extensions", ".", "We", "adopt", "similar", "factorizations", "of", "the", "joint", "pixel", "distribution", "as", "previous", "work", ".", "Following", "recent", "work", "on", "modeling", "text", ",", "however", ",", "we", "propose", "eschewing", "recurrent", "and", "convolutional", "networks", "in", "favor", "of", "the", "Image", "Transformer", ",", "a", "model", "based", "entirely", "on", "a", "self", "-", "attention", "mechanism", ".", "The", "specific", ",", "locally", "restricted", "form", "of", "multi", "-", "head", "self", "-", "attention", "we", "propose", "can", "be", "interpreted", "as", "a", "sparsely", "parameterized", "form", "of", "gated", "convolution", ".", "By", "decoupling", "the", "size", "of", "the", "receptive", "field", "from", "the", "number", "of", "parameters", ",", "this", "allows", "us", "to", "use", "significantly", "larger", "receptive", "fields", "than", "the", "PixelCNN", ".", "Despite", "comparatively", "low", "resource", "requirements", "for", "training", ",", "the", "Image", "Transformer", "attains", "a", "new", "state", "of", "the", "art", "in", "modeling", "images", "from", "the", "standard", "ImageNet", "data", "set", ",", "as", "measured", "by", "log", "-", "likelihood", ".", "Our", "experiments", "indicate", "that", "increasing", "the", "size", "of", "the", "receptive", "field", "plays", "a", "significant", "role", "in", "this", "improvement", ".", "We", "observe", "significant", "improvements", "up", "to", "effective", "receptive", "field", "sizes", "of", "256", "pixels", ",", "while", "the", "PixelCNN", "with", "5x5", "filters", "used", "25", ".", "Many", "applications", "of", "image", "density", "models", "require", "conditioning", "on", "additional", "information", "of", "various", "kinds", ":", "from", "images", "in", "enhancement", "or", "reconstruction", "tasks", "such", "as", "super", "-", "resolution", ",", "in", "-", "painting", "and", "denoising", "to", "text", "when", "synthesizing", "images", "from", "natural", "language", "descriptions", ".", "In", "visual", "planning", "tasks", ",", "conditional", "image", "generation", "models", "could", "predict", "future", "frames", "of", "video", "conditioned", "on", "previous", "frames", "and", "taken", "actions", ".", "In", "this", "work", "we", "hence", "also", "evaluate", "two", "different", "methods", "of", "performing", "conditional", "image", "generation", "with", "the", "Image", "Transformer", ".", "In", "image", "-", "class", "conditional", "generation", "we", "condition", "on", "an", "embedding", "of", "one", "of", "a", "small", "number", "of", "image", "classes", ".", "In", "super", "-", "resolution", "with", "high", "magnification", "ratio", "(", "4x", ")", ",", "we", "condition", "on", "a", "very", "low", "-", "resolution", "image", ",", "employing", "the", "Image", "Transformer", "in", "an", "encoder", "-", "decoder", "configuration", ".", "In", "comparison", "to", "recent", "work", "on", "autoregressive", "super", "-", "resolution", ",", "a", "human", "evaluation", "study", "found", "images", "generated", "by", "our", "models", "to", "look", "convincingly", "natural", "significantly", "more", "often", ".", "section", ":", "Background", "There", "is", "a", "broad", "variety", "of", "types", "of", "image", "generation", "models", "in", "the", "literature", ".", "This", "work", "is", "strongly", "inspired", "by", "autoregressive", "models", "such", "as", "fully", "visible", "belief", "networks", "and", "NADE", "Bengio00", ",", "larochelle2011", "in", "that", "we", "also", "factor", "the", "joint", "probability", "of", "the", "image", "pixels", "into", "conditional", "distributions", ".", "Following", "PixelRNN", "PixelRNN", ",", "we", "also", "model", "the", "color", "channels", "of", "the", "output", "pixels", "as", "discrete", "values", "generated", "from", "a", "multinomial", "distribution", ",", "implemented", "using", "a", "simple", "softmax", "layer", ".", "The", "current", "state", "of", "the", "art", "in", "modeling", "images", "on", "CIFAR", "-", "10", "data", "set", "was", "achieved", "by", "PixelCNN", "++", ",", "which", "models", "the", "output", "pixel", "distribution", "with", "a", "discretized", "logistic", "mixture", "likelihood", ",", "conditioning", "on", "whole", "pixels", "instead", "of", "color", "channels", "and", "changes", "to", "the", "architecture", "PixelCNNpp", ".", "These", "modifications", "are", "readily", "applicable", "to", "our", "model", ",", "which", "we", "plan", "to", "evaluate", "in", "future", "work", ".", "Another", ",", "popular", "direction", "of", "research", "in", "image", "generation", "is", "training", "models", "with", "an", "adversarial", "loss", "gan", ".", "Typically", ",", "in", "this", "regime", "a", "generator", "network", "is", "trained", "in", "opposition", "to", "a", "discriminator", "network", "trying", "to", "determine", "if", "a", "given", "image", "is", "real", "or", "generated", ".", "In", "contrast", "to", "the", "often", "blurry", "images", "generated", "by", "networks", "trained", "with", "likelihood", "-", "based", "losses", ",", "generative", "adversarial", "networks", "(", "GANs", ")", "have", "been", "shown", "to", "produce", "sharper", "images", "with", "realistic", "high", "-", "frequency", "detail", "in", "generation", "and", "image", "super", "-", "resolution", "tasks", "StackGAN", ",", "SRGAN", ".", "While", "very", "promising", ",", "GANs", "have", "various", "drawbacks", ".", "They", "are", "notoriously", "unstable", "DCGAN", ",", "motivating", "a", "large", "number", "of", "methods", "attempting", "to", "make", "their", "training", "more", "robust", "unrolled_gans", ",", "began", ".", "Another", "common", "issue", "is", "that", "of", "mode", "collapse", ",", "where", "generated", "images", "fail", "to", "reflect", "the", "diversity", "in", "the", "training", "set", "unrolled_gans", ".", "A", "related", "problem", "is", "that", "GANs", "do", "not", "have", "a", "density", "in", "closed", "-", "form", ".", "This", "makes", "it", "challenging", "to", "measure", "the", "degree", "to", "which", "the", "models", "capture", "diversity", ".", "This", "also", "complicates", "model", "design", ".", "Objectively", "evaluating", "and", "comparing", ",", "say", ",", "different", "hyperparameter", "choices", "is", "typically", "much", "more", "difficult", "in", "GANs", "than", "in", "models", "with", "a", "tractable", "likelihood", ".", "section", ":", "Model", "Architecture", "subsection", ":", "Image", "Representation", "We", "treat", "pixel", "intensities", "as", "either", "discrete", "categories", "or", "ordinal", "values", ";", "this", "setting", "depends", "on", "the", "distribution", "(", "Section", "[", "reference", "]", ")", ".", "For", "categories", ",", "each", "of", "the", "input", "pixels", "\u2019", "three", "color", "channels", "is", "encoded", "using", "a", "channel", "-", "specific", "set", "of", "-", "dimensional", "embedding", "vectors", "of", "the", "intensity", "values", ".", "For", "output", "intensities", ",", "we", "share", "a", "single", ",", "separate", "set", "of", "-", "dimensional", "embeddings", "across", "the", "channels", ".", "For", "an", "image", "of", "width", "and", "height", ",", "we", "combine", "the", "width", "and", "channel", "dimensions", "yielding", "a", "3", "-", "dimensional", "tensor", "with", "shape", ".", "For", "ordinal", "values", ",", "we", "run", "a", "1x3", "window", "size", ",", "1x3", "strided", "convolution", "to", "combine", "the", "channels", "per", "pixel", "to", "form", "an", "input", "representation", "with", "shape", ".", "To", "each", "pixel", "representation", ",", "we", "add", "a", "-", "dimensional", "encoding", "of", "coordinates", "of", "that", "pixel", ".", "We", "evaluated", "two", "different", "coordinate", "encodings", ":", "sine", "and", "cosine", "functions", "of", "the", "coordinates", ",", "with", "different", "frequencies", "across", "different", "dimensions", ",", "following", ",", "and", "learned", "position", "embeddings", ".", "Since", "we", "need", "to", "represent", "two", "coordinates", ",", "we", "use", "of", "the", "dimensions", "to", "encode", "the", "row", "number", "and", "the", "other", "of", "the", "dimensions", "to", "encode", "the", "the", "column", "and", "color", "channel", ".", "subsection", ":", "Self", "-", "Attention", "For", "image", "-", "conditioned", "generation", ",", "as", "in", "our", "super", "-", "resolution", "models", ",", "we", "use", "an", "encoder", "-", "decoder", "architecture", ".", "The", "encoder", "generates", "a", "contextualized", ",", "per", "-", "pixel", "-", "channel", "representation", "of", "the", "source", "image", ".", "The", "decoder", "autoregressively", "generates", "an", "output", "image", "of", "pixel", "intensities", ",", "one", "channel", "per", "pixel", "at", "each", "time", "step", ".", "While", "doing", "so", ",", "it", "consumes", "the", "previously", "generated", "pixels", "and", "the", "input", "image", "representation", "generated", "by", "the", "encoder", ".", "For", "both", "the", "encoder", "and", "decoder", ",", "the", "Image", "Transformer", "uses", "stacks", "of", "self", "-", "attention", "and", "position", "-", "wise", "feed", "-", "forward", "layers", ",", "similar", "to", "aiayn", ".", "In", "addition", ",", "the", "decoder", "uses", "an", "attention", "mechanism", "to", "consume", "the", "encoder", "representation", ".", "For", "unconditional", "and", "class", "-", "conditional", "generation", ",", "we", "employ", "the", "Image", "Transformer", "in", "a", "decoder", "-", "only", "configuration", ".", "Before", "we", "describe", "how", "we", "scale", "self", "-", "attention", "to", "images", "comprised", "of", "many", "more", "positions", "than", "typically", "found", "in", "sentences", ",", "we", "give", "a", "brief", "description", "of", "self", "-", "attention", ".", "Each", "self", "-", "attention", "layer", "computes", "a", "-", "dimensional", "representation", "for", "each", "position", ",", "that", "is", ",", "each", "channel", "of", "each", "pixel", ".", "To", "recompute", "the", "representation", "for", "a", "given", "position", ",", "it", "first", "compares", "the", "position", "\u2019s", "current", "representation", "to", "other", "positions", "\u2019", "representations", ",", "obtaining", "an", "attention", "distribution", "over", "the", "other", "positions", ".", "This", "distribution", "is", "then", "used", "to", "weight", "the", "contribution", "of", "the", "other", "positions", "\u2019", "representations", "to", "the", "next", "representation", "for", "the", "position", "at", "hand", ".", "Equations", "[", "reference", "]", "and", "[", "reference", "]", "outline", "the", "computation", "in", "our", "self", "-", "attention", "and", "fully", "-", "connected", "feed", "-", "forward", "layers", ";", "Figure", "[", "reference", "]", "depicts", "it", ".", "and", "are", "the", "parameters", "of", "the", "feed", "-", "forward", "layer", ",", "and", "are", "shared", "across", "all", "the", "positions", "in", "a", "layer", ".", "These", "fully", "describe", "all", "operations", "performed", "in", "every", "layer", ",", "independently", "for", "each", "position", ",", "with", "the", "exception", "of", "multi", "-", "head", "attention", ".", "For", "details", "of", "multi", "-", "head", "self", "-", "attention", ",", "see", "aiayn", ".", "In", "more", "detail", ",", "following", "previous", "work", ",", "we", "call", "the", "current", "representation", "of", "the", "pixel", "\u2019s", "channel", ",", "or", "position", ",", "to", "be", "recomputed", "the", "query", ".", "The", "other", "positions", "whose", "representations", "will", "be", "used", "in", "computing", "a", "new", "representation", "for", "are", "which", "together", "comprise", "the", "columns", "of", "the", "memory", "matrix", ".", "Note", "that", "can", "also", "contain", ".", "We", "first", "transform", "and", "linearly", "by", "learned", "matrices", "and", ",", "respectively", ".", "The", "self", "-", "attention", "mechanism", "then", "compares", "to", "each", "of", "the", "pixel", "\u2019s", "channel", "representations", "in", "the", "memory", "with", "a", "dot", "-", "product", ",", "scaled", "by", ".", "We", "apply", "the", "function", "to", "the", "resulting", "compatibility", "scores", ",", "treating", "the", "obtained", "vector", "as", "attention", "distribution", "over", "the", "pixel", "channels", "in", "the", "memory", ".", "After", "applying", "another", "linear", "transformation", "to", "the", "memory", ",", "we", "compute", "a", "weighted", "average", "of", "the", "transformed", "memory", ",", "weighted", "by", "the", "attention", "distribution", ".", "In", "the", "decoders", "of", "our", "different", "models", "we", "mask", "the", "outputs", "of", "the", "comparisons", "appropriately", "so", "that", "the", "model", "can", "not", "attend", "to", "positions", "in", "the", "memory", "that", "have", "not", "been", "generated", ",", "yet", ".", "To", "the", "resulting", "vector", "we", "then", "apply", "a", "single", "-", "layer", "fully", "-", "connected", "feed", "-", "forward", "neural", "network", "with", "rectified", "linear", "activation", "followed", "by", "another", "linear", "transformation", ".", "The", "learned", "parameters", "of", "these", "are", "shared", "across", "all", "positions", "but", "different", "from", "layer", "to", "layer", ".", "As", "illustrated", "in", "Figure", "[", "reference", "]", ",", "we", "perform", "dropout", ",", "merge", "in", "residual", "connections", "and", "perform", "layer", "normalization", "after", "each", "application", "of", "self", "-", "attention", "and", "the", "position", "-", "wise", "feed", "-", "forward", "networks", "layernorm2016", ",", "srivastava2014dropout", ".", "The", "entire", "self", "-", "attention", "operation", "can", "be", "implemented", "using", "highly", "optimized", "matrix", "multiplication", "code", "and", "executed", "in", "parallel", "for", "all", "pixels", "\u2019", "channels", ".", "subsection", ":", "Local", "Self", "-", "Attention", "The", "number", "of", "positions", "included", "in", "the", "memory", ",", "or", "the", "number", "of", "columns", "of", ",", "has", "tremendous", "impact", "on", "the", "scalability", "of", "the", "self", "-", "attention", "mechanism", ",", "which", "has", "a", "time", "complexity", "in", ".", "The", "encoders", "of", "our", "super", "-", "resolution", "models", "operate", "on", "pixel", "images", "and", "it", "is", "computationally", "feasible", "to", "attend", "to", "all", "of", "their", "positions", ".", "The", "decoders", "in", "our", "experiments", ",", "however", ",", "produce", "pixel", "images", "with", "positions", ",", "rendering", "attending", "to", "all", "positions", "impractical", ".", "Inspired", "by", "convolutional", "neural", "networks", "we", "address", "this", "by", "adopting", "a", "notion", "of", "locality", ",", "restricting", "the", "positions", "in", "the", "memory", "matrix", "to", "a", "local", "neighborhood", "around", "the", "query", "position", ".", "Changing", "this", "neighborhood", "per", "query", "position", ",", "however", ",", "would", "prohibit", "packing", "most", "of", "the", "computation", "necessary", "for", "self", "-", "attention", "into", "two", "matrix", "multiplications", "-", "one", "for", "computing", "the", "pairwise", "comparisons", "and", "another", "for", "generating", "the", "weighted", "averages", ".", "To", "avoid", "this", ",", "we", "partition", "the", "image", "into", "query", "blocks", "and", "associate", "each", "of", "these", "with", "a", "larger", "memory", "block", "that", "also", "contains", "the", "query", "block", ".", "For", "all", "queries", "from", "a", "given", "query", "block", ",", "the", "model", "attends", "to", "the", "same", "memory", "matrix", ",", "comprised", "of", "all", "positions", "from", "the", "memory", "block", ".", "The", "self", "-", "attention", "is", "then", "computed", "for", "all", "query", "blocks", "in", "parallel", ".", "The", "feed", "-", "forward", "networks", "and", "layer", "normalizations", "are", "computed", "in", "parallel", "for", "all", "positions", ".", "In", "our", "experiments", "we", "use", "two", "different", "schemes", "for", "choosing", "query", "blocks", "and", "their", "associated", "memory", "block", "neighborhoods", ",", "resulting", "in", "two", "different", "factorizations", "of", "the", "joint", "pixel", "distribution", "into", "conditional", "distributions", ".", "Both", "are", "illustrated", "in", "Figure", "[", "reference", "]", ".", "paragraph", ":", "1D", "Local", "Attention", "For", "1D", "local", "attention", "(", "Section", "[", "reference", "]", ")", "we", "first", "flatten", "the", "input", "tensor", "with", "positional", "encodings", "in", "raster", "-", "scan", "order", ",", "similar", "to", "previous", "work", "PixelRNN", ".", "To", "compute", "self", "-", "attention", "on", "the", "resulting", "linearized", "image", ",", "we", "then", "partition", "the", "length", "into", "non", "-", "overlapping", "query", "blocks", "of", "length", ",", "padding", "with", "zeroes", "if", "necessary", ".", "While", "contiguous", "in", "the", "linearized", "image", ",", "these", "blocks", "can", "be", "discontiguous", "in", "image", "coordinate", "space", ".", "For", "each", "query", "block", "we", "build", "the", "memory", "block", "from", "the", "same", "positions", "as", "and", "an", "additional", "positions", "corresponding", "to", "pixels", "that", "have", "been", "generated", "before", ",", "which", "can", "result", "in", "overlapping", "memory", "blocks", ".", "paragraph", ":", "2D", "Local", "Attention", "In", "2D", "local", "attention", "models", ",", "we", "partition", "the", "input", "tensor", "with", "positional", "encodings", "into", "rectangular", "query", "blocks", "contiguous", "in", "the", "original", "image", "space", ".", "We", "generate", "the", "image", "one", "query", "block", "after", "another", ",", "ordering", "the", "blocks", "in", "raster", "-", "scan", "order", ".", "Within", "each", "block", ",", "we", "generate", "individual", "positions", ",", "or", "pixel", "channels", ",", "again", "in", "raster", "-", "scan", "order", ".", "As", "illustrated", "in", "the", "right", "half", "of", "Figure", "[", "reference", "]", ",", "we", "generate", "the", "blocks", "outlined", "in", "grey", "lines", "left", "-", "to", "-", "right", "and", "top", "-", "to", "-", "bottom", ".", "We", "use", "2", "-", "dimensional", "query", "blocks", "of", "a", "size", "specified", "by", "height", "and", "width", ",", "and", "memory", "blocks", "extending", "the", "query", "block", "to", "the", "top", ",", "left", "and", "right", "by", ",", "and", "again", "pixels", ",", "respectively", ".", "In", "both", "1D", "and", "2D", "local", "attention", ",", "we", "mask", "attention", "weights", "in", "the", "query", "and", "memory", "blocks", "such", "that", "positions", "that", "have", "not", "yet", "been", "generated", "are", "ignored", ".", "As", "can", "be", "seen", "in", "Figure", "[", "reference", "]", ",", "2D", "local", "attention", "balances", "horizontal", "and", "vertical", "conditioning", "context", "much", "more", "evenly", ".", "We", "believe", "this", "might", "have", "an", "increasingly", "positive", "effect", "on", "quality", "with", "growing", "image", "size", "as", "the", "conditioning", "information", "in", "1D", "local", "attention", "becomes", "increasingly", "dominated", "by", "pixels", "next", "to", "a", "given", "position", "as", "opposed", "to", "above", "it", ".", "subsection", ":", "Loss", "Function", "We", "perform", "maximum", "likelihood", ",", "in", "which", "we", "maximize", "with", "respect", "to", "network", "parameters", ",", "and", "where", "the", "network", "outputs", "all", "parameters", "of", "the", "autoregressive", "distribution", ".", "We", "experiment", "with", "two", "settings", "of", "the", "distribution", ":", "a", "categorical", "distribution", "across", "each", "channel", "PixelRNN", "and", "a", "mixture", "of", "discretized", "logistics", "over", "three", "channels", "PixelCNNpp", ".", "The", "categorical", "distribution", "(", "cat", ")", "captures", "each", "intensity", "value", "as", "a", "discrete", "outcome", "and", "factorizes", "across", "channels", ".", "In", "total", ",", "there", "are", "parameters", "for", "each", "pixel", ";", "for", "images", ",", "the", "network", "outputs", "dimensions", ".", "Unlike", "the", "categorical", "distribution", ",", "the", "discretized", "mixture", "of", "logistics", "(", "DMOL", ")", "captures", "two", "important", "properties", ":", "the", "ordinal", "nature", "of", "pixel", "intensities", "and", "simpler", "dependence", "across", "channels", "PixelCNNpp", ".", "For", "each", "pixel", ",", "the", "number", "of", "parameters", "is", "times", "the", "number", "of", "mixture", "components", ":", "for", "one", "unnormalized", "mixture", "probability", ",", "three", "means", ",", "three", "standard", "deviations", ",", "and", "three", "coefficients", "which", "capture", "the", "linear", "dependence", ".", "For", "10", "mixtures", ",", "this", "translates", "to", "parameters", "for", "each", "pixel", ";", "for", "images", ",", "the", "network", "outputs", "dimensions", ",", "which", "is", "a", "7x", "reduction", "enabling", "denser", "gradients", "and", "lower", "memory", ".", "section", ":", "Inference", "Across", "all", "of", "the", "presented", "experiments", ",", "we", "use", "categorical", "sampling", "during", "decoding", "with", "a", "tempered", "PixelRecursiveSuperResolution", ".", "We", "adjust", "the", "concentration", "of", "the", "distribution", "we", "sample", "from", "with", "a", "temperature", "by", "which", "we", "divide", "the", "logits", "for", "the", "channel", "intensities", ".", "We", "tuned", "between", "and", ",", "observing", "the", "highest", "perceptual", "quality", "in", "unconditioned", "and", "class", "-", "conditional", "image", "generation", "with", ".", "For", "super", "-", "resolution", "we", "present", "results", "for", "different", "temperatures", "in", "Table", "[", "reference", "]", ".", "section", ":", "Experiments", "All", "code", "we", "used", "to", "develop", ",", "train", ",", "and", "evaluate", "our", "models", "is", "available", "in", "Tensor2Tensor", "tensor2tensor", ".", "For", "all", "experiments", "we", "optimize", "with", "Adam", "kingma2014adam", ",", "and", "vary", "the", "learning", "rate", "as", "specified", "in", ".", "We", "train", "our", "models", "on", "both", "p100", "and", "k40", "GPUs", ",", "with", "batch", "sizes", "ranging", "from", "to", "per", "GPU", ".", "subsection", ":", "Generative", "Image", "Modeling", "Our", "unconditioned", "and", "class", "-", "conditioned", "image", "generation", "models", "both", "use", "1D", "local", "attention", ",", "with", "and", "a", "total", "memory", "size", "of", ".", "On", "CIFAR", "-", "10", "our", "best", "unconditional", "models", "achieve", "a", "perplexity", "of", "bits", "/", "dim", "on", "the", "test", "set", "using", "either", "DMOL", "or", "categorical", ".", "For", "categorical", ",", "we", "use", "layers", "with", ",", "heads=", ",", "feed", "-", "forward", "dimension", "with", "a", "dropout", "of", ".", "In", "DMOL", ",", "our", "best", "config", "uses", "layers", ",", ",", "heads=", ",", "feed", "-", "forward", "dimension", "and", "a", "dropout", "of", ".", "This", "is", "a", "considerable", "improvement", "over", "two", "baselines", ":", "the", "PixelRNN", "and", "PixelCNN", "++", ".", "Introduced", "after", "the", "Image", "Transformer", ",", "the", "also", "self", "-", "attention", "based", "PixelSNAIL", "model", "reaches", "a", "significantly", "lower", "perplexity", "of", "bits", "/", "dim", "on", "CIFAR", "-", "10", ".", "On", "the", "more", "challenging", "ImageNet", "data", "set", ",", "however", ",", "the", "Image", "Transformer", "performs", "significantly", "better", "than", "PixelSNAIL", ".", "We", "also", "train", "smaller", "layer", "CIFAR", "-", "10", "models", "which", "have", ",", "dimensions", "in", "the", "feed", "-", "forward", "layers", ",", "attention", "heads", "and", "use", "dropout", "of", ",", "and", "achieve", "bits", "/", "dim", ",", "matching", "the", "PixelCNN", "model", ".", "Our", "best", "CIFAR", "-", "10", "model", "with", "DMOL", "has", "and", "feed", "-", "forward", "layer", "layer", "dimension", "of", "and", "perform", "attention", "in", "dimensions", ".", "ImageNet", "is", "a", "much", "larger", "dataset", ",", "with", "many", "more", "categories", "than", "CIFAR", "-", "10", ",", "requiring", "more", "parameters", "in", "a", "generative", "model", ".", "Our", "ImageNet", "unconditioned", "generation", "model", "has", "self", "-", "attention", "and", "feed", "-", "forward", "layers", ",", ",", "attention", "heads", ",", "dimensions", "in", "the", "feed", "-", "forward", "layers", ",", "and", "dropout", "of", ".", "It", "significantly", "outperforms", "the", "Gated", "PixelCNN", "and", "establishes", "a", "new", "state", "-", "of", "-", "the", "-", "art", "of", "bits", "/", "dim", "with", "checkpoint", "averaging", ".", "We", "trained", "only", "unconditional", "generative", "models", "on", "ImageNet", ",", "since", "class", "labels", "were", "not", "available", "in", "the", "dataset", "provided", "by", ".", "Table", "[", "reference", "]", "shows", "that", "growing", "the", "receptive", "field", "improves", "perplexity", "significantly", ".", "We", "believe", "this", "to", "highlight", "a", "key", "advantage", "of", "local", "self", "-", "attention", "over", "CNNs", ":", "namely", "that", "the", "number", "of", "parameters", "used", "by", "local", "self", "-", "attention", "is", "independent", "of", "the", "size", "of", "the", "receptive", "field", ".", "Furthermore", ",", "while", ",", "self", "-", "attention", "still", "requires", "fewer", "floating", "-", "point", "operations", ".", "For", "experiments", "with", "the", "categorical", "distribution", "we", "evaluated", "both", "coordinate", "encoding", "schemes", "described", "in", "Section", "[", "reference", "]", "and", "found", "no", "difference", "in", "quality", ".", "For", "DMOL", "we", "only", "evaluated", "learned", "coordinate", "embeddings", ".", "subsection", ":", "Conditioning", "on", "Image", "Class", "We", "represent", "the", "image", "classes", "as", "learned", "-", "dimensional", "embeddings", "per", "class", "and", "simply", "add", "the", "respective", "embedding", "to", "the", "input", "representation", "of", "every", "input", "position", "together", "with", "the", "positional", "encodings", ".", "We", "trained", "the", "class", "-", "conditioned", "Image", "Transformer", "on", "CIFAR", "-", "10", ",", "achieving", "very", "similar", "log", "-", "likelihoods", "as", "in", "unconditioned", "generation", ".", "The", "perceptual", "quality", "of", "generated", "images", ",", "however", ",", "is", "significantly", "higher", "than", "that", "of", "our", "unconditioned", "models", ".", "The", "samples", "from", "our", "-", "layer", "class", "-", "conditioned", "models", "in", "Table", "[", "reference", "]", ",", "show", "that", "we", "can", "generate", "realistic", "looking", "images", "for", "some", "categories", ",", "such", "as", "cars", "and", "trucks", ".", "subsection", ":", "Image", "Super", "-", "Resolution", "Super", "-", "resolution", "is", "the", "process", "of", "recovering", "a", "high", "resolution", "image", "from", "a", "low", "resolution", "image", "while", "generating", "realistic", "and", "plausible", "details", ".", "Following", "PixelRecursiveSuperResolution", ",", "in", "our", "experimental", "setup", "we", "enlarge", "an", "pixel", "image", "four", "-", "fold", "to", ",", "a", "process", "that", "is", "massively", "underspecified", ":", "the", "model", "has", "to", "generate", "aspects", "such", "as", "texture", "of", "hair", ",", "makeup", ",", "skin", "and", "sometimes", "even", "gender", "that", "can", "not", "possibly", "be", "recovered", "from", "the", "source", "image", ".", "Here", ",", "we", "use", "the", "Image", "Transformer", "in", "an", "encoder", "-", "decoder", "configuration", ",", "connecting", "the", "encoder", "and", "decoder", "through", "an", "attention", "mechanism", "aiayn", ".", "For", "the", "encoder", ",", "we", "use", "embeddings", "for", "RGB", "intensities", "for", "each", "pixel", "in", "the", "8", "image", "and", "add", "dimensional", "positional", "encodings", "for", "each", "row", "and", "width", "position", ".", "Since", "the", "input", "is", "small", ",", "we", "flatten", "the", "whole", "image", "as", "a", "tensor", ",", "where", "is", "typically", ".", "We", "then", "feed", "this", "sequence", "to", "our", "stack", "of", "transformer", "encoder", "layers", "that", "uses", "repeated", "self", "-", "attention", "and", "feed", "forward", "layers", ".", "In", "the", "encoder", "we", "do", "n\u2019t", "require", "masking", ",", "but", "allow", "any", "input", "pixel", "to", "attend", "to", "any", "other", "pixel", ".", "In", "the", "decoder", ",", "we", "use", "a", "stack", "of", "local", "self", "-", "attention", ",", "encoder", "-", "decoder", "-", "attention", "and", "feed", "-", "forward", "layers", ".", "We", "found", "using", "two", "to", "three", "times", "fewer", "encoder", "than", "decoder", "layers", "to", "be", "ideal", "for", "this", "task", ".", "We", "perform", "end", "-", "to", "-", "end", "training", "of", "the", "encoder", "-", "decoder", "model", "for", "Super", "resolution", "using", "the", "log", "-", "likelihood", "objective", "function", ".", "Our", "method", "generates", "higher", "resolution", "images", "that", "look", "plausible", "and", "realistic", "across", "two", "datasets", ".", "For", "both", "of", "the", "following", "data", "sets", ",", "we", "resized", "the", "image", "to", "pixels", "for", "the", "input", "and", "pixels", "for", "the", "label", "using", "TensorFlow", "\u2019s", "interpolation", "method", ".", "paragraph", ":", "CelebA", "We", "trained", "both", "our", "1D", "Local", "and", "2D", "Local", "models", "on", "the", "standard", "CelebA", "data", "set", "of", "celebrity", "faces", "with", "cropped", "boundaries", ".", "With", "the", "1D", "Local", ",", "we", "achieve", "a", "negative", "log", "likelihood", "(", "NLL", ")", "of", "bits", "/", "dim", "on", "the", "dev", "set", ",", "using", ",", "memory", "size", "of", ",", "self", "-", "attention", "and", "feed", "-", "forward", "layers", ",", ",", "attention", "heads", ",", "dimensions", "in", "the", "feed", "-", "forward", "layers", ",", "and", "a", "dropout", "of", ".", "With", "the", "2D", "Local", "model", ",", "we", "only", "change", "the", "query", "and", "memory", "to", "now", "represent", "a", "block", "of", "size", "pixels", "and", "pixels", "respectively", ".", "This", "model", "achieves", "a", "NLL", "of", "bits", "/", "dim", ".", "Existing", "automated", "metrics", "like", "pSNR", ",", "SSIM", "and", "MS", "-", "SSIM", "have", "been", "shown", "to", "not", "correlate", "with", "perceptual", "image", "quality", "PixelRecursiveSuperResolution", ".", "Hence", ",", "we", "conducted", "a", "human", "evaluation", "study", "on", "Amazon", "Mechanical", "Turk", "where", "each", "worker", "is", "required", "to", "make", "a", "binary", "choice", "when", "shown", "one", "generated", "and", "one", "real", "image", ".", "Following", "the", "same", "procedure", "for", "the", "evaluation", "study", "as", ",", "we", "show", "pairs", "of", "images", ",", "selected", "randomly", "from", "the", "validation", "set", ",", "to", "workers", "each", ".", "Each", "generated", "and", "original", "image", "is", "upscaled", "to", "pixels", "using", "the", "Bilinear", "interpolation", "method", ".", "Each", "worker", "then", "has", "-", "seconds", "to", "make", "a", "choice", "between", "these", "two", "images", ".", "In", "our", "method", ",", "workers", "choose", "images", "from", "our", "model", "up", "to", "%", "of", "the", "time", ",", "a", "significant", "improvement", "over", "previous", "models", ".", "Sampling", "temperature", "of", "and", "2D", "local", "attention", "maximized", "perceptual", "quality", "as", "measured", "by", "this", "evaluation", ".", "To", "measure", "how", "well", "the", "high", "resolution", "samples", "correspond", "to", "the", "low", "resolution", "input", ",", "we", "calculate", "Consistency", ",", "the", "distance", "between", "the", "low", "resolution", "input", "and", "a", "bicubic", "downsampled", "version", "of", "the", "high", "resolution", "sample", ".", "We", "observe", "a", "Consistency", "score", "of", "which", "is", "on", "par", "with", "the", "models", "in", ".", "We", "quantify", "that", "our", "models", "are", "more", "effective", "than", "exemplar", "based", "Super", "Resolution", "techniques", "like", "Nearest", "Neighbors", ",", "which", "perform", "a", "naive", "look", "-", "up", "of", "the", "training", "data", "to", "find", "the", "high", "resolution", "output", ".", "We", "take", "a", "bicubic", "down", "-", "sampled", "version", "of", "our", "high", "resolution", "sample", ",", "find", "the", "nearest", "low", "resolution", "input", "image", "in", "the", "training", "data", "for", "that", "sample", ",", "and", "calculate", "the", "MS", "-", "SSIM", "score", "between", "the", "high", "resolution", "sample", "and", "the", "corresponding", "high", "resolution", "image", "in", "the", "training", "data", ".", "On", "average", ",", "we", "get", "a", "MS", "-", "SSIM", "score", "of", ",", "on", "samples", "from", "the", "validation", "set", ",", "which", "shows", "that", "our", "models", "do", "n\u2019t", "merely", "learn", "to", "copy", "training", "images", "but", "generate", "high", "-", "quality", "images", "by", "adding", "synthesized", "details", "on", "the", "low", "resolution", "input", "image", ".", "paragraph", ":", "CIFAR", "-", "10", "We", "also", "trained", "a", "super", "-", "resolution", "model", "on", "the", "CIFAR", "-", "10", "data", "set", ".", "Our", "model", "reached", "a", "negative", "log", "-", "likelihood", "of", "using", "1D", "local", "attention", "and", "using", "2D", "local", "attention", "on", "the", "test", "set", ".", "As", "seen", "in", "Figure", "[", "reference", "]", ",", "our", "model", "commonly", "generates", "plausible", "looking", "objects", "even", "though", "the", "input", "images", "seem", "to", "barely", "show", "any", "discernible", "structure", "beyond", "coarse", "shapes", ".", "section", ":", "Conclusion", "In", "this", "work", "we", "demonstrate", "that", "models", "based", "on", "self", "-", "attention", "can", "operate", "effectively", "on", "modalities", "other", "than", "text", ",", "and", "through", "local", "self", "-", "attention", "scale", "to", "significantly", "larger", "structures", "than", "sentences", ".", "With", "fewer", "layers", ",", "its", "larger", "receptive", "fields", "allow", "the", "Image", "Transformer", "to", "significantly", "improve", "over", "the", "state", "of", "the", "art", "in", "unconditional", ",", "probabilistic", "image", "modeling", "of", "comparatively", "complex", "images", "from", "ImageNet", "as", "well", "as", "super", "-", "resolution", ".", "We", "further", "hope", "to", "have", "provided", "additional", "evidence", "that", "even", "in", "the", "light", "of", "generative", "adversarial", "networks", ",", "likelihood", "-", "based", "models", "of", "images", "is", "very", "much", "a", "promising", "area", "for", "further", "research", "-", "as", "is", "using", "network", "architectures", "such", "as", "the", "Image", "Transformer", "in", "GANs", ".", "In", "future", "work", "we", "would", "like", "to", "explore", "a", "broader", "variety", "of", "conditioning", "information", "including", "free", "-", "form", "text", ",", "as", "previously", "proposed", "Mansimov15", ",", "and", "tasks", "combining", "modalities", "such", "as", "language", "-", "driven", "editing", "of", "images", ".", "Fundamentally", ",", "we", "aim", "to", "move", "beyond", "still", "images", "to", "video", "Kalchbrenner16", "and", "towards", "applications", "in", "model", "-", "based", "reinforcement", "learning", ".", "bibliography", ":", "References"]}