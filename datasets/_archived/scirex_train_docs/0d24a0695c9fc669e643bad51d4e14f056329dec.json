{"coref": {"BLEU_score": [[127, 128], [537, 538], [1695, 1697], [3236, 3237], [4548, 4550], [4587, 4592], [4779, 4781], [4809, 4812], [4869, 4870], [4897, 4898], [5362, 5364], [5370, 5373], [5386, 5387]], "IWSLT2015_English-German": [[4496, 4501]], "IWSLT2015_German-English": [[4457, 4469]], "Machine_Translation": [[202, 204], [282, 284], [4444, 4446], [4449, 4450], [5510, 5512], [5564, 5566], [5645, 5647], [5673, 5675], [6013, 6015], [180, 182], [984, 986], [3779, 3781], [5501, 5503], [5831, 5833], [6132, 6134]], "RNNsearch": []}, "coref_non_salient": {"0": [[4066, 4069], [4243, 4245]], "1": [[4012, 4015], [4662, 4665], [5147, 5150]], "10": [[5787, 5789], [6072, 6074]], "100": [[1184, 1186]], "101": [[301, 303]], "102": [[3254, 3255]], "103": [[5264, 5265]], "104": [[3551, 3555]], "105": [[5681, 5683]], "106": [[359, 361]], "107": [[2524, 2526]], "108": [[2539, 2541]], "109": [[3336, 3337]], "11": [[102, 104], [1942, 1944], [4951, 4953], [5570, 5572]], "110": [[4077, 4079]], "111": [[1999, 2001]], "112": [[16, 18]], "113": [[565, 568]], "114": [[1665, 1667]], "115": [[1187, 1189]], "116": [[1662, 1664]], "117": [[250, 252]], "118": [[344, 346]], "119": [[1911, 1913]], "12": [[2850, 2852], [3023, 3027], [5618, 5621]], "120": [[1604, 1609]], "121": [[4696, 4697], [4793, 4794], [6147, 6148]], "122": [[3, 7], [1617, 1621]], "123": [[205, 207], [288, 290]], "124": [[3067, 3068]], "125": [[138, 141]], "126": [[1973, 1977]], "127": [[2100, 2103]], "128": [[2418, 2420]], "129": [[3656, 3660]], "13": [[540, 541], [3238, 3240]], "130": [[195, 199]], "131": [[3231, 3234]], "132": [[2866, 2869]], "133": [[2459, 2463]], "134": [[3790, 3792]], "135": [[4610, 4612]], "136": [[5226, 5230]], "137": [[2043, 2045]], "138": [[2429, 2433]], "139": [[1158, 1163]], "14": [[8, 10], [556, 559], [921, 923], [1271, 1273], [1277, 1279], [1477, 1479], [1545, 1547], [1622, 1624], [1920, 1922], [3219, 3221], [5447, 5449]], "140": [[2422, 2426]], "141": [[1429, 1430]], "142": [[3681, 3683]], "143": [[4581, 4582]], "15": [[2055, 2057], [2076, 2078]], "16": [[1510, 1512], [4702, 4704], [4819, 4822], [5242, 5244], [5350, 5352], [5374, 5376], [5388, 5390], [6149, 6151], [3641, 3643]], "17": [[999, 1003], [1540, 1544], [3793, 3797], [4217, 4222], [4376, 4380], [5002, 5006], [5065, 5070], [5219, 5223], [5354, 5358], [5608, 5612], [5659, 5662]], "18": [[1330, 1332], [1358, 1361], [1400, 1402], [4023, 4025]], "19": [[4291, 4292], [4879, 4881], [4919, 4920]], "2": [[3297, 3299], [3313, 3315], [3323, 3325]], "20": [[1770, 1772], [2877, 2879], [2918, 2923], [4320, 4322], [5116, 5118]], "21": [[589, 590], [801, 802], [844, 845], [1551, 1552], [1564, 1566], [1610, 1612]], "22": [[172, 174], [975, 977], [3753, 3755], [5497, 5499]], "23": [[312, 313], [1123, 1124], [1191, 1192], [1226, 1227], [1256, 1257], [1269, 1270], [1275, 1276], [1324, 1325], [4001, 4002], [1347, 1348], [1393, 1394], [1436, 1437], [1472, 1473], [1679, 1680], [1929, 1930], [2289, 2290], [2295, 2296], [5174, 5175]], "24": [[3278, 3281], [4287, 4289]], "25": [[121, 125], [530, 534], [693, 698], [1070, 1075], [3899, 3903], [604, 608], [769, 773], [3375, 3379], [3406, 3410], [3515, 3519]], "26": [[76, 78], [151, 153], [2267, 2269], [3268, 3270], [3861, 3863], [4049, 4051], [5549, 5551], [6342, 6343], [6354, 6355], [6370, 6371]], "27": [[3316, 3318], [3424, 3426]], "28": [[4008, 4009], [5177, 5179]], "29": [[2655, 2657], [5545, 5547]], "3": [[22, 26], [722, 726], [944, 948], [1916, 1919], [2219, 2223], [3054, 3058], [4205, 4208], [4252, 4255], [4401, 4404], [4428, 4431], [4814, 4817], [4855, 4858], [5283, 5286], [5423, 5426], [5442, 5446], [5513, 5516], [5931, 5935], [6195, 6198]], "30": [[891, 893], [906, 908], [2553, 2556]], "31": [[4653, 4654], [4804, 4805], [4860, 4863]], "32": [[1628, 1629], [1652, 1653], [1765, 1766], [2089, 2090], [2243, 2244], [2281, 2282], [2323, 2324], [2409, 2410], [2449, 2450], [2678, 2679], [3100, 3101], [3132, 3133], [3171, 3172], [3385, 3386], [3910, 3913], [4386, 4389], [4405, 4408], [4438, 4441], [5287, 5290], [5432, 5435]], "33": [[34, 39], [3159, 3163], [4359, 4363], [4843, 4847]], "34": [[3345, 3347], [3371, 3373], [3394, 3396]], "35": [[4303, 4308], [4909, 4910], [5555, 5556], [6188, 6189]], "36": [[423, 426], [5491, 5494]], "37": [[849, 852], [2517, 2523]], "38": [[4614, 4616], [4623, 4625], [5170, 5171]], "39": [[3333, 3334]], "4": [[3743, 3747], [3916, 3918], [3929, 3932], [3993, 3997], [4348, 4351], [4680, 4682], [5200, 5202], [5632, 5634], [6055, 6058], [6124, 6126]], "40": [[4142, 4144], [4699, 4701], [4788, 4790], [4864, 4866], [5237, 5239], [5365, 5367]], "41": [[1682, 1684], [1782, 1783], [3353, 3354]], "42": [[913, 915], [2599, 2601], [2644, 2646], [5058, 5060]], "43": [[2137, 2141]], "44": [[3135, 3137]], "45": [[4311, 4313]], "46": [[30, 31], [145, 147]], "47": [[2070, 2072], [2084, 2086]], "48": [[4070, 4071], [4357, 4358], [4384, 4385]], "49": [[2201, 2204], [3803, 3806]], "5": [[220, 222], [787, 789], [1012, 1013]], "50": [[1166, 1169], [4004, 4007]], "51": [[5942, 5947]], "52": [[246, 249], [1115, 1118], [1119, 1122]], "53": [[5758, 5761]], "54": [[95, 97], [1554, 1555], [1630, 1631], [2676, 2677], [4034, 4036]], "55": [[3815, 3818]], "56": [[1831, 1833], [1847, 1849]], "57": [[3496, 3499]], "58": [[3196, 3199], [4199, 4203]], "59": [[2440, 2442], [2578, 2581]], "6": [[512, 514], [995, 996], [2494, 2495], [3242, 3244], [3247, 3248], [3838, 3839], [3868, 3870], [4256, 4257], [4274, 4276], [4602, 4603], [5017, 5018], [5507, 5509], [5816, 5817], [5851, 5852]], "60": [[5949, 5950], [6115, 6116], [6199, 6202]], "61": [[5470, 5471], [5840, 5843]], "62": [[5339, 5341]], "63": [[5260, 5263]], "64": [[5651, 5654]], "65": [[4156, 4158]], "66": [[5888, 5897]], "67": [[1351, 1353], [4017, 4018]], "68": [[5473, 5477]], "69": [[2870, 2873]], "7": [[4370, 4375], [5247, 5252]], "70": [[5539, 5541]], "71": [[5050, 5052], [6211, 6213]], "72": [[4658, 4660]], "73": [[3289, 3290]], "74": [[3504, 3506]], "75": [[3283, 3288]], "76": [[2724, 2727]], "77": [[952, 955]], "78": [[1480, 1482]], "79": [[1365, 1367]], "8": [[714, 715], [732, 733], [854, 855], [862, 864], [940, 942], [1964, 1965], [3214, 3215]], "80": [[1060, 1061]], "81": [[5877, 5879]], "82": [[5962, 5964]], "83": [[4113, 4117]], "84": [[4336, 4337]], "85": [[3291, 3292]], "86": [[4192, 4196]], "87": [[1196, 1199]], "88": [[1597, 1601]], "89": [[865, 870]], "9": [[4783, 4787], [4892, 4896], [5024, 5027], [5270, 5274], [5762, 5765], [6184, 6187]], "90": [[991, 994]], "91": [[209, 211]], "92": [[3225, 3227]], "93": [[2749, 2751]], "94": [[27, 29], [711, 713]], "95": [[1561, 1563], [2702, 2704], [5120, 5122]], "96": [[1967, 1970]], "97": [[2806, 2808]], "98": [[643, 647]], "99": [[3415, 3417]]}, "doc_id": "0d24a0695c9fc669e643bad51d4e14f056329dec", "method_subrelations": {"RNNsearch": [[[0, 9], "RNNsearch"]]}, "n_ary_relations": [{"Material": "IWSLT2015_English-German", "Method": "RNNsearch", "Metric": "BLEU_score", "Task": "Machine_Translation", "score": "25.04"}, {"Material": "IWSLT2015_German-English", "Method": "RNNsearch", "Metric": "BLEU_score", "Task": "Machine_Translation", "score": "29.98"}], "ner": [[3, 7, "Method"], [8, 10, "Task"], [16, 18, "Method"], [22, 26, "Method"], [27, 29, "Method"], [30, 31, "Method"], [34, 39, "Method"], [76, 78, "Method"], [95, 97, "Method"], [102, 104, "Method"], [121, 125, "Metric"], [127, 128, "Metric"], [138, 141, "Task"], [145, 147, "Method"], [151, 153, "Method"], [172, 174, "Task"], [195, 199, "Task"], [202, 204, "Task"], [205, 207, "Task"], [209, 211, "Task"], [220, 222, "Task"], [246, 249, "Method"], [250, 252, "Method"], [282, 284, "Task"], [288, 290, "Task"], [301, 303, "Task"], [312, 313, "Method"], [344, 346, "Method"], [359, 361, "Method"], [423, 426, "Method"], [512, 514, "Method"], [530, 534, "Metric"], [537, 538, "Metric"], [540, 541, "Metric"], [556, 559, "Task"], [565, 568, "Metric"], [589, 590, "Method"], [643, 647, "Method"], [693, 698, "Metric"], [711, 713, "Method"], [714, 715, "Method"], [722, 726, "Method"], [732, 733, "Method"], [787, 789, "Task"], [801, 802, "Method"], [844, 845, "Method"], [849, 852, "Method"], [854, 855, "Method"], [862, 864, "Method"], [865, 870, "Method"], [891, 893, "Method"], [906, 908, "Method"], [913, 915, "Method"], [921, 923, "Task"], [940, 942, "Method"], [944, 948, "Method"], [952, 955, "Task"], [975, 977, "Task"], [991, 994, "Metric"], [995, 996, "Method"], [999, 1003, "Method"], [1012, 1013, "Task"], [1060, 1061, "Task"], [1070, 1075, "Metric"], [1115, 1118, "Method"], [1119, 1122, "Method"], [1123, 1124, "Method"], [1158, 1163, "Method"], [1166, 1169, "Method"], [1184, 1186, "Method"], [1187, 1189, "Task"], [1191, 1192, "Method"], [1196, 1199, "Method"], [1226, 1227, "Method"], [1256, 1257, "Method"], [1269, 1270, "Method"], [1271, 1273, "Task"], [1275, 1276, "Method"], [1277, 1279, "Task"], [1324, 1325, "Method"], [1330, 1332, "Method"], [1351, 1353, "Method"], [1358, 1361, "Method"], [1365, 1367, "Method"], [1400, 1402, "Method"], [1429, 1430, "Method"], [1477, 1479, "Task"], [1480, 1482, "Method"], [1510, 1512, "Method"], [1540, 1544, "Method"], [1545, 1547, "Task"], [1551, 1552, "Method"], [1554, 1555, "Method"], [1561, 1563, "Method"], [1564, 1566, "Method"], [1597, 1601, "Method"], [1604, 1609, "Method"], [1610, 1612, "Method"], [1617, 1621, "Method"], [1622, 1624, "Task"], [1628, 1629, "Method"], [1630, 1631, "Method"], [1652, 1653, "Method"], [1662, 1664, "Method"], [1665, 1667, "Method"], [1682, 1684, "Method"], [1695, 1697, "Metric"], [1765, 1766, "Method"], [1770, 1772, "Method"], [1782, 1783, "Method"], [1831, 1833, "Task"], [1847, 1849, "Task"], [1911, 1913, "Method"], [1916, 1919, "Method"], [1920, 1922, "Task"], [1942, 1944, "Method"], [1964, 1965, "Method"], [1967, 1970, "Method"], [1973, 1977, "Method"], [1999, 2001, "Task"], [2043, 2045, "Method"], [2055, 2057, "Method"], [2070, 2072, "Method"], [2076, 2078, "Method"], [2084, 2086, "Method"], [2089, 2090, "Method"], [2100, 2103, "Method"], [2137, 2141, "Method"], [2201, 2204, "Method"], [2219, 2223, "Method"], [2243, 2244, "Method"], [2267, 2269, "Method"], [2281, 2282, "Method"], [2323, 2324, "Method"], [2409, 2410, "Method"], [2418, 2420, "Method"], [2422, 2426, "Method"], [2429, 2433, "Method"], [2440, 2442, "Task"], [2449, 2450, "Method"], [2459, 2463, "Method"], [2494, 2495, "Method"], [2517, 2523, "Method"], [2524, 2526, "Method"], [2539, 2541, "Method"], [2553, 2556, "Method"], [2578, 2581, "Task"], [2599, 2601, "Method"], [2644, 2646, "Method"], [2655, 2657, "Metric"], [2676, 2677, "Method"], [2678, 2679, "Method"], [2702, 2704, "Method"], [2724, 2727, "Task"], [2749, 2751, "Task"], [2806, 2808, "Metric"], [2850, 2852, "Method"], [2866, 2869, "Method"], [2870, 2873, "Method"], [2877, 2879, "Method"], [2918, 2923, "Method"], [3023, 3027, "Method"], [3054, 3058, "Method"], [3067, 3068, "Task"], [3100, 3101, "Method"], [3132, 3133, "Method"], [3135, 3137, "Method"], [3159, 3163, "Method"], [3171, 3172, "Method"], [3196, 3199, "Task"], [3214, 3215, "Method"], [3219, 3221, "Task"], [3225, 3227, "Method"], [3231, 3234, "Method"], [3236, 3237, "Metric"], [3238, 3240, "Metric"], [3242, 3244, "Method"], [3247, 3248, "Method"], [3254, 3255, "Metric"], [3268, 3270, "Method"], [3278, 3281, "Method"], [3283, 3288, "Method"], [3289, 3290, "Method"], [3291, 3292, "Method"], [3297, 3299, "Task"], [3313, 3315, "Task"], [3316, 3318, "Method"], [3323, 3325, "Task"], [3333, 3334, "Method"], [3336, 3337, "Method"], [3345, 3347, "Method"], [3353, 3354, "Method"], [3371, 3373, "Method"], [3385, 3386, "Method"], [3394, 3396, "Method"], [3415, 3417, "Method"], [3424, 3426, "Method"], [3496, 3499, "Method"], [3504, 3506, "Method"], [3551, 3555, "Method"], [3656, 3660, "Method"], [3681, 3683, "Task"], [3743, 3747, "Task"], [3753, 3755, "Task"], [3790, 3792, "Method"], [3793, 3797, "Method"], [3803, 3806, "Method"], [3815, 3818, "Method"], [3838, 3839, "Method"], [3861, 3863, "Method"], [3868, 3870, "Method"], [3899, 3903, "Metric"], [3910, 3913, "Method"], [3916, 3918, "Task"], [3929, 3932, "Task"], [3993, 3997, "Task"], [4001, 4002, "Method"], [4004, 4007, "Method"], [4008, 4009, "Method"], [4012, 4015, "Method"], [4017, 4018, "Method"], [4023, 4025, "Method"], [4034, 4036, "Method"], [4049, 4051, "Method"], [4066, 4069, "Metric"], [4070, 4071, "Metric"], [4077, 4079, "Task"], [4113, 4117, "Metric"], [4142, 4144, "Method"], [4156, 4158, "Method"], [4192, 4196, "Task"], [4199, 4203, "Task"], [4205, 4208, "Method"], [4217, 4222, "Method"], [4243, 4245, "Metric"], [4252, 4255, "Method"], [4256, 4257, "Method"], [4274, 4276, "Method"], [4287, 4289, "Method"], [4291, 4292, "Method"], [4303, 4308, "Method"], [4311, 4313, "Method"], [4320, 4322, "Method"], [4336, 4337, "Task"], [4348, 4351, "Task"], [4357, 4358, "Metric"], [4359, 4363, "Method"], [4370, 4375, "Method"], [4376, 4380, "Method"], [4384, 4385, "Metric"], [4386, 4389, "Method"], [4401, 4404, "Method"], [4405, 4408, "Method"], [4428, 4431, "Method"], [4438, 4441, "Method"], [4444, 4446, "Task"], [4449, 4450, "Task"], [4457, 4469, "Material"], [4496, 4501, "Material"], [4548, 4550, "Metric"], [4581, 4582, "Method"], [4587, 4592, "Metric"], [4602, 4603, "Method"], [4610, 4612, "Method"], [4614, 4616, "Method"], [4623, 4625, "Method"], [4653, 4654, "Method"], [4658, 4660, "Method"], [4662, 4665, "Method"], [4680, 4682, "Task"], [4696, 4697, "Task"], [4699, 4701, "Method"], [4702, 4704, "Method"], [4779, 4781, "Metric"], [4783, 4787, "Method"], [4788, 4790, "Method"], [4793, 4794, "Task"], [4804, 4805, "Method"], [4809, 4812, "Metric"], [4814, 4817, "Method"], [4819, 4822, "Method"], [4843, 4847, "Method"], [4855, 4858, "Method"], [4860, 4863, "Method"], [4864, 4866, "Method"], [4869, 4870, "Metric"], [4879, 4881, "Method"], [4892, 4896, "Method"], [4897, 4898, "Metric"], [4909, 4910, "Method"], [4919, 4920, "Method"], [4951, 4953, "Method"], [5002, 5006, "Method"], [5017, 5018, "Method"], [5024, 5027, "Method"], [5050, 5052, "Task"], [5058, 5060, "Method"], [5065, 5070, "Method"], [5116, 5118, "Method"], [5120, 5122, "Method"], [5147, 5150, "Method"], [5170, 5171, "Method"], [5177, 5179, "Method"], [5200, 5202, "Task"], [5219, 5223, "Method"], [5226, 5230, "Method"], [5237, 5239, "Method"], [5242, 5244, "Method"], [5247, 5252, "Method"], [5260, 5263, "Method"], [5264, 5265, "Method"], [5270, 5274, "Method"], [5283, 5286, "Method"], [5287, 5290, "Method"], [5339, 5341, "Metric"], [5350, 5352, "Method"], [5354, 5358, "Method"], [5362, 5364, "Metric"], [5365, 5367, "Method"], [5370, 5373, "Metric"], [5374, 5376, "Method"], [5386, 5387, "Metric"], [5388, 5390, "Method"], [5423, 5426, "Method"], [5432, 5435, "Method"], [5442, 5446, "Method"], [5447, 5449, "Task"], [5470, 5471, "Method"], [5473, 5477, "Task"], [5491, 5494, "Method"], [5497, 5499, "Task"], [5507, 5509, "Method"], [5510, 5512, "Task"], [5513, 5516, "Method"], [5539, 5541, "Metric"], [5545, 5547, "Metric"], [5549, 5551, "Method"], [5555, 5556, "Method"], [5564, 5566, "Task"], [5570, 5572, "Method"], [5608, 5612, "Method"], [5618, 5621, "Method"], [5632, 5634, "Task"], [5645, 5647, "Task"], [5651, 5654, "Material"], [5659, 5662, "Method"], [5673, 5675, "Task"], [5681, 5683, "Task"], [5758, 5761, "Method"], [5762, 5765, "Method"], [5787, 5789, "Metric"], [5816, 5817, "Method"], [5840, 5843, "Method"], [5851, 5852, "Method"], [5877, 5879, "Task"], [5888, 5897, "Task"], [5931, 5935, "Method"], [5942, 5947, "Method"], [5949, 5950, "Method"], [5962, 5964, "Method"], [6013, 6015, "Task"], [6055, 6058, "Task"], [6072, 6074, "Metric"], [6115, 6116, "Method"], [6124, 6126, "Task"], [6147, 6148, "Task"], [6149, 6151, "Method"], [6184, 6187, "Method"], [6188, 6189, "Method"], [6195, 6198, "Method"], [6199, 6202, "Method"], [6211, 6213, "Task"], [6342, 6343, "Method"], [6354, 6355, "Method"], [6370, 6371, "Method"], [180, 182, "Task"], [604, 608, "Metric"], [769, 773, "Metric"], [984, 986, "Task"], [1347, 1348, "Method"], [1393, 1394, "Method"], [1436, 1437, "Method"], [1472, 1473, "Method"], [1679, 1680, "Method"], [1929, 1930, "Method"], [2289, 2290, "Method"], [2295, 2296, "Method"], [3375, 3379, "Metric"], [3406, 3410, "Metric"], [3515, 3519, "Metric"], [3641, 3643, "Method"], [3779, 3781, "Task"], [5174, 5175, "Method"], [5501, 5503, "Task"], [5831, 5833, "Task"], [6132, 6134, "Task"]], "sections": [[0, 212], [212, 1004], [1004, 1113], [1113, 1267], [1267, 1671], [1671, 1914], [1914, 2427], [2427, 2550], [2550, 2720], [2720, 2875], [2875, 2995], [2995, 3207], [3207, 3685], [3685, 3914], [3914, 4442], [4442, 4608], [4608, 5141], [5141, 5294], [5294, 5436], [5436, 5951], [5951, 6006], [6006, 6009], [6009, 6224], [6224, 6322], [6322, 6406], [6406, 6416]], "sentences": [[0, 10], [10, 33], [33, 69], [69, 98], [98, 129], [129, 160], [160, 183], [183, 212], [212, 215], [215, 241], [241, 275], [275, 307], [307, 347], [347, 372], [372, 399], [399, 408], [408, 433], [433, 471], [471, 488], [488, 543], [543, 579], [579, 629], [629, 656], [656, 699], [699, 713], [713, 732], [732, 759], [759, 778], [778, 813], [813, 841], [841, 861], [861, 896], [896, 924], [924, 1004], [1004, 1007], [1007, 1031], [1031, 1044], [1044, 1062], [1062, 1085], [1085, 1113], [1113, 1118], [1118, 1151], [1151, 1181], [1181, 1223], [1223, 1241], [1241, 1267], [1267, 1273], [1273, 1291], [1291, 1308], [1308, 1333], [1333, 1355], [1355, 1373], [1373, 1384], [1384, 1422], [1422, 1446], [1446, 1470], [1470, 1498], [1498, 1520], [1520, 1540], [1540, 1547], [1547, 1560], [1560, 1572], [1572, 1579], [1579, 1586], [1586, 1637], [1637, 1648], [1648, 1665], [1665, 1671], [1671, 1675], [1675, 1702], [1702, 1724], [1724, 1756], [1756, 1780], [1780, 1825], [1825, 1869], [1869, 1899], [1899, 1914], [1914, 1922], [1922, 1941], [1941, 1971], [1971, 1979], [1979, 2014], [2014, 2041], [2041, 2066], [2066, 2083], [2083, 2091], [2091, 2121], [2121, 2157], [2157, 2186], [2186, 2209], [2209, 2254], [2254, 2278], [2278, 2293], [2293, 2318], [2318, 2350], [2350, 2373], [2373, 2396], [2396, 2411], [2411, 2427], [2427, 2433], [2433, 2456], [2456, 2490], [2490, 2514], [2514, 2528], [2528, 2550], [2550, 2556], [2556, 2585], [2585, 2616], [2616, 2640], [2640, 2672], [2672, 2693], [2693, 2720], [2720, 2727], [2727, 2756], [2756, 2774], [2774, 2793], [2793, 2805], [2805, 2820], [2820, 2834], [2834, 2857], [2857, 2875], [2875, 2879], [2879, 2913], [2913, 2934], [2934, 2954], [2954, 2973], [2973, 2995], [2995, 3001], [3001, 3012], [3012, 3028], [3028, 3041], [3041, 3081], [3081, 3110], [3110, 3134], [3134, 3146], [3146, 3164], [3164, 3191], [3191, 3207], [3207, 3211], [3211, 3245], [3245, 3272], [3272, 3282], [3282, 3301], [3301, 3316], [3316, 3327], [3327, 3340], [3340, 3358], [3358, 3380], [3380, 3411], [3411, 3427], [3427, 3447], [3447, 3476], [3476, 3491], [3491, 3522], [3522, 3550], [3550, 3561], [3561, 3591], [3591, 3620], [3620, 3647], [3647, 3663], [3663, 3685], [3685, 3688], [3688, 3700], [3700, 3718], [3718, 3740], [3740, 3748], [3748, 3767], [3767, 3787], [3787, 3807], [3807, 3831], [3831, 3852], [3852, 3871], [3871, 3904], [3904, 3914], [3914, 3918], [3918, 3944], [3944, 3958], [3958, 3974], [3974, 3991], [3991, 4019], [4019, 4047], [4047, 4064], [4064, 4110], [4110, 4125], [4125, 4138], [4138, 4153], [4153, 4181], [4181, 4197], [4197, 4223], [4223, 4237], [4237, 4247], [4247, 4258], [4258, 4272], [4272, 4293], [4293, 4314], [4314, 4339], [4339, 4352], [4352, 4369], [4369, 4396], [4396, 4412], [4412, 4442], [4442, 4446], [4446, 4488], [4488, 4502], [4502, 4520], [4520, 4536], [4536, 4551], [4551, 4581], [4581, 4608], [4608, 4616], [4616, 4637], [4637, 4651], [4651, 4666], [4666, 4695], [4695, 4711], [4711, 4729], [4729, 4763], [4763, 4773], [4773, 4795], [4795, 4818], [4818, 4850], [4850, 4882], [4882, 4906], [4906, 4923], [4923, 4945], [4945, 4984], [4984, 5001], [5001, 5044], [5044, 5053], [5053, 5083], [5083, 5098], [5098, 5111], [5111, 5128], [5128, 5141], [5141, 5150], [5150, 5180], [5180, 5204], [5204, 5214], [5214, 5278], [5278, 5294], [5294, 5298], [5298, 5320], [5320, 5353], [5353, 5377], [5377, 5407], [5407, 5436], [5436, 5439], [5439, 5450], [5450, 5481], [5481, 5505], [5505, 5557], [5557, 5582], [5582, 5599], [5599, 5628], [5628, 5666], [5666, 5677], [5677, 5684], [5684, 5704], [5704, 5714], [5714, 5717], [5717, 5734], [5734, 5753], [5753, 5779], [5779, 5806], [5806, 5835], [5835, 5862], [5862, 5898], [5898, 5920], [5920, 5951], [5951, 5954], [5954, 5969], [5969, 5989], [5989, 6006], [6006, 6009], [6009, 6012], [6012, 6034], [6034, 6053], [6053, 6067], [6067, 6087], [6087, 6100], [6100, 6117], [6117, 6136], [6136, 6146], [6146, 6166], [6166, 6203], [6203, 6214], [6214, 6224], [6224, 6227], [6227, 6250], [6250, 6287], [6287, 6297], [6297, 6322], [6322, 6328], [6328, 6349], [6349, 6368], [6368, 6406], [6406, 6416]], "words": ["document", ":", "An", "Actor", "-", "Critic", "Algorithm", "for", "Sequence", "Prediction", "We", "present", "an", "approach", "to", "training", "neural", "networks", "to", "generate", "sequences", "using", "actor", "-", "critic", "methods", "from", "reinforcement", "learning", "(", "RL", ")", ".", "Current", "log", "-", "likelihood", "training", "methods", "are", "limited", "by", "the", "discrepancy", "between", "their", "training", "and", "testing", "modes", ",", "as", "models", "must", "generate", "tokens", "conditioned", "on", "their", "previous", "guesses", "rather", "than", "the", "ground", "-", "truth", "tokens", ".", "We", "address", "this", "problem", "by", "introducing", "a", "critic", "network", "that", "is", "trained", "to", "predict", "the", "value", "of", "an", "output", "token", ",", "given", "the", "policy", "of", "an", "actor", "network", ".", "This", "results", "in", "a", "training", "procedure", "that", "is", "much", "closer", "to", "the", "test", "phase", ",", "and", "allows", "us", "to", "directly", "optimize", "for", "a", "task", "-", "specific", "score", "such", "as", "BLEU", ".", "Crucially", ",", "since", "we", "leverage", "these", "techniques", "in", "the", "supervised", "learning", "setting", "rather", "than", "the", "traditional", "RL", "setting", ",", "we", "condition", "the", "critic", "network", "on", "the", "ground", "-", "truth", "output", ".", "We", "show", "that", "our", "method", "leads", "to", "improved", "performance", "on", "both", "a", "synthetic", "task", ",", "and", "for", "German", "-", "English", "machine", "translation", ".", "Our", "analysis", "paves", "the", "way", "for", "such", "methods", "to", "be", "applied", "in", "natural", "language", "generation", "tasks", ",", "such", "as", "machine", "translation", ",", "caption", "generation", ",", "and", "dialogue", "modelling", ".", "section", ":", "Introduction", "In", "many", "important", "applications", "of", "machine", "learning", ",", "the", "task", "is", "to", "develop", "a", "system", "that", "produces", "a", "sequence", "of", "discrete", "tokens", "given", "an", "input", ".", "Recent", "work", "has", "shown", "that", "recurrent", "neural", "networks", "(", "RNNs", ")", "can", "deliver", "excellent", "performance", "in", "many", "such", "tasks", "when", "trained", "to", "predict", "the", "next", "output", "token", "given", "the", "input", "and", "previous", "tokens", ".", "This", "approach", "has", "been", "applied", "successfully", "in", "machine", "translation", "sutskever2014sequence", ",", "bahdanau2015neural", ",", "caption", "generation", "kiros2014unifying", ",", "donahue2015long", ",", "vinyals2015show", ",", "xu2015show", ",", "karpathy2015deep", ",", "and", "speech", "recognition", "chorowski2015attention", ",", "chan2015listen", ".", "The", "standard", "way", "to", "train", "RNNs", "to", "generate", "sequences", "is", "to", "maximize", "the", "log", "-", "likelihood", "of", "the", "\u201c", "correct", "\u201d", "token", "given", "a", "history", "of", "the", "previous", "\u201c", "correct", "\u201d", "ones", ",", "an", "approach", "often", "called", "teacher", "forcing", ".", "At", "evaluation", "time", ",", "the", "output", "sequence", "is", "often", "produced", "by", "an", "approximate", "search", "for", "the", "most", "likely", "candidate", "according", "to", "the", "learned", "distribution", ".", "During", "this", "search", ",", "the", "model", "is", "conditioned", "on", "its", "own", "guesses", ",", "which", "may", "be", "incorrect", "and", "thus", "lead", "to", "a", "compounding", "of", "errors", "bengio2015scheduled", ".", "This", "can", "become", "especially", "problematic", "for", "longer", "sequences", ".", "Due", "to", "this", "discrepancy", "between", "training", "and", "testing", "conditions", ",", "it", "has", "been", "shown", "that", "maximum", "likelihood", "training", "can", "be", "suboptimal", "bengio2015scheduled", ",", "ranzato2015sequence", ".", "In", "these", "works", ",", "the", "authors", "argue", "that", "the", "network", "should", "be", "trained", "to", "continue", "generating", "correctly", "given", "the", "outputs", "already", "produced", "by", "the", "model", ",", "rather", "than", "the", "ground", "-", "truth", "reference", "outputs", "from", "the", "data", ".", "This", "gives", "rise", "to", "the", "challenging", "problem", "of", "determining", "the", "target", "for", "the", "next", "network", "output", ".", "bengio2015scheduled", "use", "the", "token", "from", "the", "ground", "-", "truth", "answer", "as", "the", "target", "for", "the", "network", "at", "step", ",", "whereas", "ranzato2015sequence", "rely", "on", "the", "REINFORCE", "algorithm", "williams1992simple", "to", "decide", "whether", "or", "not", "the", "tokens", "from", "a", "sampled", "prediction", "lead", "to", "a", "high", "task", "-", "specific", "score", ",", "such", "as", "BLEU", "papineni2002bleu", "or", "ROUGE", "lin2003automatic", ".", "In", "this", "work", ",", "we", "propose", "and", "study", "an", "alternative", "procedure", "for", "training", "sequence", "prediction", "networks", "that", "aims", "to", "directly", "improve", "their", "test", "time", "metrics", "(", "which", "are", "typically", "not", "the", "log", "-", "likelihood", ")", ".", "In", "particular", ",", "we", "train", "an", "additional", "network", "called", "the", "critic", "to", "output", "the", "value", "of", "each", "token", ",", "which", "we", "define", "as", "the", "expected", "task", "-", "specific", "score", "that", "the", "network", "will", "receive", "if", "it", "outputs", "the", "token", "and", "continues", "to", "sample", "outputs", "according", "to", "its", "probability", "distribution", ".", "Furthermore", ",", "we", "show", "how", "the", "predicted", "values", "can", "be", "used", "to", "train", "the", "main", "sequence", "prediction", "network", ",", "which", "we", "refer", "to", "as", "the", "actor", ".", "The", "theoretical", "foundation", "of", "our", "method", "is", "that", ",", "under", "the", "assumption", "that", "the", "critic", "computes", "exact", "values", ",", "the", "expression", "that", "we", "use", "to", "train", "the", "actor", "is", "an", "unbiased", "estimate", "of", "the", "gradient", "of", "the", "expected", "task", "-", "specific", "score", ".", "Our", "approach", "draws", "inspiration", "and", "borrows", "the", "terminology", "from", "the", "field", "of", "reinforcement", "learning", "(", "RL", ")", "sutton1998introduction", ",", "in", "particular", "from", "the", "actor", "-", "critic", "approach", "sutton1984temporal", ",", "sutton1999policy", ",", "barto1983neuronlike", ".", "RL", "studies", "the", "problem", "of", "acting", "efficiently", "based", "only", "on", "weak", "supervision", "in", "the", "form", "of", "a", "reward", "given", "for", "some", "of", "the", "agent", "\u2019s", "actions", ".", "In", "our", "case", ",", "the", "reward", "is", "analogous", "to", "the", "task", "-", "specific", "score", "associated", "with", "a", "prediction", ".", "However", ",", "the", "tasks", "we", "consider", "are", "those", "of", "supervised", "learning", ",", "and", "we", "make", "use", "of", "this", "crucial", "difference", "by", "allowing", "the", "critic", "to", "use", "the", "ground", "-", "truth", "answer", "as", "an", "input", ".", "In", "other", "words", ",", "the", "critic", "has", "access", "to", "a", "sequence", "of", "expert", "actions", "that", "are", "known", "to", "lead", "to", "high", "(", "or", "even", "optimal", ")", "returns", ".", "To", "train", "the", "critic", ",", "we", "adapt", "the", "temporal", "difference", "methods", "from", "the", "RL", "literature", "sutton1988learning", "to", "our", "setup", ".", "While", "RL", "methods", "with", "non", "-", "linear", "function", "approximators", "are", "not", "new", "tesauro1994td", ",", "miller1995neural", ",", "they", "have", "recently", "surged", "in", "popularity", ",", "giving", "rise", "to", "the", "field", "of", "\u2018", "deep", "RL", "\u2019", "mnih2015human", ".", "We", "show", "that", "some", "of", "the", "techniques", "recently", "developed", "in", "deep", "RL", ",", "such", "as", "having", "a", "target", "network", ",", "may", "also", "be", "beneficial", "for", "sequence", "prediction", ".", "The", "contributions", "of", "the", "paper", "can", "be", "summarized", "as", "follows", ":", "1", ")", "we", "describe", "how", "RL", "methodology", "like", "the", "actor", "-", "critic", "approach", "can", "be", "applied", "to", "supervised", "learning", "problems", "with", "structured", "outputs", ";", "and", "2", ")", "we", "investigate", "the", "performance", "and", "behavior", "of", "the", "new", "method", "on", "both", "a", "synthetic", "task", "and", "a", "real", "-", "world", "task", "of", "machine", "translation", ",", "demonstrating", "the", "improvements", "over", "maximum", "-", "likelihood", "and", "REINFORCE", "brought", "by", "the", "actor", "-", "critic", "training", ".", "section", ":", "Background", "We", "consider", "the", "problem", "of", "learning", "to", "produce", "an", "output", "sequence", ",", "given", "an", "input", ",", "where", "is", "the", "alphabet", "of", "output", "tokens", ".", "We", "will", "often", "use", "notation", "to", "refer", "to", "subsequences", "of", "the", "form", ".", "Two", "sets", "of", "input", "-", "output", "pairs", "are", "assumed", "to", "be", "available", "for", "both", "training", "and", "testing", ".", "The", "trained", "predictor", "is", "evaluated", "by", "computing", "the", "average", "task", "-", "specific", "score", "on", "the", "test", "set", ",", "where", "is", "the", "prediction", ".", "To", "simplify", "the", "formulas", "we", "always", "use", "to", "denote", "the", "length", "of", "an", "output", "sequence", ",", "ignoring", "the", "fact", "that", "the", "output", "sequences", "may", "have", "different", "length", ".", "paragraph", ":", "Recurrent", "neural", "networks", "A", "recurrent", "neural", "network", "(", "RNN", ")", "produces", "a", "sequence", "of", "state", "vectors", "given", "a", "sequence", "of", "input", "vectors", "by", "starting", "from", "an", "initial", "state", "and", "applying", "times", "the", "transition", "function", ":", ".", "Popular", "choices", "for", "the", "mapping", "are", "the", "Long", "Short", "-", "Term", "Memory", "hochreiter1997long", "and", "the", "Gated", "Recurrent", "Units", "cho2014learning", ",", "the", "latter", "of", "which", "we", "use", "for", "our", "models", ".", "To", "build", "a", "probabilistic", "model", "for", "sequence", "generation", "with", "an", "RNN", ",", "one", "adds", "a", "stochastic", "output", "layer", "(", "typically", "a", "softmax", "for", "discrete", "outputs", ")", "that", "generates", "outputs", "and", "can", "feed", "these", "outputs", "back", "by", "replacing", "them", "with", "their", "embedding", ":", "Thus", ",", "the", "RNN", "defines", "a", "probability", "distribution", "of", "the", "next", "output", "token", "given", "the", "previous", "tokens", ".", "Upon", "adding", "a", "special", "end", "-", "of", "-", "sequence", "token", "to", "the", "alphabet", ",", "the", "RNN", "can", "define", "the", "distribution", "over", "all", "possible", "sequences", "as", ".", "paragraph", ":", "RNNs", "for", "sequence", "prediction", "To", "use", "RNNs", "for", "sequence", "prediction", ",", "they", "must", "be", "augmented", "to", "generate", "conditioned", "on", "an", "input", ".", "The", "simplest", "way", "to", "do", "this", "is", "to", "start", "with", "an", "initial", "state", "sutskever2014sequence", ",", "cho2014learning", ".", "Alternatively", ",", "one", "can", "encode", "as", "a", "variable", "-", "length", "sequence", "of", "vectors", "and", "condition", "the", "RNN", "on", "this", "sequence", "using", "an", "attention", "mechanism", ".", "In", "our", "models", ",", "the", "sequence", "of", "vectors", "is", "produced", "by", "either", "a", "bidirectional", "RNN", "schuster1997bidirectional", "or", "a", "convolutional", "encoder", "rush2015neural", ".", "We", "use", "a", "soft", "attention", "mechanism", "bahdanau2015neural", "that", "computes", "a", "weighted", "sum", "of", "a", "sequence", "of", "vectors", ".", "The", "attention", "weights", "determine", "the", "relative", "importance", "of", "each", "vector", ".", "More", "formally", ",", "we", "consider", "the", "following", "equations", "for", "RNNs", "with", "attention", ":", "where", "is", "the", "attention", "mechanism", "that", "produces", "the", "attention", "weights", "and", "is", "the", "context", "vector", ",", "or", "\u2018", "glimpse", "\u2019", ",", "for", "time", "step", ".", "The", "attention", "weights", "are", "computed", "by", "an", "MLP", "that", "takes", "as", "input", "the", "current", "RNN", "state", "and", "each", "individual", "vector", "to", "focus", "on", ".", "The", "weights", "are", "typically", "(", "as", "in", "our", "work", ")", "constrained", "to", "be", "positive", "and", "sum", "to", "1", "by", "using", "the", "softmax", "function", ".", "A", "conditioned", "RNN", "can", "be", "trained", "for", "sequence", "prediction", "by", "gradient", "ascent", "on", "the", "log", "-", "likelihood", "for", "the", "input", "-", "output", "pairs", "from", "the", "training", "set", ".", "To", "produce", "a", "prediction", "for", "a", "test", "input", "sequence", ",", "an", "approximate", "beam", "search", "for", "the", "maximum", "of", "is", "usually", "conducted", ".", "During", "this", "search", "the", "probabilities", "are", "considered", ",", "where", "the", "previous", "tokens", "comprise", "a", "candidate", "beginning", "of", "the", "prediction", ".", "Actor", "-", "Critic", "Training", "for", "Sequence", "Prediction", "[", "1", "]", "A", "critic", "and", "an", "actor", "with", "weights", "and", "respectively", ".", "Initialize", "delayed", "actor", "and", "target", "critic", "with", "same", "weights", ":", ",", ".", "Not", "Converged", "Receive", "a", "random", "example", ".", "Generate", "a", "sequence", "of", "actions", "from", ".", "Compute", "targets", "for", "the", "critic", "Update", "the", "critic", "weights", "using", "the", "gradient", "Update", "actor", "weights", "using", "the", "following", "gradient", "estimate", "Update", "delayed", "actor", "and", "target", "critic", ",", "with", "constants", ",", "Complete", "Actor", "-", "Critic", "Algorithm", "for", "Sequence", "Prediction", "[", "1", "]", "Initialize", "critic", "and", "actor", "with", "random", "weights", "and", "respectively", ".", "Pre", "-", "train", "the", "actor", "to", "predict", "given", "by", "maximizing", ".", "Pre", "-", "train", "the", "critic", "to", "estimate", "by", "running", "Algorithm", "[", "reference", "]", "with", "fixed", "actor", ".", "Run", "Algorithm", "[", "reference", "]", ".", "paragraph", ":", "Value", "functions", "We", "view", "the", "conditioned", "RNN", "as", "a", "stochastic", "policy", "that", "generates", "actions", "and", "receives", "the", "task", "score", "(", "e.g.", ",", "BLEU", "score", ")", "as", "the", "return", ".", "We", "furthermore", "consider", "the", "case", "when", "the", "return", "is", "partially", "received", "at", "the", "intermediate", "steps", "in", "the", "form", "of", "rewards", ":", ".", "This", "is", "more", "general", "than", "the", "case", "of", "receiving", "the", "full", "return", "at", "the", "end", "of", "the", "sequence", ",", "as", "we", "can", "simply", "define", "all", "rewards", "other", "than", "to", "be", "zero", ".", "Receiving", "intermediate", "rewards", "may", "ease", "the", "learning", "for", "the", "critic", ",", "and", "we", "use", "reward", "shaping", "as", "explained", "in", "Section", "[", "reference", "]", ".", "Given", "the", "policy", ",", "possible", "actions", "and", "reward", "function", ",", "the", "value", "represents", "the", "expected", "future", "return", "as", "a", "function", "of", "the", "current", "state", "of", "the", "system", ",", "which", "in", "our", "case", "is", "uniquely", "defined", "by", "the", "sequence", "of", "actions", "taken", "so", "far", ",", ".", "We", "define", "the", "value", "of", "an", "unfinished", "prediction", "as", "follows", ":", "We", "define", "the", "value", "of", "a", "candidate", "next", "token", "for", "an", "unfinished", "prediction", "as", "the", "expected", "future", "return", "after", "generating", "token", ":", "We", "will", "refer", "to", "the", "candidate", "next", "tokens", "as", "actions", ".", "For", "notational", "simplicity", ",", "we", "henceforth", "drop", "and", "from", "the", "signature", "of", ",", ",", ",", "and", ",", "assuming", "it", "is", "clear", "from", "the", "context", "which", "of", "and", "is", "meant", ".", "We", "will", "also", "use", "without", "arguments", "for", "the", "expected", "reward", "of", "a", "random", "prediction", ".", "section", ":", "Actor", "-", "Critic", "for", "Sequence", "Prediction", "Let", "be", "the", "parameters", "of", "the", "conditioned", "RNN", ",", "which", "we", "will", "also", "refer", "to", "as", "the", "actor", ".", "Our", "training", "algorithm", "is", "based", "on", "the", "following", "way", "of", "rewriting", "the", "gradient", "of", "the", "expected", "return", ":", "This", "equality", "is", "known", "in", "RL", "under", "the", "names", "policy", "gradient", "theorem", "sutton1999policy", "and", "stochastic", "actor", "-", "critic", "sutton1984temporal", ".", "Note", "that", "we", "use", "the", "probability", "rather", "than", "the", "log", "probability", "in", "this", "formula", "(", "which", "is", "more", "typical", "in", "RL", "applications", ")", "as", "we", "are", "summing", "over", "actions", "rather", "than", "taking", "an", "expectation", ".", "Intuitively", ",", "this", "equality", "corresponds", "to", "increasing", "the", "probability", "of", "actions", "that", "give", "high", "values", ",", "and", "decreasing", "the", "probability", "of", "actions", "that", "give", "low", "values", ".", "Since", "this", "gradient", "expression", "is", "an", "expectation", ",", "it", "is", "trivial", "to", "build", "an", "unbiased", "estimate", "for", "it", ":", "where", "are", "random", "samples", "from", ".", "By", "replacing", "with", "a", "parameteric", "estimate", "one", "can", "obtain", "a", "biased", "estimate", "with", "relatively", "low", "variance", ".", "The", "parameteric", "estimate", "is", "called", "the", "critic", ".", "The", "above", "formula", "is", "similar", "in", "spirit", "to", "the", "REINFORCE", "learning", "rule", "that", "ranzato2015sequence", "use", "in", "the", "same", "context", ":", "where", "the", "scalar", "is", "called", "baseline", "or", "control", "variate", ".", "The", "difference", "is", "that", "in", "REINFORCE", "the", "inner", "sum", "over", "all", "actions", "is", "replaced", "by", "its", "1", "-", "sample", "estimate", ",", "namely", ",", "where", "the", "log", "probability", "is", "introduced", "to", "correct", "for", "the", "sampling", "of", ".", "Furthermore", ",", "instead", "of", "the", "value", ",", "REINFORCE", "uses", "the", "cumulative", "reward", "following", "the", "action", ",", "which", "again", "can", "be", "seen", "as", "a", "1", "-", "sample", "estimate", "of", ".", "Due", "to", "these", "simplifications", "and", "the", "potential", "high", "variance", "in", "the", "cumulative", "reward", ",", "the", "REINFORCE", "gradient", "estimator", "has", "very", "high", "variance", ".", "In", "order", "to", "improve", "upon", "it", ",", "we", "consider", "the", "actor", "-", "critic", "estimate", "from", "Equation", "[", "reference", "]", ",", "which", "has", "a", "lower", "variance", "at", "the", "cost", "of", "significant", "bias", ",", "since", "the", "critic", "is", "not", "perfect", "and", "trained", "simultaneously", "with", "the", "actor", ".", "The", "success", "depends", "on", "our", "ability", "to", "control", "the", "bias", "by", "designing", "the", "critic", "network", "and", "using", "an", "appropriate", "training", "criterion", "for", "it", ".", "To", "implement", "the", "critic", ",", "we", "propose", "to", "use", "a", "separate", "RNN", "parameterized", "by", ".", "The", "critic", "RNN", "is", "run", "in", "parallel", "with", "the", "actor", ",", "consumes", "the", "tokens", "that", "the", "actor", "outputs", "and", "produces", "the", "estimates", "for", "all", ".", "A", "key", "difference", "between", "the", "critic", "and", "the", "actor", "is", "that", "the", "correct", "answer", "is", "given", "to", "the", "critic", "as", "an", "input", ",", "similarly", "to", "how", "the", "actor", "is", "conditioned", "on", ".", "Indeed", ",", "the", "return", "is", "a", "deterministic", "function", "of", ",", "and", "we", "argue", "that", "using", "to", "compute", "should", "be", "of", "great", "help", ".", "We", "can", "do", "this", "because", "the", "values", "are", "only", "required", "during", "training", "and", "we", "do", "not", "use", "the", "critic", "at", "test", "time", ".", "We", "also", "experimented", "with", "providing", "the", "actor", "states", "as", "additional", "inputs", "to", "the", "critic", ".", "See", "Figure", "[", "reference", "]", "for", "a", "visual", "representation", "of", "our", "actor", "-", "critic", "architecture", ".", "paragraph", ":", "Temporal", "-", "difference", "learning", "A", "crucial", "component", "of", "our", "approach", "is", "policy", "evaluation", ",", "that", "is", "the", "training", "of", "the", "critic", "to", "produce", "useful", "estimates", "of", ".", "With", "a", "na\u00efve", "Monte", "-", "Carlo", "method", ",", "one", "could", "use", "the", "future", "return", "as", "a", "target", "to", ",", "and", "use", "the", "critic", "parameters", "to", "minimize", "the", "square", "error", "between", "these", "two", "values", ".", "However", ",", "like", "with", "REINFORCE", ",", "using", "such", "a", "target", "yields", "to", "very", "high", "variance", "which", "quickly", "grows", "with", "the", "number", "of", "steps", ".", "We", "use", "a", "temporal", "difference", "(", "TD", ")", "method", "for", "policy", "evaluation", "sutton1988learning", ".", "Namely", ",", "we", "use", "the", "right", "-", "hand", "side", "of", "the", "Bellman", "equation", "as", "the", "target", "for", "the", "left", "-", "hand", ".", "paragraph", ":", "Applying", "deep", "RL", "techniques", "It", "has", "been", "shown", "in", "the", "RL", "literature", "that", "if", "is", "non", "-", "linear", "(", "like", "in", "our", "case", ")", ",", "the", "TD", "policy", "evaluation", "might", "diverge", "tsitsiklis1997analysis", ".", "Previous", "work", "has", "shown", "that", "this", "problem", "can", "be", "alleviated", "by", "using", "an", "additional", "target", "network", "to", "compute", ",", "which", "is", "updated", "less", "often", "and", "/", "or", "more", "slowly", "than", ".", "Similarly", "to", "lillicrap2015continuous", ",", "we", "update", "the", "parameters", "of", "the", "target", "critic", "by", "linearly", "interpolating", "them", "with", "the", "parameters", "of", "the", "trained", "one", ".", "Attempts", "to", "remove", "the", "target", "network", "by", "propagating", "the", "gradient", "through", "resulted", "in", "a", "lower", "square", "error", ",", "but", "the", "resulting", "values", "proved", "very", "unreliable", "as", "training", "signals", "for", "the", "actor", ".", "The", "fact", "that", "both", "actor", "and", "critic", "use", "outputs", "of", "each", "other", "for", "training", "creates", "a", "potentially", "dangerous", "feedback", "loop", ".", "To", "address", "this", ",", "we", "sample", "predictions", "from", "a", "delayed", "actor", "lillicrap2015continuous", ",", "whose", "weights", "are", "slowly", "updated", "to", "follow", "the", "actor", "that", "is", "actually", "trained", ".", "paragraph", ":", "Dealing", "with", "large", "action", "spaces", "One", "of", "the", "challenges", "of", "our", "work", "is", "that", "the", "action", "space", "is", "very", "large", "(", "as", "is", "typically", "the", "case", "in", "NLP", "tasks", "with", "large", "vocabularies", ")", ".", "This", "can", "be", "alleviated", "by", "putting", "constraints", "on", "the", "critic", "values", "for", "actions", "that", "are", "rarely", "sampled", ".", "We", "found", "experimentally", "that", "shrinking", "the", "values", "of", "these", "rare", "actions", "is", "necessary", "for", "the", "algorithm", "to", "converge", ".", "Specifically", ",", "we", "add", "a", "term", "for", "every", "step", "to", "the", "critic", "\u2019s", "optimization", "objective", "which", "drives", "all", "value", "predictions", "of", "the", "critic", "closer", "to", "their", "mean", ":", "This", "corresponds", "to", "penalizing", "the", "variance", "of", "the", "outputs", "of", "the", "critic", ".", "Without", "this", "penalty", "the", "values", "of", "rare", "actions", "can", "be", "severely", "overestimated", ",", "which", "biases", "the", "gradient", "estimates", "and", "can", "cause", "divergence", ".", "A", "similar", "trick", "was", "used", "in", "the", "context", "of", "learning", "simple", "algorithms", "with", "Q", "-", "learning", "zaremba2015learning", ".", "paragraph", ":", "Reward", "shaping", "While", "we", "are", "ultimately", "interested", "in", "the", "maximization", "of", "the", "score", "of", "a", "complete", "prediction", ",", "simply", "awarding", "this", "score", "at", "the", "last", "step", "provides", "a", "very", "sparse", "training", "signal", "for", "the", "critic", ".", "For", "this", "reason", "we", "use", "potential", "-", "based", "reward", "shaping", "with", "potentials", "for", "incomplete", "sequences", "and", "for", "complete", "ones", "ng1999policy", ".", "Namely", ",", "for", "a", "predicted", "sequence", "we", "compute", "score", "values", "for", "all", "prefixes", "to", "obtain", "the", "sequence", "of", "scores", ".", "The", "difference", "between", "the", "consecutive", "pairs", "of", "scores", "is", "then", "used", "as", "the", "reward", "at", "each", "step", ":", ".", "Using", "the", "shaped", "reward", "instead", "of", "awarding", "the", "whole", "score", "at", "the", "last", "step", "does", "not", "change", "the", "optimal", "policy", "ng1999policy", ".", "paragraph", ":", "Putting", "it", "all", "together", "Algorithm", "[", "reference", "]", "describes", "the", "proposed", "method", "in", "detail", ".", "We", "consider", "adding", "the", "weighted", "log", "-", "likelihood", "gradient", "to", "the", "actor", "\u2019s", "gradient", "estimate", ".", "This", "is", "in", "line", "with", "the", "prior", "work", "by", "ranzato2015sequence", "and", "shen2015minimum", ".", "It", "is", "also", "motivated", "by", "our", "preliminary", "experiments", "that", "showed", "that", "using", "the", "actor", "-", "critic", "estimate", "alone", "can", "lead", "to", "an", "early", "determinization", "of", "the", "policy", "and", "vanishing", "gradients", "(", "also", "discussed", "in", "Section", "[", "reference", "]", ")", ".", "Starting", "training", "with", "a", "randomly", "initialized", "actor", "and", "critic", "would", "be", "problematic", ",", "because", "neither", "the", "actor", "nor", "the", "critic", "would", "provide", "adequate", "training", "signals", "for", "one", "another", ".", "The", "actor", "would", "sample", "completely", "random", "predictions", "that", "receive", "very", "little", "reward", ",", "thus", "providing", "a", "very", "weak", "training", "signal", "for", "the", "critic", ".", "A", "random", "critic", "would", "be", "similarly", "useless", "for", "training", "the", "actor", ".", "Motivated", "by", "these", "considerations", ",", "we", "pre", "-", "train", "the", "actor", "using", "standard", "log", "-", "likelihood", "training", ".", "Furthermore", ",", "we", "pre", "-", "train", "the", "critic", "by", "feeding", "it", "samples", "from", "the", "pre", "-", "trained", "actor", ",", "while", "the", "actor", "\u2019s", "parameters", "are", "frozen", ".", "The", "complete", "training", "procedure", "including", "pre", "-", "training", "is", "described", "by", "Algorithm", "[", "reference", "]", ".", "section", ":", "Related", "Work", "In", "other", "recent", "RL", "-", "inspired", "work", "on", "sequence", "prediction", ",", "ranzato2015sequence", "trained", "a", "translation", "model", "by", "gradually", "transitioning", "from", "maximum", "likelihood", "learning", "into", "optimizing", "BLEU", "or", "ROUGE", "scores", "using", "the", "REINFORCE", "algorithm", ".", "However", ",", "REINFORCE", "is", "known", "to", "have", "very", "high", "variance", "and", "does", "not", "exploit", "the", "availability", "of", "the", "ground", "-", "truth", "like", "the", "critic", "network", "does", ".", "The", "approach", "also", "relies", "on", "a", "curriculum", "learning", "scheme", ".", "Standard", "value", "-", "based", "RL", "algorithms", "like", "SARSA", "and", "OLPOMDP", "have", "also", "been", "applied", "to", "structured", "prediction", "maes2009structured", ".", "Again", ",", "these", "systems", "do", "not", "use", "the", "ground", "-", "truth", "for", "value", "prediction", ".", "Imitation", "learning", "has", "also", "been", "applied", "to", "structured", "prediction", "vlachos2012investigation", ".", "Methods", "of", "this", "type", "include", "the", "Searn", "daume2009search", "and", "DAgger", "ross2010reduction", "algorithms", ".", "These", "methods", "rely", "on", "an", "expert", "policy", "to", "provide", "action", "sequences", "that", "the", "policy", "learns", "to", "imitate", ".", "Unfortunately", ",", "it", "\u2019s", "not", "always", "easy", "or", "even", "possible", "to", "construct", "an", "expert", "policy", "for", "a", "task", "-", "specific", "score", ".", "In", "our", "approach", ",", "the", "critic", "plays", "a", "role", "that", "is", "similar", "to", "the", "expert", "policy", ",", "but", "is", "learned", "without", "requiring", "prior", "knowledge", "about", "the", "task", "-", "specific", "score", ".", "The", "recently", "proposed", "\u2018", "scheduled", "sampling", "\u2019", "bengio2015scheduled", "can", "also", "be", "seen", "as", "imitation", "learning", ".", "In", "this", "method", ",", "ground", "-", "truth", "tokens", "are", "occasionally", "replaced", "by", "samples", "from", "the", "model", "itself", "during", "training", ".", "A", "limitation", "is", "that", "the", "token", "for", "the", "ground", "-", "truth", "answer", "is", "used", "as", "the", "target", "at", "step", ",", "which", "might", "not", "always", "be", "the", "optimal", "strategy", ".", "There", "are", "also", "approaches", "that", "aim", "to", "approximate", "the", "gradient", "of", "the", "expected", "score", ".", "One", "such", "approach", "is", "\u2018", "Direct", "Loss", "Minimization", "\u2019", "hazan2010", "in", "which", "the", "inference", "procedure", "is", "adapted", "to", "take", "both", "the", "model", "likelihood", "and", "task", "-", "specific", "score", "into", "account", ".", "Another", "popular", "approach", "is", "to", "replace", "the", "domain", "over", "which", "the", "task", "score", "expectation", "is", "defined", "with", "a", "small", "subset", "of", "it", ",", "as", "is", "done", "in", "Minimum", "(", "Bayes", ")", "Risk", "Training", "goel2000minimum", ",", "shen2015minimum", ",", "och2003minimum", ".", "This", "small", "subset", "is", "typically", "an", "-", "best", "list", "or", "a", "sample", "(", "like", "in", "REINFORCE", ")", "that", "may", "or", "may", "not", "include", "the", "ground", "-", "truth", "as", "well", ".", "None", "of", "these", "methods", "provide", "intermediate", "targets", "for", "the", "actor", "during", "training", ",", "and", "shen2015minimum", "report", "that", "as", "many", "as", "100", "samples", "were", "required", "for", "the", "best", "results", ".", "Another", "recently", "proposed", "method", "is", "to", "optimize", "a", "global", "sequence", "cost", "with", "respect", "to", "the", "selection", "and", "pruning", "behavior", "of", "the", "beam", "search", "procedure", "itself", "wiseman2016sequence", ".", "This", "method", "follows", "the", "more", "general", "strategy", "called", "\u2018", "learning", "as", "search", "optimization", "\u2019", "daume2005learning", ".", "This", "is", "an", "interesting", "alternative", "to", "our", "approach", ";", "however", ",", "it", "is", "designed", "specifically", "for", "the", "precise", "inference", "procedure", "involved", ".", "section", ":", "Experiments", "To", "validate", "our", "approach", ",", "we", "performed", "two", "sets", "of", "experiments", ".", "First", ",", "we", "trained", "the", "proposed", "model", "to", "recover", "strings", "of", "natural", "text", "from", "their", "corrupted", "versions", ".", "Specifically", ",", "we", "consider", "each", "character", "in", "a", "natural", "language", "corpus", "and", "with", "some", "probability", "replace", "it", "with", "a", "random", "character", ".", "We", "call", "this", "synthetic", "task", "spelling", "correction", ".", "A", "desirable", "property", "of", "this", "synthetic", "task", "is", "that", "data", "is", "essentially", "infinite", "and", "overfitting", "is", "no", "concern", ".", "Our", "second", "series", "of", "experiments", "is", "done", "on", "the", "task", "of", "automatic", "machine", "translation", "using", "different", "models", "and", "datasets", ".", "In", "addition", "to", "maximum", "likelihood", "and", "actor", "-", "critic", "training", "we", "implemented", "two", "versions", "of", "the", "REINFORCE", "gradient", "estimator", ".", "In", "the", "first", "version", ",", "we", "use", "a", "linear", "baseline", "network", "that", "takes", "the", "actor", "states", "as", "input", ",", "exactly", "as", "in", "ranzato2015sequence", ".", "We", "also", "propose", "a", "novel", "extension", "of", "REINFORCE", "that", "leverages", "the", "extra", "information", "available", "in", "the", "ground", "-", "truth", "output", ".", "Specifically", ",", "we", "use", "the", "estimates", "produced", "by", "the", "critic", "network", "as", "the", "baseline", "for", "the", "REINFORCE", "algorithm", ".", "The", "motivation", "behind", "this", "approach", "is", "that", "using", "the", "ground", "-", "truth", "output", "should", "produce", "a", "better", "baseline", "that", "lowers", "the", "variance", "of", "REINFORCE", ",", "resulting", "in", "higher", "task", "-", "specific", "scores", ".", "We", "refer", "to", "this", "method", "as", "REINFORCE", "-", "critic", ".", "subsection", ":", "Spelling", "Correction", "We", "use", "text", "from", "the", "One", "Billion", "Word", "dataset", "for", "the", "spelling", "correction", "task", "chelba2013one", ",", "which", "has", "pre", "-", "defined", "training", "and", "testing", "sets", ".", "The", "training", "data", "was", "abundant", ",", "and", "we", "never", "used", "any", "example", "twice", ".", "We", "evaluate", "trained", "models", "on", "a", "section", "of", "the", "test", "data", "that", "comprises", "6075", "sentences", ".", "To", "speed", "up", "experiments", ",", "we", "clipped", "all", "sentences", "to", "the", "first", "10", "or", "30", "characters", ".", "For", "the", "spelling", "correction", "actor", "network", ",", "we", "use", "an", "RNN", "with", "100", "Gated", "Recurrent", "Units", "(", "GRU", ")", "and", "a", "bidirectional", "GRU", "network", "for", "the", "encoder", ".", "We", "use", "the", "same", "attention", "mechanism", "as", "proposed", "in", "bahdanau2015neural", ",", "which", "effectively", "makes", "our", "actor", "network", "a", "smaller", "version", "of", "the", "model", "used", "in", "that", "work", ".", "For", "the", "critic", "network", ",", "we", "employed", "a", "model", "with", "the", "same", "architecture", "as", "the", "actor", ".", "We", "use", "character", "error", "rate", "(", "CER", ")", "to", "measure", "performance", "on", "the", "spelling", "task", ",", "which", "we", "define", "as", "the", "ratio", "between", "the", "total", "of", "Levenshtein", "distances", "between", "predictions", "and", "ground", "-", "truth", "outputs", "and", "the", "total", "length", "of", "the", "ground", "-", "truth", "outputs", ".", "This", "is", "a", "corpus", "-", "level", "metric", "for", "which", "a", "lower", "value", "is", "better", ".", "We", "use", "it", "as", "the", "return", "by", "negating", "per", "-", "sentence", "ratios", ".", "At", "the", "evaluation", "time", "greedy", "search", "is", "used", "to", "extract", "predictions", "from", "the", "model", ".", "We", "use", "the", "ADAM", "optimizer", "kingma2015method", "to", "train", "all", "the", "networks", "with", "the", "parameters", "recommended", "in", "the", "original", "paper", ",", "with", "the", "exception", "of", "the", "scale", "parameter", ".", "The", "latter", "is", "first", "set", "to", "and", "then", "annealed", "to", "for", "log", "-", "likelihood", "training", ".", "For", "the", "pre", "-", "training", "stage", "of", "the", "actor", "-", "critic", ",", "we", "use", "and", "decrease", "it", "to", "for", "the", "joint", "actor", "-", "critic", "training", ".", "We", "pretrain", "the", "actor", "until", "its", "score", "on", "the", "development", "set", "stops", "improving", ".", "We", "pretrain", "the", "critic", "until", "its", "TD", "error", "stabilizes", ".", "We", "used", "sample", "for", "both", "actor", "-", "critic", "and", "REINFORCE", ".", "For", "exact", "hyperparameter", "settings", "we", "refer", "the", "reader", "to", "Appendix", "[", "reference", "]", ".", "We", "start", "REINFORCE", "training", "from", "a", "pretrained", "actor", ",", "but", "we", "do", "not", "use", "the", "curriculum", "learning", "employed", "in", "MIXER", ".", "The", "critic", "is", "trained", "in", "the", "same", "way", "for", "both", "REINFORCE", "and", "actor", "-", "critic", ",", "including", "the", "pretraining", "stage", ".", "We", "report", "results", "obtained", "with", "the", "reward", "shaping", "described", "in", "Section", "[", "reference", "]", ",", "as", "we", "found", "that", "it", "slightly", "improves", "REINFORCE", "performance", ".", "Table", "[", "reference", "]", "presents", "our", "results", "on", "the", "spelling", "correction", "task", ".", "We", "observe", "an", "improvement", "in", "CER", "over", "log", "-", "likelihood", "training", "for", "all", "four", "settings", "considered", ".", "Without", "simultaneous", "log", "-", "likelihood", "training", ",", "actor", "-", "critic", "training", "results", "in", "a", "better", "CER", "than", "REINFORCE", "-", "critic", "in", "three", "out", "of", "four", "settings", ".", "In", "the", "fourth", "case", ",", "actor", "-", "critic", "and", "REINFORCE", "-", "critic", "have", "similar", "performance", ".", "Adding", "the", "log", "-", "likelihood", "gradient", "with", "a", "cofficient", "helps", "both", "of", "the", "methods", ",", "but", "actor", "-", "critic", "still", "retains", "a", "margin", "of", "improvement", "over", "REINFORCE", "-", "critic", ".", "subsection", ":", "Machine", "Translation", "For", "our", "first", "translation", "experiment", ",", "we", "use", "data", "from", "the", "German", "-", "English", "machine", "translation", "track", "of", "the", "IWSLT", "2014", "evaluation", "campaign", "cettolo2014report", ",", "as", "used", "in", "ranzato2015sequence", ",", "and", "closely", "follow", "the", "pre", "-", "processing", "described", "in", "that", "work", ".", "The", "training", "data", "comprises", "about", "153", ",", "000", "German", "-", "English", "sentence", "pairs", ".", "In", "addition", "we", "considered", "a", "larger", "WMT14", "English", "-", "French", "dataset", "with", "more", "than", "12", "million", "examples", ".", "For", "further", "information", "about", "the", "data", "we", "refer", "the", "reader", "to", "Appendix", "[", "reference", "]", ".", "The", "return", "is", "defined", "as", "a", "smoothed", "and", "rescaled", "version", "of", "the", "BLEU", "score", ".", "Specifically", ",", "we", "start", "all", "n", "-", "gram", "counts", "from", "1", "instead", "of", "0", ",", "and", "multiply", "the", "resulting", "score", "by", "the", "length", "of", "the", "ground", "-", "truth", "translation", ".", "Smoothing", "is", "a", "common", "practice", "when", "sentence", "-", "level", "BLEU", "score", "is", "considered", ",", "and", "it", "has", "been", "used", "to", "apply", "REINFORCE", "in", "similar", "settings", "ranzato2015sequence", ".", "paragraph", ":", "IWSLT", "2014", "with", "a", "convolutional", "encoder", "In", "our", "first", "experiment", "we", "use", "a", "convolutional", "encoder", "in", "the", "actor", "to", "make", "our", "results", "more", "comparable", "with", "ranzato2015sequence", ".", "For", "the", "same", "reason", ",", "we", "use", "256", "hidden", "units", "in", "the", "networks", ".", "For", "the", "critic", ",", "we", "replaced", "the", "convolutional", "network", "with", "a", "bidirectional", "GRU", "network", ".", "For", "training", "this", "model", "we", "mostly", "used", "the", "same", "hyperparameter", "values", "as", "in", "the", "spelling", "correction", "experiments", ",", "with", "a", "few", "differences", "highlighted", "in", "Appendix", "[", "reference", "]", ".", "For", "decoding", "we", "used", "greedy", "search", "and", "beam", "search", "with", "a", "beam", "size", "of", "10", ".", "We", "found", "that", "penalizing", "candidate", "sentences", "that", "are", "too", "short", "was", "required", "to", "obtain", "the", "best", "results", ".", "Similarly", "to", "hannun2014first", ",", "we", "subtracted", "from", "the", "negative", "log", "-", "likelihood", "of", "each", "candidate", "sentence", ",", "where", "is", "the", "candidate", "\u2019s", "length", ",", "and", "is", "a", "hyperparameter", "tuned", "on", "the", "validation", "set", ".", "The", "results", "are", "summarized", "in", "Table", "[", "reference", "]", ".", "We", "report", "a", "significant", "improvement", "of", "BLEU", "points", "over", "the", "log", "-", "likelihood", "baseline", "when", "greedy", "search", "is", "used", "for", "decoding", ".", "Surprisingly", ",", "the", "best", "performing", "method", "is", "REINFORCE", "with", "critic", ",", "with", "an", "additional", "BLEU", "point", "advantage", "over", "the", "actor", "-", "critic", ".", "When", "beam", "-", "search", "is", "used", ",", "the", "ranking", "of", "the", "compared", "approaches", "is", "the", "same", ",", "but", "the", "margin", "between", "the", "proposed", "methods", "and", "log", "-", "likelihood", "training", "becomes", "smaller", ".", "The", "final", "performances", "of", "the", "actor", "-", "critic", "and", "the", "REINFORCE", "-", "critic", "with", "greedy", "search", "are", "also", "and", "BLEU", "points", "respectively", "better", "than", "what", "ranzato2015sequence", "report", "for", "their", "MIXER", "approach", ".", "This", "comparison", "should", "be", "treated", "with", "caution", ",", "because", "our", "log", "-", "likelihood", "baseline", "is", "BLEU", "points", "stronger", "than", "its", "equivalent", "from", "ranzato2015sequence", ".", "The", "performance", "of", "REINFORCE", "with", "a", "simple", "baseline", "matches", "the", "score", "reported", "for", "MIXER", "in", "ranzato2015sequence", ".", "To", "better", "understand", "the", "IWSLT", "2014", "results", "we", "provide", "the", "learning", "curves", "for", "the", "considered", "approaches", "in", "Figure", "[", "reference", "]", ".", "We", "can", "clearly", "see", "that", "the", "training", "methods", "that", "use", "generated", "predictions", "have", "a", "strong", "regularization", "effect", "\u2014", "that", "is", ",", "better", "progress", "on", "the", "validation", "set", "in", "exchange", "for", "slower", "or", "negative", "progress", "on", "the", "training", "set", ".", "The", "effect", "is", "stronger", "for", "both", "REINFORCE", "varieties", ",", "especially", "for", "the", "one", "without", "a", "critic", ".", "The", "actor", "-", "critic", "training", "does", "a", "much", "better", "job", "of", "fitting", "the", "training", "set", "than", "REINFORCE", "and", "is", "the", "only", "method", "except", "log", "-", "likelihood", "that", "shows", "a", "clear", "overfitting", ",", "which", "is", "a", "healthy", "behaviour", "for", "such", "a", "small", "dataset", ".", "In", "addition", ",", "we", "performed", "an", "ablation", "study", ".", "We", "found", "that", "using", "a", "target", "network", "was", "crucial", ";", "while", "the", "joint", "actor", "-", "critic", "training", "was", "still", "progressing", "with", ",", "with", "it", "did", "not", "work", "at", "all", ".", "Similarly", "important", "was", "the", "value", "penalty", "described", "in", "Equation", "(", "[", "reference", "]", ")", ".", "We", "found", "that", "good", "values", "of", "the", "coefficient", "were", "in", "the", "range", ".", "Other", "techniques", ",", "such", "as", "reward", "shaping", "and", "a", "delayed", "actor", ",", "brought", "moderate", "performance", "gains", ".", "We", "refer", "the", "reader", "to", "Appendix", "[", "reference", "]", "for", "more", "details", ".", "paragraph", ":", "IWSLT", "2014", "with", "a", "bidirectional", "GRU", "encoder", "In", "order", "to", "compare", "our", "results", "with", "those", "reported", "by", "wiseman2016sequence", "we", "repeated", "our", "IWSLT", "2014", "investigation", "with", "a", "different", "encoder", ",", "a", "bidirectional", "RNN", "with", "256", "GRU", "units", ".", "In", "this", "round", "of", "experiments", "we", "also", "tried", "to", "used", "combined", "training", "objectives", "in", "the", "same", "way", "as", "in", "our", "spelling", "correction", "experiments", ".", "The", "results", "are", "summarized", "in", "Table", "[", "reference", "]", ".", "One", "can", "see", "that", "the", "actor", "-", "critic", "training", ",", "especially", "its", "AC", "+", "LL", "version", ",", "yields", "significant", "improvements", "(", "1.7", "with", "greedy", "search", "and", "1.0", "with", "beam", "search", ")", "upon", "the", "pure", "log", "-", "likelihood", "training", ",", "which", "are", "comparable", "to", "those", "brought", "by", "Beam", "Search", "Optimization", "(", "BSO", ")", ",", "even", "though", "our", "log", "-", "likelihood", "baseline", "is", "much", "stronger", ".", "In", "this", "round", "of", "experiments", "actor", "-", "critic", "and", "REINFORCE", "-", "critic", "performed", "on", "par", ".", "paragraph", ":", "WMT", "14", "Finally", "we", "report", "our", "results", "on", "a", "very", "popular", "large", "WMT14", "English", "-", "French", "dataset", "cho2014learning", "in", "Table", "[", "reference", "]", ".", "Our", "model", "closely", "follows", "the", "achitecture", "from", "bahdanau2015neural", ",", "however", "we", "achieved", "a", "higher", "baseline", "performance", "by", "annealing", "the", "learning", "rate", "and", "penalizing", "output", "sequences", "that", "were", "too", "short", "during", "beam", "search", ".", "The", "actor", "-", "critic", "training", "brings", "a", "significant", "1.5", "BLEU", "improvement", "with", "greedy", "search", "and", "a", "noticeable", "0.4", "BLEU", "improvement", "with", "beam", "search", ".", "In", "previous", "work", "report", "a", "higher", "improvement", "of", "1.4", "BLEU", "with", "beam", "search", ",", "however", "they", "use", "100", "samples", "for", "each", "training", "example", ",", "whereas", "we", "use", "just", "one", ".", "We", "note", "that", "in", "this", "experiment", ",", "which", "is", "perhaps", "the", "most", "realistic", "settings", ",", "the", "actor", "-", "critic", "enjoys", "a", "significant", "advantage", "over", "the", "REINFORCE", "-", "critic", ".", "section", ":", "Discussion", "We", "proposed", "an", "actor", "-", "critic", "approach", "to", "sequence", "prediction", ".", "Our", "method", "takes", "the", "task", "objective", "into", "account", "during", "training", "and", "uses", "the", "ground", "-", "truth", "output", "to", "aid", "the", "critic", "in", "its", "prediction", "of", "intermediate", "targets", "for", "the", "actor", ".", "We", "showed", "that", "our", "method", "leads", "to", "significant", "improvements", "over", "maximum", "likelihood", "training", "on", "both", "a", "synthetic", "task", "and", "a", "machine", "translation", "benchmark", ".", "Compared", "to", "REINFORCE", "training", "on", "machine", "translation", ",", "actor", "-", "critic", "fits", "the", "training", "data", "much", "faster", ",", "although", "in", "some", "of", "our", "experiments", "we", "were", "able", "to", "significantly", "reduce", "the", "gap", "in", "the", "training", "speed", "and", "achieve", "a", "better", "test", "error", "using", "our", "critic", "network", "as", "the", "baseline", "for", "REINFORCE", ".", "One", "interesting", "observation", "we", "made", "from", "the", "machine", "translation", "results", "is", "that", "the", "training", "methods", "that", "use", "generated", "predictions", "have", "a", "strong", "regularization", "effect", ".", "Our", "understanding", "is", "that", "conditioning", "on", "the", "sampled", "outputs", "effectively", "increases", "the", "diversity", "of", "training", "data", ".", "This", "phenomenon", "makes", "it", "harder", "to", "judge", "whether", "the", "actor", "-", "critic", "training", "meets", "our", "expectations", ",", "because", "a", "noisier", "gradient", "estimate", "yielded", "a", "better", "test", "set", "performance", ".", "We", "argue", "that", "the", "spelling", "correction", "results", "obtained", "on", "a", "virtually", "infinite", "dataset", "in", "conjuction", "with", "better", "machine", "translation", "performance", "on", "the", "large", "WMT", "14", "dataset", "provide", "convincing", "evidence", "that", "the", "actor", "-", "training", "can", "be", "effective", ".", "In", "future", "work", "we", "will", "consider", "larger", "machine", "translation", "datasets", ".", "We", "ran", "into", "several", "optimization", "issues", ".", "The", "critic", "would", "sometimes", "assign", "very", "high", "values", "to", "actions", "with", "a", "very", "low", "probability", "according", "to", "the", "actor", ".", "We", "were", "able", "to", "resolve", "this", "by", "penalizing", "the", "critic", "\u2019s", "variance", ".", "Additionally", ",", "the", "actor", "would", "sometimes", "have", "trouble", "to", "adapt", "to", "the", "demands", "of", "the", "critic", ".", "We", "noticed", "that", "the", "action", "distribution", "tends", "to", "saturate", "and", "become", "deterministic", ",", "causing", "the", "gradient", "to", "vanish", ".", "We", "found", "that", "combining", "an", "RL", "training", "objective", "with", "log", "-", "likelihood", "can", "help", ",", "but", "in", "general", "we", "think", "this", "issue", "deserves", "further", "investigation", ".", "For", "example", ",", "one", "can", "look", "for", "suitable", "training", "criteria", "that", "have", "a", "well", "-", "behaved", "gradient", "even", "when", "the", "policy", "has", "little", "or", "no", "stochasticity", ".", "In", "a", "concurrent", "work", "wu2016google", "show", "that", "a", "version", "of", "REINFORCE", "with", "the", "baseline", "computed", "using", "multiple", "samples", "can", "improve", "performance", "of", "a", "very", "strong", "machine", "translation", "system", ".", "This", "result", ",", "and", "our", "REINFORCE", "-", "critic", "experiments", ",", "suggest", "that", "often", "the", "variance", "of", "REINFORCE", "can", "be", "reduced", "enough", "to", "make", "its", "application", "practical", ".", "That", "said", ",", "we", "would", "like", "to", "emphasize", "that", "this", "paper", "attacks", "the", "problem", "of", "gradient", "estimation", "from", "a", "very", "different", "angle", "as", "it", "aims", "for", "low", "-", "variance", "but", "potentially", "high", "-", "bias", "estimates", ".", "The", "idea", "of", "using", "the", "ground", "-", "truth", "output", "that", "we", "proposed", "is", "an", "absolutely", "necessary", "first", "step", "in", "this", "direction", ".", "Future", "work", "could", "focus", "on", "further", "reducing", "the", "bias", "of", "the", "actor", "-", "critic", "estimate", ",", "for", "example", ",", "by", "using", "a", "multi", "-", "sample", "training", "criterion", "for", "the", "critic", ".", "subsubsection", ":", "Acknowledgments", "We", "thank", "the", "developers", "of", "Theano", "team2016theano", "and", "Blocks", "blocksfuel", "for", "their", "great", "work", ".", "We", "thank", "NSERC", ",", "Compute", "Canada", ",", "Calcul", "Queb\u00e9c", ",", "Canada", "Research", "Chairs", ",", "CIFAR", ",", "CHISTERA", "project", "M2CR", "(", "PCIN", "-", "2015", "-", "226", ")", "and", "Samsung", "Institute", "of", "Advanced", "Techonology", "for", "their", "financial", "support", ".", "bibliography", ":", "References", "appendix", ":", "Hyperparameters", "For", "machine", "translation", "experiments", "the", "variance", "penalty", "coefficient", "was", "set", "to", ",", "and", "the", "delay", "coefficients", "and", "were", "both", "set", "to", ".", "For", "REINFORCE", "with", "the", "critic", "we", "did", "not", "use", "a", "delayed", "actor", ",", "i.e.", "was", "set", "to", "1", ".", "For", "the", "spelling", "correction", "task", "we", "used", "the", "same", "and", "but", "a", "different", ".", "When", "we", "used", "a", "combined", "training", "criterion", ",", "the", "weight", "of", "the", "log", "-", "likelihood", "gradient", "was", "always", "0.1", ".", "All", "initial", "weights", "were", "sampled", "from", "a", "centered", "uniform", "distribution", "with", "width", ".", "In", "some", "of", "our", "experiments", "we", "provided", "the", "actor", "states", "as", "additional", "inputs", "to", "the", "critic", ".", "Specifically", ",", "we", "did", "so", "in", "our", "spelling", "correction", "experiments", "and", "in", "our", "WMT", "14", "machine", "translation", "study", ".", "All", "the", "other", "results", "were", "obtained", "without", "this", "technique", ".", "For", "decoding", "with", "beam", "search", "we", "substracted", "the", "length", "of", "a", "candidate", "times", "from", "the", "log", "-", "likelihood", "cost", ".", "The", "exact", "value", "of", "was", "selected", "on", "the", "validation", "set", "and", "was", "equal", "to", "for", "models", "trained", "by", "log", "-", "likelihood", "and", "REINFORCE", "and", "to", "for", "models", "trained", "by", "actor", "-", "critic", "and", "REINFORCE", "-", "critic", ".", "For", "some", "of", "the", "hyperparameters", "we", "performed", "an", "ablation", "study", ".", "The", "results", "are", "reported", "in", "Table", "[", "reference", "]", ".", "appendix", ":", "Data", "For", "the", "IWSLT", "2014", "data", "the", "sizes", "of", "validation", "and", "tests", "set", "were", "6", ",", "969", "and", "6", ",", "750", ",", "respectively", ".", "We", "limited", "the", "number", "of", "words", "in", "the", "English", "and", "German", "vocabularies", "to", "the", "22", ",", "822", "and", "32", ",", "009", "most", "frequent", "words", ",", "respectively", ",", "and", "replaced", "all", "other", "words", "with", "a", "special", "token", ".", "The", "maximum", "sentence", "length", "in", "our", "dataset", "was", "50", ".", "For", "WMT14", "we", "used", "vocabularies", "of", "30", ",", "000", "words", "for", "both", "English", "and", "French", ",", "and", "the", "maximum", "sentence", "length", "was", "also", "50", ".", "appendix", ":", "Generated", "Q", "-", "values", "In", "Table", "[", "reference", "]", "we", "provide", "an", "example", "of", "value", "predictions", "that", "the", "critic", "outputs", "for", "candidate", "next", "words", ".", "One", "can", "see", "that", "the", "critic", "has", "indeed", "learnt", "to", "assign", "larger", "values", "for", "the", "appropriate", "next", "words", ".", "While", "the", "critic", "does", "not", "always", "produce", "sensible", "estimates", "and", "can", "often", "predict", "a", "high", "return", "for", "irrelevant", "rare", "words", ",", "this", "is", "greatly", "reduced", "using", "the", "variance", "penalty", "term", "from", "Equation", "(", "[", "reference", "]", ")", ".", "appendix", ":", "Proof", "of", "Equation", "(", "[", "reference", "]", ")"]}