{"coref": {"DukeMTMC-reID": [[4694, 4695]], "MAP": [[3428, 3431], [3432, 3433], [4480, 4484], [4547, 4548], [4851, 4852], [5094, 5097]], "OIM": [[113, 116], [117, 118], [796, 799], [816, 819], [820, 821], [1578, 1581], [1582, 1583], [2525, 2526], [4443, 4446], [4453, 4456], [4457, 4458], [4911, 4915], [181, 182], [912, 913], [996, 999], [1631, 1632], [1973, 1974], [2009, 2012], [2551, 2552], [2741, 2742], [2757, 2758], [3636, 3639], [3640, 3641], [4226, 4227], [4558, 4559], [4582, 4583], [4637, 4638], [4674, 4675], [4723, 4724], [4780, 4781], [5325, 5328]], "Person_Re-Identification": [[95, 99], [198, 202], [203, 207], [290, 295], [523, 527], [691, 697], [1112, 1116], [1171, 1176], [1270, 1275], [1313, 1318], [1463, 1467], [1595, 1597], [3136, 3137], [3368, 3374], [3442, 3448], [3616, 3620], [3824, 3828], [3912, 3914], [3954, 3958], [4139, 4142], [4171, 4175], [4273, 4278], [4300, 4305], [4316, 4321], [5047, 5052], [5127, 5132], [5152, 5157], [5318, 5319], [12, 16], [379, 383], [968, 972], [1118, 1122], [3835, 3839], [3963, 3967], [4058, 4062], [4077, 4081], [4249, 4253], [4333, 4337], [4642, 4646], [4683, 4687]], "Rank-1": []}, "coref_non_salient": {"0": [[4874, 4876], [4964, 4966]], "1": [[3422, 3426], [4704, 4709]], "10": [[3659, 3661], [5175, 5177]], "100": [[2239, 2241]], "101": [[3451, 3452]], "102": [[4147, 4150]], "103": [[1140, 1143]], "104": [[2496, 2498]], "105": [[2748, 2750]], "11": [[1602, 1604], [1980, 1982], [2144, 2146]], "12": [[75, 78], [499, 502], [943, 946], [1335, 1338], [1453, 1456], [5306, 5309]], "13": [[4064, 4065], [4378, 4379], [4398, 4399], [4436, 4438]], "14": [[233, 238], [240, 243]], "15": [[4475, 4478], [4507, 4508], [4538, 4540], [4564, 4566]], "16": [[2604, 2606], [2691, 2693], [2793, 2795]], "17": [[3674, 3679], [3892, 3895]], "18": [[3859, 3868], [4404, 4411]], "19": [[1611, 1615], [1993, 1998]], "2": [[2801, 2805], [5339, 5343]], "20": [[3528, 3532], [3916, 3920]], "21": [[192, 194], [921, 923], [4499, 4501]], "22": [[3680, 3686]], "23": [[5080, 5082]], "24": [[4012, 4013], [4018, 4019]], "25": [[407, 409], [964, 966], [1363, 1365]], "26": [[4655, 4656]], "27": [[2710, 2713], [4502, 4504], [4535, 4536]], "28": [[1759, 1761], [1904, 1906]], "29": [[738, 740], [752, 754]], "3": [[2997, 2999], [3197, 3199], [3415, 3417]], "30": [[576, 578], [594, 596], [1533, 1535], [1814, 1816]], "31": [[1311, 1312], [1983, 1984], [4137, 4138], [4169, 4170], [5316, 5317], [93, 94], [465, 466], [521, 522], [670, 671], [1345, 1346], [1461, 1462], [3495, 3496], [3503, 3504], [3614, 3615], [3656, 3657], [3822, 3823], [3831, 3832], [3853, 3854], [4210, 4211], [4417, 4418], [5032, 5033], [5057, 5058]], "32": [[4906, 4910]], "33": [[1642, 1645], [1864, 1867], [3899, 3902], [4661, 4664]], "34": [[2374, 2376], [3994, 3996], [4345, 4347]], "35": [[4993, 4995]], "36": [[5291, 5294]], "37": [[108, 111], [536, 539], [1470, 1473]], "38": [[540, 541], [544, 545], [982, 983], [1474, 1475], [3896, 3897], [5322, 5323], [1168, 1169], [1383, 1384], [1397, 1398], [1422, 1423], [1442, 1443], [1498, 1499], [1622, 1623], [1648, 1649], [4197, 4198], [4395, 4396], [4734, 4735]], "39": [[602, 604], [2242, 2243]], "4": [[3950, 3952], [4289, 4290]], "40": [[744, 748], [4886, 4888]], "41": [[1776, 1778], [1908, 1910]], "42": [[1349, 1350], [3886, 3887]], "43": [[1209, 1210], [4652, 4654]], "44": [[3986, 3989]], "45": [[2678, 2680]], "46": [[3515, 3517]], "47": [[4464, 4466]], "48": [[4258, 4264]], "49": [[3703, 3704], [3719, 3720]], "5": [[558, 561], [589, 592], [1510, 1513], [1722, 1725], [4032, 4035]], "50": [[5347, 5348]], "51": [[2936, 2940]], "52": [[3672, 3673]], "53": [[3971, 3976]], "54": [[3990, 3991]], "55": [[1654, 1656], [1731, 1733], [3696, 3698]], "56": [[1553, 1555], [1956, 1957]], "57": [[1966, 1970]], "58": [[1352, 1353]], "59": [[631, 634]], "6": [[9, 11], [79, 81], [154, 156], [425, 426], [445, 448], [503, 505], [902, 906], [1056, 1058], [1305, 1307], [3094, 3097], [3317, 3319], [3567, 3569], [4243, 4245], [4280, 4286], [4931, 4933], [5024, 5026], [5037, 5039], [5121, 5123], [5170, 5174], [5178, 5180], [5310, 5312]], "60": [[1406, 1408]], "61": [[3162, 3164]], "62": [[4958, 4961]], "63": [[1026, 1028]], "64": [[3700, 3702]], "65": [[687, 689]], "66": [[3978, 3981]], "67": [[2888, 2891]], "68": [[484, 487]], "69": [[224, 227]], "7": [[1536, 1539], [1835, 1839]], "70": [[3781, 3783]], "71": [[4090, 4091]], "72": [[2, 8]], "73": [[2235, 2238]], "74": [[2252, 2254]], "75": [[4776, 4778]], "76": [[3982, 3983]], "77": [[3480, 3481]], "78": [[3518, 3519]], "79": [[609, 611], [1607, 1609]], "8": [[5026, 5028], [5114, 5115]], "80": [[1192, 1196]], "81": [[1682, 1683]], "82": [[230, 232]], "83": [[3418, 3421]], "84": [[3689, 3691]], "85": [[2220, 2222]], "86": [[1152, 1156]], "87": [[1347, 1348]], "88": [[2304, 2306]], "89": [[455, 459]], "9": [[4015, 4016], [4020, 4021], [4380, 4383], [5042, 5045]], "90": [[1252, 1256]], "91": [[1374, 1376]], "92": [[1871, 1875]], "93": [[1261, 1263]], "94": [[3474, 3479]], "95": [[1859, 1860]], "96": [[1435, 1440]], "97": [[3605, 3607]], "98": [[4003, 4005]], "99": [[616, 617], [620, 621], [5068, 5069]]}, "doc_id": "0c769c19d894e0dbd6eb314781dc1db3c626df57", "method_subrelations": {"OIM": [[[0, 3], "OIM"]]}, "n_ary_relations": [{"Material": "DukeMTMC-reID", "Method": "OIM", "Metric": "MAP", "Task": "Person_Re-Identification", "score": "47.4"}, {"Material": "DukeMTMC-reID", "Method": "OIM", "Metric": "Rank-1", "Task": "Person_Re-Identification", "score": "68.1"}], "ner": [[2, 8, "Task"], [9, 11, "Task"], [75, 78, "Method"], [79, 81, "Task"], [95, 99, "Task"], [108, 111, "Method"], [113, 116, "Method"], [117, 118, "Method"], [154, 156, "Task"], [192, 194, "Method"], [198, 202, "Task"], [203, 207, "Task"], [224, 227, "Task"], [230, 232, "Task"], [233, 238, "Task"], [240, 243, "Task"], [290, 295, "Task"], [407, 409, "Method"], [425, 426, "Task"], [445, 448, "Task"], [455, 459, "Method"], [484, 487, "Method"], [499, 502, "Method"], [503, 505, "Task"], [523, 527, "Task"], [536, 539, "Method"], [540, 541, "Method"], [544, 545, "Method"], [558, 561, "Method"], [576, 578, "Method"], [589, 592, "Method"], [594, 596, "Method"], [602, 604, "Task"], [609, 611, "Method"], [616, 617, "Metric"], [620, 621, "Metric"], [631, 634, "Method"], [687, 689, "Method"], [691, 697, "Task"], [738, 740, "Method"], [744, 748, "Metric"], [752, 754, "Method"], [796, 799, "Method"], [816, 819, "Method"], [820, 821, "Method"], [902, 906, "Task"], [921, 923, "Method"], [943, 946, "Method"], [964, 966, "Method"], [982, 983, "Method"], [1026, 1028, "Metric"], [1056, 1058, "Task"], [1112, 1116, "Task"], [1140, 1143, "Metric"], [1152, 1156, "Method"], [1171, 1176, "Task"], [1192, 1196, "Method"], [1209, 1210, "Method"], [1252, 1256, "Method"], [1261, 1263, "Method"], [1270, 1275, "Task"], [1305, 1307, "Task"], [1311, 1312, "Task"], [1313, 1318, "Task"], [1335, 1338, "Method"], [1347, 1348, "Method"], [1349, 1350, "Method"], [1352, 1353, "Method"], [1363, 1365, "Method"], [1374, 1376, "Method"], [1406, 1408, "Method"], [1435, 1440, "Method"], [1453, 1456, "Method"], [1463, 1467, "Task"], [1470, 1473, "Method"], [1474, 1475, "Method"], [1510, 1513, "Method"], [1533, 1535, "Method"], [1536, 1539, "Method"], [1553, 1555, "Task"], [1578, 1581, "Method"], [1582, 1583, "Method"], [1595, 1597, "Task"], [1602, 1604, "Method"], [1607, 1609, "Method"], [1611, 1615, "Task"], [1642, 1645, "Method"], [1654, 1656, "Method"], [1682, 1683, "Method"], [1722, 1725, "Method"], [1731, 1733, "Method"], [1759, 1761, "Method"], [1776, 1778, "Method"], [1814, 1816, "Method"], [1835, 1839, "Method"], [1859, 1860, "Method"], [1864, 1867, "Method"], [1871, 1875, "Method"], [1904, 1906, "Method"], [1908, 1910, "Method"], [1956, 1957, "Task"], [1966, 1970, "Method"], [1980, 1982, "Method"], [1983, 1984, "Task"], [1993, 1998, "Task"], [2144, 2146, "Method"], [2220, 2222, "Method"], [2235, 2238, "Method"], [2239, 2241, "Method"], [2242, 2243, "Task"], [2252, 2254, "Method"], [2304, 2306, "Method"], [2374, 2376, "Method"], [2496, 2498, "Method"], [2525, 2526, "Method"], [2604, 2606, "Method"], [2678, 2680, "Method"], [2691, 2693, "Method"], [2710, 2713, "Method"], [2748, 2750, "Method"], [2793, 2795, "Method"], [2801, 2805, "Method"], [2888, 2891, "Metric"], [2936, 2940, "Method"], [2997, 2999, "Metric"], [3094, 3097, "Task"], [3136, 3137, "Task"], [3162, 3164, "Task"], [3197, 3199, "Metric"], [3317, 3319, "Task"], [3368, 3374, "Task"], [3415, 3417, "Metric"], [3418, 3421, "Metric"], [3422, 3426, "Metric"], [3428, 3431, "Metric"], [3432, 3433, "Metric"], [3442, 3448, "Task"], [3451, 3452, "Task"], [3474, 3479, "Metric"], [3480, 3481, "Metric"], [3515, 3517, "Metric"], [3518, 3519, "Metric"], [3528, 3532, "Metric"], [3567, 3569, "Task"], [3605, 3607, "Method"], [3616, 3620, "Task"], [3659, 3661, "Metric"], [3672, 3673, "Method"], [3674, 3679, "Method"], [3680, 3686, "Method"], [3689, 3691, "Task"], [3696, 3698, "Method"], [3700, 3702, "Method"], [3703, 3704, "Method"], [3781, 3783, "Metric"], [3824, 3828, "Task"], [3859, 3868, "Method"], [3886, 3887, "Method"], [3892, 3895, "Method"], [3896, 3897, "Method"], [3899, 3902, "Method"], [3912, 3914, "Task"], [3916, 3920, "Metric"], [3950, 3952, "Method"], [3954, 3958, "Task"], [3971, 3976, "Method"], [3978, 3981, "Method"], [3982, 3983, "Method"], [3986, 3989, "Method"], [3990, 3991, "Method"], [3994, 3996, "Method"], [4003, 4005, "Metric"], [4012, 4013, "Method"], [4015, 4016, "Method"], [4018, 4019, "Method"], [4020, 4021, "Method"], [4032, 4035, "Method"], [4064, 4065, "Method"], [4090, 4091, "Task"], [4137, 4138, "Task"], [4139, 4142, "Task"], [4147, 4150, "Method"], [4169, 4170, "Task"], [4171, 4175, "Task"], [4243, 4245, "Task"], [4258, 4264, "Method"], [4273, 4278, "Task"], [4280, 4286, "Task"], [4289, 4290, "Method"], [4300, 4305, "Task"], [4316, 4321, "Task"], [4345, 4347, "Method"], [4378, 4379, "Method"], [4380, 4383, "Method"], [4398, 4399, "Method"], [4404, 4411, "Method"], [4436, 4438, "Method"], [4443, 4446, "Method"], [4453, 4456, "Method"], [4457, 4458, "Method"], [4464, 4466, "Method"], [4475, 4478, "Metric"], [4480, 4484, "Metric"], [4499, 4501, "Method"], [4502, 4504, "Method"], [4507, 4508, "Metric"], [4535, 4536, "Method"], [4538, 4540, "Metric"], [4547, 4548, "Metric"], [4564, 4566, "Metric"], [4652, 4654, "Method"], [4655, 4656, "Method"], [4661, 4664, "Method"], [4694, 4695, "Material"], [4704, 4709, "Metric"], [4776, 4778, "Metric"], [4851, 4852, "Metric"], [4874, 4876, "Metric"], [4886, 4888, "Metric"], [4906, 4910, "Metric"], [4911, 4915, "Method"], [4931, 4933, "Task"], [4958, 4961, "Method"], [4964, 4966, "Metric"], [4993, 4995, "Task"], [5024, 5026, "Task"], [5026, 5028, "Metric"], [5037, 5039, "Task"], [5042, 5045, "Method"], [5047, 5052, "Task"], [5068, 5069, "Metric"], [5080, 5082, "Metric"], [5094, 5097, "Metric"], [5114, 5115, "Metric"], [5121, 5123, "Task"], [5127, 5132, "Task"], [5152, 5157, "Task"], [5170, 5174, "Task"], [5175, 5177, "Metric"], [5178, 5180, "Task"], [5291, 5294, "Task"], [5306, 5309, "Method"], [5310, 5312, "Task"], [5316, 5317, "Task"], [5318, 5319, "Task"], [5322, 5323, "Method"], [5339, 5343, "Method"], [5347, 5348, "Metric"], [12, 16, "Task"], [93, 94, "Task"], [181, 182, "Method"], [379, 383, "Task"], [465, 466, "Task"], [521, 522, "Task"], [670, 671, "Task"], [912, 913, "Method"], [968, 972, "Task"], [996, 999, "Method"], [1118, 1122, "Task"], [1168, 1169, "Method"], [1345, 1346, "Task"], [1383, 1384, "Method"], [1397, 1398, "Method"], [1422, 1423, "Method"], [1442, 1443, "Method"], [1461, 1462, "Task"], [1498, 1499, "Method"], [1622, 1623, "Method"], [1631, 1632, "Method"], [1648, 1649, "Method"], [1973, 1974, "Method"], [2009, 2012, "Method"], [2551, 2552, "Method"], [2741, 2742, "Method"], [2757, 2758, "Method"], [3495, 3496, "Task"], [3503, 3504, "Task"], [3614, 3615, "Task"], [3636, 3639, "Method"], [3640, 3641, "Method"], [3656, 3657, "Task"], [3719, 3720, "Method"], [3822, 3823, "Task"], [3831, 3832, "Task"], [3835, 3839, "Task"], [3853, 3854, "Task"], [3963, 3967, "Task"], [4058, 4062, "Task"], [4077, 4081, "Task"], [4197, 4198, "Method"], [4210, 4211, "Task"], [4226, 4227, "Method"], [4249, 4253, "Task"], [4333, 4337, "Task"], [4395, 4396, "Method"], [4417, 4418, "Task"], [4558, 4559, "Method"], [4582, 4583, "Method"], [4637, 4638, "Method"], [4642, 4646, "Task"], [4674, 4675, "Method"], [4683, 4687, "Task"], [4723, 4724, "Method"], [4734, 4735, "Method"], [4780, 4781, "Method"], [5032, 5033, "Task"], [5057, 5058, "Task"], [5325, 5328, "Method"]], "sections": [[0, 195], [195, 1108], [1108, 1446], [1446, 1635], [1635, 2007], [2007, 2899], [2899, 3002], [3002, 3195], [3195, 3549], [3549, 3662], [3662, 4133], [4133, 4439], [4439, 5020], [5020, 5295], [5295, 5460], [5460, 5463]], "sentences": [[0, 11], [11, 31], [31, 66], [66, 82], [82, 112], [112, 138], [138, 157], [157, 168], [168, 195], [195, 198], [198, 221], [221, 244], [244, 279], [279, 288], [288, 319], [319, 367], [367, 389], [389, 402], [402, 429], [429, 442], [442, 471], [471, 491], [491, 506], [506, 543], [543, 588], [588, 605], [605, 635], [635, 655], [655, 690], [690, 706], [706, 737], [737, 761], [761, 785], [785, 808], [808, 830], [830, 857], [857, 881], [881, 895], [895, 907], [907, 927], [927, 937], [937, 959], [959, 991], [991, 1022], [1022, 1042], [1042, 1069], [1069, 1081], [1081, 1096], [1096, 1108], [1108, 1112], [1112, 1117], [1117, 1144], [1144, 1163], [1163, 1177], [1177, 1201], [1201, 1227], [1227, 1245], [1245, 1264], [1264, 1291], [1291, 1308], [1308, 1344], [1344, 1347], [1347, 1366], [1366, 1380], [1380, 1393], [1393, 1413], [1413, 1432], [1432, 1446], [1446, 1449], [1449, 1485], [1485, 1509], [1509, 1552], [1552, 1571], [1571, 1616], [1616, 1635], [1635, 1639], [1639, 1651], [1651, 1680], [1680, 1690], [1690, 1712], [1712, 1730], [1730, 1744], [1744, 1783], [1783, 1801], [1801, 1831], [1831, 1852], [1852, 1883], [1883, 1920], [1920, 1958], [1958, 1977], [1977, 2007], [2007, 2013], [2013, 2031], [2031, 2075], [2075, 2096], [2096, 2105], [2105, 2128], [2128, 2141], [2141, 2163], [2163, 2197], [2197, 2213], [2213, 2244], [2244, 2256], [2256, 2302], [2302, 2324], [2324, 2361], [2361, 2377], [2377, 2391], [2391, 2412], [2412, 2442], [2442, 2472], [2472, 2507], [2507, 2589], [2589, 2594], [2594, 2619], [2619, 2625], [2625, 2665], [2665, 2690], [2690, 2717], [2717, 2739], [2739, 2764], [2764, 2781], [2781, 2796], [2796, 2813], [2813, 2832], [2832, 2834], [2834, 2863], [2863, 2899], [2899, 2902], [2902, 2920], [2920, 2930], [2930, 2949], [2949, 2978], [2978, 3002], [3002, 3005], [3005, 3040], [3040, 3054], [3054, 3074], [3074, 3113], [3113, 3138], [3138, 3165], [3165, 3181], [3181, 3195], [3195, 3201], [3201, 3223], [3223, 3235], [3235, 3246], [3246, 3275], [3275, 3293], [3293, 3308], [3308, 3334], [3334, 3362], [3362, 3410], [3410, 3417], [3417, 3435], [3435, 3487], [3487, 3498], [3498, 3514], [3514, 3549], [3549, 3552], [3552, 3582], [3582, 3601], [3601, 3626], [3626, 3644], [3644, 3662], [3662, 3666], [3666, 3680], [3680, 3692], [3692, 3728], [3728, 3734], [3734, 3740], [3740, 3742], [3742, 3761], [3761, 3770], [3770, 3780], [3780, 3804], [3804, 3829], [3829, 3851], [3851, 3883], [3883, 3915], [3915, 3934], [3934, 3953], [3953, 3993], [3993, 4027], [4027, 4067], [4067, 4084], [4084, 4116], [4116, 4133], [4133, 4142], [4142, 4176], [4176, 4186], [4186, 4195], [4195, 4229], [4229, 4255], [4255, 4287], [4287, 4306], [4306, 4328], [4328, 4372], [4372, 4412], [4412, 4423], [4423, 4439], [4439, 4446], [4446, 4474], [4474, 4492], [4492, 4513], [4513, 4532], [4532, 4552], [4552, 4578], [4578, 4596], [4596, 4631], [4631, 4648], [4648, 4661], [4661, 4696], [4696, 4723], [4723, 4738], [4738, 4750], [4750, 4762], [4762, 4768], [4768, 4791], [4791, 4803], [4803, 4809], [4809, 4811], [4811, 4830], [4830, 4849], [4849, 4861], [4861, 4889], [4889, 4911], [4911, 4916], [4916, 4935], [4935, 4945], [4945, 4974], [4974, 4996], [4996, 5020], [5020, 5026], [5026, 5029], [5029, 5060], [5060, 5077], [5077, 5092], [5092, 5108], [5108, 5141], [5141, 5175], [5175, 5178], [5178, 5190], [5190, 5216], [5216, 5227], [5227, 5246], [5246, 5257], [5257, 5295], [5295, 5298], [5298, 5313], [5313, 5324], [5324, 5338], [5338, 5357], [5357, 5359], [5359, 5460], [5460, 5463]], "words": ["document", ":", "Joint", "Detection", "and", "Identification", "Feature", "Learning", "for", "Person", "Search", "Existing", "person", "re", "-", "identification", "benchmarks", "and", "methods", "mainly", "focus", "on", "matching", "cropped", "pedestrian", "images", "between", "queries", "and", "candidates", ".", "However", ",", "it", "is", "different", "from", "real", "-", "world", "scenarios", "where", "the", "annotations", "of", "pedestrian", "bounding", "boxes", "are", "unavailable", "and", "the", "target", "person", "needs", "to", "be", "searched", "from", "a", "gallery", "of", "whole", "scene", "images", ".", "To", "close", "the", "gap", ",", "we", "propose", "a", "new", "deep", "learning", "framework", "for", "person", "search", ".", "Instead", "of", "breaking", "it", "down", "into", "two", "separate", "tasks", "\u2014", "pedestrian", "detection", "and", "person", "re", "-", "identification", ",", "we", "jointly", "handle", "both", "aspects", "in", "a", "single", "convolutional", "neural", "network", ".", "An", "Online", "Instance", "Matching", "(", "OIM", ")", "loss", "function", "is", "proposed", "to", "train", "the", "network", "effectively", ",", "which", "is", "scalable", "to", "datasets", "with", "numerous", "identities", ".", "To", "validate", "our", "approach", ",", "we", "collect", "and", "annotate", "a", "large", "-", "scale", "benchmark", "dataset", "for", "person", "search", ".", "It", "contains", "images", ",", "identities", ",", "and", "pedestrian", "bounding", "boxes", ".", "Experiments", "show", "that", "our", "framework", "outperforms", "other", "separate", "approaches", ",", "and", "the", "proposed", "OIM", "loss", "function", "converges", "much", "faster", "and", "better", "than", "the", "conventional", "Softmax", "loss", ".", "section", ":", "Introduction", "Person", "re", "-", "identification", "(", "re", "-", "i", "d", ")", "aims", "at", "matching", "a", "target", "person", "with", "a", "gallery", "of", "pedestrian", "images", ".", "It", "has", "many", "video", "surveillance", "applications", ",", "such", "as", "finding", "criminals", ",", "cross", "-", "camera", "person", "tracking", ",", "and", "person", "activity", "analysis", ".", "The", "problem", "is", "challenging", "because", "of", "complex", "variations", "of", "human", "poses", ",", "camera", "viewpoints", ",", "lighting", ",", "occlusion", ",", "resolution", ",", "background", "clutter", ",", ",", "and", "thus", "draws", "much", "research", "attention", "in", "recent", "years", ".", "[", "b", "]", "[", "1em", "]", "[", "b", "]", "Although", "numerous", "person", "re", "-", "i", "d", "datasets", "and", "methods", "have", "been", "proposed", ",", "there", "is", "still", "a", "big", "gap", "between", "the", "problem", "setting", "itself", "and", "real", "-", "world", "applications", ".", "In", "most", "benchmarks", ",", "the", "gallery", "only", "contains", "manually", "cropped", "pedestrian", "images", "(", "Figure", "[", "reference", "]", ")", ",", "while", "in", "real", "applications", ",", "the", "goal", "is", "to", "find", "a", "target", "person", "in", "a", "gallery", "of", "whole", "scene", "images", ",", "as", "shown", "in", "Figure", "[", "reference", "]", ".", "Following", "the", "protocols", "of", "these", "benchmarks", ",", "most", "of", "the", "existing", "person", "re", "-", "i", "d", "methods", "assume", "perfect", "pedestrian", "detections", ".", "However", ",", "these", "manually", "cropped", "bounding", "boxes", "are", "unavailable", "in", "practical", "applications", ".", "Off", "-", "the", "-", "shelf", "pedestrian", "detectors", "would", "inevitably", "produce", "false", "alarms", ",", "misdetections", ",", "and", "misalignments", ",", "which", "could", "harm", "the", "final", "searching", "performance", "significantly", ".", "In", "2014", ",", "Xu", "made", "the", "first", "step", "towards", "closing", "this", "gap", ".", "They", "introduced", "the", "person", "search", "problem", "to", "the", "community", ",", "and", "proposed", "a", "sliding", "window", "searching", "strategy", "based", "on", "a", "combination", "of", "pedestrian", "detection", "and", "person", "matching", "scores", ".", "However", ",", "the", "performance", "is", "limited", "by", "the", "handcrafted", "features", ",", "and", "the", "sliding", "window", "framework", "is", "not", "scalable", ".", "In", "this", "paper", ",", "we", "propose", "a", "new", "deep", "learning", "framework", "for", "person", "search", ".", "Different", "from", "conventional", "approaches", "that", "break", "down", "the", "problem", "into", "two", "separate", "tasks", "\u2014", "pedestrian", "detection", "and", "person", "re", "-", "identification", ",", "we", "jointly", "handle", "both", "aspects", "in", "a", "single", "Convolutional", "Neural", "Network", "(", "CNN", ")", ".", "Our", "CNN", "consists", "of", "two", "parts", ",", "given", "a", "whole", "input", "gallery", "image", ",", "a", "pedestrian", "proposal", "net", "is", "used", "to", "produce", "bounding", "boxes", "of", "candidate", "people", ",", "which", "are", "fed", "into", "an", "identification", "net", "to", "extract", "features", "for", "comparing", "with", "the", "target", "person", ".", "The", "pedestrian", "proposal", "net", "and", "the", "identification", "net", "adapt", "with", "each", "other", "during", "the", "joint", "optimization", ".", "For", "example", ",", "the", "proposal", "net", "can", "focus", "more", "on", "the", "recall", "rather", "than", "the", "precision", ",", "as", "false", "alarms", "could", "be", "eliminated", "through", "the", "latter", "features", "matching", "process", ".", "Meanwhile", ",", "misalignments", "of", "proposals", "are", "also", "acceptable", ",", "as", "they", "can", "be", "further", "adjusted", "by", "the", "identification", "net", ".", "To", "improve", "the", "scalability", "of", "the", "whole", "system", ",", "inspired", "by", "recent", "advances", "in", "object", "detection", ",", "we", "encourage", "both", "parts", "to", "share", "underlying", "convolutional", "feature", "maps", ",", "which", "significantly", "accelerates", "the", "inference", "procedure", ".", "Traditional", "re", "-", "i", "d", "feature", "learning", "mainly", "employs", "pairwise", "or", "triplet", "distance", "loss", "functions", ".", "However", ",", "they", "are", "not", "efficient", "as", "only", "several", "data", "samples", "are", "compared", "at", "each", "time", ",", "and", "there", "are", "potential", "input", "combinations", ",", "where", "is", "the", "number", "of", "images", ".", "Different", "sampling", "strategies", "could", "significantly", "impact", "the", "convergence", "rate", "and", "quality", ",", "but", "finding", "efficient", "sampling", "strategies", "becomes", "much", "more", "difficult", "as", "increases", ".", "Another", "approach", "is", "learning", "to", "classify", "identities", "with", "the", "Softmax", "loss", "function", ",", "which", "effectively", "compares", "all", "the", "samples", "at", "the", "same", "time", ".", "But", "as", "the", "number", "of", "classes", "increases", ",", "training", "the", "big", "Softmax", "classifier", "matrix", "becomes", "much", "slower", "or", "even", "can", "not", "converge", ".", "In", "this", "paper", ",", "we", "propose", "a", "novel", "Online", "Instance", "Matching", "(", "OIM", ")", "loss", "function", "to", "cope", "with", "the", "problems", ".", "We", "maintain", "a", "lookup", "table", "of", "features", "from", "all", "the", "labeled", "identities", ",", "and", "compare", "distances", "between", "mini", "-", "batch", "samples", "and", "all", "the", "registered", "entries", ".", "On", "the", "other", "hand", ",", "many", "unlabeled", "identities", "could", "appear", "in", "scene", "images", ",", "which", "can", "be", "served", "as", "negatives", "for", "labeled", "identities", ".", "We", "thus", "exploit", "a", "circular", "queue", "to", "store", "their", "features", "also", "for", "comparison", ".", "This", "is", "another", "advantage", "brought", "by", "the", "person", "search", "problem", "setting", ".", "The", "proposed", "parameter", "-", "free", "OIM", "loss", "converges", "much", "faster", "and", "better", "than", "the", "Softmax", "loss", "in", "our", "experiments", ".", "The", "contribution", "of", "our", "work", "is", "three", "-", "fold", ".", "First", ",", "we", "propose", "a", "new", "deep", "learning", "framework", "to", "search", "a", "target", "person", "from", "a", "gallery", "of", "whole", "scene", "images", ".", "Instead", "of", "simply", "combining", "the", "pedestrian", "detectors", "and", "person", "re", "-", "i", "d", "methods", ",", "we", "jointly", "optimize", "both", "objectives", "in", "a", "single", "CNN", "and", "they", "better", "adapt", "with", "each", "other", ".", "Second", ",", "we", "propose", "an", "Online", "Instance", "Matching", "loss", "function", "to", "learn", "identification", "features", "more", "effectively", ",", "which", "enables", "our", "framework", "to", "be", "scalable", "to", "large", "datasets", "with", "numerous", "identities", ".", "Together", "with", "the", "fast", "inference", "speed", ",", "our", "framework", "is", "much", "closer", "to", "the", "real", "-", "world", "application", "requirements", ".", "At", "last", ",", "we", "collect", "and", "annotate", "a", "large", "-", "scale", "benchmark", "dataset", "for", "person", "search", ",", "covering", "hundreds", "of", "scenes", "from", "street", "and", "movie", "snapshots", ".", "The", "dataset", "contains", "images", ",", "identities", ",", "and", "pedestrian", "bounding", "boxes", ".", "We", "validate", "the", "effectiveness", "of", "our", "approach", "comparing", "against", "other", "baselines", "on", "this", "dataset", ".", "The", "dataset", "and", "code", "are", "made", "public", "to", "facilitate", "further", "research", ".", "section", ":", "Related", "Work", "Person", "re", "-", "identification", ".", "Early", "person", "re", "-", "identification", "methods", "addressed", "the", "problem", "by", "manually", "designing", "discriminative", "features", ",", "learning", "feature", "transforms", "across", "camera", "views", ",", "and", "learning", "distance", "metrics", ".", "Recent", "years", ",", "many", "researchers", "have", "proposed", "various", "deep", "learning", "based", "methods", "that", "jointly", "handle", "all", "these", "aspects", ".", "Li", "and", "Ahmed", "designed", "specific", "CNN", "models", "for", "person", "re", "-", "i", "d", ".", "Both", "the", "networks", "utilize", "as", "input", "a", "pair", "of", "cropped", "pedestrian", "images", "and", "employ", "a", "binary", "verification", "loss", "function", "to", "train", "the", "parameters", ".", "Ding", "and", "Cheng", "exploited", "triplet", "samples", "for", "training", "CNNs", "to", "minimize", "the", "feature", "distance", "between", "the", "same", "person", "and", "maximize", "the", "distance", "between", "different", "people", ".", "Apart", "from", "using", "pairwise", "or", "triplet", "loss", "functions", ",", "Xiao", "proposed", "to", "learn", "features", "by", "classifying", "identities", ".", "Multiple", "datasets", "are", "combined", "together", "and", "a", "domain", "guided", "dropout", "technique", "is", "proposed", "to", "improve", "the", "feature", "learning", ".", "Several", "recent", "works", "addressed", "on", "solving", "person", "re", "-", "i", "d", "on", "abnormal", "images", ",", "such", "as", "low", "-", "resolution", "images", ",", "or", "partially", "occluded", "images", ".", "Concurrent", "with", "our", "prior", "arXiv", "submission", ",", "Zheng", "also", "contributed", "a", "benchmark", "dataset", "for", "person", "search", ".", "They", "exploited", "separate", "detection", "and", "re", "-", "i", "d", "methods", "with", "scores", "re", "-", "weighting", "to", "solve", "the", "problem", ",", "while", "in", "this", "work", "we", "propose", "a", "deep", "learning", "framework", "that", "jointly", "handles", "both", "aspects", ".", "Pedestrian", "detection", ".", "DPM", ",", "ACF", ",", "and", "Checkerboards", "are", "the", "most", "commonly", "used", "off", "-", "the", "-", "shelf", "pedestrian", "detectors", ".", "They", "rely", "on", "hand", "-", "crafted", "features", "and", "linear", "classifiers", "to", "detect", "pedestrians", ".", "Recent", "years", ",", "CNN", "-", "based", "pedestrian", "detectors", "have", "also", "been", "developed", ".", "Various", "factors", ",", "including", "CNN", "model", "structures", ",", "training", "data", ",", "and", "different", "training", "strategies", "are", "studied", "empirically", "in", ".", "Tian", "exploited", "pedestrian", "and", "scene", "attribute", "labels", "to", "train", "CNN", "pedestrian", "detectors", "in", "a", "multi", "-", "task", "manner", ".", "Cai", "proposed", "a", "complexity", "-", "aware", "boosting", "algorithm", "for", "learning", "CNN", "detector", "cascades", ".", "section", ":", "Method", "We", "propose", "a", "new", "deep", "learning", "framework", "that", "jointly", "handles", "the", "pedestrian", "detection", "and", "person", "re", "-", "identification", "in", "a", "single", "convolutional", "neural", "network", "(", "CNN", ")", ",", "as", "shown", "in", "Figure", "[", "reference", "]", ".", "Given", "as", "input", "a", "whole", "scene", "image", ",", "we", "first", "use", "a", "stem", "CNN", "to", "transform", "from", "raw", "pixels", "to", "convolutional", "feature", "maps", ".", "A", "pedestrian", "proposal", "net", "is", "built", "upon", "these", "feature", "maps", "to", "predict", "bounding", "boxes", "of", "candidate", "people", ",", "which", "are", "then", "fed", "into", "an", "identification", "net", "with", "RoI", "-", "Pooling", "to", "extract", "L2", "-", "normalized", "-", "d", "features", "for", "each", "of", "them", ".", "At", "inference", "stage", ",", "we", "rank", "the", "gallery", "people", "according", "to", "their", "feature", "distances", "to", "the", "target", "person", ".", "At", "training", "stage", ",", "we", "propose", "an", "Online", "Instance", "Matching", "(", "OIM", ")", "loss", "function", "on", "top", "of", "the", "feature", "vectors", "to", "supervise", "the", "identification", "net", ",", "together", "with", "several", "other", "loss", "functions", "for", "training", "the", "proposal", "net", "in", "a", "multi", "-", "task", "manner", ".", "Below", "we", "will", "first", "detail", "the", "CNN", "model", "structure", ",", "and", "then", "elaborate", "on", "the", "OIM", "loss", "function", ".", "subsection", ":", "Model", "Structure", "We", "adopt", "the", "ResNet", "-", "50", "as", "our", "base", "CNN", "model", ".", "It", "has", "a", "convolution", "layer", "in", "front", "(", "named", "conv1", ")", ",", "followed", "by", "four", "blocks", "(", "named", "conv2_x", "to", "conv5_x", ")", "each", "containing", "residual", "units", ",", "respectively", ".", "We", "exploit", "conv1", "to", "conv4_3", "as", "the", "stem", "part", ".", "Given", "an", "input", "image", ",", "the", "stem", "will", "produce", "channels", "of", "features", "maps", ",", "which", "have", "resolutions", "of", "the", "original", "image", ".", "On", "top", "of", "these", "feature", "maps", ",", "we", "build", "a", "pedestrian", "proposal", "network", "to", "detect", "person", "candidates", ".", "A", "convolutional", "layer", "is", "first", "added", "to", "transform", "the", "features", "specifically", "for", "pedestrians", ".", "Then", "we", "follow", "to", "associate", "anchors", "at", "each", "feature", "map", "location", ",", "and", "use", "a", "Softmax", "classifier", "to", "predict", "whether", "each", "anchor", "is", "a", "pedestrian", "or", "not", ",", "as", "well", "as", "a", "linear", "regression", "to", "adjust", "their", "locations", ".", "We", "will", "keep", "the", "top", "adjusted", "bounding", "boxes", "after", "non", "-", "maximum", "suppression", "as", "our", "final", "proposals", ".", "To", "find", "the", "target", "person", "among", "all", "these", "proposals", ",", "we", "build", "an", "identification", "net", "to", "extract", "the", "features", "of", "each", "proposal", ",", "and", "compare", "against", "the", "target", "ones", ".", "We", "first", "exploit", "an", "RoI", "-", "Pooling", "layer", "to", "pool", "a", "region", "from", "the", "stem", "feature", "maps", "for", "each", "proposal", ".", "Then", "they", "are", "passed", "through", "the", "rest", "conv4_4", "to", "conv5_3", "of", "the", "ResNet", "-", "50", ",", "followed", "by", "a", "global", "average", "pooling", "layer", "to", "summarize", "into", "a", "dimensional", "feature", "vector", ".", "On", "one", "hand", ",", "as", "the", "pedestrian", "proposals", "would", "inevitably", "contain", "some", "false", "alarms", "and", "misalignments", ",", "we", "use", "again", "a", "Softmax", "classifier", "and", "a", "linear", "regression", "to", "reject", "non", "-", "persons", "and", "refine", "the", "locations", ".", "On", "the", "other", "hand", ",", "we", "project", "the", "features", "into", "a", "L2", "-", "normalized", "dimensional", "subspace", "(", "i", "d", "-", "feat", ")", ",", "and", "use", "them", "to", "compute", "cosine", "similarities", "with", "the", "target", "person", "when", "doing", "inference", ".", "During", "the", "training", "stage", ",", "we", "supervise", "the", "i", "d", "-", "feat", "with", "the", "proposed", "OIM", "loss", "function", ".", "Together", "with", "other", "loss", "functions", "for", "detection", ",", "the", "whole", "net", "is", "jointly", "trained", "in", "a", "multi", "-", "task", "learning", "manner", ",", "rather", "than", "using", "the", "alternative", "optimizations", "in", ".", "subsection", ":", "Online", "Instance", "Matching", "Loss", "There", "are", "three", "different", "types", "of", "proposals", ",", "labeled", "identities", ",", "unlabeled", "identities", ",", "and", "background", "clutter", ".", "Suppose", "there", "are", "different", "target", "people", "in", "the", "training", "set", ",", "when", "a", "proposal", "matches", "a", "target", "person", ",", "we", "call", "it", "an", "instance", "of", "the", "labeled", "identity", ",", "and", "assign", "a", "class", "-", "i", "d", "(", "from", "to", ")", "to", "it", "accordingly", ".", "There", "are", "also", "lots", "of", "proposals", "predicting", "pedestrians", "correctly", ",", "but", "do", "not", "belong", "to", "anyone", "of", "our", "target", "people", ".", "We", "call", "them", "unlabeled", "identities", "in", "such", "cases", ".", "We", "demonstrate", "some", "examples", "of", "labeled", "and", "unlabeled", "identities", "in", "Figure", "[", "reference", "]", "with", "blue", "and", "orange", "bounding", "boxes", ",", "respectively", ".", "Other", "proposals", "are", "just", "false", "alarms", "on", "other", "objects", "or", "background", "regions", ".", "In", "the", "proposed", "loss", "function", ",", "we", "only", "consider", "the", "labeled", "and", "unlabeled", "identities", ",", "while", "leave", "the", "other", "proposals", "untouched", ".", "As", "our", "goal", "is", "to", "distinguish", "different", "people", ",", "a", "natural", "objective", "is", "to", "minimize", "the", "features", "discrepancy", "among", "the", "instances", "of", "the", "same", "person", ",", "while", "maximize", "the", "discrepancy", "among", "different", "people", ".", "To", "fulfill", "this", "goal", ",", "we", "need", "to", "memorize", "the", "features", "of", "all", "the", "people", ".", "This", "could", "be", "done", "offline", "by", "doing", "network", "forward", "on", "all", "the", "training", "images", ",", "but", "it", "is", "not", "practical", "when", "using", "stochastic", "gradient", "descent", "(", "SGD", ")", "for", "optimization", ".", "Thus", "in", "our", "approach", ",", "we", "choose", "an", "online", "approximation", "instead", ".", "Denote", "the", "features", "of", "a", "labeled", "identity", "inside", "a", "mini", "-", "batch", "by", ",", "where", "is", "the", "feature", "dimension", ",", "we", "maintain", "a", "lookup", "table", "(", "LUT", ")", "to", "store", "the", "features", "of", "all", "the", "labeled", "identities", ",", "as", "demonstrated", "in", "Figure", "[", "reference", "]", ".", "During", "the", "forward", "propagation", ",", "we", "compute", "cosine", "similarities", "between", "the", "mini", "-", "batch", "sample", "and", "all", "the", "labeled", "identities", "by", ".", "During", "backward", ",", "if", "the", "target", "class", "-", "i", "d", "is", ",", "then", "we", "will", "update", "the", "-", "th", "column", "of", "the", "LUT", "by", ",", "where", ",", "and", "then", "scale", "to", "have", "unit", "L2", "-", "norm", ".", "Apart", "from", "labeled", "identities", ",", "many", "unlabeled", "identities", "are", "also", "valuable", "for", "learning", "feature", "representations", ".", "They", "can", "be", "safely", "used", "as", "negative", "classes", "for", "all", "the", "labeled", "identities", ".", "We", "use", "a", "circular", "queue", "to", "store", "the", "features", "of", "these", "unlabeled", "identities", "that", "appear", "in", "recent", "mini", "-", "batches", ".", "Denote", "the", "features", "in", "this", "circular", "queue", "by", ",", "where", "is", "the", "queue", "size", ",", "we", "can", "also", "compute", "their", "cosine", "similarities", "with", "the", "mini", "-", "batch", "sample", "by", ".", "After", "each", "iteration", ",", "we", "push", "the", "new", "feature", "vectors", "into", "the", "queue", ",", "while", "pop", "the", "out", "-", "of", "-", "date", "ones", "to", "keep", "the", "queue", "size", "unchanged", ".", "Based", "on", "these", "two", "data", "structures", ",", "we", "define", "the", "probability", "of", "being", "recognized", "as", "the", "identity", "with", "class", "-", "i", "d", "by", "a", "Softmax", "function", "where", "higher", "temperature", "leads", "to", "softer", "probability", "distribution", ".", "Similarly", ",", "the", "probability", "of", "being", "recognized", "as", "the", "-", "th", "unlabeled", "identity", "in", "the", "circular", "queue", "is", "OIM", "objective", "is", "to", "maximize", "the", "expected", "log", "-", "likelihood", "and", "its", "gradient", "with", "respect", "to", "can", "be", "derived", "as", "It", "can", "be", "seen", "that", "our", "OIM", "loss", "effectively", "compares", "the", "mini", "-", "batch", "sample", "with", "all", "the", "labeled", "and", "unlabeled", "identities", ",", "driving", "the", "underlying", "feature", "vector", "to", "be", "similar", "with", "the", "target", "one", ",", "while", "pushing", "it", "away", "from", "the", "others", ".", "Why", "not", "Softmax", "loss", "?", "A", "natural", "question", "here", "is", "that", "why", "not", "learning", "a", "classifier", "matrix", "with", "a", "conventional", "Softmax", "loss", "to", "predict", "the", "class", "-", "i", "d", ".", "There", "are", "mainly", "two", "drawbacks", ".", "First", ",", "large", "-", "scale", "person", "search", "datasets", "would", "have", "a", "large", "number", "of", "identities", "(", "more", "than", "in", "our", "training", "set", ")", ",", "while", "each", "identity", "only", "has", "several", "instances", "and", "each", "image", "only", "contains", "a", "few", "identities", ".", "We", "need", "to", "learn", "more", "than", "discriminant", "functions", "simultaneously", ",", "but", "during", "each", "SGD", "iteration", "we", "only", "have", "positive", "samples", "from", "tens", "of", "classes", ".", "The", "classifier", "matrix", "suffers", "from", "large", "variance", "of", "gradients", "and", "thus", "can", "not", "be", "learned", "effectively", ",", "even", "with", "proper", "pre", "-", "training", "and", "high", "momentum", ".", "Second", ",", "we", "can", "not", "exploit", "the", "unlabeled", "identities", "with", "Softmax", "loss", ",", "as", "they", "have", "no", "specific", "class", "-", "ids", ".", "Although", "our", "OIM", "loss", "formulation", "is", "similar", "to", "the", "Softmax", "one", ",", "the", "major", "difference", "is", "that", "the", "OIM", "loss", "is", "non", "-", "parametric", ".", "The", "LUT", "and", "circular", "queue", "are", "considered", "as", "external", "buffer", ",", "rather", "than", "the", "network", "parameters", ".", "The", "gradients", "directly", "operate", "on", "the", "features", "without", "the", "transformation", "by", "a", "classifier", "matrix", ".", "The", "potential", "drawback", "of", "this", "non", "-", "parametric", "loss", "is", "that", "it", "could", "overfit", "more", "easily", ".", "We", "find", "that", "projecting", "the", "features", "into", "a", "L2", "-", "normalized", "low", "-", "dimensional", "subspace", "helps", "reduce", "overfitting", ".", "Scalability", ".", "Computing", "the", "partition", "function", "in", "Eq", "(", "[", "reference", "]", ")", "and", "Eq", "(", "[", "reference", "]", ")", "could", "be", "time", "consuming", "when", "the", "number", "of", "identities", "increases", ".", "To", "overcome", "this", "problem", ",", "we", "can", "approximate", "the", "denominators", "by", "sub", "-", "sampling", "the", "labeled", "and", "unlabeled", "identities", ",", "which", "results", "in", "optimizing", "a", "lower", "-", "bound", "of", "Eq", "(", "[", "reference", "]", ")", ".", "section", ":", "Dataset", "We", "collect", "and", "annotate", "a", "large", "-", "scale", "person", "search", "dataset", "to", "evaluate", "of", "our", "proposed", "method", ".", "We", "exploit", "two", "data", "sources", "to", "diversify", "the", "scenes", ".", "On", "one", "hand", ",", "we", "use", "hand", "-", "held", "cameras", "to", "shoot", "street", "snaps", "around", "an", "urban", "city", ".", "On", "the", "other", "hand", ",", "we", "collect", "from", "movie", "snapshots", "that", "contain", "pedestrians", ",", "as", "they", "could", "enrich", "the", "variations", "of", "viewpoints", ",", "lighting", ",", "and", "background", "conditions", ".", "In", "this", "section", ",", "we", "will", "show", "the", "basic", "statistics", "of", "our", "dataset", ",", "as", "well", "as", "define", "the", "evaluation", "protocols", "and", "metrics", ".", "subsection", ":", "Statistics", "After", "collecting", "all", "the", "images", ",", "we", "first", "densely", "annotate", "all", "the", "pedestrians", "bounding", "boxes", "in", "these", "scenes", ",", "and", "then", "associate", "the", "person", "that", "appears", "across", "different", "images", ",", "resulting", "in", "labeled", "identities", ".", "The", "statistics", "of", "two", "data", "sources", "are", "listed", "in", "Table", "[", "reference", "]", ".", "We", "did", "not", "annotate", "those", "people", "who", "appear", "with", "half", "bodies", "or", "abnormal", "poses", "such", "as", "sitting", "or", "squatting", ".", "Moreover", ",", "people", "who", "change", "clothes", "and", "decorations", "in", "different", "video", "frames", "are", "not", "associated", "in", "our", "dataset", ",", "since", "person", "search", "problem", "requires", "to", "recognize", "identities", "mainly", "according", "to", "their", "clothes", "and", "body", "shapes", "rather", "than", "faces", ".", "We", "ensure", "that", "the", "background", "pedestrians", "do", "not", "contain", "labeled", "identities", ",", "and", "thus", "they", "can", "be", "safely", "served", "as", "negative", "samples", "for", "identification", ".", "Note", "that", "we", "also", "ignore", "the", "background", "pedestrians", "whose", "heights", "are", "smaller", "than", "pixels", ",", "as", "they", "would", "be", "hard", "to", "recognize", "even", "for", "human", "labelers", ".", "The", "height", "distributions", "of", "labeled", "and", "unlabeled", "identities", "are", "demonstrated", "in", "Figure", "[", "reference", "]", ".", "It", "can", "be", "seen", "that", "our", "dataset", "has", "rich", "variations", "of", "pedestrian", "scales", ".", "subsection", ":", "Evaluation", "Protocols", "and", "Metrics", "We", "split", "the", "dataset", "into", "a", "training", "and", "a", "test", "subset", ",", "ensuring", "no", "overlapped", "images", "or", "labeled", "identities", "between", "them", ".", "Table", "[", "reference", "]", "shows", "the", "statistics", "of", "these", "two", "subsets", ".", "We", "divide", "the", "test", "identity", "instances", "into", "queries", "and", "galleries", ".", "For", "each", "of", "the", "test", "identities", ",", "we", "randomly", "choose", "one", "of", "his", "/", "her", "instances", "as", "the", "query", ",", "while", "the", "corresponding", "gallery", "set", "consists", "of", "two", "parts", "\u2014", "all", "the", "images", "containing", "the", "other", "instances", "and", "some", "randomly", "sampled", "images", "not", "containing", "this", "person", ".", "Different", "queries", "have", "different", "galleries", ",", "and", "jointly", "they", "cover", "all", "the", "test", "images", ".", "To", "better", "understand", "how", "gallery", "size", "would", "affect", "the", "person", "search", "performance", ",", "we", "define", "a", "set", "of", "protocols", "with", "gallery", "size", "ranging", "from", "to", ".", "Taking", "gallery", "size", "of", "as", "an", "example", ",", "as", "each", "image", "approximately", "contains", "pedestrians", ",", "then", "our", "task", "is", "to", "find", "the", "target", "person", "among", "about", "people", ".", "This", "setting", "is", "comparable", "with", "existing", "person", "re", "-", "i", "d", "datasets", "(", ",", "CUHK", "-", "03", ",", "VIPeR", ")", "in", "terms", "of", "the", "number", "of", "gallery", "pedestrians", ",", "and", "is", "even", "more", "challenging", "as", "there", "could", "be", "thousands", "of", "background", "clutter", "bounding", "boxes", "distracting", "our", "attentions", ".", "We", "employ", "two", "kinds", "of", "evaluation", "metrics", "\u2014", "cumulative", "matching", "characteristics", "(", "CMC", "top", "-", "K", ")", "and", "mean", "averaged", "precision", "(", "mAP", ")", ".", "The", "first", "one", "is", "inherited", "from", "the", "person", "re", "-", "i", "d", "problem", ",", "where", "a", "matching", "is", "counted", "if", "there", "is", "at", "least", "one", "of", "the", "top", "-", "K", "predicted", "bounding", "boxes", "overlaps", "with", "the", "ground", "truths", "with", "intersection", "-", "over", "-", "union", "(", "IoU", ")", "greater", "or", "equal", "to", ".", "The", "second", "one", "is", "inspired", "from", "the", "object", "detection", "tasks", ".", "We", "follow", "the", "ILSVRC", "object", "detection", "criterion", "to", "judge", "the", "correctness", "of", "predicted", "bounding", "boxes", ".", "An", "averaged", "precision", "(", "AP", ")", "is", "calculated", "for", "each", "query", "based", "on", "the", "precision", "-", "recall", "curve", ",", "and", "then", "we", "average", "the", "APs", "across", "all", "the", "queries", "to", "get", "the", "final", "result", ".", "section", ":", "Experiments", "To", "evaluate", "the", "effectiveness", "of", "our", "approach", "and", "study", "the", "impact", "of", "various", "factors", "on", "person", "search", "performance", ",", "we", "conduct", "several", "groups", "of", "experiments", "on", "the", "new", "dataset", ".", "In", "this", "section", ",", "we", "first", "detail", "the", "baseline", "methods", "and", "experiment", "settings", "in", "Section", "[", "reference", "]", ".", "Then", "we", "compare", "our", "joint", "framework", "with", "the", "baselines", "of", "using", "separate", "pedestrian", "detection", "and", "person", "re", "-", "identification", "in", "Section", "[", "reference", "]", ".", "Section", "[", "reference", "]", "shows", "the", "effectiveness", "of", "our", "proposed", "Online", "Instance", "Matching", "(", "OIM", ")", "loss", ".", "At", "last", ",", "we", "present", "the", "influence", "of", "various", "factors", ",", "including", "detection", "recall", "and", "gallery", "size", ".", "subsection", ":", "Experiment", "Settings", "We", "implement", "our", "framework", "based", "on", "Caffe", "and", "py", "-", "faster", "-", "rcnn", ".", "ImageNet", "-", "pretrained", "ResNet", "-", "50", "are", "exploited", "for", "parameters", "initialization", ".", "We", "fix", "the", "first", "convolution", "layer", "and", "the", "batch", "normalization", "(", "BN", ")", "layers", "as", "constant", "affine", "transformations", "in", "the", "stem", "part", ",", "while", "keep", "the", "other", "BN", "layers", "as", "normal", "in", "the", "identification", "part", ".", "The", "temperature", "scalar", "in", "Eq", ".", "(", "[", "reference", "]", ")", "and", "Eq", ".", "(", "[", "reference", "]", ")", "is", "set", "to", ",", "the", "size", "of", "the", "circular", "queue", "is", "set", "to", ".", "All", "the", "losses", "have", "the", "same", "loss", "weight", ".", "Each", "mini", "-", "batch", "consists", "of", "two", "scene", "images", ".", "The", "learning", "rate", "is", "initialized", "to", ",", "dropped", "to", "after", "K", "iterations", ",", "and", "kept", "unchanged", "until", "the", "model", "converges", "at", "K", "iterations", ".", "We", "compare", "our", "framework", "with", "conventional", "methods", "that", "break", "down", "the", "problem", "into", "two", "separate", "tasks", "\u2014", "pedestrian", "detection", "and", "person", "re", "-", "identification", ".", "Three", "pedestrian", "detection", "and", "five", "person", "re", "-", "i", "d", "methods", "are", "used", "in", "our", "experiments", ",", "resulting", "in", "baseline", "combinations", ".", "For", "pedestrian", "detection", ",", "we", "directly", "use", "the", "off", "-", "the", "-", "shelf", "deep", "learning", "CCF", "detector", ",", "as", "well", "as", "two", "other", "detectors", "specifically", "fine", "-", "tuned", "on", "our", "dataset", ".", "One", "is", "the", "ACF", ",", "and", "the", "other", "is", "Faster", "-", "RCNN", "(", "CNN", ")", "with", "ResNet", "-", "50", ",", "which", "is", "equivalent", "to", "our", "framework", "but", "without", "the", "identification", "task", ".", "The", "recall", "-", "precision", "curve", "of", "each", "detector", "on", "our", "dataset", "are", "plotted", "in", "Figure", "[", "reference", "]", ".", "We", "also", "use", "the", "ground", "truth", "(", "GT", ")", "bounding", "boxes", "as", "the", "results", "of", "a", "perfect", "detector", ".", "For", "person", "re", "-", "identification", ",", "we", "use", "several", "popular", "re", "-", "i", "d", "feature", "representations", ",", "including", "DenseSIFT", "-", "ColorHist", "(", "DSIFT", ")", ",", "Bag", "of", "Words", "(", "BoW", ")", ",", "and", "Local", "Maximal", "Occurrence", "(", "LOMO", ")", ".", "Each", "feature", "representation", "is", "used", "in", "conjunction", "with", "a", "specific", "distance", "metric", ",", "including", "Euclidean", ",", "Cosine", "similarity", ",", "KISSME", ",", "and", "XQDA", ",", "where", "KISSME", "and", "XQDA", "are", "trained", "on", "our", "dataset", ".", "Moreover", ",", "by", "discarding", "the", "pedestrian", "proposal", "network", "in", "our", "framework", "and", "training", "the", "remaining", "net", "to", "classify", "identities", "with", "Softmax", "loss", "from", "cropped", "pedestrian", "images", ",", "we", "get", "another", "baseline", "re", "-", "i", "d", "method", "(", "IDNet", ")", ".", "This", "training", "scheme", "has", "been", "exploited", "in", "to", "learn", "discriminative", "re", "-", "i", "d", "feature", "representations", ".", "In", "our", "experiments", ",", "when", "training", "IDNet", "with", "detector", "boxes", ",", "we", "found", "that", "adding", "background", "clutter", "as", "a", "unique", "class", "improves", "the", "result", ",", "while", "adding", "unlabeled", "identities", "does", "not", ".", "The", "following", "results", "are", "reported", "using", "the", "protocol", "with", "gallery", "size", "equal", "to", "if", "not", "specified", ".", "subsection", ":", "Comparison", "with", "Detection", "and", "Re", "-", "ID", "We", "first", "compare", "our", "proposed", "person", "search", "framework", "(", "with", "or", "without", "using", "unlabeled", "identities", ")", "with", "other", "baseline", "combinations", "that", "break", "down", "the", "problem", "into", "separate", "detection", "and", "re", "-", "identification", "tasks", ".", "The", "results", "are", "summarized", "in", "Table", "[", "reference", "]", ".", "Our", "method", "outperforms", "the", "others", "by", "large", "margin", ".", "Comparing", "with", "CNN", "+", "IDNet", ",", "the", "gain", "comes", "from", "the", "joint", "optimization", "of", "the", "detection", "and", "identification", "parts", ",", "as", "well", "as", "the", "effective", "use", "of", "unlabeled", "identities", "in", "the", "OIM", "loss", ".", "From", "Table", "[", "reference", "]", "we", "can", "also", "see", "that", "different", "detectors", "affect", "the", "person", "search", "performance", "significantly", "for", "each", "re", "-", "i", "d", "method", ".", "Directly", "using", "an", "off", "-", "the", "-", "shelf", "detector", "may", "not", "be", "a", "good", "choice", "when", "applying", "existing", "re", "-", "i", "d", "methods", "in", "the", "real", "-", "world", "person", "search", "applications", ".", "Otherwise", "the", "detector", "could", "become", "a", "bottleneck", "that", "diminishes", "the", "returns", "of", "better", "re", "-", "i", "d", "methods", ".", "On", "the", "other", "hand", ",", "the", "relative", "performance", "of", "different", "re", "-", "i", "d", "methods", "are", "consistent", "across", "all", "the", "detectors", ".", "It", "implies", "that", "existing", "person", "re", "-", "i", "d", "datasets", "could", "still", "guide", "us", "to", "design", "better", "feature", "representations", ",", "but", "it", "may", "lose", "some", "valuable", "data", ",", "such", "as", "unlabeled", "identities", "and", "background", "clutter", ",", "which", "come", "with", "the", "person", "search", "datasets", ".", "Another", "interesting", "phenomenon", "is", "that", "although", "IDNet", "and", "LOMO", "+", "XQDA", "have", "similar", "performance", "when", "using", "GT", "or", "fine", "-", "tuned", "ACF", "and", "CNN", "detectors", ",", "IDNet", "is", "significantly", "better", "when", "using", "off", "-", "the", "-", "shelf", "CCF", "detector", ".", "We", "observe", "that", "the", "CCF", "detection", "results", "contain", "many", "misalignments", ".", "Hand", "-", "crafted", "features", "in", "such", "cases", "are", "not", "as", "robust", "as", "the", "IDNet", "counterpart", ".", "subsection", ":", "Effectiveness", "of", "Online", "Instance", "Matching", "We", "validate", "the", "effectiveness", "of", "the", "proposed", "Online", "Instance", "Matching", "(", "OIM", ")", "loss", "by", "comparing", "it", "against", "Softmax", "baselines", "with", "or", "without", "pretraining", "the", "classifier", "matrix", ".", "The", "training", "identification", "accuracy", "and", "test", "person", "search", "mAP", "curves", "are", "demonstrated", "in", "Figure", "[", "reference", "]", ".", "First", ",", "we", "can", "see", "that", "using", "Softmax", "loss", "without", "pretraining", "classifier", "remains", "at", "low", "accuracy", "during", "the", "whole", "process", ".", "This", "phenomenon", "verifies", "our", "analysis", "in", "Section", "[", "reference", "]", "that", "learning", "a", "large", "classifier", "matrix", "is", "difficult", ".", "Even", "with", "proper", "pretraining", ",", "the", "training", "accuracy", "still", "improves", "slowly", ",", "and", "the", "test", "mAP", "keeps", "at", "around", ".", "On", "the", "contrary", ",", "the", "proposed", "OIM", "loss", "starts", "with", "a", "low", "training", "accuracy", "but", "converges", "much", "faster", "and", "also", "consistently", "improves", "the", "test", "performance", ".", "The", "parameter", "-", "free", "OIM", "loss", "learns", "features", "directly", "without", "needing", "to", "learn", "a", "big", "classifier", "matrix", ".", "Moreover", ",", "the", "mismatch", "between", "training", "and", "test", "criterion", "no", "longer", "exists", ",", "as", "both", "are", "computed", "based", "on", "the", "inner", "product", "of", "L2", "-", "normalized", "feature", "vectors", ",", "which", "represents", "the", "cosine", "similarity", ".", "We", "further", "evaluate", "the", "impact", "of", "OIM", "loss", "on", "the", "standard", "person", "re", "-", "identification", "task", ".", "We", "train", "two", "different", "base", "CNNs", ",", "Inception", "(", "from", "scratch", ")", "and", "ResNet", "-", "50", "(", "ImageNet", "pretrained", ")", ",", "with", "either", "Softmax", "loss", "or", "OIM", "loss", ",", "on", "three", "large", "-", "scale", "person", "re", "-", "i", "d", "datasets", ",", "CUHK03", ",", "Market1501", ",", "and", "Duke", ".", "Following", "their", "own", "protocols", ",", "we", "evaluate", "the", "CMC", "top", "-", "1", "accuracy", "of", "using", "different", "loss", "functions", ",", "as", "listed", "in", "Table", "[", "reference", "]", ".", "OIM", "loss", "consistently", "outperforms", "Softmax", "loss", ",", "regardless", "of", "which", "base", "CNN", "is", "used", ".", "We", "refer", "readers", "to", "Open", "-", "ReID", "benchmarks", "for", "more", "details", ".", "[", "t", "]", "0.32", "[", "t", "]", "0.32", "[", "t", "]", "0.32", "Sub", "-", "sampling", "the", "identities", ".", "As", "the", "number", "of", "identities", "increases", ",", "the", "computation", "time", "of", "the", "OIM", "loss", "could", "become", "the", "bottleneck", "of", "the", "whole", "system", ".", "Thus", "we", "proposed", "in", "Section", "[", "reference", "]", "to", "approximate", "Eq", ".", "(", "[", "reference", "]", ")", "and", "Eq", ".", "(", "[", "reference", "]", ")", "by", "sub", "-", "sampling", "both", "the", "labeled", "and", "unlabeled", "identities", "in", "the", "denominators", ".", "We", "validate", "this", "approach", "here", "by", "training", "the", "framework", "with", "sub", "-", "sampling", "size", "of", ",", ",", "and", ".", "The", "test", "mAP", "curves", "are", "demonstrated", "in", "Figure", "[", "reference", "]", ".", "In", "general", ",", "sub", "-", "sampling", "a", "small", "number", "of", "identities", "relaxes", "the", "training", "objective", ",", "which", "leads", "to", "slightly", "inferior", "performance", "but", "much", "faster", "convergence", "rate", ".", "This", "indicates", "that", "our", "framework", "is", "scalable", "to", "larger", "datasets", "with", "even", "more", "identities", "by", "using", "proper", "sub", "-", "sampling", "rate", ".", "Low", "-", "dimensional", "subspace", ".", "We", "further", "investigate", "how", "the", "dimension", "of", "the", "L2", "-", "normalized", "feature", "vector", "affects", "the", "person", "search", "performance", ".", "The", "results", "are", "summarized", "in", "Table", "[", "reference", "]", ".", "We", "observe", "that", "using", "the", "-", "d", "global", "pooled", "feature", "vector", "directly", "with", "L2", "-", "normalization", "leads", "to", "lower", "training", "error", ",", "but", "its", "test", "performance", "is", "worse", ".", "This", "suggests", "that", "projecting", "the", "features", "into", "a", "proper", "low", "-", "rank", "subspace", "is", "very", "important", "to", "regularize", "the", "network", "training", ".", "In", "our", "experiments", ",", "to", "dimensions", "have", "similar", "test", "performance", ",", "and", "we", "choose", "-", "d", "to", "accelerate", "the", "computation", "of", "feature", "distances", ".", "subsection", ":", "Factors", "for", "Person", "Search", "Detection", "Recall", ".", "We", "investigate", "how", "detection", "recalls", "would", "affect", "the", "person", "search", "performance", "by", "using", "LOMO", "+", "XQDA", "as", "the", "re", "-", "i", "d", "method", "and", "setting", "different", "thresholds", "on", "detection", "scores", ".", "A", "lower", "threshold", "reduces", "misdetections", "(", "increases", "the", "recall", ")", "but", "results", "in", "more", "false", "alarms", ".", "We", "choose", "the", "recall", "rates", "ranging", "from", "to", "the", "maximum", "value", "of", "each", "detector", ".", "The", "final", "person", "search", "mAP", "under", "each", "setting", "is", "demonstrated", "in", "Figure", "[", "reference", "]", ".", "An", "interesting", "observation", "is", "that", "higher", "recall", "does", "not", "necessarily", "lead", "to", "higher", "person", "search", "performance", ",", "which", "means", "re", "-", "i", "d", "method", "could", "still", "get", "confused", "on", "some", "false", "alarms", ".", "This", "again", "indicates", "that", "we", "should", "not", "focus", "solely", "on", "training", "re", "-", "i", "d", "methods", "with", "manually", "cropped", "pedestrians", ",", "but", "should", "consider", "the", "detections", "jointly", "under", "the", "person", "search", "problem", "setting", ".", "Gallery", "size", ".", "Person", "search", "could", "be", "more", "challenging", "as", "the", "gallery", "size", "increases", ".", "We", "evaluate", "several", "methods", "under", "different", "test", "gallery", "sizes", "from", "to", "full", "set", "of", "images", ",", "following", "the", "protocols", "defined", "in", "Section", "[", "reference", "]", ".", "The", "test", "mAPs", "are", "demonstrated", "in", "Figure", "[", "reference", "]", ".", "Note", "that", "for", "each", "test", "query", ",", "the", "corresponding", "gallery", "images", "are", "randomly", "sampled", "from", "the", "whole", "set", ".", "All", "test", "images", "are", "covered", "even", "with", "small", "gallery", "sizes", ".", "The", "performance", "gaps", "among", "different", "methods", "are", "reduced", "as", "the", "gallery", "size", "increases", ",", "indicating", "all", "the", "methods", "may", "suffer", "from", "some", "common", "hard", "samples", ",", "and", "we", "could", "further", "improve", "the", "performance", "with", "hard", "example", "minings", ".", "section", ":", "Conclusion", "In", "this", "paper", ",", "we", "propose", "a", "new", "deep", "learning", "framework", "for", "person", "search", ".", "It", "jointly", "handles", "detection", "and", "identification", "in", "a", "single", "CNN", ".", "An", "Online", "Instance", "Matching", "loss", "function", "is", "proposed", "to", "train", "the", "network", "effectively", ".", "Its", "non", "-", "parametric", "nature", "enables", "faster", "yet", "better", "convergence", ",", "which", "is", "validated", "through", "series", "of", "experiments", ".", "Acknowledgements", ".", "This", "work", "is", "supported", "in", "part", "by", "SenseTime", "Group", "Limited", ",", "in", "part", "by", "the", "General", "Research", "Fund", "through", "the", "Research", "Grants", "Council", "of", "Hong", "Kong", "under", "Grants", "CUHK14213616", ",", "CUHK14206114", ",", "CUHK14205615", ",", "CUHK14207814", ",", "CUHK14203015", ",", "CUHK14239816", ",", "and", "CUHK419412", ",", "in", "part", "by", "the", "Hong", "Kong", "Innovation", "and", "Technology", "Support", "Programme", "Grant", "ITS", "/", "121", "/", "15FX", ",", "in", "part", "by", "the", "State", "Key", "Development", "Program", "under", "Grant", "2016YFB1001004", ",", "in", "part", "by", "the", "Guangdong", "Natural", "Science", "Foundation", "under", "Grant", "No", ".", "2014A030313201", ",", "and", "in", "part", "by", "National", "Natural", "Science", "Foundation", "of", "China", "under", "Grant", "61371192", ".", "bibliography", ":", "References"]}