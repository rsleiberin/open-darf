{"coref": {"INRIA_Holidays": [[4790, 4792]], "ImageNet": [[182, 183], [1101, 1102], [1550, 1551], [4043, 4044], [4752, 4757], [5001, 5002], [5674, 5675], [5858, 5859], [6482, 6485], [7467, 7468], [1270, 1271], [1281, 1282], [7260, 7261]], "Image_Classification": [[26, 28], [93, 94], [678, 679], [702, 703], [804, 805], [1086, 1087], [1185, 1186], [1336, 1338], [2107, 2108], [2112, 2113], [2223, 2225], [2365, 2366], [2744, 2745], [2785, 2786], [3338, 3340], [3799, 3801], [4031, 4032], [4145, 4146], [5084, 5085], [5110, 5111], [5238, 5239], [5290, 5291], [5361, 5362], [5414, 5415], [5425, 5426], [5434, 5435], [6186, 6188], [6256, 6257], [6293, 6295], [6479, 6480], [7280, 7281], [7328, 7329], [7357, 7358], [7687, 7688], [38, 39], [629, 630], [840, 842], [913, 914], [1004, 1005], [1165, 1166], [1548, 1549], [1560, 1561], [1590, 1591], [2610, 2611], [2680, 2682], [2758, 2759], [2854, 2855], [3284, 3285], [3375, 3376], [3693, 3694], [3706, 3707], [3928, 3929], [4210, 4212], [4310, 4311], [4485, 4486], [4501, 4502], [4624, 4626], [5204, 5205], [5251, 5252], [5323, 5324], [5671, 5672], [6273, 6274], [6704, 6706], [6747, 6748], [7261, 7262], [7366, 7367], [7506, 7507], [7545, 7546]], "Image_Retrieval": [[220, 222], [410, 412], [947, 949], [1058, 1060], [1088, 1090], [1409, 1411], [1445, 1447], [1670, 1672], [2657, 2659], [2719, 2721], [2746, 2748], [2869, 2871], [3160, 3161], [3644, 3646], [3851, 3853], [3892, 3894], [4033, 4034], [4143, 4144], [4509, 4510], [4659, 4661], [4779, 4781], [5113, 5114], [5418, 5419], [5865, 5866], [5870, 5871], [5994, 5995], [6015, 6016], [6258, 6259], [6291, 6292], [7249, 7251], [7282, 7284], [31, 32], [460, 462], [567, 568], [705, 706], [1048, 1049], [1340, 1341], [1360, 1361], [1418, 1419], [1575, 1576], [1584, 1585], [1621, 1622], [1695, 1697], [1707, 1708], [2227, 2228], [2427, 2428], [2763, 2764], [3286, 3287], [3627, 3628], [3709, 3710], [3930, 3931], [4024, 4025], [4213, 4214], [5512, 5513], [5937, 5938], [6108, 6109], [6168, 6169], [6190, 6191], [6431, 6432], [7121, 7122], [7292, 7293]], "Mean_mAP": [[4785, 4788], [4880, 4883], [5974, 5975]], "MultiGrain_R50-AA-224": [], "MultiGrain_R50-AA-500": [], "MultiGrain_R50___500": [], "MultiGrain_R50___800": [], "MultiGrain_p____450": [], "MultiGrain_p____500": [], "PNASNet-5-Large": [], "PNASNet-5-Large___MultiGrain_p____500": [], "SENet154": [[2406, 2407]], "SENet154___MultiGrain_p____450": [], "Top_1_Accuracy": [[171, 175], [891, 892], [1099, 1100], [1202, 1203], [4086, 4087], [4381, 4386], [4413, 4414], [4766, 4768], [4812, 4813], [5082, 5083], [5455, 5459], [5474, 5477], [5568, 5572], [5639, 5640], [5669, 5670], [5755, 5759], [5777, 5781], [5815, 5816], [5820, 5824], [5900, 5901], [5948, 5950], [5972, 5973], [6451, 6452], [6605, 6607], [6692, 6693], [6976, 6977], [7648, 7650], [4995, 4998]], "Top_5_Accuracy": []}, "coref_non_salient": {"0": [[1437, 1441], [4891, 4894]], "1": [[753, 757], [7318, 7322]], "10": [[1245, 1248], [1850, 1854], [1865, 1869]], "100": [[6901, 6903]], "101": [[18, 21]], "102": [[7288, 7289]], "103": [[5196, 5197]], "104": [[573, 575]], "105": [[6743, 6745]], "106": [[482, 486]], "107": [[7497, 7498]], "108": [[1527, 1533]], "109": [[7027, 7031]], "11": [[2791, 2795], [4180, 4184], [4396, 4400], [6612, 6615], [7459, 7463]], "110": [[6099, 6101]], "111": [[5804, 5805]], "112": [[1736, 1741], [2380, 2382]], "113": [[1489, 1491]], "114": [[669, 672], [1538, 1541], [2215, 2218], [2332, 2334], [2494, 2497]], "115": [[4584, 4585]], "116": [[7340, 7346]], "117": [[1765, 1767]], "118": [[6020, 6022]], "119": [[1496, 1504]], "12": [[5, 8], [152, 153], [467, 469], [548, 550], [5412, 5413], [6054, 6055], [6183, 6185], [7184, 7185], [7278, 7279]], "120": [[1813, 1814]], "121": [[1492, 1494]], "122": [[479, 481]], "123": [[1790, 1793], [1805, 1808], [2805, 2807]], "124": [[5126, 5129]], "125": [[3211, 3215], [4725, 4729]], "126": [[1168, 1171], [2236, 2237]], "127": [[2781, 2783]], "128": [[3264, 3266]], "129": [[4692, 4694]], "13": [[2051, 2053], [2175, 2176]], "130": [[1657, 1666]], "131": [[1962, 1965]], "132": [[1290, 1295]], "133": [[3387, 3391]], "134": [[1908, 1921]], "135": [[1858, 1859]], "136": [[2016, 2020]], "137": [[1485, 1487]], "138": [[1700, 1702]], "139": [[1768, 1771], [2630, 2633], [2653, 2656]], "14": [[80, 82], [2238, 2240], [5579, 5580], [6721, 6723]], "140": [[847, 850]], "141": [[1027, 1029], [3320, 3321]], "142": [[582, 589]], "143": [[5611, 5612]], "144": [[2404, 2405]], "145": [[3502, 3505]], "146": [[3699, 3701]], "147": [[1833, 1834]], "148": [[1189, 1191]], "149": [[2372, 2375]], "15": [[1774, 1778], [1949, 1950], [3223, 3226], [3385, 3386], [3919, 3925], [4443, 4449], [4740, 4741], [5175, 5176]], "150": [[3994, 3995]], "151": [[2385, 2390]], "152": [[7051, 7052]], "153": [[899, 901]], "154": [[2303, 2306]], "155": [[3824, 3826]], "156": [[3397, 3399]], "157": [[6344, 6345]], "158": [[7240, 7243]], "159": [[621, 624]], "16": [[5595, 5597], [5645, 5646]], "160": [[4922, 4925]], "161": [[5663, 5666]], "162": [[7370, 7373]], "163": [[561, 565]], "164": [[1683, 1687]], "17": [[2737, 2739], [6467, 6469]], "18": [[2357, 2359], [4228, 4230], [6197, 6201], [6282, 6284]], "19": [[177, 180], [1104, 1108], [4231, 4234], [4417, 4421], [5439, 5442], [5690, 5694], [5783, 5786], [5853, 5856], [5908, 5912], [6023, 6026], [6524, 6528], [7726, 7730]], "2": [[3513, 3515], [4239, 4241], [6581, 6584], [7580, 7582], [7586, 7590]], "20": [[1951, 1956], [2190, 2196], [6065, 6074]], "21": [[2986, 2988], [4689, 4691]], "22": [[4278, 4281], [4401, 4404], [6540, 6544]], "23": [[194, 196], [5800, 5802]], "24": [[2, 3], [12, 13], [121, 122], [518, 519], [543, 544], [988, 990], [4612, 4614], [5368, 5370], [5463, 5465], [5563, 5565], [5753, 5754], [5897, 5899], [5956, 5957], [6057, 6058], [6097, 6098], [6180, 6181], [6192, 6193], [6250, 6252], [6262, 6263], [6447, 6448], [7132, 7134], [7722, 7724]], "25": [[107, 109], [1942, 1944], [2010, 2013], [2168, 2170], [3346, 3348], [3353, 3355], [3623, 3625], [4325, 4327], [5271, 5273], [5519, 5521], [5659, 5662], [6671, 6673], [6857, 6863], [7037, 7039], [7272, 7275], [7310, 7313]], "26": [[577, 581], [1211, 1213]], "27": [[268, 270], [304, 305], [614, 616], [932, 934], [944, 946], [1375, 1377], [1378, 1381], [2242, 2246], [3343, 3345]], "28": [[1728, 1732], [4468, 4471], [5531, 5534]], "29": [[6941, 6943]], "3": [[2312, 2316], [2345, 2348], [2616, 2621]], "30": [[685, 688], [1565, 1568], [3889, 3891], [5635, 5637]], "31": [[673, 674], [1351, 1352], [1542, 1543], [1557, 1558], [1641, 1642]], "32": [[962, 964], [3425, 3427], [4063, 4065], [4391, 4393], [4428, 4430], [5749, 5752], [6630, 6632]], "33": [[2317, 2320], [2469, 2471]], "34": [[1627, 1632], [1709, 1710]], "35": [[392, 394], [1648, 1650]], "36": [[96, 98], [2865, 2867], [5508, 5510]], "37": [[6394, 6396], [6500, 6502], [6968, 6971]], "38": [[4905, 4914], [4935, 4937]], "39": [[4003, 4006], [5050, 5052]], "4": [[657, 661], [2089, 2092]], "40": [[2376, 2377], [6487, 6488]], "41": [[1823, 1825], [2055, 2057]], "42": [[1652, 1654], [3614, 3616], [3635, 3637], [3683, 3685]], "43": [[6049, 6050]], "44": [[5044, 5045]], "45": [[223, 225], [4618, 4619], [4650, 4651], [4946, 4948], [5554, 5556], [5559, 5560]], "46": [[2023, 2030], [6684, 6688]], "47": [[3462, 3463], [3579, 3581], [4235, 4236], [6837, 6839], [7565, 7566]], "48": [[1344, 1346], [1354, 1357]], "49": [[273, 275], [1570, 1572], [1800, 1802], [1855, 1856]], "5": [[3036, 3038], [3052, 3054], [3162, 3163], [3216, 3218], [3278, 3280], [3775, 3776], [6844, 6846]], "50": [[5652, 5653], [5721, 5722]], "51": [[88, 92], [921, 924]], "52": [[4082, 4083], [6087, 6088], [4815, 4816]], "53": [[147, 149], [2814, 2816], [3734, 3735]], "54": [[607, 609], [695, 697], [994, 996], [1450, 1452]], "55": [[4074, 4077], [4115, 4118], [4134, 4137], [6159, 6163]], "56": [[1505, 1508], [1512, 1515], [6122, 6125]], "57": [[7381, 7384]], "58": [[7633, 7640]], "59": [[2586, 2589]], "6": [[6459, 6463], [7423, 7425], [7629, 7631]], "60": [[6813, 6816]], "61": [[5760, 5761], [5825, 5826], [7233, 7236]], "62": [[4941, 4943], [6089, 6091]], "63": [[3742, 3744]], "64": [[6597, 6600]], "65": [[3267, 3269]], "66": [[2155, 2156], [2181, 2182], [3325, 3326], [3401, 3402], [5919, 5920], [7202, 7203], [3498, 3499], [3552, 3553], [4294, 4295], [4976, 4977], [5009, 5010], [5491, 5492]], "67": [[7561, 7562], [7610, 7613]], "68": [[386, 388], [825, 827]], "69": [[1382, 1384], [4874, 4877], [5882, 5885]], "7": [[1180, 1182], [1196, 1198], [2769, 2771]], "70": [[1968, 1976], [6782, 6785], [7453, 7456]], "71": [[6841, 6842], [6872, 6873]], "72": [[6724, 6727]], "73": [[124, 126], [1054, 1056], [1597, 1599], [5523, 5524], [6118, 6120], [6221, 6223], [6621, 6622], [7511, 7513], [7747, 7748]], "74": [[4175, 4178]], "75": [[6662, 6666], [6925, 6927]], "76": [[3042, 3044]], "77": [[1712, 1716], [5951, 5955]], "78": [[5015, 5016], [5422, 5423]], "79": [[2152, 2154], [3322, 3324], [5487, 5489], [5916, 5918], [7022, 7025]], "8": [[2599, 2600], [4466, 4467], [5525, 5526], [2550, 2551], [2567, 2568], [2676, 2677], [4463, 4464], [5387, 5388], [6204, 6205], [7404, 7405], [7679, 7680]], "80": [[2322, 2324], [2637, 2639]], "81": [[904, 905], [7400, 7402]], "82": [[4737, 4738], [6347, 6349]], "83": [[4539, 4548]], "84": [[3828, 3829]], "85": [[4425, 4427]], "86": [[2408, 2410], [2605, 2607], [4479, 4481], [5380, 5382]], "87": [[2752, 2755]], "88": [[4531, 4532]], "89": [[15, 17]], "9": [[1959, 1960], [2078, 2079], [2200, 2204]], "90": [[1215, 1217]], "91": [[6645, 6647], [6921, 6924]], "92": [[5309, 5310], [7692, 7693]], "93": [[1721, 1724], [2481, 2485], [2546, 2549]], "94": [[2126, 2128], [3382, 3384], [3459, 3461]], "95": [[161, 163], [488, 490], [1010, 1012], [1067, 1069], [4071, 4073], [5047, 5049], [5054, 5056], [5284, 5286], [5338, 5340]], "96": [[4000, 4002]], "97": [[1517, 1518]], "98": [[7081, 7086], [7091, 7094]], "99": [[6114, 6116]]}, "doc_id": "1e7678467b1807777dcd9be557b79328ce9419a8", "method_subrelations": {"MultiGrain_R50-AA-224": [[[0, 21], "MultiGrain_R50-AA-224"]], "MultiGrain_R50-AA-500": [[[0, 21], "MultiGrain_R50-AA-500"]], "MultiGrain_R50___500": [[[0, 20], "MultiGrain_R50___500"]], "MultiGrain_R50___800": [[[0, 20], "MultiGrain_R50___800"]], "PNASNet-5-Large___MultiGrain_p____500": [[[0, 15], "PNASNet-5-Large"], [[18, 37], "MultiGrain_p____500"]], "SENet154___MultiGrain_p____450": [[[0, 8], "SENet154"], [[11, 30], "MultiGrain_p____450"]]}, "n_ary_relations": [{"Material": "INRIA_Holidays", "Method": "MultiGrain_R50___500", "Metric": "Mean_mAP", "Task": "Image_Retrieval", "score": "91.8%"}, {"Material": "INRIA_Holidays", "Method": "MultiGrain_R50___800", "Metric": "Mean_mAP", "Task": "Image_Retrieval", "score": "92.5%"}, {"Material": "ImageNet", "Method": "MultiGrain_R50-AA-224", "Metric": "Top_1_Accuracy", "Task": "Image_Classification", "score": "78.2%"}, {"Material": "ImageNet", "Method": "MultiGrain_R50-AA-500", "Metric": "Top_1_Accuracy", "Task": "Image_Classification", "score": "79.4%"}, {"Material": "ImageNet", "Method": "PNASNet-5-Large___MultiGrain_p____500", "Metric": "Top_1_Accuracy", "Task": "Image_Classification", "score": "83.6%"}, {"Material": "ImageNet", "Method": "SENet154___MultiGrain_p____450", "Metric": "Top_1_Accuracy", "Task": "Image_Classification", "score": "83.1%"}, {"Material": "ImageNet", "Method": "MultiGrain_R50-AA-224", "Metric": "Top_5_Accuracy", "Task": "Image_Classification", "score": "93.9%"}, {"Material": "ImageNet", "Method": "MultiGrain_R50-AA-500", "Metric": "Top_5_Accuracy", "Task": "Image_Classification", "score": "94.8%"}, {"Material": "ImageNet", "Method": "PNASNet-5-Large___MultiGrain_p____500", "Metric": "Top_5_Accuracy", "Task": "Image_Classification", "score": "96.7%"}, {"Material": "ImageNet", "Method": "SENet154___MultiGrain_p____450", "Metric": "Top_5_Accuracy", "Task": "Image_Classification", "score": "96.5%"}], "ner": [[2, 3, "Method"], [5, 8, "Method"], [12, 13, "Method"], [15, 17, "Method"], [18, 21, "Method"], [26, 28, "Task"], [80, 82, "Method"], [88, 92, "Metric"], [93, 94, "Task"], [96, 98, "Metric"], [107, 109, "Task"], [121, 122, "Method"], [124, 126, "Method"], [147, 149, "Method"], [152, 153, "Method"], [161, 163, "Metric"], [171, 175, "Metric"], [177, 180, "Method"], [182, 183, "Material"], [194, 196, "Method"], [220, 222, "Task"], [223, 225, "Task"], [268, 270, "Task"], [273, 275, "Task"], [304, 305, "Task"], [386, 388, "Method"], [392, 394, "Method"], [410, 412, "Task"], [467, 469, "Method"], [479, 481, "Metric"], [482, 486, "Metric"], [488, 490, "Metric"], [518, 519, "Method"], [543, 544, "Method"], [548, 550, "Method"], [561, 565, "Method"], [573, 575, "Task"], [577, 581, "Task"], [582, 589, "Task"], [607, 609, "Task"], [614, 616, "Task"], [621, 624, "Method"], [657, 661, "Metric"], [669, 672, "Method"], [673, 674, "Method"], [678, 679, "Task"], [685, 688, "Method"], [695, 697, "Task"], [702, 703, "Task"], [753, 757, "Task"], [804, 805, "Task"], [825, 827, "Method"], [847, 850, "Method"], [891, 892, "Metric"], [899, 901, "Metric"], [904, 905, "Method"], [921, 924, "Metric"], [932, 934, "Task"], [944, 946, "Task"], [947, 949, "Task"], [962, 964, "Method"], [988, 990, "Method"], [994, 996, "Task"], [1010, 1012, "Metric"], [1027, 1029, "Method"], [1054, 1056, "Method"], [1058, 1060, "Task"], [1067, 1069, "Metric"], [1086, 1087, "Task"], [1088, 1090, "Task"], [1099, 1100, "Metric"], [1101, 1102, "Material"], [1104, 1108, "Method"], [1168, 1171, "Method"], [1180, 1182, "Method"], [1185, 1186, "Task"], [1189, 1191, "Method"], [1196, 1198, "Method"], [1202, 1203, "Metric"], [1211, 1213, "Task"], [1215, 1217, "Task"], [1245, 1248, "Method"], [1290, 1295, "Method"], [1336, 1338, "Task"], [1344, 1346, "Task"], [1351, 1352, "Method"], [1354, 1357, "Task"], [1375, 1377, "Task"], [1378, 1381, "Task"], [1382, 1384, "Task"], [1409, 1411, "Task"], [1437, 1441, "Material"], [1445, 1447, "Task"], [1450, 1452, "Task"], [1485, 1487, "Method"], [1489, 1491, "Task"], [1492, 1494, "Task"], [1496, 1504, "Task"], [1505, 1508, "Method"], [1512, 1515, "Method"], [1517, 1518, "Task"], [1527, 1533, "Method"], [1538, 1541, "Method"], [1542, 1543, "Method"], [1550, 1551, "Material"], [1557, 1558, "Method"], [1565, 1568, "Method"], [1570, 1572, "Task"], [1597, 1599, "Method"], [1627, 1632, "Method"], [1641, 1642, "Method"], [1648, 1650, "Method"], [1652, 1654, "Method"], [1657, 1666, "Task"], [1670, 1672, "Task"], [1683, 1687, "Method"], [1700, 1702, "Method"], [1709, 1710, "Method"], [1712, 1716, "Method"], [1721, 1724, "Method"], [1728, 1732, "Method"], [1736, 1741, "Method"], [1765, 1767, "Method"], [1768, 1771, "Method"], [1774, 1778, "Task"], [1790, 1793, "Method"], [1800, 1802, "Task"], [1805, 1808, "Method"], [1813, 1814, "Metric"], [1823, 1825, "Method"], [1833, 1834, "Task"], [1850, 1854, "Method"], [1855, 1856, "Task"], [1858, 1859, "Task"], [1865, 1869, "Method"], [1908, 1921, "Task"], [1942, 1944, "Task"], [1949, 1950, "Task"], [1951, 1956, "Task"], [1959, 1960, "Task"], [1962, 1965, "Task"], [1968, 1976, "Method"], [2010, 2013, "Task"], [2016, 2020, "Method"], [2023, 2030, "Method"], [2051, 2053, "Task"], [2055, 2057, "Method"], [2078, 2079, "Task"], [2089, 2092, "Metric"], [2107, 2108, "Task"], [2112, 2113, "Task"], [2126, 2128, "Method"], [2152, 2154, "Method"], [2155, 2156, "Method"], [2168, 2170, "Task"], [2175, 2176, "Task"], [2181, 2182, "Method"], [2190, 2196, "Task"], [2200, 2204, "Task"], [2215, 2218, "Method"], [2223, 2225, "Task"], [2236, 2237, "Method"], [2238, 2240, "Method"], [2242, 2246, "Task"], [2303, 2306, "Method"], [2312, 2316, "Method"], [2317, 2320, "Method"], [2322, 2324, "Method"], [2332, 2334, "Method"], [2345, 2348, "Method"], [2357, 2359, "Method"], [2365, 2366, "Task"], [2372, 2375, "Method"], [2376, 2377, "Method"], [2380, 2382, "Method"], [2385, 2390, "Method"], [2404, 2405, "Method"], [2406, 2407, "Method"], [2408, 2410, "Method"], [2469, 2471, "Method"], [2481, 2485, "Method"], [2494, 2497, "Method"], [2546, 2549, "Method"], [2586, 2589, "Method"], [2599, 2600, "Method"], [2605, 2607, "Method"], [2616, 2621, "Method"], [2630, 2633, "Method"], [2637, 2639, "Method"], [2653, 2656, "Method"], [2657, 2659, "Task"], [2719, 2721, "Task"], [2737, 2739, "Metric"], [2744, 2745, "Task"], [2746, 2748, "Task"], [2752, 2755, "Metric"], [2769, 2771, "Method"], [2781, 2783, "Metric"], [2785, 2786, "Task"], [2791, 2795, "Method"], [2805, 2807, "Method"], [2814, 2816, "Method"], [2865, 2867, "Metric"], [2869, 2871, "Task"], [2986, 2988, "Task"], [3036, 3038, "Method"], [3042, 3044, "Method"], [3052, 3054, "Method"], [3160, 3161, "Task"], [3162, 3163, "Method"], [3211, 3215, "Method"], [3216, 3218, "Method"], [3223, 3226, "Task"], [3264, 3266, "Method"], [3267, 3269, "Method"], [3278, 3280, "Method"], [3320, 3321, "Method"], [3322, 3324, "Method"], [3325, 3326, "Method"], [3338, 3340, "Task"], [3343, 3345, "Task"], [3346, 3348, "Task"], [3353, 3355, "Task"], [3382, 3384, "Method"], [3385, 3386, "Task"], [3387, 3391, "Task"], [3397, 3399, "Task"], [3401, 3402, "Method"], [3425, 3427, "Method"], [3459, 3461, "Method"], [3462, 3463, "Method"], [3502, 3505, "Method"], [3513, 3515, "Metric"], [3579, 3581, "Method"], [3614, 3616, "Method"], [3623, 3625, "Task"], [3635, 3637, "Method"], [3644, 3646, "Task"], [3683, 3685, "Method"], [3699, 3701, "Method"], [3734, 3735, "Method"], [3742, 3744, "Method"], [3775, 3776, "Method"], [3799, 3801, "Task"], [3824, 3826, "Metric"], [3828, 3829, "Task"], [3851, 3853, "Task"], [3889, 3891, "Method"], [3892, 3894, "Task"], [3919, 3925, "Task"], [3994, 3995, "Metric"], [4000, 4002, "Task"], [4003, 4006, "Metric"], [4031, 4032, "Task"], [4033, 4034, "Task"], [4043, 4044, "Material"], [4063, 4065, "Method"], [4071, 4073, "Metric"], [4074, 4077, "Task"], [4082, 4083, "Material"], [4086, 4087, "Metric"], [4115, 4118, "Task"], [4134, 4137, "Task"], [4143, 4144, "Task"], [4145, 4146, "Task"], [4175, 4178, "Method"], [4180, 4184, "Method"], [4228, 4230, "Method"], [4231, 4234, "Method"], [4235, 4236, "Method"], [4239, 4241, "Metric"], [4278, 4281, "Method"], [4325, 4327, "Task"], [4381, 4386, "Metric"], [4391, 4393, "Method"], [4396, 4400, "Method"], [4401, 4404, "Method"], [4413, 4414, "Metric"], [4417, 4421, "Method"], [4425, 4427, "Method"], [4428, 4430, "Method"], [4443, 4449, "Task"], [4466, 4467, "Method"], [4468, 4471, "Method"], [4479, 4481, "Method"], [4509, 4510, "Task"], [4531, 4532, "Metric"], [4539, 4548, "Method"], [4584, 4585, "Task"], [4612, 4614, "Method"], [4618, 4619, "Task"], [4650, 4651, "Task"], [4659, 4661, "Task"], [4689, 4691, "Task"], [4692, 4694, "Task"], [4725, 4729, "Method"], [4737, 4738, "Method"], [4740, 4741, "Task"], [4752, 4757, "Material"], [4766, 4768, "Metric"], [4779, 4781, "Task"], [4785, 4788, "Metric"], [4790, 4792, "Material"], [4812, 4813, "Metric"], [4874, 4877, "Task"], [4880, 4883, "Metric"], [4891, 4894, "Material"], [4905, 4914, "Material"], [4922, 4925, "Method"], [4935, 4937, "Material"], [4941, 4943, "Material"], [4946, 4948, "Task"], [5001, 5002, "Material"], [5015, 5016, "Method"], [5044, 5045, "Method"], [5047, 5049, "Metric"], [5050, 5052, "Metric"], [5054, 5056, "Metric"], [5082, 5083, "Metric"], [5084, 5085, "Task"], [5110, 5111, "Task"], [5113, 5114, "Task"], [5126, 5129, "Method"], [5175, 5176, "Task"], [5196, 5197, "Method"], [5238, 5239, "Task"], [5271, 5273, "Task"], [5284, 5286, "Metric"], [5290, 5291, "Task"], [5309, 5310, "Task"], [5338, 5340, "Metric"], [5361, 5362, "Task"], [5368, 5370, "Method"], [5380, 5382, "Method"], [5412, 5413, "Method"], [5414, 5415, "Task"], [5418, 5419, "Task"], [5422, 5423, "Method"], [5425, 5426, "Task"], [5434, 5435, "Task"], [5439, 5442, "Method"], [5455, 5459, "Metric"], [5463, 5465, "Method"], [5474, 5477, "Metric"], [5487, 5489, "Method"], [5508, 5510, "Metric"], [5519, 5521, "Task"], [5523, 5524, "Method"], [5525, 5526, "Method"], [5531, 5534, "Method"], [5554, 5556, "Task"], [5559, 5560, "Task"], [5563, 5565, "Method"], [5568, 5572, "Metric"], [5579, 5580, "Method"], [5595, 5597, "Method"], [5611, 5612, "Task"], [5635, 5637, "Method"], [5639, 5640, "Metric"], [5645, 5646, "Method"], [5652, 5653, "Method"], [5659, 5662, "Task"], [5663, 5666, "Method"], [5669, 5670, "Metric"], [5674, 5675, "Material"], [5690, 5694, "Method"], [5749, 5752, "Method"], [5753, 5754, "Method"], [5755, 5759, "Metric"], [5760, 5761, "Metric"], [5777, 5781, "Metric"], [5783, 5786, "Method"], [5800, 5802, "Method"], [5804, 5805, "Method"], [5815, 5816, "Metric"], [5820, 5824, "Metric"], [5825, 5826, "Metric"], [5853, 5856, "Method"], [5858, 5859, "Material"], [5865, 5866, "Task"], [5870, 5871, "Task"], [5882, 5885, "Task"], [5897, 5899, "Method"], [5900, 5901, "Metric"], [5908, 5912, "Method"], [5916, 5918, "Method"], [5919, 5920, "Method"], [5948, 5950, "Metric"], [5951, 5955, "Method"], [5956, 5957, "Method"], [5972, 5973, "Metric"], [5974, 5975, "Metric"], [5994, 5995, "Task"], [6015, 6016, "Task"], [6020, 6022, "Method"], [6023, 6026, "Method"], [6049, 6050, "Metric"], [6054, 6055, "Method"], [6057, 6058, "Method"], [6065, 6074, "Task"], [6087, 6088, "Material"], [6089, 6091, "Material"], [6097, 6098, "Method"], [6099, 6101, "Method"], [6114, 6116, "Method"], [6118, 6120, "Method"], [6122, 6125, "Method"], [6159, 6163, "Task"], [6180, 6181, "Method"], [6183, 6185, "Method"], [6186, 6188, "Task"], [6192, 6193, "Method"], [6197, 6201, "Method"], [6221, 6223, "Method"], [6250, 6252, "Method"], [6256, 6257, "Task"], [6258, 6259, "Task"], [6262, 6263, "Method"], [6282, 6284, "Method"], [6291, 6292, "Task"], [6293, 6295, "Task"], [6344, 6345, "Method"], [6347, 6349, "Method"], [6394, 6396, "Method"], [6447, 6448, "Method"], [6451, 6452, "Metric"], [6459, 6463, "Method"], [6467, 6469, "Metric"], [6479, 6480, "Task"], [6482, 6485, "Material"], [6487, 6488, "Method"], [6500, 6502, "Method"], [6524, 6528, "Method"], [6540, 6544, "Method"], [6581, 6584, "Metric"], [6597, 6600, "Metric"], [6605, 6607, "Metric"], [6612, 6615, "Method"], [6621, 6622, "Method"], [6630, 6632, "Method"], [6645, 6647, "Method"], [6662, 6666, "Method"], [6671, 6673, "Task"], [6684, 6688, "Method"], [6692, 6693, "Metric"], [6721, 6723, "Method"], [6724, 6727, "Method"], [6743, 6745, "Method"], [6782, 6785, "Method"], [6813, 6816, "Method"], [6837, 6839, "Method"], [6841, 6842, "Method"], [6844, 6846, "Method"], [6857, 6863, "Task"], [6872, 6873, "Method"], [6901, 6903, "Method"], [6921, 6924, "Method"], [6925, 6927, "Method"], [6941, 6943, "Method"], [6968, 6971, "Method"], [6976, 6977, "Metric"], [7022, 7025, "Method"], [7027, 7031, "Task"], [7037, 7039, "Task"], [7051, 7052, "Method"], [7081, 7086, "Task"], [7091, 7094, "Task"], [7132, 7134, "Method"], [7184, 7185, "Method"], [7202, 7203, "Method"], [7233, 7236, "Metric"], [7240, 7243, "Method"], [7249, 7251, "Task"], [7272, 7275, "Task"], [7278, 7279, "Method"], [7280, 7281, "Task"], [7282, 7284, "Task"], [7288, 7289, "Task"], [7310, 7313, "Task"], [7318, 7322, "Task"], [7328, 7329, "Task"], [7340, 7346, "Method"], [7357, 7358, "Task"], [7370, 7373, "Method"], [7381, 7384, "Method"], [7400, 7402, "Method"], [7423, 7425, "Method"], [7453, 7456, "Method"], [7459, 7463, "Method"], [7467, 7468, "Material"], [7497, 7498, "Method"], [7511, 7513, "Method"], [7561, 7562, "Task"], [7565, 7566, "Method"], [7580, 7582, "Metric"], [7586, 7590, "Metric"], [7610, 7613, "Task"], [7629, 7631, "Method"], [7633, 7640, "Method"], [7648, 7650, "Metric"], [7687, 7688, "Task"], [7692, 7693, "Task"], [7722, 7724, "Method"], [7726, 7730, "Method"], [7747, 7748, "Method"], [31, 32, "Task"], [38, 39, "Task"], [460, 462, "Task"], [567, 568, "Task"], [629, 630, "Task"], [705, 706, "Task"], [840, 842, "Task"], [913, 914, "Task"], [1004, 1005, "Task"], [1048, 1049, "Task"], [1165, 1166, "Task"], [1270, 1271, "Material"], [1281, 1282, "Material"], [1340, 1341, "Task"], [1360, 1361, "Task"], [1418, 1419, "Task"], [1548, 1549, "Task"], [1560, 1561, "Task"], [1575, 1576, "Task"], [1584, 1585, "Task"], [1590, 1591, "Task"], [1621, 1622, "Task"], [1695, 1697, "Task"], [1707, 1708, "Task"], [2227, 2228, "Task"], [2427, 2428, "Task"], [2550, 2551, "Method"], [2567, 2568, "Method"], [2610, 2611, "Task"], [2676, 2677, "Method"], [2680, 2682, "Task"], [2758, 2759, "Task"], [2763, 2764, "Task"], [2854, 2855, "Task"], [3284, 3285, "Task"], [3286, 3287, "Task"], [3375, 3376, "Task"], [3498, 3499, "Method"], [3552, 3553, "Method"], [3627, 3628, "Task"], [3693, 3694, "Task"], [3706, 3707, "Task"], [3709, 3710, "Task"], [3928, 3929, "Task"], [3930, 3931, "Task"], [4024, 4025, "Task"], [4210, 4212, "Task"], [4213, 4214, "Task"], [4294, 4295, "Method"], [4310, 4311, "Task"], [4463, 4464, "Method"], [4485, 4486, "Task"], [4501, 4502, "Task"], [4624, 4626, "Task"], [4815, 4816, "Material"], [4976, 4977, "Method"], [4995, 4998, "Metric"], [5009, 5010, "Method"], [5204, 5205, "Task"], [5251, 5252, "Task"], [5323, 5324, "Task"], [5387, 5388, "Method"], [5491, 5492, "Method"], [5512, 5513, "Task"], [5671, 5672, "Task"], [5721, 5722, "Method"], [5937, 5938, "Task"], [6108, 6109, "Task"], [6168, 6169, "Task"], [6190, 6191, "Task"], [6204, 6205, "Method"], [6273, 6274, "Task"], [6431, 6432, "Task"], [6704, 6706, "Task"], [6747, 6748, "Task"], [7121, 7122, "Task"], [7260, 7261, "Material"], [7261, 7262, "Task"], [7292, 7293, "Task"], [7366, 7367, "Task"], [7404, 7405, "Method"], [7506, 7507, "Task"], [7545, 7546, "Task"], [7679, 7680, "Method"]], "sections": [[0, 265], [265, 1158], [1158, 1162], [1162, 1342], [1342, 1577], [1577, 1772], [1772, 1940], [1940, 2205], [2205, 2301], [2301, 2363], [2363, 2424], [2424, 2735], [2735, 2779], [2779, 2863], [2863, 3270], [3270, 3318], [3318, 3612], [3612, 3791], [3791, 3998], [3998, 4191], [4191, 4215], [4215, 4219], [4219, 4323], [4323, 4436], [4436, 4579], [4579, 4687], [4687, 4742], [4742, 4944], [4944, 5141], [5141, 5359], [5359, 5648], [5648, 5863], [5863, 6171], [6171, 6312], [6312, 6355], [6355, 6493], [6493, 7040], [7040, 7072], [7072, 7111], [7111, 7336], [7336, 7781]], "sentences": [[0, 12], [12, 33], [33, 41], [41, 79], [79, 117], [117, 143], [143, 164], [164, 197], [197, 226], [226, 227], [227, 260], [260, 265], [265, 268], [268, 295], [295, 365], [365, 392], [392, 407], [407, 430], [430, 456], [456, 472], [472, 491], [491, 509], [509, 541], [541, 554], [554, 566], [566, 590], [590, 617], [617, 646], [646, 665], [665, 689], [689, 712], [712, 748], [748, 769], [769, 790], [790, 820], [820, 844], [844, 863], [863, 893], [893, 909], [909, 930], [930, 975], [975, 985], [985, 1002], [1002, 1016], [1016, 1061], [1061, 1077], [1077, 1091], [1091, 1115], [1115, 1122], [1122, 1124], [1124, 1129], [1129, 1150], [1150, 1158], [1158, 1162], [1162, 1167], [1167, 1192], [1192, 1218], [1218, 1236], [1236, 1260], [1260, 1308], [1308, 1317], [1317, 1342], [1342, 1353], [1353, 1354], [1354, 1405], [1405, 1442], [1442, 1453], [1453, 1482], [1482, 1505], [1505, 1534], [1534, 1577], [1577, 1585], [1585, 1613], [1613, 1633], [1633, 1643], [1643, 1673], [1673, 1709], [1709, 1728], [1728, 1750], [1750, 1772], [1772, 1778], [1778, 1803], [1803, 1815], [1815, 1846], [1846, 1874], [1874, 1940], [1940, 1944], [1944, 1966], [1966, 2021], [2021, 2039], [2039, 2093], [2093, 2147], [2147, 2177], [2177, 2205], [2205, 2209], [2209, 2229], [2229, 2252], [2252, 2273], [2273, 2301], [2301, 2306], [2306, 2317], [2317, 2342], [2342, 2363], [2363, 2367], [2367, 2391], [2391, 2400], [2400, 2424], [2424, 2428], [2428, 2465], [2465, 2477], [2477, 2486], [2486, 2522], [2522, 2545], [2545, 2549], [2549, 2564], [2564, 2577], [2577, 2599], [2599, 2624], [2624, 2660], [2660, 2684], [2684, 2735], [2735, 2739], [2739, 2766], [2766, 2779], [2779, 2784], [2784, 2796], [2796, 2830], [2830, 2833], [2833, 2863], [2863, 2868], [2868, 2900], [2900, 2908], [2908, 2932], [2932, 2960], [2960, 2975], [2975, 2989], [2989, 3002], [3002, 3055], [3055, 3133], [3133, 3162], [3162, 3208], [3208, 3270], [3270, 3277], [3277, 3293], [3293, 3318], [3318, 3327], [3327, 3349], [3349, 3365], [3365, 3378], [3378, 3400], [3400, 3432], [3432, 3453], [3453, 3481], [3481, 3519], [3519, 3545], [3545, 3570], [3570, 3574], [3574, 3595], [3595, 3612], [3612, 3616], [3616, 3647], [3647, 3664], [3664, 3680], [3680, 3711], [3711, 3741], [3741, 3768], [3768, 3791], [3791, 3795], [3795, 3819], [3819, 3846], [3846, 3884], [3884, 3915], [3915, 3933], [3933, 3954], [3954, 3998], [3998, 4008], [4008, 4035], [4035, 4068], [4068, 4108], [4108, 4130], [4130, 4147], [4147, 4191], [4191, 4196], [4196, 4215], [4215, 4219], [4219, 4227], [4227, 4235], [4235, 4259], [4259, 4277], [4277, 4309], [4309, 4323], [4323, 4328], [4328, 4351], [4351, 4371], [4371, 4405], [4405, 4431], [4431, 4436], [4436, 4441], [4441, 4477], [4477, 4488], [4488, 4515], [4515, 4522], [4522, 4537], [4537, 4549], [4549, 4579], [4579, 4586], [4586, 4605], [4605, 4617], [4617, 4649], [4649, 4687], [4687, 4695], [4695, 4705], [4705, 4722], [4722, 4742], [4742, 4746], [4746, 4766], [4766, 4778], [4778, 4808], [4808, 4864], [4864, 4895], [4895, 4915], [4915, 4921], [4921, 4944], [4944, 4951], [4951, 4959], [4959, 4963], [4963, 4982], [4982, 5017], [5017, 5038], [5038, 5040], [5040, 5044], [5044, 5071], [5071, 5098], [5098, 5115], [5115, 5141], [5141, 5148], [5148, 5158], [5158, 5194], [5194, 5196], [5196, 5230], [5230, 5250], [5250, 5274], [5274, 5287], [5287, 5298], [5298, 5311], [5311, 5326], [5326, 5347], [5347, 5359], [5359, 5363], [5363, 5378], [5378, 5390], [5390, 5420], [5420, 5428], [5428, 5479], [5479, 5508], [5508, 5523], [5523, 5554], [5554, 5573], [5573, 5608], [5608, 5648], [5648, 5651], [5651, 5676], [5676, 5709], [5709, 5726], [5726, 5744], [5744, 5766], [5766, 5806], [5806, 5827], [5827, 5863], [5863, 5867], [5867, 5896], [5896, 5916], [5916, 5930], [5930, 5942], [5942, 5956], [5956, 5970], [5970, 5985], [5985, 6017], [6017, 6043], [6043, 6075], [6075, 6099], [6099, 6113], [6113, 6126], [6126, 6149], [6149, 6171], [6171, 6174], [6174, 6192], [6192, 6214], [6214, 6246], [6246, 6260], [6260, 6285], [6285, 6301], [6301, 6312], [6312, 6316], [6316, 6326], [6326, 6355], [6355, 6358], [6358, 6361], [6361, 6378], [6378, 6397], [6397, 6419], [6419, 6434], [6434, 6470], [6470, 6493], [6493, 6502], [6502, 6516], [6516, 6552], [6552, 6589], [6589, 6648], [6648, 6694], [6694, 6739], [6739, 6758], [6758, 6786], [6786, 6824], [6824, 6834], [6834, 6846], [6846, 6869], [6869, 6895], [6895, 6918], [6918, 6966], [6966, 6968], [6968, 6991], [6991, 7011], [7011, 7040], [7040, 7047], [7047, 7072], [7072, 7079], [7079, 7111], [7111, 7122], [7122, 7146], [7146, 7179], [7179, 7192], [7192, 7237], [7237, 7252], [7252, 7263], [7263, 7287], [7287, 7308], [7308, 7336], [7336, 7349], [7349, 7376], [7376, 7418], [7418, 7428], [7428, 7476], [7476, 7524], [7524, 7560], [7560, 7597], [7597, 7622], [7622, 7641], [7641, 7651], [7651, 7672], [7672, 7715], [7715, 7757], [7757, 7771], [7771, 7780], [7780, 7781]], "words": ["document", ":", "MultiGrain", ":", "a", "unified", "image", "embedding", "for", "classes", "and", "instances", "MultiGrain", "is", "a", "network", "architecture", "producing", "compact", "vector", "representations", "that", "are", "suited", "both", "for", "image", "classification", "and", "particular", "object", "retrieval", ".", "It", "builds", "on", "a", "standard", "classification", "trunk", ".", "The", "top", "of", "the", "network", "produces", "an", "embedding", "containing", "coarse", "and", "fine", "-", "grained", "information", ",", "so", "that", "images", "can", "be", "recognized", "based", "on", "the", "object", "class", ",", "particular", "object", ",", "or", "if", "they", "are", "distorted", "copies", ".", "Our", "joint", "training", "is", "simple", ":", "we", "minimize", "a", "cross", "-", "entropy", "loss", "for", "classification", "and", "a", "ranking", "loss", "that", "determines", "if", "two", "images", "are", "identical", "up", "to", "data", "augmentation", ",", "with", "no", "need", "for", "additional", "labels", ".", "A", "key", "component", "of", "MultiGrain", "is", "a", "pooling", "layer", "that", "takes", "advantage", "of", "high", "-", "resolution", "images", "with", "a", "network", "trained", "at", "a", "lower", "resolution", ".", "When", "fed", "to", "a", "linear", "classifier", ",", "the", "learned", "embeddings", "provide", "state", "-", "of", "-", "the", "-", "art", "classification", "accuracy", ".", "For", "instance", ",", "we", "obtain", "79.4", "%", "top", "-", "1", "accuracy", "with", "a", "ResNet", "-", "50", "learned", "on", "Imagenet", ",", "which", "is", "a", "+", "1.8", "%", "absolute", "improvement", "over", "the", "AutoAugment", "method", ".", "When", "compared", "with", "the", "cosine", "similarity", ",", "the", "same", "embeddings", "perform", "on", "par", "with", "the", "state", "-", "of", "-", "the", "-", "art", "for", "image", "retrieval", "at", "moderate", "resolutions", ".", "fixltx2efixltx2eisnotrequired", "arrows.meta", ",", "positioning", ",", "fit", ",", "backgrounds", ",", "calc", "supplSupplementalreferences", "[", "itemize", "]", "labelsep=5pt", ",", "labelindent=0.4itemindent=0pt", ",", "leftmargin=*", ",", "itemsep=", "-", "4pt", ",", "darkgreenRGB0", ",", "140", ",", "0", "antiquefuchsiargb0.57", ",", "0.36", ",", "0.51", "auburnrgb0.43", ",", "0.21", ",", "0.1", "section", ":", "Introduction", "Image", "recognition", "is", "central", "to", "computer", "vision", ",", "with", "dozens", "of", "new", "approaches", "being", "proposed", "every", "year", ",", "each", "optimized", "for", "particular", "aspects", "of", "the", "problem", ".", "From", "coarse", "to", "fine", ",", "we", "may", "distinguish", "the", "recognition", "of", "(", "a", ")", "classes", ",", "where", "one", "looks", "for", "a", "certain", "type", "of", "object", "regardless", "of", "intra", "-", "class", "variations", ",", "(", "b", ")", "instances", ",", "where", "one", "looks", "for", "a", "particular", "object", "despite", "changes", "in", "the", "viewing", "conditions", ",", "and", "(", "c", ")", "copies", ",", "where", "one", "looks", "for", "a", "copy", "of", "a", "specific", "image", "despite", "edits", ".", "While", "these", "problems", "are", "in", "many", "ways", "similar", ",", "the", "standard", "practice", "is", "to", "use", "specialized", ",", "and", "thus", "incompatible", ",", "image", "representations", "for", "each", "case", ".", "Specialized", "representations", "may", "be", "accurate", ",", "but", "constitute", "a", "significant", "bottleneck", "in", "some", "applications", ".", "Consider", "for", "example", "image", "retrieval", ",", "where", "the", "goal", "is", "to", "match", "a", "query", "image", "to", "a", "large", "database", "of", "other", "images", ".", "Very", "often", "one", "would", "like", "to", "search", "the", "same", "database", "with", "multiple", "granularities", ",", "by", "matching", "the", "query", "by", "class", ",", "instance", ",", "or", "copy", ".", "The", "performance", "of", "an", "image", "retrieval", "system", "depends", "primarily", "on", "the", "image", "embeddings", "it", "uses", ".", "These", "strike", "a", "trade", "-", "off", "between", "database", "size", ",", "matching", "and", "indexing", "speed", ",", "and", "retrieval", "accuracy", ".", "Adopting", "multiple", "embeddings", ",", "narrowly", "optimized", "for", "each", "type", "of", "query", ",", "means", "multiplying", "the", "resource", "usage", ".", "In", "this", "paper", "we", "present", "a", "new", "representation", ",", "MultiGrain", ",", "that", "can", "achieve", "the", "three", "tasks", "together", ",", "regardless", "of", "differences", "in", "their", "semantic", "granularity", ",", "see", "fig", ":", "splash", ".", "We", "learn", "MultiGrain", "by", "jointly", "training", "an", "image", "embedding", "for", "multiple", "tasks", ".", "The", "resulting", "representation", "is", "compact", "and", "outperforms", "narrowly", "-", "trained", "embeddings", ".", "Instance", "retrieval", "has", "a", "wide", "range", "of", "industrial", "applications", ",", "including", "detection", "of", "copyrighted", "images", "and", "exemplar", "-", "based", "recognition", "of", "unseen", "objects", ".", "In", "settings", "where", "billion", "of", "images", "have", "to", "be", "treated", ",", "it", "is", "of", "interest", "to", "obtain", "image", "embeddings", "suitable", "for", "more", "than", "one", "recognition", "task", ".", "For", "instance", ",", "an", "image", "storage", "platform", "is", "likely", "to", "perform", "some", "classification", "of", "the", "input", "images", ",", "aside", "from", "detecting", "copies", "or", "instances", "of", "the", "same", "object", ".", "An", "embedding", "relevant", "to", "all", "these", "tasks", "advantageously", "reduces", "both", "the", "computing", "time", "per", "image", "and", "storage", "space", ".", "In", "this", "perspective", ",", "convolutional", "neural", "networks", "(", "CNNs", ")", "trained", "only", "for", "classification", "already", "go", "a", "long", "way", "towards", "universal", "features", "extractors", ".", "The", "fact", "that", "we", "can", "learn", "image", "embeddings", "that", "are", "simultaneously", "good", "for", "classification", "and", "instance", "retrieval", "is", "surprising", "but", "not", "contradictory", ".", "In", "fact", ",", "there", "is", "a", "logical", "dependence", "between", "the", "tasks", ":", "images", "that", "contain", "the", "same", "instance", "also", "contain", ",", "by", "definition", ",", "the", "same", "class", ";", "and", "copied", "images", "contain", "the", "same", "instance", ".", "This", "is", "in", "contrast", "to", "multi", "-", "task", "settings", "where", "tasks", "are", "in", "competition", "and", "are", "thus", "difficult", "to", "combine", ".", "Instead", ",", "both", "class", ",", "instance", ",", "and", "copy", "congruency", "lead", "to", "embeddings", "that", "should", "be", "close", "in", "feature", "space", ".", "Still", ",", "the", "degree", "of", "similarity", "is", "different", "in", "the", "different", "cases", ",", "with", "classification", "requiring", "more", "invariance", "to", "appearance", "variations", "and", "copy", "detection", "sensitivity", "to", "small", "image", "details", ".", "In", "order", "to", "learn", "an", "image", "representation", "that", "satisfies", "the", "different", "trade", "-", "offs", ",", "we", "start", "from", "an", "existing", "image", "classification", "network", ".", "We", "use", "a", "generalized", "mean", "layer", "that", "converts", "a", "spatial", "activation", "map", "to", "a", "fixed", "-", "size", "vector", ".", "Most", "importantly", ",", "we", "show", "that", "it", "is", "an", "effective", "way", "to", "learn", "an", "architecture", "that", "can", "adapt", "to", "different", "resolutions", "at", "test", "time", ",", "and", "offer", "higher", "accuracies", ".", "This", "circumvents", "the", "massive", "engineering", "and", "computational", "effort", "needed", "to", "learn", "networks", "for", "larger", "input", "resolutions", "The", "joint", "training", "of", "classification", "and", "instance", "recognition", "objectives", "is", "based", "on", "cross", "-", "entropy", "and", "contrastive", "losses", ",", "respectively", ".", "Remarkably", ",", "instance", "recognition", "is", "learned", "for", "free", ",", "without", "using", "labels", "specific", "to", "instance", "recognition", "or", "image", "retrieval", ":", "we", "simply", "use", "the", "identity", "of", "the", "images", "as", "labels", ",", "and", "data", "augmentation", "as", "a", "way", "to", "generate", "different", "versions", "of", "each", "image", ".", "In", "summary", ",", "our", "main", "contributions", "are", "as", "follows", ":", "We", "introduce", "the", "MultiGrain", "architecture", ",", "which", "outputs", "an", "image", "embedding", "incorporating", "different", "levels", "of", "granularity", ".", "Our", "dual", "classification", "+", "instance", "objective", "improves", "the", "classification", "accuracy", "on", "its", "own", ".", "We", "show", "that", "part", "of", "this", "gain", "is", "due", "to", "the", "batching", "strategy", ",", "where", "each", "batch", "contains", "repeated", "instances", "of", "its", "images", "with", "different", "data", "augmentations", "for", "the", "purpose", "of", "the", "retrieval", "loss", ";", "We", "incorporate", "a", "pooling", "layer", "inspired", "by", "image", "retrieval", ".", "It", "provides", "a", "significant", "boost", "in", "classification", "accuracy", "when", "provided", "with", "high", "-", "resolution", "images", ".", "Overall", ",", "our", "architecture", "offers", "competing", "performance", "both", "for", "classification", "and", "image", "retrieval", ".", "Noticeably", ",", "we", "report", "a", "significant", "boost", "in", "accuracy", "on", "Imagenet", "with", "a", "ResNet", "-", "50", "network", "over", "the", "state", "of", "the", "art", ".", "The", "paper", "is", "organized", "as", "follows", ".", "sec", ":", "related", "introduces", "related", "works", ".", "sec", ":", "arch", "introduces", "our", "architecture", ",", "the", "training", "procedure", "and", "explains", "how", "we", "adapt", "the", "resolution", "at", "test", "time", ".", "sec", ":", "experiments", "reports", "the", "main", "experiments", ".", "section", ":", "Related", "work", "paragraph", ":", "Image", "classification", ".", "Most", "computer", "vision", "architectures", "designed", "for", "a", "wide", "range", "of", "tasks", "leverage", "a", "trunk", "architecture", "initially", "designed", "for", "classification", ",", "such", "as", "Residual", "networks", ".", "An", "improvement", "on", "the", "trunk", "architecture", "eventually", "translates", "to", "better", "accuracies", "in", "other", "tasks", ",", "as", "shown", "on", "the", "detection", "task", "of", "the", "LSVRC\u201915", "challenge", ".", "While", "recent", "architectures", "have", "exhibited", "some", "additional", "gains", ",", "other", "lines", "of", "research", "have", "been", "investigated", "successfully", ".", "For", "instance", ",", "a", "recent", "trend", "is", "to", "train", "high", "capacity", "networks", "by", "leveraging", "much", "larger", "training", "sets", "of", "of", "weakly", "annotated", "data", ".", "To", "our", "knowledge", ",", "the", "state", "of", "the", "art", "on", "Imagenet", "ILSVRC", "2012", "benchmark", "for", "a", "model", "learned", "from", "scratch", "on", "Imagenet", "train", "data", "only", "is", "currently", "hold", "by", "the", "gigantic", "AmoebaNet", "-", "B", "architecture", "(", "557", "M", "parameters", ")", ",", "which", "takes", "480x480", "images", "as", "input", ".", "In", "our", "paper", ",", "we", "choose", "ResNet", "-", "50", "(", "25.6", "M", "parameters", ")", ",", "as", "this", "architecture", "is", "adopted", "in", "the", "literature", "in", "many", "works", "both", "on", "image", "classification", "and", "instance", "retrieval", ".", "paragraph", ":", "Image", "search", ":", "from", "local", "features", "to", "CNN", ".", "\u201c", "Image", "search", "\u201d", "is", "a", "generic", "retrieval", "task", "that", "is", "usually", "associated", "with", "and", "evaluated", "for", "more", "specific", "problems", "such", "as", "landmark", "recognition", ",", "particular", "object", "recognition", "or", "copy", "detection", ",", "for", "which", "the", "objective", "is", "to", "find", "the", "images", "most", "similar", "to", "the", "query", "in", "a", "large", "image", "collection", ".", "In", "this", "paper", "\u201c", "image", "retrieval", "\u201d", "will", "refer", "to", "instance", "-", "level", "retrieval", ",", "where", "object", "instances", "are", "as", "broad", "as", "possible", ",", "not", "restricted", "to", "buildings", ",", "as", "in", "the", "Oxford", "/", "Paris", "benchmark", ".", "Effective", "systems", "for", "image", "retrieval", "rely", "on", "accurate", "image", "descriptors", ".", "Typically", ",", "a", "query", "image", "is", "described", "by", "an", "embedding", "vector", ",", "and", "the", "task", "amounts", "to", "searching", "the", "nearest", "neighbors", "of", "this", "vector", "in", "the", "embedding", "space", ".", "Possible", "improvement", "include", "refinement", "steps", "such", "as", "geometric", "verification", ",", "query", "expansion", ",", "or", "database", "-", "side", "pre", "-", "processing", "or", "augmentation", ".", "Local", "image", "descriptors", "are", "traditionally", "aggregated", "to", "global", "image", "descriptors", "suited", "for", "matching", "in", "an", "inverted", "database", ",", "as", "in", "the", "seminal", "bag", "-", "of", "-", "words", "model", ".", "After", "the", "emergence", "of", "convolutional", "neural", "networks", "(", "CNNs", ")", "for", "large", "-", "scale", "classification", "on", "ImageNet", ",", "it", "has", "become", "apparent", "that", "CNNs", "trained", "on", "classification", "datasets", "are", "very", "competitive", "image", "feature", "extractors", "for", "various", "vision", "tasks", ",", "including", "instance", "retrieval", ".", "paragraph", ":", "Specific", "architectures", "for", "particular", "object", "retrieval", "are", "built", "upon", "a", "regular", "classification", "trunk", ",", "and", "modified", "so", "the", "pooling", "stage", "gives", "more", "spatial", "locality", "in", "order", "to", "cope", "with", "small", "objects", "and", "clutter", ".", "For", "instance", ",", "a", "competitive", "baseline", "for", "instance", "retrieval", "on", "various", "datasets", "is", "the", "R", "-", "MAC", "image", "descriptor", ".", "It", "aggregates", "regionally", "pooled", "features", "extracted", "from", "a", "CNN", ".", "The", "authors", "show", "that", "this", "specialized", "pooling", "combined", "with", "PCA", "whitening", "leads", "to", "efficient", "many", "-", "to", "-", "many", "comparisons", "between", "image", "regions", ",", "highly", "beneficial", "to", "image", "retrieval", ".", "Gordo", "et", "al", ".", "show", "that", "fine", "-", "tuning", "these", "regionally", "-", "aggregated", "representations", "end", "-", "to", "-", "end", "on", "an", "external", "image", "retrieval", "dataset", "using", "a", "ranking", "loss", "yields", "significant", "improvements", "for", "instance", "retrieval", ".", "Radenovi\u0107", "show", "that", "R", "-", "MAC", "pooling", "is", "advantageously", "replaced", "by", "a", "generalized", "mean", "pooling", "(", "see", "sec", ":", "p", "-", "pooling", ")", ",", "which", "is", "a", "spatial", "pooling", "of", "the", "features", "exponentiated", "to", "an", "exponent", "over", "the", "whole", "image", ".", "The", "exponentiation", "localizes", "the", "features", "on", "the", "point", "of", "interests", "in", "the", "image", ",", "replacing", "regional", "aggregation", "in", "R", "-", "MAC", ".", "paragraph", ":", "Multi", "-", "task", "training", "is", "an", "active", "area", "of", "research", ",", "motivated", "by", "the", "observation", "that", "deep", "neural", "networks", "are", "transferable", "to", "a", "wide", "range", "of", "vision", "tasks", ".", "Moreover", "trained", "deep", "neural", "networks", "exhibit", "a", "high", "level", "of", "compressibility", ".", "In", "some", "cases", ",", "sharing", "the", "capacity", "of", "neural", "networks", "between", "different", "tasks", "through", "shared", "parameters", "helps", "the", "learning", "by", "allowing", "complementary", "training", "among", "datasets", "and", "low", "-", "level", "features", ".", "Despite", "some", "successes", "with", "multi", "-", "task", "networks", "for", "vision", "such", "as", "UberNet", ",", "the", "design", "and", "training", "of", "multi", "-", "task", "networks", "still", "involve", "numerous", "heuristics", ".", "Ongoing", "lines", "of", "work", "include", "finding", "the", "right", "architecture", "for", "an", "efficient", "sharing", "of", "parameters", ",", "and", "finding", "the", "right", "optimization", "parameters", "for", "such", "networks", "in", "order", "to", "depart", "from", "the", "traditional", "setting", "of", "single", "-", "task", "single", "-", "dataset", "end", "-", "to", "-", "end", "gradient", "descent", ",", "and", "efficiently", "weight", "the", "gradients", "in", "order", "to", "obtain", "a", "well", "-", "performing", "network", "in", "all", "tasks", ".", "paragraph", ":", "Data", "augmentation", "is", "a", "cornerstone", "of", "the", "training", "in", "large", "-", "scale", "vision", "applications", ",", "which", "improves", "generalization", "and", "reduces", "over", "-", "fitting", ".", "In", "a", "stochastic", "gradient", "descent", "(", "SGD", ")", "optimization", "setting", ",", "we", "show", "that", "including", "multiple", "data", "-", "augmented", "instances", "of", "the", "same", "image", "in", "one", "optimization", "batch", ",", "rather", "than", "having", "only", "distinct", "images", "in", "the", "batch", ",", "significantly", "enhances", "the", "effect", "of", "data", "-", "augmentations", "and", "improve", "the", "generalization", "of", "the", "network", ".", "A", "related", "batch", "augmented", "(", "BA", ")", "sampling", "strategy", "was", "concurrently", "introduced", "by", "Hoffer", "et", "al", ".", ".", "When", "augmenting", "the", "size", "of", "the", "batches", "in", "a", "large", "-", "scale", "distributed", "optimization", "of", "a", "neural", "network", ",", "they", "show", "that", "filling", "these", "bigger", "batches", "with", "data", "-", "augmented", "copies", "of", "the", "image", "in", "the", "batch", "yields", "better", "generalization", "performance", ",", "and", "uses", "computing", "resources", "more", "efficiently", "through", "reduced", "data", "processing", "time", ".", "As", "discussed", "in", "sec", ":", "data", "-", "augmented", "-", "batches", "and", "highlighted", "in", "our", "classification", "results", "(", "sec", ":", "classif", "-", "results", ")", ",", "we", "show", "that", "a", "gain", "in", "performance", "under", "this", "sampling", "scheme", "is", "obtained", "using", "the", "same", "batch", "size", ",", ",", "with", "a", "lower", "number", "of", "distinct", "images", "per", "batch", ".", "We", "consider", "this", "scheme", "of", "repeated", "augmentations", "(", "RA", ")", "within", "the", "batch", "as", "a", "way", "to", "boost", "the", "effect", "of", "data", "augmentation", "over", "the", "course", "of", "the", "optimization", ".", "Our", "results", "indicate", "that", "RA", "is", "a", "technique", "of", "general", "interest", ",", "beyond", "large", "-", "scale", "distributed", "training", "applications", ",", "for", "improving", "the", "generalization", "of", "neural", "networks", ".", "section", ":", "Architecture", "design", "Our", "goal", "is", "to", "develop", "a", "convolutional", "neural", "network", "that", "is", "suitable", "for", "both", "image", "classification", "and", "instance", "retrieval", ".", "In", "the", "current", "best", "practices", ",", "the", "architectures", "and", "training", "procedures", "used", "for", "class", "and", "instance", "recognition", "differ", "in", "a", "significant", "manner", ".", "This", "section", "describes", "such", "technical", "differences", ",", "summarized", "in", "tab", ":", "diff_classif_instance", ",", "together", "with", "our", "solutions", "to", "bridge", "them", ".", "This", "leads", "us", "to", "a", "unified", "architecture", ",", "shown", "in", "fig:3arch", ",", "that", "we", "jointly", "train", "for", "both", "tasks", "in", "an", "end", "-", "to", "-", "end", "manner", ".", "subsection", ":", "Spatial", "pooling", "operators", "This", "section", "considers", "the", "final", ",", "global", "spatial", "pooling", "layer", ".", "Local", "pooling", "operators", ",", "usually", "max", "pooling", ",", "are", "found", "throughout", "the", "layers", "of", "most", "convolutional", "networks", "to", "achieve", "local", "invariance", "to", "small", "translations", ".", "By", "contrast", ",", "global", "spatial", "pooling", "converts", "a", "3D", "tensor", "of", "activations", "produced", "by", "a", "convolutional", "trunk", "to", "a", "vector", ".", "paragraph", ":", "Classification", ".", "In", "early", "models", "such", "as", "LeNet", "-", "5", "or", "AlexNet", ",", "the", "final", "spatial", "pooling", "is", "just", "a", "linearization", "of", "the", "activation", "map", ".", "It", "is", "therefore", "sensitive", "to", "the", "absolute", "location", ".", "Recent", "architectures", "such", "as", "ResNet", "and", "DenseNet", "employ", "average", "pooling", ",", "which", "is", "permutation", "invariant", "and", "hence", "offers", "a", "more", "global", "translation", "invariance", ".", "paragraph", ":", "Image", "retrieval", "requires", "more", "localized", "geometric", "information", ":", "particular", "objects", "or", "landmarks", "are", "visually", "more", "similar", ",", "but", "the", "task", "suffers", "more", "from", "clutter", ",", "and", "a", "given", "query", "image", "has", "no", "specific", "training", "data", "devoted", "to", "it", ".", "This", "is", "why", "the", "pooling", "operator", "tries", "to", "favor", "more", "locality", ".", "Next", "we", "discuss", "the", "generalized", "mean", "pooling", "operator", ".", "Let", "be", "the", "feature", "tensor", "computed", "by", "a", "convolutional", "neural", "network", "for", "a", "given", "image", ",", "where", "is", "the", "number", "of", "feature", "channels", "and", "and", "are", "the", "height", "and", "width", "of", "the", "map", ",", "respectively", ".", "We", "denote", "by", "a", "\u201c", "pixel", "\u201d", "in", "the", "map", ",", "by", "the", "channel", ",", "and", "by", "the", "corresponding", "tensor", "element", ":", ".", "The", "generalized", "mean", "pooling", "(", "GeM", ")", "layer", "computes", "the", "generalized", "mean", "of", "each", "channel", "in", "a", "tensor", ".", "Formally", ",", "the", "GeM", "embedding", "is", "given", "by", "where", "is", "a", "parameter", ".", "Setting", "this", "exponent", "as", "increases", "the", "contrast", "of", "the", "pooled", "feature", "map", "and", "focuses", "on", "the", "salient", "features", "of", "the", "image", ".", "GeM", "is", "a", "generalization", "of", "the", "average", "pooling", "commonly", "used", "in", "classification", "networks", "(", ")", "and", "of", "spatial", "max", "-", "pooling", "layer", "(", ")", ".", "It", "is", "employed", "in", "the", "original", "R", "-", "MAC", "as", "an", "approximation", "of", "max", "pooling", ",", "yet", "only", "recently", "it", "was", "shown", "to", "be", "competitive", "on", "its", "own", "with", "R", "-", "MAC", "for", "image", "retrieval", ".", "To", "the", "best", "of", "our", "knowledge", ",", "this", "paper", "is", "the", "first", "to", "apply", "and", "evaluate", "GeM", "pooling", "in", "an", "image", "classification", "setting", ".", "More", "importantly", ",", "we", "show", "later", "in", "this", "paper", "that", "adjusting", "the", "exponent", "is", "an", "effective", "way", "to", "change", "the", "input", "image", "resolution", "between", "train", "and", "test", "time", "for", "all", "tasks", ",", "which", "explains", "why", "image", "retrieval", "has", "benefited", "from", "it", "considering", "that", "this", "task", "employs", "higher", "-", "resolution", "images", ".", "subsection", ":", "Training", "objective", "In", "order", "to", "combine", "the", "classification", "and", "retrieval", "tasks", ",", "we", "use", "a", "joint", "objective", "function", "composed", "of", "a", "classification", "loss", "and", "an", "instance", "retrieval", "loss", ".", "The", "two", "-", "branch", "architecture", "is", "illustrated", "in", "fig:3arch", "and", "detailed", "next", ".", "paragraph", ":", "Classification", "loss", ".", "For", "classification", ",", "we", "adopt", "the", "standard", "cross", "-", "entropy", "loss", ".", "Formally", ",", "let", "be", "the", "embedding", "computed", "by", "the", "deep", "network", "for", "image", ",", "the", "parameters", "of", "a", "linear", "classifier", "for", "class", ",", "and", "be", "the", "ground", "-", "truth", "class", "for", "that", "image", ".", "Then", "where", ".", "We", "omit", "it", "for", "simplicity", ",", "but", "by", "adding", "a", "constant", "channel", "to", "the", "feature", "vector", ",", "the", "bias", "of", "the", "classification", "layer", "is", "incorporated", "in", "its", "weight", "matrix", ".", "paragraph", ":", "Retrieval", "loss", ".", "For", "image", "retrieval", ",", "the", "embeddings", "of", "two", "matching", "images", "(", "a", "positive", "pair", ")", "should", "have", "distances", "smaller", "than", "embeddings", "of", "non", "-", "matching", "images", "(", "a", "negative", "pair", ")", ".", "This", "can", "be", "enforced", "in", "two", "ways", ".", "The", "contrastive", "loss", "requires", "distances", "between", "positive", "pairs", "to", "be", "smaller", "than", "a", "threshold", ",", "and", "distances", "between", "negative", "pairs", "to", "be", "greater", ".", "The", "triplet", "loss", "instead", "requires", "an", "image", "to", "be", "closer", "to", "a", "positive", "sibling", "than", "to", "a", "negative", "sibling", ",", "which", "is", "relative", "property", "of", "image", "triplets", ".", "These", "losses", "requires", "adjusting", "multiple", "parameters", ",", "including", "how", "pairs", "and", "triplets", "are", "sampled", ".", "These", "parameters", "are", "sometimes", "hard", "to", "tune", ",", "especially", "for", "the", "triplet", "loss", ".", "Wu", "et", "al", ".", "proposed", "an", "effective", "method", "that", "addresses", "these", "difficulties", ".", "Given", "a", "batch", "of", "images", ",", "they", "re", "-", "normalize", "their", "embeddings", "to", "the", "unit", "sphere", ",", "sample", "negative", "pairs", "as", "a", "function", "of", "the", "embedding", "similarity", ",", "and", "use", "those", "pairs", "in", "a", "margin", "loss", ",", "a", "variant", "of", "contrastive", "loss", "that", "shares", "some", "of", "the", "benefits", "of", "the", "triplet", "loss", ".", "In", "more", "detail", ",", "given", "images", "in", "a", "batch", "with", "embeddings", ",", "the", "margin", "loss", "is", "expressed", "as", "where", "is", "the", "Euclidean", "distance", "between", "the", "normalized", "embeddings", ",", "the", "label", "is", "equal", "to", "1", "if", "the", "two", "images", "match", "and", "otherwise", ",", "the", "margin", "(", "a", "constant", "hyper", "-", "parameter", ")", ",", "and", "is", "a", "parameter", "(", "learned", "during", "training", "together", "with", "the", "model", "parameters", ")", ",", "controlling", "the", "volume", "of", "the", "embedding", "space", "occupied", "embedding", "vectors", ".", "Due", "to", "the", "normalization", ",", "is", "equivalent", "to", "a", "cosine", "similarity", ",", "which", ",", "up", "to", "whitening", "(", "sec", ":", "whiten", ")", ",", "is", "also", "used", "in", "retrieval", ".", "Loss", "(", "[", "reference", "]", ")", "is", "computed", "on", "a", "subset", "of", "positive", "and", "negative", "pairs", "selected", "with", "the", "sampling", "where", "the", "conditional", "probability", "of", "choosing", "a", "negative", "for", "image", "is", "where", "is", "a", "parameter", "and", "is", "a", "PDF", "that", "depends", "on", "the", "embedding", "dimension", ".", "The", "use", "of", "distance", "weighted", "-", "sampling", "with", "margin", "loss", "is", "very", "suited", "to", "our", "joint", "training", "setting", ":", "this", "framework", "tolerates", "relatively", "small", "batch", "sizes", "(", "to", "instances", ")", "while", "requiring", "only", "a", "small", "amount", "of", "positives", "images", "(", "3", "to", "5", ")", "of", "each", "instance", "in", "the", "batch", ",", "without", "the", "need", "for", "elaborate", "parameter", "tuning", "or", "offline", "sampling", ".", "paragraph", ":", "Joint", "loss", "and", "architecture", ".", "The", "joint", "loss", "is", "a", "combination", "of", "classification", "and", "retrieval", "loss", "weighted", "by", "a", "factor", ".", "For", "a", "batch", "of", "images", ",", "the", "joint", "loss", "writes", "as", ",", "losses", "are", "normalized", "by", "the", "number", "of", "items", "in", "the", "corresponding", "summations", ".", "subsection", ":", "Batching", "with", "repeated", "augmentation", "(", "RA", ")", "Here", ",", "we", "propose", "to", "use", "only", "a", "training", "dataset", "for", "image", "classification", ",", "and", "train", "instance", "recognition", "via", "data", "augmentation", ".", "The", "rationale", "is", "that", "data", "augmentation", "produces", "another", "image", "that", "contains", "the", "same", "object", "instance", ".", "This", "approach", "does", "not", "require", "more", "annotation", "beyond", "the", "standard", "classification", "set", ".", "We", "introduce", "a", "new", "sampling", "scheme", "for", "training", "with", "SGD", "and", "data", "augmentation", ",", "which", "we", "refer", "to", "as", "repeated", "augmentations", ".", "In", "RA", "we", "form", "an", "image", "batch", "by", "sampling", "different", "images", "from", "the", "dataset", ",", "and", "transform", "them", "up", "to", "times", "by", "a", "set", "of", "data", "augmentations", "to", "fill", "the", "batch", ".", "Thus", ",", "the", "instance", "level", "ground", "-", "truth", "iff", "images", "and", "are", "two", "augmented", "versions", "of", "the", "same", "training", "image", ".", "The", "key", "difference", "with", "the", "standard", "sampling", "scheme", "in", "SGD", "is", "that", "samples", "are", "not", "independent", ",", "as", "augmented", "versions", "of", "the", "same", "image", "are", "highly", "correlated", ".", "While", "this", "strategy", "reduces", "the", "performance", "if", "the", "batch", "size", "is", "small", ",", "for", "larger", "batch", "sizes", "RA", "outperforms", "the", "standard", "i.i.d", ".", "scheme", "\u2013", "while", "using", "the", "same", "batch", "size", "and", "learning", "rate", "for", "both", "schemes", ".", "This", "is", "different", "from", "the", "observation", "of", ",", "who", "also", "consider", "repeated", "samples", "in", "a", "batch", ",", "but", "simultaneously", "increase", "the", "size", "of", "the", "latter", ".", "We", "conjecture", "that", "the", "benefit", "of", "correlated", "RA", "samples", "is", "to", "facilitate", "learning", "features", "that", "are", "invariant", "to", "the", "only", "difference", "between", "the", "repeated", "images", "\u2014", "the", "augmentations", ".", "By", "comparison", ",", "with", "standard", "SGD", "sampling", ",", "two", "versions", "of", "the", "same", "image", "are", "seen", "only", "in", "different", "epochs", ".", "A", "study", "of", "an", "idealized", "problem", "illustrates", "this", "phenomenon", "in", "the", "supplementary", "material", "[", "reference", "]", ".", "subsection", ":", "PCA", "whitening", "In", "order", "to", "transfer", "features", "learned", "via", "data", "augmentation", "to", "standard", "retrieval", "datasets", ",", "we", "apply", "a", "step", "of", "PCA", "whitening", ",", "in", "accordance", "with", "previous", "works", "in", "image", "retrieval", ".", "The", "Euclidean", "distance", "between", "transformed", "features", "is", "equivalent", "to", "the", "Mahalanobis", "distance", "between", "the", "input", "descriptors", ".", "This", "is", "done", "after", "training", "the", "network", ",", "using", "an", "external", "dataset", "of", "unlabelled", "images", ".", "The", "effect", "of", "PCA", "whitening", "can", "be", "undone", "in", "the", "parameters", "of", "the", "classification", "layer", ",", "so", "that", "the", "whitened", "embeddings", "can", "be", "used", "for", "both", "classification", "and", "instance", "retrieval", ".", "In", "detail", ",", "let", "be", "an", "image", "embedding", "vector", "and", "the", "weight", "vector", "for", "class", ",", "such", "that", "are", "the", "outputs", "of", "the", "classifier", "as", "in", "eq", ":", "crossent", ".", "The", "whitening", "operation", "can", "be", "written", "as", "given", "the", "whitening", "matrix", "and", "centering", "vector", ";", "hence", "where", "and", "are", "the", "modified", "weight", "and", "bias", "for", "class", ".", "We", "observed", "that", "inducing", "decorrelation", "via", "a", "loss", "is", "insufficient", "to", "ensure", "that", "features", "generalize", "well", ",", "which", "concurs", "with", "prior", "works", ".", "subsection", ":", "Input", "sizes", "The", "standard", "practice", "in", "image", "classification", "is", "to", "resize", "and", "center", "-", "crop", "input", "images", "to", "a", "relatively", "low", "resolution", ",", "e.g.", "pixels", ".", "The", "benefits", "are", "a", "smaller", "memory", "footprint", ",", "faster", "inference", ",", "and", "the", "possibility", "of", "batching", "the", "inputs", "if", "they", "are", "cropped", "to", "a", "common", "size", ".", "On", "the", "other", "hand", ",", "image", "retrieval", "is", "typically", "dependent", "on", "finer", "details", "in", "the", "images", ",", "as", "an", "instance", "can", "be", "seen", "under", "a", "variety", "of", "scales", ",", "and", "cover", "only", "a", "small", "amount", "of", "pixels", ".", "The", "currently", "best", "-", "performing", "feature", "extractors", "for", "image", "retrieval", "therefore", "commonly", "use", "input", "sizes", "of", "or", "pixels", "for", "the", "largest", "side", ",", "without", "cropping", "the", "image", "to", "a", "square", ".", "This", "is", "impractical", "for", "end", "-", "to", "-", "end", "training", "of", "a", "joint", "classification", "and", "retrieval", "network", ".", "Instead", ",", "we", "train", "our", "architecture", "at", "the", "standard", "resolution", ",", "and", "use", "larger", "input", "resolutions", "at", "test", "time", "only", ".", "This", "is", "possible", "due", "to", "a", "key", "advantage", "of", "our", "architecture", ":", "a", "network", "trained", "with", "a", "pooling", "exponent", "and", "resolution", "can", "be", "evaluated", "at", "a", "larger", "resolution", "using", "a", "larger", "pooling", "exponent", ",", "see", "our", "validation", "in", "sec", ":", "classif", "-", "results", ".", "paragraph", ":", "Proxy", "task", "for", "cross", "-", "validation", "of", ".", "In", "order", "to", "select", "the", "exponent", ",", "suitable", "for", "all", "tasks", ",", "we", "create", "a", "synthetic", "retrieval", "task", "IN", "-", "aug", "in", "between", "classification", "and", "retrieval", ".", "We", "sample", "images", "from", "the", "training", "set", "of", "ImageNet", ",", "per", "class", ",", "and", "create", "5", "augmented", "copies", "of", "each", "of", "them", ",", "using", "the", "\u201c", "full", "\u201d", "data", "augmentation", "described", "before", ".", "We", "evaluate", "the", "retrieval", "accuracy", "on", "IN", "-", "aug", "in", "a", "fashion", "similar", "to", "UKBench", ",", "with", "an", "accuracy", "ranging", "from", "0", "to", "5", "depending", "measuring", "how", "many", "of", "the", "first", "5", "augmentations", "are", "ranked", "in", "top", "5", "positions", ".", "We", "pick", "the", "best", "-", "performing", "on", "IN", "-", "aug", ",", "which", "provides", "the", "following", "choices", "as", "a", "function", "of", "and", ":", "The", "optimal", "obtained", "on", "IN", "-", "aug", "provides", "a", "trade", "-", "off", "between", "retrieval", "and", "classification", ".", "Experimentally", ",", "we", "observed", "that", "other", "choices", "are", "suitable", "for", "setting", "this", "parameter", ":", "fine", "-", "tuning", "the", "parameter", "alone", "using", "training", "inputs", "at", "a", "given", "resolution", "by", "back", "-", "propagation", "of", "the", "cross", "-", "entropy", "loss", "provides", "similar", "results", "and", "values", "of", ".", "section", ":", "Experiments", "and", "Results", "After", "presenting", "the", "datasets", ",", "we", "provide", "a", "parametric", "study", "and", "our", "results", "in", "image", "classification", "and", "retrieval", ".", "subsection", ":", "Experimental", "settings", "paragraph", ":", "Base", "architecture", "and", "training", "settings", ".", "The", "convolutional", "trunk", "is", "ResNet", "-", "50", ".", "SGD", "starts", "with", "a", "learning", "rate", "of", "which", "is", "reduced", "tenfold", "at", "epochs", "for", "a", "total", "of", "epochs", "(", "a", "standard", "setting", ")", ".", "The", "batch", "size", "is", "set", "to", "and", "an", "epoch", "is", "defined", "as", "a", "fixed", "number", "of", "iterations", ".", "With", "uniform", "batch", "sampling", ",", "one", "epoch", "corresponds", "to", "two", "passes", "over", "the", "training", "set", ";", "with", "RA", "and", ",", "one", "epoch", "corresponds", "to", "of", "the", "images", "of", "the", "training", "set", ".", "All", "classification", "baselines", "are", "trained", "using", "this", "longer", "schedule", "for", "a", "fair", "comparison", ".", "paragraph", ":", "Data", "augmentation", ".", "We", "use", "standard", "flips", ",", "random", "resized", "crops", ",", "random", "lighting", "noise", "and", "a", "color", "jittering", "of", "brightness", ",", "contrast", "and", "saturation", ".", "We", "refer", "to", "this", "set", "of", "augmentations", "as", "\u201c", "full", "\u201d", ",", "see", "details", "in", "supplemental", "[", "reference", "]", ".", "As", "indicated", "in", "tab", ":", "classifres", "our", "network", "reaches", "%", "top", "-", "1", "validation", "error", "under", "our", "chosen", "schedule", "and", "data", "augmentation", "when", "trained", "with", "cross", "-", "entropy", "alone", "and", "uniform", "batch", "sampling", ".", "This", "figure", "is", "on", "the", "high", "end", "of", "accuracies", "reported", "for", "the", "ResNet", "-", "50", "network", "without", "specially", "-", "crafted", "regularization", "terms", "or", "data", "augmentations", ".", "Input", "image", "resolution", "full", "resolution", "paragraph", ":", "Pooling", "exponent", ".", "During", "the", "end", "-", "to", "-", "end", "training", "of", "our", "network", ",", "we", "consider", "two", "settings", "for", "the", "pooling", "exponent", "in", "the", "GeM", "layer", "of", "sec", ":", "p", "-", "pooling", ":", "we", "set", "either", "or", ".", "corresponds", "to", "average", "pooling", ",", "as", "used", "in", "classification", "architectures", ".", "The", "relevant", "literature", "and", "our", "preliminary", "experiments", "on", "off", "-", "the", "-", "shelf", "classification", "networks", "suggest", "that", "the", "value", "improves", "the", "retrieval", "performance", "on", "standard", "benchmarks", ".", "fig", ":", "heatmap", "illustrates", "this", "choice", ".", "By", "setting", ",", "the", "car", "is", "detected", "with", "high", "confidence", "and", "without", "spurious", "detections", ".", "Boureau", "analyse", "average", "-", "and", "max", "-", "pooling", "of", "sparse", "features", ".", "They", "find", "that", "when", "the", "number", "of", "pooled", "features", "increases", ",", "it", "is", "beneficial", "to", "make", "them", "more", "sparse", ",", "which", "is", "consistent", "with", "the", "observation", "we", "make", "here", ".", "paragraph", ":", "Input", "size", "and", "cropping", ".", "As", "described", "in", "sec", ":", "input", "-", "size", ",", "we", "train", "our", "network", "on", "crops", "of", "size", "pixels", ".", "For", "testing", ",", "we", "experiment", "with", "computing", "MultiGrain", "embeddings", "at", "resolutions", ".", "For", "resolution", ",", "we", "follow", "the", "classical", "image", "classification", "protocol", "\u201c", "resolution", "224", "\u201d", ":", "the", "smallest", "side", "of", "an", "image", "is", "resized", "to", "and", "then", "a", "central", "crop", "is", "extracted", ".", "For", "resolution", ",", "we", "instead", "follow", "the", "protocol", "common", "in", "image", "retrieval", "and", "resize", "the", "largest", "side", "of", "the", "image", "to", "the", "desired", "number", "of", "pixels", "and", "evaluate", "the", "network", "on", "the", "rectangular", "image", ",", "without", "cropping", ".", "paragraph", ":", "Margin", "loss", "and", "batch", "sampling", ".", "We", "use", "3", "data", "-", "augmented", "repetitions", "per", "batch", ".", "We", "use", "the", "default", "margin", "loss", "hyperparameters", "of", "(", "details", "in", "supplementary", "[", "reference", "]", ")", ".", "As", "in", "the", "distance", "-", "weighted", "sampling", "is", "performed", "independently", "on", "each", "of", "the", "4", "GPUs", "used", "for", "training", ".", "paragraph", ":", "Datasets", ".", "We", "train", "our", "networks", "on", "the", "ImageNet", "-", "2012", "training", "set", "of", "1.2", "million", "images", "labelled", "into", "object", "categories", ".", "Classification", "accuracies", "are", "reported", "on", "the", "validation", "images", "of", "this", "dataset", ".", "For", "image", "retrieval", ",", "we", "report", "the", "mean", "average", "precision", "on", "the", "Holidays", "dataset", ",", "with", "images", "rotated", "manually", "when", "necessary", ",", "as", "in", "prior", "evaluations", "on", "this", "dataset", ".", "We", "also", "report", "the", "accuracy", "on", "the", "UKB", "object", "recognition", "benchmark", ",", "which", "contains", "instances", "of", "objects", "under", "varying", "viewpoints", "each", ";", "each", "image", "is", "used", "as", "a", "query", "to", "find", "its", "4", "closest", "neighbors", "in", "embedding", "space", ";", "the", "number", "of", "correct", "neighbors", "is", "averaged", "across", "all", "images", ",", "yielding", "a", "maximum", "score", "of", ".", "We", "also", "report", "the", "performance", "of", "our", "network", "in", "a", "copy", "detection", "setting", ",", "indicating", "the", "mean", "average", "precision", "on", "the", "\u201c", "strong", "\u201d", "subset", "of", "the", "INRIA", "Copydays", "dataset", ".", "We", "add", "10", "K", "distractor", "images", "randomly", "sampled", "from", "the", "YFCC100", "M", "large", "-", "scale", "collection", "of", "unlabelled", "images", ".", "We", "call", "the", "combination", "C10k", ".", "The", "PCA", "whitening", "transformations", "are", "computed", "from", "the", "features", "of", "20", "K", "images", "from", "YFCC100", "M", ",", "distinct", "from", "the", "C10k", "distractors", ".", "subsection", ":", "Expanding", "resolution", "with", "pooling", "exponent", "[", "t", "]", "0.42", "[", "t", "]", "0.42", "[", "t", "]", "0.13", "As", "our", "reference", "scheme", ",", "we", "train", "the", "network", "at", "resolution", "224x224", "with", "RA", "sampling", "and", "pooling", "exponent", ".", "When", "testing", "on", "images", "with", "the", "same", "224x224", "resolution", ",", "this", "gives", "a", "top", "-", "1", "validation", "accuracy", "on", "Imagenet", ",", "%", "points", "above", "the", "non", "-", "RA", "baseline", ",", "see", "tab", ":", "classifres", ".", "We", "now", "feed", "larger", "images", "at", "test", "time", ",", ",", "we", "consider", "resolutions", "and", "vary", "the", "exponents", "at", "test", "time", ".", "fig", ":", "p_scale_classif", ",", "fig", ":", "p_scale_holidays", "show", "the", "classification", "accuracy", "on", "ImageNet", "validation", "and", "the", "retrieval", "accuracy", "on", "Holidays", "at", "different", "resolutions", ",", "for", "different", "values", "of", "the", "test", "pooling", "exponent", ".", "As", "expected", ",", "at", "=", ",", "the", "pooling", "exponent", "yielding", "best", "accuracy", "in", "classification", "is", "the", "exponent", "with", "which", "the", "network", "has", "been", "trained", ",", "=", ".", "Observe", "that", "testing", "at", "larger", "scale", "requires", "an", "exponent", ",", "both", "for", "classification", "and", "for", "retrieval", ".", "In", "the", "following", ",", "we", "adopt", "the", "values", "obtained", "by", "our", "cross", "-", "validation", "on", "IN", "-", "aug", ",", "see", "sec", ":", "expanding", "-", "resolution", ".", "subsection", ":", "Analysis", "of", "the", "tradeoff", "parameter", "We", "now", "analyze", "the", "impact", "of", "the", "tradeoff", "parameter", ".", "Note", ",", "this", "parameter", "does", "not", "directly", "reflect", "the", "relative", "importance", "of", "the", "two", "loss", "terms", "during", "training", ",", "since", "these", "are", "not", "homogeneous", ":", "=", "0.5", "does", "not", "mean", "that", "they", "have", "equal", "importance", ".", "fig", ":", "gradients", "analyzes", "the", "actual", "relative", "importance", "of", "the", "classification", "and", "margin", "loss", "terms", ",", "by", "measuring", "the", "average", "norm", "of", "the", "gradient", "back", "-", "propagated", "through", "the", "network", "at", "epochs", "0", "and", "120", ".", "One", "can", "see", "that", "=", "means", "that", "the", "classification", "has", "slightly", "more", "weight", "at", "the", "beginning", "of", "the", "training", ".", "The", "classification", "term", "becomes", "dominant", "at", "the", "end", "of", "the", "training", ",", "meaning", "that", "the", "network", "has", "already", "learned", "to", "cancel", "data", "augmentation", ".", "In", "terms", "of", "performance", ",", "=", "leads", "to", "a", "poor", "classification", "accuracy", ".", "Interestingly", ",", "the", "classification", "performance", "is", "higher", "for", "the", "intermediate", "=", "(", "at", "=", ")", "than", "for", "=", ",", "see", "tab", ":", "classifres", ".", "Thus", ",", "the", "margin", "loss", "leads", "to", "a", "performance", "gain", "for", "the", "classification", "task", ".", "We", "set", "in", "our", "following", "experiments", ",", "as", "it", "gives", "the", "best", "classification", "accuracy", "at", "the", "practical", "resolutions", "and", "pixels", ".", "As", "a", "reference", ",", "we", "also", "report", "a", "few", "results", "with", ".", "subsection", ":", "Classification", "results", "From", "now", "on", ",", "our", "MultiGrain", "nets", "are", "trained", "at", "resolution", "=", "with", "exponent", "=", "(", "standard", "average", "pooling", ")", "or", "=", "in", "the", "GeM", "pooling", ".", "For", "each", "evaluation", "resolutions", "=", ",", "the", "same", "exponent", "is", "selected", "according", "to", "sec", ":", "expanding", "-", "resolution", ",", "yielding", "a", "single", "embedding", "for", "classification", "and", "for", "the", "retrieval", ".", "tab", ":", "classifres", "presents", "the", "classification", "results", ".", "There", "is", "a", "large", "improvement", "in", "classification", "performance", "from", "our", "baseline", "Resnet", "-", "50", "with", "=", ",", "=", ",", "\u201c", "full", "\u201d", "data", "augmentation", "(", "76.2", "%", "top", "-", "1", "accuracy", ")", ",", "to", "a", "MultiGrain", "model", "at", "=", ",", "=", ",", "=", "(", "78.6", "%", "top", "-", "1", ")", ".", "We", "identify", "four", "sources", "for", "this", "improvement", ":", "Repeated", "augmentations", ":", "adding", "RA", "batch", "sampling", "(", "sec", ":", "data", "-", "augmented", "-", "batches", ")", "yields", "an", "improvement", "of", ".", "Margin", "loss", ":", "the", "retrieval", "loss", "helps", "the", "generalizing", "effect", "of", "data", "augmentation", ":", ".", "pooling", ":", "GeM", "at", "training", "(", "sec", ":", "p", "-", "pooling", ")", "allows", "the", "margin", "loss", "to", "have", "a", "much", "stronger", "effect", "thanks", "to", "increased", "localization", "of", "the", "features", ":", ".", "Expanding", "resolution", ":", "evaluating", "at", "resolution", "adds", "to", "the", "MultiGrain", "network", ",", "reaching", "the", "top", "-", "1", "accuracy", ".", "This", "is", "made", "possible", "by", "the", "training", "\u2013", "which", "yields", "sparser", "features", ",", "more", "generalizable", "over", "different", "resolutions", ",", "and", "by", "the", "pooling", "adaptation", "\u2013", "without", "it", "the", "performance", "at", "this", "resolution", "is", "only", ".", "The", "selection", "for", "evaluation", "at", "higher", "resolutions", "has", "its", "limits", ":", "at", "pixels", ",", "due", "to", "the", "large", "discrepancy", "between", "the", "training", "and", "testing", "scale", "for", "the", "feature", "extractor", ",", "the", "accuracy", "drops", "to", "(", "without", "the", "adaptation", ")", ".", "paragraph", ":", "AutoAugment", "(", "AA", ")", "is", "a", "method", "to", "learn", "data", "-", "augmentation", "using", "reinforcement", "learning", "techniques", "to", "improve", "the", "accuracy", "of", "classification", "networks", "on", "ImageNet", ".", "We", "directly", "integrate", "the", "data", "-", "augmentations", "found", "by", "the", "algorithm", "trained", "on", "their", "Resnet", "-", "50", "model", "using", "a", "long", "schedule", "of", "270", "passes", "over", "the", "dataset", ",", "with", "batch", "size", ".", "We", "have", "observed", "that", "this", "longer", "training", "gives", "more", "impact", "to", "the", "AA", "-", "generated", "augmentations", ".", "We", "therefore", "use", "a", "longer", "schedule", "of", "7508", "iterations", "per", "epoch", ",", "keeping", "the", "batch", "size", "to", ".", "Our", "method", "benefits", "from", "this", "data", "-", "augmentation", ":", "MultiGrain", "reaches", "top", "-", "1", "accuracy", "at", "resolution", "with", "3", ",", "0.5", ".", "To", "the", "best", "of", "our", "knowledge", ",", "this", "is", "the", "best", "top", "-", "1", "accuracy", "reported", "for", "Resnet", "-", "50", "when", "training", "and", "evaluating", "at", "this", "resolution", ",", "significantly", "higher", "than", "the", "reported", "with", "AutoAugment", "alone", "or", "for", "mixup", ".", "Using", "a", "higher", "resolution", "at", "test", "time", "improves", "the", "accuracy", "further", ":", "we", "obtain", "top", "-", "1", "accuracy", "at", "resolution", ".", "Our", "strategy", "of", "adapting", "the", "pooling", "exponent", "to", "a", "larger", "resolution", "is", "still", "effective", ",", "and", "significantly", "outperforms", "the", "state", "of", "the", "art", "performance", "for", "a", "ResNet", "-", "50", "learned", "on", "ImageNet", "at", "training", "resolution", ".", "subsection", ":", "Retrieval", "results", "We", "present", "our", "retrieval", "results", "in", "tab", ":", "instanceres", ",", "with", "an", "ablation", "study", "and", "copy", "-", "detection", "results", "in", "the", "supplemental", "material", "(", "[", "reference", "]", ")", ".", "Our", "MultiGrain", "nets", "improve", "accuracies", "on", "all", "datasets", "with", "respect", "to", "the", "Resnet", "-", "50", "baseline", "for", "comparable", "resolutions", ".", "Repeated", "augmentations", "(", "RA", ")", "is", "again", "a", "key", "ingredient", "in", "this", "context", ".", "We", "compare", "with", "baselines", "where", "no", "annotated", "retrieval", "dataset", "is", "used", ".", "give", "off", "-", "the", "-", "shelf", "network", "accuracies", "with", "R", "-", "MAC", "pooling", ".", "MultiGrain", "compares", "favorably", "with", "their", "results", "at", "a", "comparable", "resolution", "(", "800", ")", ".", "They", "reach", "accuracies", "above", "mAP", "on", "Holidays", "but", "this", "requires", "a", "resolution", "1000", "pixels", ".", "It", "is", "also", "worth", "noting", "that", "we", "reach", "reasonable", "retrieval", "performance", "at", "resolution", "500", ",", "which", "is", "a", "interesting", "operating", "point", "with", "respect", "to", "the", "traditional", "inference", "resolutions", "\u2013", "for", "retrieval", ".", "Indeed", ",", "a", "forward", "pass", "of", "Resnet", "-", "50", "on", "16", "processor", "cores", "takes", "s", "at", "resolution", ",", "against", "s", "at", "resolution", "(", "slower", ")", ".", "Because", "of", "this", "quadratic", "increase", "in", "timing", ",", "and", "the", "single", "embedding", "computed", "by", "MultiGrain", ",", "our", "solution", "is", "particularly", "adapted", "to", "large", "-", "scale", "or", "low", "-", "resource", "vision", "applications", ".", "For", "comparison", ",", "we", "also", "report", "some", "older", "related", "results", "on", "the", "UKB", "and", "C10k", "datasets", ",", "that", "are", "not", "competitive", "with", "MultiGrain", ".", "Neural", "codes", "is", "one", "of", "the", "first", "works", "on", "retrieval", "with", "deep", "features", ".", "The", "Fisher", "vector", "is", "a", "pooling", "method", "that", "uses", "local", "SIFT", "descriptors", ".", "At", "resolutions", "we", "see", "that", "the", "results", "with", "the", "margin", "loss", "(", "0.5", ")", "are", "slightly", "lower", "than", "without", "(", "1", ")", ".", "This", "is", "partly", "due", "to", "the", "limited", "transfer", "from", "the", "IN", "-", "aug", "task", "to", "the", "variations", "observed", "in", "retrieval", "datasets", ".", "section", ":", "Conclusion", "In", "this", "work", "we", "have", "introduced", "MultiGrain", ",", "a", "unified", "embedding", "for", "image", "classification", "and", "instance", "retrieval", ".", "MultiGrain", "relies", "on", "a", "classical", "convolutional", "neural", "network", "trunk", ",", "with", "a", "GeM", "layer", "topped", "with", "two", "heads", "at", "training", "time", ".", "We", "have", "discovered", "that", "by", "adjusting", "this", "pooling", "layer", "we", "are", "able", "to", "increase", "the", "resolution", "of", "images", "used", "a", "inference", "time", ",", "while", "maintaining", "a", "small", "resolution", "at", "training", "time", ".", "We", "have", "shown", "that", "MultiGrain", "embeddings", "can", "perform", "well", "on", "classification", "and", "retrieval", ".", "Interestingly", ",", "MultiGrain", "also", "sets", "a", "new", "state", "of", "the", "art", "on", "pure", "classification", "compared", "to", "all", "results", "obtained", "with", "the", "same", "convolutional", "trunk", ".", "Overall", ",", "our", "results", "show", "that", "retrieval", "and", "classification", "tasks", "can", "benefit", "from", "each", "other", ".", "An", "implementation", "of", "our", "method", "is", "open", "-", "sourced", "at", ".", "paragraph", ":", "Acknowledgments", ".", "We", "thank", "Kaiming", "He", "for", "useful", "feedback", "and", "references", ".", "Maxim", "Berman", "is", "supported", "by", "Research", "Foundation", "-", "Flanders", "(", "FWO", ")", "through", "project", "number", "G0A2716N.", "PSI", "\u2013", "ESAT", "acknowledges", "a", "GPU", "server", "donation", "from", "FAIR", "Partnership", "Program", ".", "bibliography", ":", "References", "figuresection", "tablesection", "equationsection", "We", "report", "a", "few", "additional", "experiments", "and", "results", "that", "did", "not", "fit", "in", "the", "main", "paper", ".", "Section", "[", "reference", "]", "shows", "the", "effect", "of", "data", "-", "augmented", "batches", "when", "training", "a", "simple", "toy", "model", ".", "Sections", "[", "reference", "]", "and", "[", "reference", "]", "list", "the", "values", "of", "a", "few", "hyper", "-", "parameters", "used", "in", "our", "method", ".", "Section", "[", "reference", "]", "gives", "a", "some", "more", "ablation", "results", "in", "the", "retrieval", "setting", ".", "Finally", ",", "Section", "[", "reference", "]", "shows", "how", "to", "use", "the", "ingredients", "of", "MultiGrain", "to", "improve", "the", "accuracy", "of", "an", "off", "-", "the", "-", "shelf", "pre", "-", "trained", "ConvNet", "at", "almost", "no", "additional", "training", "cost", ".", "It", "obtains", "what", "appear", "to", "be", "the", "best", "reported", "classification", "results", "on", "imagenet", "-", "2012", "for", "a", "convnet", "with", "publicly", "available", "weights", ".", "appendix", ":", "Data", "-", "augmented", "batches", ":", "toy", "model", "We", "have", "observed", "in", "sec", ":", "data", "-", "augmented", "-", "batches", ",", "sec", ":", "tradeoff", "-", "parameter", "that", "training", "our", "architecture", "(", "ResNet", "-", "50", "trunk", ")", "with", "data", "-", "augmented", "batches", "yields", "improvements", "with", "respect", "to", "the", "vanilla", "uniform", "sampling", "scheme", ",", "despite", "the", "decrease", "in", "image", "diversity", ".", "This", "observation", "holds", "even", "in", "the", "absence", "of", "ranking", "triplet", "loss", ",", "all", "things", "being", "equal", "otherwise", ":", "same", "number", "of", "iterations", "per", "epoch", ",", "number", "of", "epochs", ",", "learning", "rate", "schedule", ",", "and", "batch", "size", ".", "As", "an", "example", ",", "fig", ":", "suppl", "-", "compare", "-", "sampling", "shows", "the", "evolution", "of", "the", "validation", "accuracy", "of", "our", "network", "trained", "under", "cross", "-", "entropy", "with", "our", "training", "schedule", "and", "a", "pooling", ",", "batches", "of", "size", "512", ",", "with", "the", "data", "augmentation", "introduced", "in", "sec", ":", "experimental", "-", "settings", ",", "with", "uniform", "batches", "vs.", "with", "batch", "sampling", ".", "While", "initial", "epochs", "suffer", "from", "the", "reduced", "diversity", "of", "the", "batches", "compared", "to", "the", "uniformly", "-", "sampled", "variant", ",", "the", "reinforced", "effect", "on", "data", "augmentation", "compensates", "for", "this", "in", "the", "long", "run", ",", "and", "makes", "the", "batch", "-", "augmented", "variant", "reach", "a", "higher", "final", "accuracy", ".", "Since", "we", "observe", "this", "better", "performance", "even", "for", "a", "pure", "image", "classification", "task", ",", "an", "interesting", "question", "is", "whether", "this", "benefit", "is", "specific", "to", "our", "architecture", "and", "training", "method", "(", "batch", "-", "norm", ",", "etc", ")", ",", "or", "if", "it", "is", "more", "generally", "applicable", "?", "Hereafter", "we", "analyse", "a", "linear", "model", "and", "synthetic", "classification", "task", "that", "seems", "to", "align", "with", "the", "second", "hypothesis", ".", "We", "consider", "an", "idealized", "model", "of", "the", "effect", "of", "including", "different", "data", "-", "augmented", "instances", "of", "the", "same", "image", "in", "one", "batch", "using", "standard", "stochastic", "gradient", "descent", ".", "We", "create", "a", "synthetic", "training", "set", "of", "points", "pictured", "in", "fig", ":", "toy", "-", "train", "of", "=", "positive", "and", "=", "negative", "training", "points", "by", "sampling", "from", "two", "2D", "Gaussian", "distributions", ":", "with", "being", "the", "ground", "truth", "label", ".", "We", "sample", "a", "test", "dataset", "in", "the", "same", "manner", ".", "We", "consider", "the", "SGD", "training", "of", "an", "SVM", "using", "the", "Hinge", "loss", "We", "consider", "the", "symmetry", "across", "the", "x", "-", "axis", "as", "a", "label", "-", "preserving", "data", "-", "augmentation", "suited", "to", "our", "synthetic", "dataset", ".", "We", "train", "the", "SVM", "(", "[", "reference", "]", ")", "using", "one", "pass", "through", "the", "data", "-", "augmented", "dataset", "of", "size", ",", "using", "batches", "of", "size", ".", "The", "only", "difference", "between", "the", "two", "optimization", "schedules", "is", "the", "order", "in", "which", "the", "samples", "are", "batched", "and", "presented", "to", "the", "optimizer", ".", "We", "consider", "two", "batch", "sampling", "strategies", ":", "Uniform", "sampling", ":", "we", "sample", "the", "elements", "of", "the", "batch", "randomly", "from", ",", "without", "replacement", ";", "Paired", "sampling", ":", "we", "generate", "a", "batch", "by", "pairing", "a", "random", "element", "from", "and", "its", "data", "-", "augmentation", ",", "removing", "these", "two", "elements", "from", ".", "fig", ":", "evo", "-", "toy", "shows", "the", "evaluation", "of", "the", "accuracy", "with", "the", "iterations", "in", "both", "of", "these", "cases", ",", "averaged", "across", "100", "runs", ".", "It", "is", "clear", "that", "pairing", "the", "data", "-", "augmented", "pairs", "in", "one", "batch", "accelerates", "the", "convergence", "of", "this", "model", ".", "This", "idealized", "experiment", "demonstrates", "that", "there", "are", "cases", "in", "which", "the", "repeated", "augmentation", "scheme", "provides", "an", "optimization", "and", "generalization", "boost", ",", "and", "reinforces", "the", "effect", "of", "data", "augmentation", ".", "appendix", ":", "Margin", "loss", "hyper", "-", "parameters", "tab", ":", "training", "-", "hyperparam", "gives", "the", "value", "of", "the", "hyper", "-", "parameters", "for", "the", "margin", "loss", "used", "during", "the", "training", "of", "our", "models", ".", "appendix", ":", "Data", "augmentation", "hyper", "-", "parameters", "tab", ":", "full", "-", "data", "-", "augment", "gives", "the", "transformations", "in", "the", "full", "data", "augmentation", "used", "in", "our", "experiments", "(", "sec", ":", "experimental", "-", "settings", ")", ",", "along", "with", "their", "parameters", ".", "appendix", ":", "Additional", "results", "and", "ablation", "study", "for", "Multigrain", "in", "retrieval", "tab", ":", "instanceres", "-", "abl", "reports", "additional", "results", "of", "the", "MultiGrain", "architecture", ",", "with", "an", "ablation", "study", "analyzing", "the", "effect", "of", "each", "component", ".", "As", "already", "reported", "in", "the", "main", "paper", ",", "for", "some", "datasets", "the", "choice", "of", "not", "using", "the", "triplet", "loss", "(", ")", "is", "as", "good", "or", "better", "than", "our", "generic", "choice", "(", ")", ".", "Of", "course", ",", "then", "the", "embedding", "is", "not", "multi", "-", "purpose", "anymore", ".", "Overall", ",", "the", "different", "elements", "employed", "in", "our", "architecture", "(", "RA", "and", "the", "layers", "specific", "to", "Multigrain", ")", "still", "give", "a", "significant", "improvement", "over", "simply", "using", "the", "activations", ",", "and", "is", "competitive", "with", "the", "state", "of", "the", "art", "for", "the", "same", "resolution", "/", "complexity", ".", "Note", ",", "the", "AutoAugment", "data", "augmentation", "does", "not", "transfer", "well", "to", "the", "retrieval", "tasks", ".", "This", "can", "be", "explained", "by", "their", "specificity", "to", "Imagenet", "classification", ".", "This", "shows", "the", "limitation", "of", "a", "particular", "choice", "of", "data", "-", "augmentation", "if", "a", "single", "embedding", "for", "classification", "and", "retrieval", "datasets", "is", "desired", ".", "Learning", "AutoAugment", "specifically", "for", "the", "retrieval", "task", "would", "certainly", "help", ",", "but", "would", "probably", "also", "result", "in", "less", "general", "embeddings", ".", "Hence", ",", "data", "-", "augmentation", "is", "a", "limiting", "factor", "for", "multi", "-", "purpose", "embeddings", ":", "improving", "for", "one", "task", "like", "classification", "hurts", "the", "performance", "for", "other", "tasks", ".", "appendix", ":", "Evaluation", "of", "off", "-", "the", "-", "shelf", "classifiers", "at", "higher", "resolutions", "In", "this", "section", ",", "we", "present", "some", "additional", "classification", "results", "using", "off", "-", "the", "-", "shelf", "pretrained", "classification", "networks", "trained", "with", "standard", "average", "pooling", "(", ")", ".", "As", "outlined", "in", "sec", ":", "expand", "-", "pooling", ",", "sec", ":", "expanding", "-", "resolution", ",", "one", "of", "our", "contributions", "is", "a", "strategy", "for", "evaluating", "classifier", "networks", "trained", "with", "GeM", "pooling", "at", "scale", "and", "exponent", "at", "a", "higher", "resolution", "and", "adapted", "exponent", ".", "It", "can", "be", "used", "on", "pretrained", "networks", "as", "well", ".", "For", "an", "evaluation", "scale", ",", "we", "use", "the", "alternative", "strategy", "described", "in", "sec", ":", "expanding", "-", "resolution", "to", "choose", ":", "we", "finetune", "the", "parameter", "by", "stochastic", "gradient", "descent", ",", "backpropagating", "the", "cross", "-", "entropy", "loss", "on", "training", "images", "from", "imagenet", ",", "rescaled", "to", "the", "desired", "input", "resolution", ".", "Compared", "to", "a", "full", "finetuning", "at", "this", "input", "resolution", ",", "this", "strategy", "has", "a", "limited", "memory", "footprint", ",", "given", "that", "the", "backpropagation", "only", "has", "to", "be", "done", "on", "the", "ultimate", "classification", "layer", "before", "reaching", "the", "pooling", "layer", ",", "allowing", "for", "an", "efficient", "computation", "of", "the", "gradient", "of", ".", "Experimentally", "we", "also", "found", "that", "this", "process", "converges", "on", "a", "few", "thousands", "of", "training", "samples", ",", "while", "a", "finetuning", "of", "the", "classification", "layer", "would", "require", "several", "data", "-", "augmented", "epochs", "on", "the", "full", "training", "set", ".", "The", "finetuning", "is", "done", "using", "SGD", "with", "batches", "of", "(", "non", "-", "cropped", ")", "images", ",", "with", "momentum", "and", "initial", "learning", "rate", ",", "decayed", "under", "a", "polynomial", "learning", "rate", "decay", "with", "the", "total", "number", "of", "iterations", ".", "We", "select", "images", "from", "the", "training", "set", "(", "per", "category", ")", "for", "the", "fine", "-", "tuning", "and", "do", "one", "pass", "on", "this", "reduced", "dataset", ".", "We", "use", "off", "-", "the", "-", "shelf", "pretrained", "convnets", "from", "the", "Cadene", "/", "pretrained", "-", "models.pytorch", "GitHub", "repository", ".", "Table", "[", "reference", "]", "outlines", "the", "resulting", "validation", "accuracies", ".", "We", "see", "that", "for", "each", "network", "there", "is", "a", "scale", "and", "choice", "of", "that", "performs", "better", "than", "the", "standard", "evaluation", ".", "These", "networks", "have", "not", "been", "trained", "using", "GeM", "pooling", "with", ";", "as", "exhibited", "in", "our", "classification", "results", "(", "tab", ":", "classifres", ")", "we", "found", "this", "to", "be", "another", "key", "ingredient", "in", "ensuring", "a", "higher", "scale", "insensitivity", "and", "better", "performance", "at", "larger", "resolution", ".", "As", "in", "our", "main", "experiments", "with", "the", "MultiGrain", "architecture", "with", "a", "ResNet", "-", "50", "backbone", ",", "it", "is", "likely", "that", "these", "networks", "would", "reach", "higher", "values", "when", "training", "from", "scratch", "with", "a", "pooling", ",", "and", "adding", "repeated", "augmentations", "and", "margin", "loss", ".", "However", ",", "running", "training", "experiments", "on", "these", "large", "networks", "is", "significantly", "more", "expensive", ".", "Therefore", ",", "we", "leave", "this", "for", "future", "work", ".", "ieee"]}