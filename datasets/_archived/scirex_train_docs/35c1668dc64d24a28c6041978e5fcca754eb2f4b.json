{"coref": {"BLEU_score": [[102, 103], [489, 490], [490, 491], [518, 519], [1214, 1216], [1216, 1217], [3405, 3406], [3406, 3407], [3423, 3424], [3430, 3435], [3939, 3940], [4763, 4764], [5737, 5738], [5748, 5749], [5756, 5757], [6752, 6753], [6788, 6789], [5407, 5408], [5558, 5559]], "IWSLT2015_German-English": [[236, 238], [5174, 5180], [5238, 5240], [5246, 5248], [5307, 5309]], "Machine_Translation": [[180, 182], [971, 973], [5138, 5140], [5142, 5144], [5562, 5564], [6764, 6766], [6825, 6828]], "Word-level_LSTM_w_attn": [[2048, 2052], [6771, 6772]]}, "coref_non_salient": {"0": [[974, 976], [5319, 5321], [5323, 5326], [5565, 5568], [6767, 6769], [6810, 6813]], "1": [[67, 68], [1208, 1209], [1221, 1222], [1253, 1254], [1491, 1492], [1970, 1971], [2154, 2155], [2334, 2335], [2384, 2385], [2409, 2410], [2544, 2546], [2897, 2898], [4545, 4546], [5818, 5819]], "10": [[5330, 5333], [5433, 5435]], "100": [[5289, 5292]], "101": [[1791, 1793]], "102": [[3821, 3823]], "103": [[4303, 4305]], "104": [[5982, 5984]], "105": [[2263, 2265]], "106": [[6230, 6232]], "107": [[3467, 3469]], "108": [[1057, 1058]], "109": [[159, 162]], "11": [[1762, 1764], [5083, 5085], [5159, 5162], [6330, 6332]], "110": [[3210, 3213]], "111": [[4490, 4492]], "112": [[643, 649]], "113": [[1595, 1597]], "114": [[208, 213]], "115": [[5214, 5216]], "116": [[1083, 1086], [1116, 1119]], "117": [[5182, 5186]], "118": [[2258, 2262]], "119": [[6538, 6540]], "12": [[176, 178], [200, 202], [587, 589], [735, 738], [750, 752], [777, 779], [1398, 1400], [1440, 1442], [1640, 1642], [1960, 1962], [3996, 3998], [4129, 4131], [6029, 6031], [6070, 6072], [6097, 6099]], "120": [[5424, 5427]], "121": [[1578, 1581]], "122": [[561, 563]], "123": [[871, 874]], "124": [[2205, 2206]], "125": [[1536, 1538]], "126": [[5890, 5892]], "127": [[6559, 6560]], "128": [[5150, 5154]], "129": [[1936, 1939]], "13": [[1368, 1369], [3725, 3731]], "130": [[1352, 1354]], "131": [[188, 190]], "132": [[497, 501]], "133": [[5675, 5677]], "134": [[5899, 5900]], "135": [[4257, 4258]], "136": [[1289, 1292], [1313, 1316]], "137": [[1391, 1394]], "138": [[2421, 2428]], "139": [[3909, 3911]], "14": [[1999, 2000], [2231, 2233], [6036, 6037]], "140": [[6135, 6138]], "141": [[503, 505]], "15": [[1649, 1651], [1670, 1672], [1817, 1819]], "16": [[852, 855], [4066, 4069]], "17": [[657, 659], [661, 662], [684, 686], [726, 727], [848, 849], [1524, 1525], [3231, 3233], [3237, 3238], [3253, 3256], [3782, 3783], [3915, 3916], [4100, 4101], [4389, 4391], [4441, 4442], [4480, 4481], [4597, 4598]], "18": [[2471, 2473], [2482, 2484], [6600, 6602]], "19": [[1696, 1698], [1708, 1710]], "2": [[1300, 1302], [3272, 3274], [6047, 6049], [6093, 6096]], "20": [[2901, 2907], [1026, 1032]], "21": [[533, 535], [712, 713]], "22": [[5297, 5298], [5299, 5300]], "23": [[2633, 2635], [3242, 3244], [3264, 3266], [3340, 3343]], "24": [[1676, 1678], [6785, 6787]], "25": [[3067, 3070], [3701, 3704], [5680, 5683]], "26": [[130, 132], [1088, 1090], [1132, 1134], [1188, 1190], [2535, 2537], [2581, 2584], [2938, 2940], [3073, 3075], [5821, 5823], [5849, 5851], [5859, 5861], [6157, 6159], [6571, 6574], [6620, 6622], [6713, 6715]], "27": [[104, 105], [4765, 4767], [5570, 5571], [5729, 5730], [5762, 5764], [5768, 5769]], "28": [[916, 920], [2170, 2173], [6115, 6120]], "29": [[581, 583], [2255, 2256], [2601, 2602], [6211, 6213]], "3": [[455, 459], [989, 992], [1560, 1564], [2176, 2180], [4189, 4193]], "30": [[3408, 3412], [3454, 3457], [3941, 3944], [6748, 6751]], "31": [[15, 17], [251, 253], [4240, 4242], [4288, 4290]], "32": [[5038, 5041], [6774, 6776]], "33": [[912, 914], [1372, 1373], [1458, 1460], [3326, 3327], [4148, 4150], [4161, 4163], [6111, 6113]], "34": [[768, 770], [3975, 3977], [4039, 4041], [4138, 4140], [5902, 5904], [6107, 6109]], "35": [[2174, 2175], [2181, 2182], [2603, 2604], [4478, 4479], [4577, 4578], [5631, 5632], [5693, 5694], [5724, 5725], [2202, 2203], [2879, 2880], [3156, 3157], [4378, 4379], [4419, 4420], [4588, 4589], [5934, 5935]], "36": [[1485, 1486], [4260, 4261], [4284, 4285]], "37": [[4237, 4238]], "38": [[6442, 6444], [6464, 6466], [6494, 6496]], "39": [[5465, 5471]], "4": [[3850, 3852], [3864, 3865], [3883, 3884]], "40": [[5199, 5201]], "41": [[3988, 3991]], "42": [[1653, 1655], [5100, 5101]], "43": [[3688, 3691]], "44": [[6804, 6806]], "45": [[997, 998], [1434, 1435], [1488, 1489], [2598, 2599], [2620, 2621], [2624, 2625], [2660, 2661], [2764, 2765], [5687, 5688], [2846, 2847], [4091, 4092]], "46": [[3733, 3735]], "47": [[610, 612], [3283, 3285], [5034, 5036], [5103, 5105], [5146, 5148], [5479, 5481], [6026, 6028]], "48": [[619, 621], [2129, 2131], [2647, 2649], [4328, 4330]], "49": [[2923, 2926], [3188, 3191], [3529, 3530], [4667, 4668]], "5": [[824, 825], [837, 838], [905, 906], [1008, 1009], [1048, 1049], [1073, 1074], [1105, 1106], [1130, 1131], [2039, 2040], [3202, 3203], [3225, 3226], [4079, 4080], [4472, 4473], [5554, 5555], [5622, 5623], [5700, 5701], [5726, 5727], [5745, 5746], [5753, 5754], [5766, 5768], [5811, 5812], [5844, 5845], [5871, 5872], [5990, 5991], [6143, 6144], [6756, 6757], [6779, 6780], [4057, 4058], [4082, 4083], [4610, 4611], [6000, 6001], [6080, 6081], [6206, 6207]], "50": [[1388, 1389], [4088, 4090]], "51": [[118, 120], [4785, 4787], [6149, 6151]], "52": [[6, 9], [270, 273], [1627, 1630]], "53": [[4625, 4627]], "54": [[3889, 3892]], "55": [[5295, 5296]], "56": [[247, 250], [2062, 2065]], "57": [[2, 5], [86, 90], [3178, 3181]], "58": [[5211, 5212]], "59": [[1174, 1178], [2090, 2094]], "6": [[242, 243], [4859, 4862]], "60": [[6187, 6189]], "61": [[3275, 3276]], "62": [[864, 866], [4485, 4487], [5939, 5941]], "63": [[817, 823], [3195, 3201], [4072, 4078], [4465, 4471]], "64": [[3427, 3429]], "65": [[5059, 5062]], "66": [[2908, 2909], [2912, 2913], [5642, 5643]], "67": [[968, 970], [4802, 4804], [5167, 5168], [5720, 5721], [6823, 6824], [186, 187], [4810, 4811], [5573, 5574], [6285, 6286], [6740, 6741]], "68": [[5192, 5198]], "69": [[1052, 1054], [1075, 1077], [1107, 1109], [5881, 5883]], "7": [[274, 275], [986, 987], [1631, 1632], [1732, 1733], [1788, 1789], [1814, 1815], [2210, 2211], [3287, 3288], [3375, 3376], [3598, 3599], [3861, 3862], [4186, 4187], [4548, 4549], [4572, 4573], [4580, 4581], [5265, 5266], [5462, 5463], [5543, 5544], [6345, 6346]], "70": [[2686, 2688], [2699, 2701], [4334, 4336]], "71": [[2548, 2550]], "72": [[5293, 5294]], "73": [[6308, 6310]], "74": [[5428, 5429]], "75": [[3751, 3753]], "76": [[3818, 3819]], "77": [[4671, 4674]], "78": [[4252, 4253]], "79": [[1162, 1164]], "8": [[94, 95], [516, 517], [633, 635], [2519, 2521], [3220, 3223], [6644, 6646]], "80": [[3867, 3872]], "81": [[2266, 2268]], "82": [[1550, 1552]], "83": [[255, 261]], "84": [[3986, 3987]], "85": [[2989, 2992]], "86": [[10, 14]], "87": [[1306, 1307]], "88": [[196, 199]], "89": [[1421, 1423]], "9": [[556, 558], [691, 693]], "90": [[6382, 6385]], "91": [[4030, 4032]], "92": [[2528, 2530], [5795, 5797]], "93": [[3707, 3709]], "94": [[481, 483]], "95": [[150, 151]], "96": [[993, 996], [1430, 1433], [2594, 2597]], "97": [[4726, 4728]], "98": [[6669, 6676]], "99": [[262, 268]]}, "doc_id": "35c1668dc64d24a28c6041978e5fcca754eb2f4b", "method_subrelations": {"Word-level_LSTM_w_attn": [[[0, 22], "Word-level_LSTM_w_attn"]]}, "n_ary_relations": [{"Material": "IWSLT2015_German-English", "Method": "Word-level_LSTM_w_attn", "Metric": "BLEU_score", "Task": "Machine_Translation", "score": "20.2"}], "ner": [[2, 5, "Method"], [6, 9, "Method"], [10, 14, "Task"], [15, 17, "Method"], [67, 68, "Task"], [86, 90, "Method"], [94, 95, "Metric"], [102, 103, "Metric"], [104, 105, "Metric"], [118, 120, "Task"], [130, 132, "Method"], [150, 151, "Task"], [159, 162, "Method"], [176, 178, "Task"], [180, 182, "Task"], [188, 190, "Task"], [196, 199, "Method"], [200, 202, "Task"], [208, 213, "Task"], [236, 238, "Material"], [242, 243, "Material"], [247, 250, "Method"], [251, 253, "Method"], [255, 261, "Method"], [262, 268, "Method"], [270, 273, "Method"], [274, 275, "Method"], [455, 459, "Method"], [481, 483, "Metric"], [489, 490, "Metric"], [490, 491, "Metric"], [497, 501, "Metric"], [503, 505, "Method"], [516, 517, "Metric"], [518, 519, "Metric"], [533, 535, "Task"], [556, 558, "Metric"], [561, 563, "Method"], [581, 583, "Method"], [587, 589, "Task"], [610, 612, "Method"], [619, 621, "Method"], [633, 635, "Metric"], [643, 649, "Method"], [657, 659, "Method"], [661, 662, "Method"], [684, 686, "Method"], [691, 693, "Metric"], [712, 713, "Task"], [726, 727, "Method"], [735, 738, "Task"], [750, 752, "Task"], [768, 770, "Method"], [777, 779, "Task"], [817, 823, "Method"], [824, 825, "Method"], [837, 838, "Method"], [848, 849, "Method"], [852, 855, "Task"], [864, 866, "Method"], [871, 874, "Method"], [905, 906, "Method"], [912, 914, "Method"], [916, 920, "Method"], [968, 970, "Task"], [971, 973, "Task"], [974, 976, "Task"], [986, 987, "Method"], [989, 992, "Method"], [993, 996, "Method"], [997, 998, "Method"], [1008, 1009, "Method"], [1048, 1049, "Method"], [1052, 1054, "Method"], [1057, 1058, "Metric"], [1073, 1074, "Method"], [1075, 1077, "Method"], [1083, 1086, "Method"], [1088, 1090, "Method"], [1105, 1106, "Method"], [1107, 1109, "Method"], [1116, 1119, "Method"], [1130, 1131, "Method"], [1132, 1134, "Method"], [1162, 1164, "Method"], [1174, 1178, "Metric"], [1188, 1190, "Method"], [1208, 1209, "Task"], [1214, 1216, "Metric"], [1216, 1217, "Metric"], [1221, 1222, "Task"], [1253, 1254, "Task"], [1289, 1292, "Task"], [1300, 1302, "Method"], [1306, 1307, "Method"], [1313, 1316, "Task"], [1352, 1354, "Method"], [1368, 1369, "Method"], [1372, 1373, "Method"], [1388, 1389, "Method"], [1391, 1394, "Method"], [1398, 1400, "Task"], [1421, 1423, "Task"], [1430, 1433, "Method"], [1434, 1435, "Method"], [1440, 1442, "Task"], [1458, 1460, "Method"], [1485, 1486, "Task"], [1488, 1489, "Method"], [1491, 1492, "Task"], [1524, 1525, "Method"], [1536, 1538, "Task"], [1550, 1552, "Task"], [1560, 1564, "Method"], [1578, 1581, "Method"], [1595, 1597, "Method"], [1627, 1630, "Method"], [1631, 1632, "Method"], [1640, 1642, "Task"], [1649, 1651, "Method"], [1653, 1655, "Method"], [1670, 1672, "Method"], [1676, 1678, "Method"], [1696, 1698, "Method"], [1708, 1710, "Method"], [1732, 1733, "Method"], [1762, 1764, "Method"], [1788, 1789, "Method"], [1791, 1793, "Method"], [1814, 1815, "Method"], [1817, 1819, "Method"], [1936, 1939, "Task"], [1960, 1962, "Task"], [1970, 1971, "Task"], [1999, 2000, "Method"], [2039, 2040, "Method"], [2048, 2052, "Method"], [2062, 2065, "Method"], [2090, 2094, "Metric"], [2129, 2131, "Method"], [2154, 2155, "Task"], [2170, 2173, "Method"], [2174, 2175, "Method"], [2176, 2180, "Method"], [2181, 2182, "Method"], [2205, 2206, "Task"], [2210, 2211, "Method"], [2231, 2233, "Method"], [2255, 2256, "Method"], [2258, 2262, "Method"], [2263, 2265, "Method"], [2266, 2268, "Method"], [2334, 2335, "Task"], [2384, 2385, "Task"], [2409, 2410, "Task"], [2421, 2428, "Method"], [2471, 2473, "Metric"], [2482, 2484, "Metric"], [2519, 2521, "Metric"], [2528, 2530, "Task"], [2535, 2537, "Method"], [2544, 2546, "Task"], [2548, 2550, "Metric"], [2581, 2584, "Method"], [2594, 2597, "Method"], [2598, 2599, "Method"], [2601, 2602, "Method"], [2603, 2604, "Method"], [2620, 2621, "Method"], [2624, 2625, "Method"], [2633, 2635, "Task"], [2647, 2649, "Method"], [2660, 2661, "Method"], [2686, 2688, "Method"], [2699, 2701, "Method"], [2764, 2765, "Method"], [2897, 2898, "Task"], [2901, 2907, "Method"], [2908, 2909, "Method"], [2923, 2926, "Task"], [2938, 2940, "Method"], [2989, 2992, "Method"], [3067, 3070, "Method"], [3073, 3075, "Method"], [3178, 3181, "Method"], [3188, 3191, "Task"], [3195, 3201, "Method"], [3202, 3203, "Method"], [3210, 3213, "Task"], [3220, 3223, "Metric"], [3225, 3226, "Method"], [3231, 3233, "Method"], [3237, 3238, "Method"], [3242, 3244, "Task"], [3253, 3256, "Method"], [3264, 3266, "Task"], [3272, 3274, "Method"], [3275, 3276, "Method"], [3283, 3285, "Method"], [3287, 3288, "Method"], [3326, 3327, "Method"], [3340, 3343, "Task"], [3375, 3376, "Method"], [3405, 3406, "Metric"], [3406, 3407, "Metric"], [3408, 3412, "Metric"], [3423, 3424, "Metric"], [3427, 3429, "Metric"], [3430, 3435, "Metric"], [3454, 3457, "Metric"], [3467, 3469, "Method"], [3529, 3530, "Task"], [3598, 3599, "Method"], [3688, 3691, "Method"], [3701, 3704, "Method"], [3707, 3709, "Method"], [3725, 3731, "Method"], [3733, 3735, "Task"], [3751, 3753, "Method"], [3782, 3783, "Method"], [3818, 3819, "Metric"], [3821, 3823, "Method"], [3850, 3852, "Method"], [3861, 3862, "Method"], [3864, 3865, "Method"], [3867, 3872, "Method"], [3883, 3884, "Method"], [3889, 3892, "Metric"], [3909, 3911, "Method"], [3915, 3916, "Method"], [3939, 3940, "Metric"], [3941, 3944, "Metric"], [3975, 3977, "Method"], [3986, 3987, "Task"], [3988, 3991, "Task"], [3996, 3998, "Task"], [4030, 4032, "Metric"], [4039, 4041, "Method"], [4066, 4069, "Task"], [4072, 4078, "Method"], [4079, 4080, "Method"], [4088, 4090, "Method"], [4100, 4101, "Method"], [4129, 4131, "Task"], [4138, 4140, "Method"], [4148, 4150, "Method"], [4161, 4163, "Method"], [4186, 4187, "Method"], [4189, 4193, "Method"], [4237, 4238, "Metric"], [4240, 4242, "Method"], [4252, 4253, "Method"], [4257, 4258, "Metric"], [4260, 4261, "Task"], [4284, 4285, "Task"], [4288, 4290, "Method"], [4303, 4305, "Method"], [4328, 4330, "Method"], [4334, 4336, "Method"], [4389, 4391, "Method"], [4441, 4442, "Method"], [4465, 4471, "Method"], [4472, 4473, "Method"], [4478, 4479, "Method"], [4480, 4481, "Method"], [4485, 4487, "Method"], [4490, 4492, "Method"], [4545, 4546, "Task"], [4548, 4549, "Method"], [4572, 4573, "Method"], [4577, 4578, "Method"], [4580, 4581, "Method"], [4597, 4598, "Method"], [4625, 4627, "Method"], [4667, 4668, "Task"], [4671, 4674, "Method"], [4726, 4728, "Metric"], [4763, 4764, "Metric"], [4765, 4767, "Metric"], [4785, 4787, "Task"], [4802, 4804, "Task"], [4859, 4862, "Material"], [5034, 5036, "Method"], [5038, 5041, "Method"], [5059, 5062, "Method"], [5083, 5085, "Method"], [5100, 5101, "Method"], [5103, 5105, "Method"], [5138, 5140, "Task"], [5142, 5144, "Task"], [5146, 5148, "Method"], [5150, 5154, "Method"], [5159, 5162, "Method"], [5167, 5168, "Task"], [5174, 5180, "Material"], [5182, 5186, "Material"], [5192, 5198, "Material"], [5199, 5201, "Material"], [5211, 5212, "Method"], [5214, 5216, "Method"], [5238, 5240, "Material"], [5246, 5248, "Material"], [5265, 5266, "Method"], [5289, 5292, "Material"], [5293, 5294, "Material"], [5295, 5296, "Material"], [5297, 5298, "Material"], [5299, 5300, "Material"], [5307, 5309, "Material"], [5319, 5321, "Task"], [5323, 5326, "Task"], [5330, 5333, "Material"], [5424, 5427, "Method"], [5428, 5429, "Method"], [5433, 5435, "Material"], [5462, 5463, "Method"], [5465, 5471, "Method"], [5479, 5481, "Method"], [5543, 5544, "Method"], [5554, 5555, "Method"], [5562, 5564, "Task"], [5565, 5568, "Task"], [5570, 5571, "Metric"], [5622, 5623, "Method"], [5631, 5632, "Method"], [5675, 5677, "Method"], [5680, 5683, "Method"], [5687, 5688, "Method"], [5693, 5694, "Method"], [5700, 5701, "Method"], [5720, 5721, "Task"], [5724, 5725, "Method"], [5726, 5727, "Method"], [5729, 5730, "Metric"], [5737, 5738, "Metric"], [5745, 5746, "Method"], [5748, 5749, "Metric"], [5753, 5754, "Method"], [5756, 5757, "Metric"], [5762, 5764, "Metric"], [5766, 5768, "Method"], [5768, 5769, "Metric"], [5795, 5797, "Task"], [5811, 5812, "Method"], [5818, 5819, "Task"], [5821, 5823, "Method"], [5844, 5845, "Method"], [5849, 5851, "Method"], [5859, 5861, "Method"], [5871, 5872, "Method"], [5881, 5883, "Method"], [5890, 5892, "Method"], [5899, 5900, "Task"], [5902, 5904, "Method"], [5939, 5941, "Method"], [5982, 5984, "Method"], [5990, 5991, "Method"], [6026, 6028, "Method"], [6029, 6031, "Task"], [6036, 6037, "Method"], [6047, 6049, "Method"], [6070, 6072, "Task"], [6093, 6096, "Method"], [6097, 6099, "Task"], [6107, 6109, "Method"], [6111, 6113, "Method"], [6115, 6120, "Method"], [6135, 6138, "Method"], [6143, 6144, "Method"], [6149, 6151, "Task"], [6157, 6159, "Method"], [6187, 6189, "Method"], [6211, 6213, "Method"], [6230, 6232, "Method"], [6308, 6310, "Metric"], [6330, 6332, "Method"], [6345, 6346, "Method"], [6382, 6385, "Method"], [6442, 6444, "Method"], [6464, 6466, "Method"], [6494, 6496, "Method"], [6538, 6540, "Method"], [6559, 6560, "Method"], [6571, 6574, "Method"], [6600, 6602, "Metric"], [6620, 6622, "Method"], [6644, 6646, "Metric"], [6669, 6676, "Task"], [6713, 6715, "Method"], [6748, 6751, "Metric"], [6752, 6753, "Metric"], [6756, 6757, "Method"], [6764, 6766, "Task"], [6767, 6769, "Task"], [6771, 6772, "Method"], [6774, 6776, "Method"], [6779, 6780, "Method"], [6785, 6787, "Method"], [6788, 6789, "Metric"], [6804, 6806, "Metric"], [6810, 6813, "Task"], [6823, 6824, "Task"], [6825, 6828, "Task"], [186, 187, "Task"], [1026, 1032, "Method"], [2202, 2203, "Method"], [2846, 2847, "Method"], [2879, 2880, "Method"], [2912, 2913, "Method"], [3156, 3157, "Method"], [4057, 4058, "Method"], [4082, 4083, "Method"], [4091, 4092, "Method"], [4378, 4379, "Method"], [4419, 4420, "Method"], [4588, 4589, "Method"], [4610, 4611, "Method"], [4810, 4811, "Task"], [5407, 5408, "Metric"], [5558, 5559, "Metric"], [5573, 5574, "Task"], [5642, 5643, "Method"], [5934, 5935, "Method"], [6000, 6001, "Method"], [6080, 6081, "Method"], [6206, 6207, "Method"], [6285, 6286, "Task"], [6740, 6741, "Task"]], "sections": [[0, 139], [139, 1158], [1158, 1591], [1591, 2046], [2046, 2168], [2168, 2592], [2592, 2899], [2899, 3176], [3176, 3245], [3245, 4070], [4070, 4615], [4615, 4800], [4800, 5136], [5136, 5317], [5317, 5547], [5547, 6011], [6011, 6236], [6236, 6296], [6296, 6299], [6299, 6303], [6303, 6306], [6306, 6310], [6310, 6313], [6313, 6327], [6327, 6569], [6569, 6719], [6719, 6853]], "sentences": [[0, 9], [9, 21], [21, 47], [47, 64], [64, 78], [78, 106], [106, 121], [121, 139], [139, 142], [142, 154], [154, 169], [169, 194], [194, 220], [220, 244], [244, 284], [284, 299], [299, 318], [318, 357], [357, 393], [393, 406], [406, 434], [434, 450], [450, 470], [470, 484], [484, 510], [510, 531], [531, 549], [549, 576], [576, 594], [594, 605], [605, 625], [625, 636], [636, 650], [650, 670], [670, 700], [700, 725], [725, 746], [746, 771], [771, 811], [811, 837], [837, 856], [856, 886], [886, 893], [893, 904], [904, 953], [953, 977], [977, 1005], [1005, 1022], [1022, 1037], [1037, 1044], [1044, 1068], [1068, 1100], [1100, 1125], [1125, 1158], [1158, 1162], [1162, 1179], [1179, 1205], [1205, 1241], [1241, 1249], [1249, 1279], [1279, 1303], [1303, 1317], [1317, 1349], [1349, 1381], [1381, 1395], [1395, 1420], [1420, 1484], [1484, 1487], [1487, 1514], [1514, 1522], [1522, 1553], [1553, 1591], [1591, 1594], [1594, 1620], [1620, 1643], [1643, 1656], [1656, 1673], [1673, 1699], [1699, 1707], [1707, 1729], [1729, 1755], [1755, 1787], [1787, 1816], [1816, 1842], [1842, 1867], [1867, 1889], [1889, 1903], [1903, 1918], [1918, 1948], [1948, 2006], [2006, 2032], [2032, 2046], [2046, 2052], [2052, 2077], [2077, 2099], [2099, 2117], [2117, 2148], [2148, 2168], [2168, 2176], [2176, 2195], [2195, 2230], [2230, 2255], [2255, 2272], [2272, 2288], [2288, 2303], [2303, 2311], [2311, 2331], [2331, 2341], [2341, 2358], [2358, 2379], [2379, 2400], [2400, 2408], [2408, 2414], [2414, 2464], [2464, 2474], [2474, 2498], [2498, 2522], [2522, 2531], [2531, 2547], [2547, 2577], [2577, 2592], [2592, 2600], [2600, 2620], [2620, 2650], [2650, 2681], [2681, 2698], [2698, 2717], [2717, 2731], [2731, 2752], [2752, 2760], [2760, 2791], [2791, 2816], [2816, 2826], [2826, 2839], [2839, 2840], [2840, 2855], [2855, 2862], [2862, 2888], [2888, 2899], [2899, 2910], [2910, 2941], [2941, 2969], [2969, 2993], [2993, 3011], [3011, 3030], [3030, 3052], [3052, 3053], [3053, 3071], [3071, 3100], [3100, 3134], [3134, 3162], [3162, 3176], [3176, 3181], [3181, 3205], [3205, 3224], [3224, 3245], [3245, 3248], [3248, 3274], [3274, 3282], [3282, 3319], [3319, 3338], [3338, 3360], [3360, 3378], [3378, 3394], [3394, 3401], [3401, 3423], [3423, 3454], [3454, 3465], [3465, 3481], [3481, 3526], [3526, 3544], [3544, 3579], [3579, 3617], [3617, 3624], [3624, 3637], [3637, 3649], [3649, 3653], [3653, 3664], [3664, 3684], [3684, 3694], [3694, 3732], [3732, 3758], [3758, 3782], [3782, 3802], [3802, 3840], [3840, 3863], [3863, 3879], [3879, 3894], [3894, 3915], [3915, 3933], [3933, 3958], [3958, 3981], [3981, 3994], [3994, 4024], [4024, 4050], [4050, 4070], [4070, 4081], [4081, 4103], [4103, 4132], [4132, 4157], [4157, 4182], [4182, 4201], [4201, 4229], [4229, 4252], [4252, 4286], [4286, 4322], [4322, 4348], [4348, 4356], [4356, 4396], [4396, 4407], [4407, 4435], [4435, 4450], [4450, 4461], [4461, 4494], [4494, 4505], [4505, 4531], [4531, 4543], [4543, 4547], [4547, 4558], [4558, 4567], [4567, 4569], [4569, 4570], [4570, 4587], [4587, 4615], [4615, 4618], [4618, 4637], [4637, 4655], [4655, 4666], [4666, 4693], [4693, 4712], [4712, 4749], [4749, 4772], [4772, 4785], [4785, 4800], [4800, 4804], [4804, 4842], [4842, 4869], [4869, 4886], [4886, 4925], [4925, 4962], [4962, 4981], [4981, 5000], [5000, 5012], [5012, 5033], [5033, 5079], [5079, 5097], [5097, 5116], [5116, 5136], [5136, 5140], [5140, 5169], [5169, 5188], [5188, 5202], [5202, 5228], [5228, 5252], [5252, 5269], [5269, 5284], [5284, 5306], [5306, 5317], [5317, 5321], [5321, 5334], [5334, 5352], [5352, 5381], [5381, 5389], [5389, 5414], [5414, 5447], [5447, 5461], [5461, 5489], [5489, 5520], [5520, 5534], [5534, 5547], [5547, 5550], [5550, 5576], [5576, 5593], [5593, 5605], [5605, 5619], [5619, 5640], [5640, 5652], [5652, 5687], [5687, 5702], [5702, 5719], [5719, 5790], [5790, 5798], [5798, 5824], [5824, 5837], [5837, 5869], [5869, 5884], [5884, 5899], [5899, 5910], [5910, 5931], [5931, 5953], [5953, 5992], [5992, 6011], [6011, 6014], [6014, 6046], [6046, 6073], [6073, 6100], [6100, 6139], [6139, 6160], [6160, 6178], [6178, 6208], [6208, 6236], [6236, 6239], [6239, 6266], [6266, 6296], [6296, 6299], [6299, 6303], [6303, 6306], [6306, 6310], [6310, 6313], [6313, 6317], [6317, 6327], [6327, 6332], [6332, 6356], [6356, 6372], [6372, 6393], [6393, 6412], [6412, 6429], [6429, 6452], [6452, 6490], [6490, 6509], [6509, 6540], [6540, 6541], [6541, 6569], [6569, 6574], [6574, 6591], [6591, 6623], [6623, 6647], [6647, 6663], [6663, 6679], [6679, 6686], [6686, 6688], [6688, 6697], [6697, 6719], [6719, 6722], [6722, 6763], [6763, 6788], [6788, 6794], [6794, 6798], [6798, 6829], [6829, 6853]], "words": ["document", ":", "Sequence", "Level", "Training", "with", "Recurrent", "Neural", "Networks", "Many", "natural", "language", "processing", "applications", "use", "language", "models", "to", "generate", "text", ".", "These", "models", "are", "typically", "trained", "to", "predict", "the", "next", "word", "in", "a", "sequence", ",", "given", "the", "previous", "words", "and", "some", "context", "such", "as", "an", "image", ".", "However", ",", "at", "test", "time", "the", "model", "is", "expected", "to", "generate", "the", "entire", "sequence", "from", "scratch", ".", "This", "discrepancy", "makes", "generation", "brittle", ",", "as", "errors", "may", "accumulate", "along", "the", "way", ".", "We", "address", "this", "issue", "by", "proposing", "a", "novel", "sequence", "level", "training", "algorithm", "that", "directly", "optimizes", "the", "metric", "used", "at", "test", "time", ",", "such", "as", "BLEU", "or", "ROUGE", ".", "On", "three", "different", "tasks", ",", "our", "approach", "outperforms", "several", "strong", "baselines", "for", "greedy", "generation", ".", "The", "method", "is", "also", "competitive", "when", "these", "baselines", "employ", "beam", "search", ",", "while", "being", "several", "times", "faster", ".", "section", ":", "Introduction", "Natural", "language", "is", "the", "most", "natural", "form", "of", "communication", "for", "humans", ".", "It", "is", "therefore", "essential", "that", "interactive", "AI", "systems", "are", "capable", "of", "generating", "text", "textgen", ".", "A", "wide", "variety", "of", "applications", "rely", "on", "text", "generation", ",", "including", "machine", "translation", ",", "video", "/", "text", "summarization", ",", "question", "answering", ",", "among", "others", ".", "From", "a", "machine", "learning", "perspective", ",", "text", "generation", "is", "the", "problem", "of", "predicting", "a", "syntactically", "and", "semantically", "correct", "sequence", "of", "consecutive", "words", "given", "some", "context", ".", "For", "instance", ",", "given", "an", "image", ",", "generate", "an", "appropriate", "caption", "or", "given", "a", "sentence", "in", "English", "language", ",", "translate", "it", "into", "French", ".", "Popular", "choices", "for", "text", "generation", "models", "are", "language", "models", "based", "on", "n", "-", "grams", "kneser", "+", "ney1995", ",", "feed", "-", "forward", "neural", "networks", "nlm", ",", "and", "recurrent", "neural", "networks", "(", "RNNs", ";", "Mikolov", "et", "al", ".", ",", "2010", ")", ".", "These", "models", "when", "used", "as", "is", "to", "generate", "text", "suffer", "from", "two", "major", "drawbacks", ".", "First", ",", "they", "are", "trained", "to", "predict", "the", "next", "word", "given", "the", "previous", "ground", "truth", "words", "as", "input", ".", "However", ",", "at", "test", "time", ",", "the", "resulting", "models", "are", "used", "to", "generate", "an", "entire", "sequence", "by", "predicting", "one", "word", "at", "a", "time", ",", "and", "by", "feeding", "the", "generated", "word", "back", "as", "input", "at", "the", "next", "time", "step", ".", "This", "process", "is", "very", "brittle", "because", "the", "model", "was", "trained", "on", "a", "different", "distribution", "of", "inputs", ",", "namely", ",", "words", "drawn", "from", "the", "data", "distribution", ",", "as", "opposed", "to", "words", "drawn", "from", "the", "model", "distribution", ".", "As", "a", "result", "the", "errors", "made", "along", "the", "way", "will", "quickly", "accumulate", ".", "We", "refer", "to", "this", "discrepancy", "as", "exposure", "bias", "which", "occurs", "when", "a", "model", "is", "only", "exposed", "to", "the", "training", "data", "distribution", ",", "instead", "of", "its", "own", "predictions", ".", "Second", ",", "the", "loss", "function", "used", "to", "train", "these", "models", "is", "at", "the", "word", "level", ".", "A", "popular", "choice", "is", "the", "cross", "-", "entropy", "loss", "used", "to", "maximize", "the", "probability", "of", "the", "next", "correct", "word", ".", "However", ",", "the", "performance", "of", "these", "models", "is", "typically", "evaluated", "using", "discrete", "metrics", ".", "One", "such", "metric", "is", "called", "BLEU", "bleu", "for", "instance", ",", "which", "measures", "the", "n", "-", "gram", "overlap", "between", "the", "model", "generation", "and", "the", "reference", "text", ".", "Training", "these", "models", "to", "directly", "optimize", "metrics", "like", "BLEU", "is", "hard", "because", "a", ")", "these", "are", "not", "differentiable", "rosti2011", ",", "and", "b", ")", "combinatorial", "optimization", "is", "required", "to", "determine", "which", "sub", "-", "string", "maximizes", "them", "given", "some", "context", ".", "Prior", "attempts", "mcallister2010", ",", "he12", "at", "optimizing", "test", "metrics", "were", "restricted", "to", "linear", "models", ",", "or", "required", "a", "large", "number", "of", "samples", "to", "work", "well", "auli2014", ".", "This", "paper", "proposes", "a", "novel", "training", "algorithm", "which", "results", "in", "improved", "text", "generation", "compared", "to", "standard", "models", ".", "The", "algorithm", "addresses", "the", "two", "issues", "discussed", "above", "as", "follows", ".", "First", ",", "while", "training", "the", "generative", "model", "we", "avoid", "the", "exposure", "bias", "by", "using", "model", "predictions", "at", "training", "time", ".", "Second", ",", "we", "directly", "optimize", "for", "our", "final", "evaluation", "metric", ".", "Our", "proposed", "methodology", "borrows", "ideas", "from", "the", "reinforcement", "learning", "literature", "sutton", "-", "rl", ".", "In", "particular", ",", "we", "build", "on", "the", "REINFORCE", "algorithm", "proposed", "by", "reinforce", ",", "to", "achieve", "the", "above", "two", "objectives", ".", "While", "sampling", "from", "the", "model", "during", "training", "is", "quite", "a", "natural", "step", "for", "the", "REINFORCE", "algorithm", ",", "optimizing", "directly", "for", "any", "test", "metric", "can", "also", "be", "achieved", "by", "it", ".", "REINFORCE", "side", "steps", "the", "issues", "associated", "with", "the", "discrete", "nature", "of", "the", "optimization", "by", "not", "requiring", "rewards", "(", "or", "losses", ")", "to", "be", "differentiable", ".", "While", "REINFORCE", "appears", "to", "be", "well", "suited", "to", "tackle", "the", "text", "generation", "problem", ",", "it", "suffers", "from", "a", "significant", "issue", ".", "The", "problem", "setting", "of", "text", "generation", "has", "a", "very", "large", "action", "space", "which", "makes", "it", "extremely", "difficult", "to", "learn", "with", "an", "initial", "random", "policy", ".", "Specifically", ",", "the", "search", "space", "for", "text", "generation", "is", "of", "size", ",", "where", "is", "the", "number", "of", "words", "in", "the", "vocabulary", "(", "typically", "around", "or", "more", ")", "and", "is", "the", "length", "of", "the", "sentence", "(", "typically", "around", "to", ")", ".", "Towards", "that", "end", ",", "we", "introduce", "Mixed", "Incremental", "Cross", "-", "Entropy", "Reinforce", "(", "MIXER", ")", ",", "which", "is", "our", "first", "major", "contribution", "of", "this", "work", ".", "MIXER", "is", "an", "easy", "-", "to", "-", "implement", "recipe", "to", "make", "REINFORCE", "work", "well", "for", "text", "generation", "applications", ".", "It", "is", "based", "on", "two", "key", "ideas", ":", "incremental", "learning", "and", "the", "use", "of", "a", "hybrid", "loss", "function", "which", "combines", "both", "REINFORCE", "and", "cross", "-", "entropy", "(", "see", "Sec", ".", "[", "reference", "]", "for", "details", ")", ".", "Both", "ingredients", "are", "essential", "to", "training", "with", "large", "action", "spaces", ".", "In", "MIXER", ",", "the", "model", "starts", "from", "the", "optimal", "policy", "given", "by", "cross", "-", "entropy", "training", "(", "as", "opposed", "to", "a", "random", "one", ")", ",", "from", "which", "it", "then", "slowly", "deviates", ",", "in", "order", "to", "make", "use", "of", "its", "own", "predictions", ",", "as", "is", "done", "at", "test", "time", ".", "Our", "second", "contribution", "is", "a", "thorough", "empirical", "evaluation", "on", "three", "different", "tasks", ",", "namely", ",", "Text", "Summarization", ",", "Machine", "Translation", "and", "Image", "Captioning", ".", "We", "compare", "against", "several", "strong", "baselines", ",", "including", ",", "RNNs", "trained", "with", "cross", "-", "entropy", "and", "Data", "as", "Demonstrator", "(", "DAD", ")", "sbengio", "-", "nips2015", ",", "dad", ".", "We", "also", "compare", "MIXER", "with", "another", "simple", "yet", "novel", "model", "that", "we", "propose", "in", "this", "paper", ".", "We", "call", "it", "the", "End", "-", "to", "-", "End", "BackProp", "model", "(", "see", "Sec", ".", "[", "reference", "]", "for", "details", ")", ".", "Our", "results", "show", "that", "MIXER", "with", "a", "simple", "greedy", "search", "achieves", "much", "better", "accuracy", "compared", "to", "the", "baselines", "on", "all", "the", "three", "tasks", ".", "In", "addition", "we", "show", "that", "MIXER", "with", "greedy", "search", "is", "even", "more", "accurate", "than", "the", "cross", "entropy", "model", "augmented", "with", "beam", "search", "at", "inference", "time", "as", "a", "post", "-", "processing", "step", ".", "This", "is", "particularly", "remarkable", "because", "MIXER", "with", "greedy", "search", "is", "at", "least", "times", "faster", "than", "the", "cross", "entropy", "model", "with", "a", "beam", "of", "size", ".", "Lastly", ",", "we", "note", "that", "MIXER", "and", "beam", "search", "are", "complementary", "to", "each", "other", "and", "can", "be", "combined", "to", "further", "improve", "performance", ",", "although", "the", "extent", "of", "the", "improvement", "is", "task", "dependent", ".", "section", ":", "Related", "Work", "Sequence", "models", "are", "typically", "trained", "to", "predict", "the", "next", "word", "using", "the", "cross", "-", "entropy", "loss", ".", "At", "test", "time", ",", "it", "is", "common", "to", "use", "beam", "search", "to", "explore", "multiple", "alternative", "paths", "sutskever2014", ",", "bahdanau", "-", "iclr2015", ",", "rush", "-", "2015", ".", "While", "this", "improves", "generation", "by", "typically", "one", "or", "two", "BLEU", "points", "bleu", ",", "it", "makes", "the", "generation", "at", "least", "times", "slower", ",", "where", "is", "the", "number", "of", "active", "paths", "in", "the", "beam", "(", "see", "Sec", ".", "[", "reference", "]", "for", "more", "details", ")", ".", "The", "idea", "of", "improving", "generation", "by", "letting", "the", "model", "use", "its", "own", "predictions", "at", "training", "time", "(", "the", "key", "proposal", "of", "this", "work", ")", "was", "first", "advocated", "by", "searn", ".", "In", "their", "seminal", "work", ",", "the", "authors", "first", "noticed", "that", "structured", "prediction", "problems", "can", "be", "cast", "as", "a", "particular", "instance", "of", "reinforcement", "learning", ".", "They", "then", "proposed", "SEARN", ",", "an", "algorithm", "to", "learn", "such", "structured", "prediction", "tasks", ".", "The", "basic", "idea", "is", "to", "let", "the", "model", "use", "its", "own", "predictions", "at", "training", "time", "to", "produce", "a", "sequence", "of", "actions", "(", "e.g.", ",", "the", "choice", "of", "the", "next", "word", ")", ".", "Then", ",", "a", "search", "algorithm", "is", "run", "to", "determine", "the", "optimal", "action", "at", "each", "time", "step", ",", "and", "a", "classifier", "(", "a.k.a", ".", "policy", ")", "is", "trained", "to", "predict", "that", "action", ".", "A", "similar", "idea", "was", "later", "proposed", "by", "dagger", "in", "an", "imitation", "learning", "framework", ".", "Unfortunately", ",", "for", "text", "generation", "it", "is", "generally", "intractable", "to", "compute", "an", "oracle", "of", "the", "optimal", "target", "word", "given", "the", "words", "predicted", "so", "far", ".", "The", "oracle", "issue", "was", "later", "addressed", "by", "an", "algorithm", "called", "Data", "As", "Demonstrator", "(", "DAD", ")", "dad", "and", "applied", "for", "text", "generation", "by", ",", "whereby", "the", "target", "action", "at", "step", "is", "the", "-", "th", "action", "taken", "by", "the", "optimal", "policy", "(", "ground", "truth", "sequence", ")", "regardless", "of", "which", "input", "is", "fed", "to", "the", "system", ",", "whether", "it", "is", "ground", "truth", ",", "or", "the", "model", "\u2019s", "prediction", ".", "While", "DAD", "usually", "improves", "generation", ",", "it", "seems", "unsatisfactory", "to", "force", "the", "model", "to", "predict", "a", "certain", "word", "regardless", "of", "the", "preceding", "words", "(", "see", "sec", ".", "[", "reference", "]", "for", "more", "details", ")", ".", "Finally", ",", "REINFORCE", "has", "already", "been", "used", "for", "other", "applications", ",", "such", "as", "in", "computer", "vision", "vmnih", "-", "nips2014", ",", "xu", "-", "icml2015", ",", "ba_iclr15", ",", "and", "for", "speech", "recognition", ".", "While", "they", "simply", "pre", "-", "trained", "with", "cross", "-", "entropy", "loss", ",", "we", "found", "that", "the", "use", "of", "a", "mixed", "loss", "and", "a", "more", "gentle", "incremental", "learning", "scheduling", "to", "be", "important", "for", "all", "the", "tasks", "we", "considered", ".", "section", ":", "Models", "The", "learning", "algorithms", "we", "describe", "in", "the", "following", "sections", "are", "agnostic", "to", "the", "choice", "of", "the", "underlying", "model", ",", "as", "long", "as", "it", "is", "parametric", ".", "In", "this", "work", ",", "we", "focus", "on", "Recurrent", "Neural", "Networks", "(", "RNNs", ")", "as", "they", "are", "a", "popular", "choice", "for", "text", "generation", ".", "In", "particular", ",", "we", "use", "standard", "Elman", "RNNs", "elman1990", "and", "LSTMs", "lstm", ".", "For", "the", "sake", "of", "simplicity", "but", "without", "loss", "of", "generality", ",", "we", "discuss", "next", "Elman", "RNNs", ".", "This", "is", "a", "parametric", "model", "that", "at", "each", "time", "step", ",", "takes", "as", "input", "a", "word", "as", "its", "input", ",", "together", "with", "an", "internal", "representation", ".", "is", "the", "the", "vocabulary", "of", "input", "words", ".", "This", "internal", "representation", "is", "a", "real", "-", "valued", "vector", "which", "encodes", "the", "history", "of", "words", "the", "model", "has", "seen", "so", "far", ".", "Optionally", ",", "the", "RNN", "can", "also", "take", "as", "input", "an", "additional", "context", "vector", ",", "which", "encodes", "the", "context", "to", "be", "used", "while", "generating", "the", "output", ".", "In", "our", "experiments", "is", "computed", "using", "an", "attentive", "decoder", "inspired", "by", "and", "rush", "-", "2015", ",", "the", "details", "of", "which", "are", "given", "in", "Section", "[", "reference", "]", "of", "the", "supplementary", "material", ".", "The", "RNN", "learns", "a", "recursive", "function", "to", "compute", "and", "outputs", "the", "distribution", "over", "the", "next", "word", ":", "The", "parametric", "expression", "for", "and", "depends", "on", "the", "type", "of", "RNN", ".", "For", "Elman", "RNNs", "we", "have", ":", "where", "the", "parameters", "of", "the", "model", "are", "the", "set", "of", "matrices", "and", "also", "the", "additional", "parameters", "used", "to", "compute", ".", "is", "a", "vector", "whose", "components", "are", ",", "and", "is", "an", "indicator", "vector", "with", "only", "the", "-", "th", "component", "set", "to", "and", "the", "rest", "to", ".", "We", "assume", "the", "first", "word", "of", "the", "sequence", "is", "a", "special", "token", "indicating", "the", "beginning", "of", "a", "sequence", ",", "denoted", "by", ".", "All", "entries", "of", "the", "first", "hidden", "state", "are", "set", "to", "a", "constant", "value", ".", "Next", ",", "we", "are", "going", "to", "introduce", "both", "baselines", "and", "the", "model", "we", "propose", ".", "As", "we", "describe", "these", "models", ",", "it", "is", "useful", "to", "keep", "in", "mind", "the", "key", "characteristics", "of", "a", "text", "generation", "system", ",", "as", "outlined", "in", "Table", "[", "reference", "]", ".", "There", "are", "three", "dimensions", "which", "are", "important", "when", "training", "a", "model", "for", "text", "generation", ":", "the", "exposure", "bias", "which", "can", "adversely", "affect", "generation", "at", "test", "time", ",", "the", "ability", "to", "fully", "back", "-", "propagate", "gradients", "(", "including", "with", "respect", "to", "the", "chosen", "inputs", "at", "each", "time", "step", ")", ",", "and", "a", "loss", "operating", "at", "the", "sequence", "level", ".", "We", "will", "start", "discussing", "models", "that", "do", "not", "possess", "any", "of", "these", "desirable", "features", ",", "and", "then", "move", "towards", "models", "that", "better", "satisfy", "our", "requirements", ".", "The", "last", "model", "we", "propose", ",", "dubbed", "MIXER", ",", "has", "all", "the", "desiderata", ".", "subsection", ":", "Word", "-", "Level", "Training", "We", "now", "review", "a", "collection", "of", "methodologies", "used", "for", "training", "text", "generation", "models", "which", "optimize", "the", "prediction", "of", "only", "one", "word", "ahead", "of", "time", ".", "We", "start", "with", "the", "simplest", "and", "the", "most", "popular", "method", "which", "optimizes", "the", "cross", "-", "entropy", "loss", "at", "every", "time", "step", ".", "We", "then", "discuss", "a", "recently", "proposed", "modification", "to", "it", "which", "explicitly", "uses", "the", "model", "predictions", "during", "training", ".", "We", "finish", "by", "proposing", "a", "simple", "yet", "novel", "baseline", "which", "uses", "its", "model", "prediction", "during", "training", "and", "also", "has", "the", "ability", "to", "back", "propagate", "the", "gradients", "through", "the", "entire", "sequence", ".", "While", "these", "extensions", "tend", "to", "make", "generation", "more", "robust", ",", "they", "still", "lack", "explicit", "supervision", "at", "the", "sequence", "level", ".", "subsubsection", ":", "Cross", "Entropy", "Training", "(", "XENT", ")", "Cross", "-", "entropy", "loss", "(", "XENT", ")", "maximizes", "the", "probability", "of", "the", "observed", "sequence", "according", "to", "the", "model", ".", "If", "the", "target", "sequence", "is", ",", "then", "XENT", "training", "involves", "minimizing", ":", "When", "using", "an", "RNN", ",", "each", "term", "is", "modeled", "as", "a", "parametric", "function", "as", "given", "in", "Equation", "(", "[", "reference", "]", ")", ".", "This", "loss", "function", "trains", "the", "model", "to", "be", "good", "at", "greedily", "predicting", "the", "next", "word", "at", "each", "time", "step", "without", "considering", "the", "whole", "sequence", ".", "Training", "proceeds", "by", "truncated", "back", "-", "propagation", "through", "time", "bptt", "with", "gradient", "clipping", "mikolov", "-", "2010", ".", "Once", "trained", ",", "one", "can", "use", "the", "model", "to", "generate", "an", "entire", "sequence", "as", "follows", ".", "Let", "denote", "the", "word", "generated", "by", "the", "model", "at", "the", "-", "th", "time", "step", ".", "Then", "the", "next", "word", "is", "generated", "by", ":", "Notice", "that", ",", "the", "model", "is", "trained", "to", "maximize", ",", "where", "is", "the", "word", "in", "the", "ground", "truth", "sequence", ".", "However", ",", "during", "generation", "the", "model", "is", "used", "as", ".", "In", "other", "words", ",", "during", "training", "the", "model", "is", "only", "exposed", "to", "the", "ground", "truth", "words", ".", "However", ",", "at", "test", "time", "the", "model", "has", "only", "access", "to", "its", "own", "predictions", ",", "which", "may", "not", "be", "correct", ".", "As", "a", "result", ",", "during", "generation", "the", "model", "can", "potentially", "deviate", "quite", "far", "from", "the", "actual", "sequence", "to", "be", "generated", ".", "Figure", "[", "reference", "]", "illustrates", "this", "discrepancy", ".", "The", "generation", "described", "by", "Eq", ".", "(", "[", "reference", "]", ")", "is", "a", "greedy", "left", "-", "to", "-", "right", "process", "which", "does", "not", "necessarily", "produce", "the", "most", "likely", "sequence", "according", "to", "the", "model", ",", "because", ":", "The", "most", "likely", "sequence", "might", "contain", "a", "word", "which", "is", "sub", "-", "optimal", "at", "an", "intermediate", "time", "-", "step", ".", "This", "phenomena", "is", "commonly", "known", "as", "a", "search", "error", ".", "One", "popular", "way", "to", "reduce", "the", "effect", "of", "search", "error", "is", "to", "pursue", "not", "only", "one", "but", "next", "word", "candidates", "at", "each", "point", ".", "While", "still", "approximate", ",", "this", "strategy", "can", "recover", "higher", "scoring", "sequences", "that", "are", "often", "also", "better", "in", "terms", "of", "our", "final", "evaluation", "metric", ".", "This", "process", "is", "commonly", "know", "as", "Beam", "Search", ".", "The", "downside", "of", "using", "beam", "search", "is", "that", "it", "significantly", "slows", "down", "the", "generation", "process", ".", "The", "time", "complexity", "grows", "linearly", "in", "the", "number", "of", "beams", ",", "because", "we", "need", "to", "perform", "forward", "passes", "for", "our", "network", ",", "which", "is", "the", "most", "time", "intensive", "operation", ".", "The", "details", "of", "the", "Beam", "Search", "algorithm", "are", "described", "in", "Section", "[", "reference", "]", ".", "subsubsection", ":", "Data", "As", "Demonstrator", "(", "DAD", ")", "Conventional", "training", "with", "XENT", "suffers", "from", "exposure", "bias", "since", "training", "uses", "ground", "truth", "words", "as", "opposed", "to", "model", "predictions", ".", "DAD", ",", "proposed", "in", "dad", "and", "also", "used", "in", "sbengio", "-", "nips2015", "for", "sequence", "generation", ",", "addresses", "this", "issue", "by", "mixing", "the", "ground", "truth", "training", "data", "with", "model", "predictions", ".", "At", "each", "time", "step", "and", "with", "a", "certain", "probability", ",", "DAD", "takes", "as", "input", "either", "the", "prediction", "from", "the", "model", "at", "the", "previous", "time", "step", "or", "the", "ground", "truth", "data", ".", "sbengio", "-", "nips2015", "proposed", "different", "annealing", "schedules", "for", "the", "probability", "of", "choosing", "the", "ground", "truth", "word", ".", "The", "annealing", "schedules", "are", "such", "that", "at", "the", "beginning", ",", "the", "algorithm", "always", "chooses", "the", "ground", "truth", "words", ".", "However", ",", "as", "the", "training", "progresses", "the", "model", "predictions", "are", "selected", "more", "often", ".", "This", "has", "the", "effect", "of", "making", "the", "model", "somewhat", "more", "aware", "of", "how", "it", "will", "be", "used", "at", "test", "time", ".", "Figure", "[", "reference", "]", "illustrates", "the", "algorithm", ".", "A", "major", "limitation", "of", "DAD", "is", "that", "at", "every", "time", "step", "the", "target", "labels", "are", "always", "selected", "from", "the", "ground", "truth", "data", ",", "regardless", "of", "how", "the", "input", "was", "chosen", ".", "As", "a", "result", ",", "the", "targets", "may", "not", "be", "aligned", "with", "the", "generated", "sequence", ",", "forcing", "the", "model", "to", "predict", "a", "potentially", "incorrect", "sequence", ".", "For", "instance", ",", "if", "the", "ground", "truth", "sequence", "is", "\u201c", "I", "took", "a", "long", "walk", "\u201d", "and", "the", "model", "has", "so", "far", "predicted", "\u201c", "I", "took", "a", "walk", "\u201d", ",", "DAD", "will", "force", "the", "model", "to", "predict", "the", "word", "\u201c", "walk", "\u201d", "a", "second", "time", ".", "Finally", ",", "gradients", "are", "not", "back", "-", "propagated", "through", "the", "samples", "drawn", "by", "the", "model", "and", "the", "XENT", "loss", "is", "still", "at", "the", "word", "level", ".", "It", "is", "not", "well", "understood", "how", "these", "problems", "affect", "generation", ".", "subsubsection", ":", "End", "-", "to", "-", "End", "BackProp", "(", "E2E", ")", "The", "novel", "E2E", "algorithm", "is", "perhaps", "the", "most", "natural", "and", "na\u00efve", "approach", "approximating", "sequence", "level", "training", ",", "which", "can", "also", "be", "interpreted", "as", "a", "computationally", "efficient", "approximation", "to", "beam", "search", ".", "The", "key", "idea", "is", "that", "at", "time", "step", "we", "propagate", "as", "input", "the", "top", "words", "predicted", "at", "the", "previous", "time", "step", "instead", "of", "the", "ground", "truth", "word", ".", "Specifically", ",", "we", "take", "the", "output", "distribution", "over", "words", "from", "the", "previous", "time", "step", ",", "and", "pass", "it", "through", "a", "-", "max", "layer", ".", "This", "layer", "zeros", "all", "but", "the", "largest", "values", "and", "re", "-", "normalizes", "them", "to", "sum", "to", "one", ".", "We", "thus", "have", ":", "where", "are", "indexes", "of", "the", "words", "with", "largest", "probabilities", "and", "are", "their", "corresponding", "scores", ".", "At", "the", "time", "step", ",", "we", "take", "the", "largest", "scoring", "previous", "words", "as", "input", "whose", "contributions", "is", "weighted", "by", "their", "scores", "\u2019", "s.", "Smoothing", "the", "input", "this", "way", "makes", "the", "whole", "process", "differentiable", "and", "trainable", "using", "standard", "back", "-", "propagation", ".", "Compared", "to", "beam", "search", ",", "this", "can", "be", "interpreted", "as", "fusing", "the", "possible", "next", "hypotheses", "together", "into", "a", "single", "path", ",", "as", "illustrated", "in", "Figure", "[", "reference", "]", ".", "In", "practice", "we", "also", "employ", "a", "schedule", ",", "whereby", "we", "use", "only", "the", "ground", "truth", "words", "at", "the", "beginning", "and", "gradually", "let", "the", "model", "use", "its", "own", "top", "-", "predictions", "as", "training", "proceeds", ".", "While", "this", "algorithm", "is", "a", "simple", "way", "to", "expose", "the", "model", "to", "its", "own", "predictions", ",", "the", "loss", "function", "optimized", "is", "still", "XENT", "at", "each", "time", "step", ".", "There", "is", "no", "explicit", "supervision", "at", "the", "sequence", "level", "while", "training", "the", "model", ".", "subsection", ":", "Sequence", "Level", "Training", "We", "now", "introduce", "a", "novel", "algorithm", "for", "sequence", "level", "training", ",", "which", "we", "call", "Mixed", "Incremental", "Cross", "-", "Entropy", "Reinforce", "(", "MIXER", ")", ".", "The", "proposed", "method", "avoids", "the", "exposure", "bias", "problem", ",", "and", "also", "directly", "optimizes", "for", "the", "final", "evaluation", "metric", ".", "Since", "MIXER", "is", "an", "extension", "of", "the", "REINFORCE", "algorithm", ",", "we", "first", "describe", "REINFORCE", "from", "the", "perspective", "of", "sequence", "generation", ".", "subsubsection", ":", "REINFORCE", "In", "order", "to", "apply", "the", "REINFORCE", "algorithm", "reinforce", ",", "zaremba", "-", "arxiv2015", "to", "the", "problem", "of", "sequence", "generation", "we", "cast", "our", "problem", "in", "the", "reinforcement", "learning", "(", "RL", ")", "framework", "sutton", "-", "rl", ".", "Our", "generative", "model", "(", "the", "RNN", ")", "can", "be", "viewed", "as", "an", "agent", ",", "which", "interacts", "with", "the", "external", "environment", "(", "the", "words", "and", "the", "context", "vector", "it", "sees", "as", "input", "at", "every", "time", "step", ")", ".", "The", "parameters", "of", "this", "agent", "defines", "a", "policy", ",", "whose", "execution", "results", "in", "the", "agent", "picking", "an", "action", ".", "In", "the", "sequence", "generation", "setting", ",", "an", "action", "refers", "to", "predicting", "the", "next", "word", "in", "the", "sequence", "at", "each", "time", "step", ".", "After", "taking", "an", "action", "the", "agent", "updates", "its", "internal", "state", "(", "the", "hidden", "units", "of", "RNN", ")", ".", "Once", "the", "agent", "has", "reached", "the", "end", "of", "a", "sequence", ",", "it", "observes", "a", "reward", ".", "We", "can", "choose", "any", "reward", "function", ".", "Here", ",", "we", "use", "BLEU", "bleu", "and", "ROUGE", "-", "2", "rouge", "since", "these", "are", "the", "metrics", "we", "use", "at", "test", "time", ".", "BLEU", "is", "essentially", "a", "geometric", "mean", "over", "n", "-", "gram", "precision", "scores", "as", "well", "as", "a", "brevity", "penalty", "liang2006", ";", "in", "this", "work", ",", "we", "consider", "up", "to", "-", "grams", ".", "ROUGE", "-", "2", "is", "instead", "recall", "over", "bi", "-", "grams", ".", "Like", "in", "imitation", "learning", ",", "we", "have", "a", "training", "set", "of", "optimal", "sequences", "of", "actions", ".", "During", "training", "we", "choose", "actions", "according", "to", "the", "current", "policy", "and", "only", "observe", "a", "reward", "at", "the", "end", "of", "the", "sequence", "(", "or", "after", "maximum", "sequence", "length", ")", ",", "by", "comparing", "the", "sequence", "of", "actions", "from", "the", "current", "policy", "against", "the", "optimal", "action", "sequence", ".", "The", "goal", "of", "training", "is", "to", "find", "the", "parameters", "of", "the", "agent", "that", "maximize", "the", "expected", "reward", ".", "We", "define", "our", "loss", "as", "the", "negative", "expected", "reward", ":", "where", "is", "the", "word", "chosen", "by", "our", "model", "at", "the", "-", "th", "time", "step", ",", "and", "is", "the", "reward", "associated", "with", "the", "generated", "sequence", ".", "In", "practice", ",", "we", "approximate", "this", "expectation", "with", "a", "single", "sample", "from", "the", "distribution", "of", "actions", "implemented", "by", "the", "RNN", "(", "right", "hand", "side", "of", "the", "equation", "above", "and", "Figure", "[", "reference", "]", "of", "Supplementary", "Material", ")", ".", "We", "refer", "the", "reader", "to", "prior", "work", "zaremba", "-", "arxiv2015", ",", "reinforce", "for", "the", "full", "derivation", "of", "the", "gradients", ".", "Here", ",", "we", "directly", "report", "the", "partial", "derivatives", "and", "their", "interpretation", ".", "The", "derivatives", "w.r.t", ".", "parameters", "are", ":", "where", "is", "the", "input", "to", "the", "softmax", ".", "The", "gradient", "of", "the", "loss", "with", "respect", "to", "is", "given", "by", ":", "where", "is", "the", "average", "reward", "at", "time", ".", "The", "interpretation", "of", "this", "weight", "update", "rule", "is", "straightforward", ".", "While", "Equation", "[", "reference", "]", "is", "standard", "back", "-", "propagation", "(", "a.k.a", ".", "chain", "rule", ")", ",", "Equation", "[", "reference", "]", "is", "almost", "exactly", "the", "same", "as", "the", "gradient", "of", "a", "multi", "-", "class", "logistic", "regression", "classifier", ".", "In", "logistic", "regression", ",", "the", "gradient", "is", "the", "difference", "between", "the", "prediction", "and", "the", "actual", "1", "-", "of", "-", "N", "representation", "of", "the", "target", "word", ":", "Therefore", ",", "Equation", "[", "reference", "]", "says", "that", "the", "chosen", "word", "acts", "like", "a", "surrogate", "target", "for", "our", "output", "distribution", ",", "at", "time", ".", "REINFORCE", "first", "establishes", "a", "baseline", ",", "and", "then", "either", "encourages", "a", "word", "choice", "if", ",", "or", "discourages", "it", "if", ".", "The", "actual", "derivation", "suggests", "that", "the", "choice", "of", "this", "average", "reward", "is", "useful", "to", "decrease", "the", "variance", "of", "the", "gradient", "estimator", "since", "in", "Equation", "[", "reference", "]", "we", "use", "a", "single", "sample", "from", "the", "distribution", "of", "actions", ".", "In", "our", "implementation", ",", "the", "baseline", "is", "estimated", "by", "a", "linear", "regressor", "which", "takes", "as", "input", "the", "hidden", "states", "of", "the", "RNN", ".", "The", "regressor", "is", "an", "unbiased", "estimator", "of", "future", "rewards", "since", "it", "only", "uses", "past", "information", ".", "The", "parameters", "of", "the", "regressor", "are", "trained", "by", "minimizing", "the", "mean", "squared", "loss", ":", ".", "In", "order", "to", "prevent", "feedback", "loops", ",", "we", "do", "not", "backpropagate", "this", "error", "through", "the", "recurrent", "network", "zaremba", "-", "arxiv2015", ".", "REINFORCE", "is", "an", "elegant", "algorithm", "to", "train", "at", "the", "sequence", "level", "using", "any", "user", "-", "defined", "reward", ".", "In", "this", "work", ",", "we", "use", "BLEU", "and", "ROUGE", "-", "2", "as", "reward", ",", "however", "one", "could", "just", "as", "easily", "use", "any", "other", "metric", ".", "When", "presented", "as", "is", ",", "one", "major", "drawback", "associated", "with", "the", "algorithm", "is", "that", "it", "assumes", "a", "random", "policy", "to", "start", "with", ".", "This", "assumption", "can", "make", "the", "learning", "for", "large", "action", "spaces", "very", "challenging", ".", "Unfortunately", ",", "text", "generation", "is", "such", "a", "setting", "where", "the", "cardinality", "of", "the", "action", "set", "is", "in", "the", "order", "of", "(", "the", "number", "of", "words", "in", "the", "vocabulary", ")", ".", "This", "leads", "to", "a", "very", "high", "branching", "factor", "where", "it", "is", "extremely", "hard", "for", "a", "random", "policy", "to", "improve", "in", "any", "reasonable", "amount", "of", "time", ".", "In", "the", "next", "section", "we", "describe", "the", "MIXER", "algorithm", "which", "addresses", "these", "issues", ",", "better", "targeting", "text", "generation", "applications", ".", "subsubsection", ":", "Mixed", "Incremental", "Cross", "-", "Entropy", "Reinforce", "(", "MIXER", ")", "The", "MIXER", "algorithm", "borrows", "ideas", "both", "from", "DAGGER", "dagger", "and", "DAD", "dad", ",", "sbengio", "-", "nips2015", "and", "modifies", "the", "REINFORCE", "appropriately", ".", "The", "first", "key", "idea", "is", "to", "change", "the", "initial", "policy", "of", "REINFORCE", "to", "make", "sure", "the", "model", "can", "effectively", "deal", "with", "the", "large", "action", "space", "of", "text", "generation", ".", "Instead", "of", "starting", "from", "a", "poor", "random", "policy", "and", "training", "the", "model", "to", "converge", "towards", "the", "optimal", "policy", ",", "we", "do", "the", "exact", "opposite", ".", "We", "start", "from", "the", "optimal", "policy", "and", "then", "slowly", "deviate", "from", "it", "to", "let", "the", "model", "explore", "and", "make", "use", "of", "its", "own", "predictions", ".", "We", "first", "train", "the", "RNN", "with", "the", "cross", "-", "entropy", "loss", "for", "epochs", "using", "the", "ground", "truth", "sequences", ".", "This", "ensures", "that", "we", "start", "off", "with", "a", "much", "better", "policy", "than", "random", "because", "now", "the", "model", "can", "focus", "on", "a", "good", "part", "of", "the", "search", "space", ".", "This", "can", "be", "better", "understood", "by", "comparing", "the", "perplexity", "of", "a", "language", "model", "that", "is", "randomly", "initialized", "versus", "one", "that", "is", "trained", ".", "Perplexity", "is", "a", "measure", "of", "uncertainty", "of", "the", "prediction", "and", ",", "roughly", "speaking", ",", "it", "corresponds", "to", "the", "average", "number", "of", "words", "the", "model", "is", "\u2018", "hesitating", "\u2019", "about", "when", "making", "a", "prediction", ".", "A", "good", "language", "model", "trained", "on", "one", "of", "our", "data", "sets", "has", "perplexity", "of", ",", "whereas", "a", "random", "model", "is", "likely", "to", "have", "perplexity", "close", "to", "the", "size", "of", "the", "vocabulary", ",", "which", "is", "about", ".", "The", "second", "idea", "is", "to", "introduce", "model", "predictions", "during", "training", "with", "an", "annealing", "schedule", "in", "order", "to", "gradually", "teach", "the", "model", "to", "produce", "stable", "sequences", ".", "Let", "be", "the", "length", "of", "the", "sequence", ".", "After", "the", "initial", "epochs", ",", "we", "continue", "training", "the", "model", "for", "epochs", ",", "such", "that", ",", "for", "every", "sequence", "we", "use", "the", "XENT", "loss", "for", "the", "first", "(", ")", "steps", ",", "and", "the", "REINFORCE", "algorithm", "for", "the", "remaining", "steps", ".", "In", "our", "experiments", "is", "typically", "set", "to", "two", "or", "three", ".", "Next", "we", "anneal", "the", "number", "of", "steps", "for", "which", "we", "use", "the", "XENT", "loss", "for", "every", "sequence", "to", "(", ")", "and", "repeat", "the", "training", "for", "another", "epochs", ".", "We", "repeat", "this", "process", "until", "only", "REINFORCE", "is", "used", "to", "train", "the", "whole", "sequence", ".", "See", "Algorithm", "[", "reference", "]", "for", "the", "pseudo", "-", "code", ".", "We", "call", "this", "algorithm", "Mixed", "Incremental", "Cross", "-", "Entropy", "Reinforce", "(", "MIXER", ")", "because", "we", "combine", "both", "XENT", "and", "REINFORCE", ",", "and", "we", "use", "incremental", "learning", "(", "a.k.a", ".", "curriculum", "learning", ")", ".", "The", "overall", "algorithm", "is", "illustrated", "in", "Figure", "[", "reference", "]", ".", "By", "the", "end", "of", "training", ",", "the", "model", "can", "make", "effective", "use", "of", "its", "own", "predictions", "in", "-", "line", "with", "its", "use", "at", "test", "time", ".", "[", "t", "]", "a", "set", "of", "sequences", "with", "their", "corresponding", "context", ".", "optimized", "for", "generation", ".", "Initialize", "RNN", "at", "random", "and", "set", "NXENT", ",", "NXE", "+", "R", "and", "\u0394", "=", "T", ",", "1", ",", "-", "\u0394", "s", "=", "=", "T", "train", "RNN", "for", "NXENT", "epochs", "using", "XENT", "only", "train", "RNN", "for", "NXE", "+", "R", "epochs", ".", "Use", "XENT", "loss", "in", "the", "first", "s", "steps", ",", "and", "REINFORCE", "(", "sampling", "from", "the", "model", ")", "in", "the", "remaining", "-", "Ts", "steps", "MIXER", "pseudo", "-", "code", ".", "section", ":", "Experiments", "In", "all", "our", "experiments", ",", "we", "train", "conditional", "RNNs", "by", "unfolding", "them", "up", "to", "a", "certain", "maximum", "length", ".", "We", "chose", "this", "length", "to", "cover", "about", "of", "the", "target", "sentences", "in", "the", "data", "sets", "we", "consider", ".", "The", "remaining", "sentences", "are", "cropped", "to", "the", "chosen", "maximum", "length", ".", "For", "training", ",", "we", "use", "stochastic", "gradient", "descent", "with", "mini", "-", "batches", "of", "size", "and", "we", "reset", "the", "hidden", "states", "at", "the", "beginning", "of", "each", "sequence", ".", "Before", "updating", "the", "parameters", "we", "re", "-", "scale", "the", "gradients", "if", "their", "norm", "is", "above", "mikolov", "-", "2010", ".", "We", "search", "over", "the", "values", "of", "hyper", "-", "parameter", ",", "such", "as", "the", "initial", "learning", "rate", ",", "the", "various", "scheduling", "parameters", ",", "number", "of", "epochs", ",", "etc", ".", ",", "using", "a", "held", "-", "out", "validation", "set", ".", "We", "then", "take", "the", "model", "that", "performed", "best", "on", "the", "validation", "set", "and", "compute", "BLEU", "or", "ROUGE", "score", "on", "the", "test", "set", ".", "In", "the", "following", "sections", "we", "report", "results", "on", "the", "test", "set", "only", ".", "Greedy", "generation", "is", "performed", "by", "taking", "the", "most", "likely", "word", "at", "each", "time", "step", ".", "subsection", ":", "Text", "Summarization", "We", "consider", "the", "problem", "of", "abstractive", "summarization", "where", ",", "given", "a", "piece", "of", "\u201c", "source", "\u201d", "text", ",", "we", "aim", "at", "generating", "its", "summary", "(", "the", "\u201c", "target", "\u201d", "text", ")", "such", "that", "its", "meaning", "is", "intact", ".", "The", "data", "set", "we", "use", "to", "train", "and", "evaluate", "our", "models", "consists", "of", "a", "subset", "of", "the", "Gigaword", "corpus", "gigaword", "as", "described", "in", "rush", "-", "2015", ".", "This", "is", "a", "collection", "of", "news", "articles", "taken", "from", "different", "sources", "over", "the", "past", "two", "decades", ".", "Our", "version", "is", "organized", "as", "a", "set", "of", "example", "pairs", ",", "where", "each", "pair", "is", "composed", "of", "the", "first", "sentence", "of", "a", "news", "article", "(", "the", "source", "sentence", ")", "and", "its", "corresponding", "headline", "(", "the", "target", "sentence", ")", ".", "We", "pre", "-", "process", "the", "data", "in", "the", "same", "way", "as", "in", "rush", "-", "2015", ",", "which", "consists", "of", "lower", "-", "casing", "and", "replacing", "the", "infrequent", "words", "with", "a", "special", "token", "denoted", "by", "\u201c", "unk", "\u201d", ".", "After", "pre", "-", "processing", "there", "are", "unique", "words", "in", "the", "source", "dictionary", "and", "words", "in", "the", "target", "dictionary", ".", "The", "number", "of", "sample", "pairs", "in", "the", "training", ",", "validation", "and", "test", "set", "are", ",", ",", "and", "respectively", ".", "The", "average", "sequence", "length", "of", "the", "target", "headline", "is", "about", "words", ".", "We", "considered", "sequences", "up", "to", "words", "to", "comply", "with", "our", "initial", "constraint", "of", "covering", "at", "least", "%", "of", "the", "data", ".", "Our", "generative", "model", "is", "a", "conditional", "Elman", "RNN", "(", "Equation", "[", "reference", "]", ")", "with", "hidden", "units", ",", "where", "the", "conditioning", "vector", "is", "provided", "by", "a", "convolutional", "attentive", "encoder", ",", "similar", "to", "the", "one", "described", "in", "Section", "3.2", "of", "rush", "-", "2015", "and", "inspired", "by", ".", "The", "details", "of", "our", "attentive", "encoder", "are", "mentioned", "in", "Section", "[", "reference", "]", "of", "the", "Supplementary", "Material", ".", "We", "also", "tried", "LSTMs", "as", "our", "generative", "model", "for", "this", "task", ",", "however", "it", "did", "not", "improve", "performance", ".", "We", "conjecture", "this", "is", "due", "to", "the", "fact", "that", "the", "target", "sentences", "in", "this", "data", "set", "are", "rather", "short", ".", "subsection", ":", "Machine", "Translation", "For", "the", "translation", "task", ",", "our", "generative", "model", "is", "an", "LSTM", "with", "hidden", "units", "and", "it", "uses", "the", "same", "attentive", "encoder", "architecture", "as", "the", "one", "used", "for", "summarization", ".", "We", "use", "data", "from", "the", "German", "-", "English", "machine", "translation", "track", "of", "the", "IWSLT", "2014", "evaluation", "campaign", "cettolo2014", ".", "The", "corpus", "consists", "of", "sentence", "-", "aligned", "subtitles", "of", "TED", "and", "TEDx", "talks", ".", "We", "pre", "-", "process", "the", "training", "data", "using", "the", "tokenizer", "of", "the", "Moses", "toolkit", "koehn2007", "and", "remove", "sentences", "longer", "than", "words", "as", "well", "as", "casing", ".", "The", "training", "data", "comprises", "of", "about", "sentences", "where", "the", "average", "English", "sentence", "is", "words", "long", "and", "the", "average", "German", "sentence", "is", "words", "long", ".", "In", "order", "to", "retain", "at", "least", "of", "this", "data", ",", "we", "unrolled", "our", "RNN", "for", "steps", ".", "Our", "validation", "set", "comprises", "of", "sentence", "pairs", "which", "was", "taken", "from", "the", "training", "data", ".", "The", "test", "set", "is", "a", "concatenation", "of", "dev2010", ",", "dev2012", ",", "tst2010", ",", "tst2011", "and", "tst2012", "which", "results", "in", "sentence", "pairs", ".", "The", "English", "dictionary", "has", "words", "while", "the", "German", "has", "words", ".", "subsection", ":", "Image", "Captioning", "For", "the", "image", "captioning", "task", ",", "we", "use", "the", "MSCOCO", "dataset", "mscoco", ".", "We", "use", "the", "entire", "training", "set", "provided", "by", "the", "authors", ",", "which", "consists", "of", "around", "k", "images", ".", "We", "then", "took", "the", "original", "validation", "set", "(", "consisting", "of", "around", "k", "images", ")", "and", "randomly", "sampled", "(", "without", "replacement", ")", "images", "for", "validation", "and", "another", "for", "test", ".", "There", "are", "different", "captions", "for", "each", "image", ".", "At", "training", "time", "we", "sample", "one", "of", "these", "captions", ",", "while", "at", "test", "time", "we", "report", "the", "maximum", "BLEU", "score", "across", "the", "five", "captions", ".", "The", "context", "is", "represented", "by", "1024", "features", "extracted", "by", "a", "Convolutional", "Neural", "Network", "(", "CNN", ")", "trained", "on", "the", "Imagenet", "dataset", "imagenet_cvpr09", ";", "we", "do", "not", "back", "-", "propagate", "through", "these", "features", ".", "We", "use", "a", "similar", "experimental", "set", "up", "as", "described", "in", "sbengio", "-", "nips2015", ".", "The", "RNN", "is", "a", "single", "layer", "LSTM", "with", "hidden", "units", "and", "the", "image", "features", "are", "provided", "to", "the", "generative", "model", "as", "the", "first", "word", "in", "the", "sequence", ".", "We", "pre", "-", "process", "the", "captions", "by", "lower", "-", "casing", "all", "words", "and", "replacing", "all", "the", "words", "which", "appear", "less", "than", "3", "times", "with", "a", "special", "token", "\u201c", "unk", "\u201d", ".", "As", "a", "result", "the", "total", "number", "of", "unique", "words", "in", "our", "dataset", "is", ".", "Keeping", "in", "mind", "the", "rule", ",", "we", "unroll", "the", "RNN", "for", "steps", ".", "subsection", ":", "Results", "In", "order", "to", "validate", "MIXER", ",", "we", "compute", "BLEU", "score", "on", "the", "machine", "translation", "and", "image", "captioning", "task", ",", "and", "ROUGE", "on", "the", "summarization", "task", ".", "The", "input", "provided", "to", "the", "system", "is", "only", "the", "context", "and", "the", "beginning", "of", "sentence", "token", ".", "We", "apply", "the", "same", "protocol", "to", "the", "baseline", "methods", "as", "well", ".", "The", "scores", "on", "the", "test", "set", "are", "reported", "in", "Figure", "[", "reference", "]", ".", "We", "observe", "that", "MIXER", "produces", "the", "best", "generations", "and", "improves", "generation", "over", "XENT", "by", "to", "points", "across", "all", "the", "tasks", ".", "Unfortunately", "the", "E2E", "approach", "did", "not", "prove", "to", "be", "very", "effective", ".", "Training", "at", "the", "sequence", "level", "and", "directly", "optimizing", "for", "testing", "score", "yields", "better", "generations", "than", "turning", "a", "sequence", "of", "discrete", "decisions", "into", "a", "differentiable", "process", "amenable", "to", "standard", "back", "-", "propagation", "of", "the", "error", ".", "DAD", "is", "usually", "better", "than", "the", "XENT", ",", "but", "not", "as", "good", "as", "MIXER", ".", "Overall", ",", "these", "experiments", "demonstrate", "the", "importance", "of", "optimizing", "for", "the", "metric", "used", "at", "test", "time", ".", "In", "summarization", "for", "instance", ",", "XENT", "and", "MIXER", "trained", "with", "ROUGE", "achieve", "a", "poor", "performance", "in", "terms", "of", "BLEU", "(", "8.16", "and", "5.80", "versus", "9.32", "of", "MIXER", "trained", "with", "BLEU", ")", ";", "likewise", ",", "MIXER", "trained", "with", "BLEU", "does", "not", "achieve", "as", "good", "ROUGE", "score", "as", "a", "MIXER", "optimizing", "ROUGE", "at", "training", "time", "as", "well", "(", "15.1", "versus", "16.22", ",", "see", "also", "Figure", "[", "reference", "]", "in", "Supplementary", "Material", ")", ".", "Next", ",", "we", "experimented", "with", "beam", "search", ".", "The", "results", "in", "Figure", "[", "reference", "]", "suggest", "that", "all", "methods", ",", "including", "MIXER", ",", "improve", "the", "quality", "of", "their", "generation", "by", "using", "beam", "search", ".", "However", ",", "the", "extent", "of", "the", "improvement", "is", "very", "much", "task", "dependent", ".", "We", "observe", "that", "the", "greedy", "performance", "of", "MIXER", "(", "i.e.", ",", "without", "beam", "search", ")", "can", "not", "be", "matched", "by", "baselines", "using", "beam", "search", "in", "two", "out", "of", "the", "three", "tasks", ".", "Moreover", ",", "MIXER", "is", "several", "times", "faster", "since", "it", "relies", "only", "on", "greedy", "search", ".", "It", "is", "worth", "mentioning", "that", "the", "REINFORCE", "baseline", "did", "not", "work", "for", "these", "applications", ".", "Exploration", "from", "a", "random", "policy", "has", "little", "chance", "of", "success", ".", "We", "do", "not", "report", "it", "since", "we", "were", "never", "able", "to", "make", "it", "converge", "within", "a", "reasonable", "amount", "of", "time", ".", "Using", "the", "hybrid", "XENT", "-", "REINFORCE", "loss", "without", "incremental", "learning", "is", "also", "insufficient", "to", "make", "training", "take", "off", "from", "random", "chance", ".", "In", "order", "to", "gain", "some", "insight", "on", "what", "kind", "of", "schedule", "works", ",", "we", "report", "in", "Table", "[", "reference", "]", "of", "Supplementary", "Material", "the", "best", "values", "we", "found", "after", "grid", "search", "over", "the", "hyper", "-", "parameters", "of", "MIXER", ".", "Finally", ",", "we", "report", "some", "anecdotal", "examples", "of", "MIXER", "generation", "in", "Figure", "[", "reference", "]", "of", "Supplementary", "Material", ".", "section", ":", "Conclusions", "Our", "work", "is", "motivated", "by", "two", "major", "deficiencies", "in", "training", "the", "current", "generative", "models", "for", "text", "generation", ":", "exposure", "bias", "and", "a", "loss", "which", "does", "not", "operate", "at", "the", "sequence", "level", ".", "While", "Reinforcement", "learning", "can", "potentially", "address", "these", "issues", ",", "it", "struggles", "in", "settings", "when", "there", "are", "very", "large", "action", "spaces", ",", "such", "as", "in", "text", "generation", ".", "Towards", "that", "end", ",", "we", "propose", "the", "MIXER", "algorithm", ",", "which", "deals", "with", "these", "issues", "and", "enables", "successful", "training", "of", "reinforcement", "learning", "models", "for", "text", "generation", ".", "We", "achieve", "this", "by", "replacing", "the", "initial", "random", "policy", "with", "the", "optimal", "policy", "of", "a", "cross", "-", "entropy", "trained", "model", "and", "by", "gradually", "exposing", "the", "model", "more", "and", "more", "to", "its", "own", "predictions", "in", "an", "incremental", "learning", "framework", ".", "Our", "results", "show", "that", "MIXER", "outperforms", "three", "strong", "baselines", "for", "greedy", "generation", "and", "it", "is", "very", "competitive", "with", "beam", "search", ".", "The", "approach", "we", "propose", "is", "agnostic", "to", "the", "underlying", "model", "or", "the", "form", "of", "the", "reward", "function", ".", "In", "future", "work", "we", "would", "like", "to", "design", "better", "estimation", "techniques", "for", "the", "average", "reward", ",", "because", "poor", "estimates", "can", "lead", "to", "slow", "convergence", "of", "both", "REINFORCE", "and", "MIXER", ".", "Finally", ",", "our", "training", "algorithm", "relies", "on", "a", "single", "sample", "while", "it", "would", "be", "interesting", "to", "investigate", "the", "effect", "of", "more", "comprehensive", "search", "methods", "at", "training", "time", ".", "subsubsection", ":", "Acknowledgments", "The", "authors", "would", "like", "to", "thank", "David", "Grangier", ",", "Tomas", "Mikolov", ",", "Leon", "Bottou", ",", "Ronan", "Collobert", "and", "Laurens", "van", "der", "Maaten", "for", "their", "insightful", "comments", ".", "We", "also", "would", "like", "to", "thank", "Alexander", "M.", "Rush", "for", "his", "help", "in", "preparing", "the", "data", "set", "for", "the", "summarization", "task", "and", "Sam", "Gross", "for", "providing", "the", "image", "features", ".", "bibliography", ":", "References", "section", ":", "Supplementary", "Material", "subsection", ":", "Experiments", "subsubsection", ":", "Qualitative", "Comparison", "subsubsection", ":", "Hyperparameters", "subsubsection", ":", "Relative", "Gains", "Training", "with", "exposure", "bias", "Training", "in", "expectation", "(", "Reinforce", ")", "subsection", ":", "The", "Attentive", "Encoder", "Here", "we", "explain", "in", "detail", "how", "we", "generate", "the", "conditioning", "vector", "for", "our", "RNN", "using", "the", "source", "sentence", "and", "the", "current", "hidden", "state", ".", "Let", "us", "denote", "by", "the", "source", "sentence", "which", "is", "composed", "of", "a", "sequence", "of", "words", ".", "With", "a", "slight", "overload", "of", "notation", "let", "also", "denote", "the", "dimensional", "learnable", "embedding", "of", "the", "-", "th", "word", "(", ")", ".", "In", "addition", "the", "position", "of", "the", "word", "is", "also", "associated", "with", "a", "learnable", "embedding", "of", "size", "(", ")", ".", "Then", "the", "full", "embedding", "for", "the", "-", "th", "word", "in", "the", "input", "sentence", "is", "given", "by", ".", "In", "order", "for", "the", "embeddings", "to", "capture", "local", "context", ",", "we", "associate", "an", "aggregate", "embedding", "to", "each", "word", "in", "the", "source", "sentence", ".", "In", "particular", "for", "a", "word", "in", "the", "-", "th", "position", ",", "its", "aggregate", "embedding", "is", "computed", "by", "taking", "a", "window", "of", "consecutive", "words", "centered", "at", "position", "and", "averaging", "the", "embeddings", "of", "all", "the", "words", "in", "this", "window", ".", "More", "precisely", ",", "the", "aggregate", "embedding", "is", "given", "by", ":", "In", "our", "experiments", "the", "width", "was", "set", "to", ".", "In", "order", "to", "account", "for", "the", "words", "at", "the", "two", "boundaries", "of", "the", "input", "sentence", "we", "first", "pad", "the", "sequence", "on", "both", "sides", "with", "dummy", "words", "before", "computing", "the", "aggregate", "vectors", "s.", "Given", "these", "aggregate", "vectors", "of", "words", ",", "we", "compute", "the", "context", "vector", "(", "the", "final", "output", "of", "the", "encoder", ")", "as", ":", "where", "the", "weights", "are", "computed", "as", "subsection", ":", "Beam", "Search", "Algorithm", "Equation", "[", "reference", "]", "always", "chooses", "the", "highest", "scoring", "next", "word", "candidate", "at", "each", "time", "step", ".", "At", "test", "time", "we", "can", "reduce", "the", "effect", "of", "search", "error", "by", "pursuing", "not", "only", "one", "but", "next", "word", "candidates", "at", "each", "point", ",", "which", "is", "commonly", "known", "as", "beam", "search", ".", "While", "still", "approximate", ",", "this", "strategy", "can", "recover", "higher", "scoring", "sequences", "that", "are", "often", "also", "better", "in", "terms", "of", "our", "final", "evaluation", "metric", ".", "The", "algorithm", "maintains", "the", "highest", "scoring", "partial", "sequences", ",", "where", "is", "a", "hyper", "-", "parameter", ".", "Setting", "reduces", "the", "algorithm", "to", "a", "greedy", "left", "-", "to", "-", "right", "search", "(", "Eq", ".", "(", "[", "reference", "]", ")", ")", ".", "[", "!", "h", "]", "model", ",", "beam", "size", "sequence", "of", "words", "empty", "heaps", "an", "empty", "hidden", "state", "vector", "-", "most", "likely", "words", "from", "Pseudo", "-", "code", "of", "beam", "search", "with", "beam", "size", "k.", "subsection", ":", "Notes", "The", "current", "version", "of", "the", "paper", "updates", "the", "first", "version", "uploaded", "on", "arXiv", "as", "follows", ":", "on", "the", "summarization", "task", ",", "we", "report", "results", "using", "both", "ROUGE", "-", "2", "and", "BLEU", "to", "demonstrate", "that", "MIXER", "can", "work", "with", "any", "metric", ".", "on", "machine", "translation", "and", "image", "captioning", "we", "use", "LSTM", "instead", "of", "Elman", "RNN", "to", "demonstrate", "the", "MIXER", "can", "work", "with", "any", "underlying", "parametric", "model", ".", "BLEU", "is", "evaluated", "using", "up", "to", "4", "-", "grams", ",", "and", "it", "is", "computed", "at", "the", "corpus", "level", "(", "except", "in", "the", "image", "captioning", "case", ")", "as", "this", "seems", "the", "most", "common", "practice", "in", "the", "summarization", "and", "machine", "translation", "literature", ".", "we", "have", "added", "several", "references", "as", "suggested", "by", "our", "reviewers", "we", "have", "shortened", "the", "paper", "by", "moving", "some", "content", "to", "the", "Supplementary", "Material", "."]}