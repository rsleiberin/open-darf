{"coref": {"Mean_Error_Rate": [[5332, 5334], [5685, 5687], [6139, 6141]], "Question_Answering": [], "RR": [], "_RR": [[93, 95], [132, 134], [149, 151], [232, 234], [476, 478], [616, 618], [697, 699], [804, 806], [935, 937], [2311, 2313], [2395, 2397], [2419, 2421], [2441, 2443], [2516, 2518], [2837, 2839], [3416, 3418], [3628, 3630], [3908, 3910], [4313, 4315], [5723, 5725], [6194, 6196], [172, 174], [539, 541], [958, 960], [992, 994], [1029, 1031], [4280, 4282], [4372, 4374]], "bAbi": [[105, 111], [125, 126], [1046, 1047], [1936, 1937], [2412, 2413], [2899, 2900], [3920, 3921], [5086, 5087], [5533, 5534], [6079, 6080], [6612, 6613], [1931, 1932], [2048, 2049], [2317, 2318], [2402, 2403], [4004, 4005], [5359, 5360], [5375, 5376]]}, "coref_non_salient": {"0": [[216, 218], [255, 257], [290, 291], [293, 294], [839, 845], [1048, 1049], [1070, 1072], [3143, 3145], [3738, 3739], [3760, 3761], [3986, 3987], [5807, 5809]], "1": [[4731, 4734], [4759, 4761], [4765, 4767]], "10": [[4240, 4242], [4324, 4326], [4958, 4960]], "100": [[4047, 4049]], "101": [[970, 971]], "102": [[6293, 6295]], "103": [[1972, 1973]], "104": [[3964, 3967]], "105": [[72, 77]], "106": [[999, 1002]], "107": [[855, 857]], "108": [[1121, 1124]], "109": [[867, 869]], "11": [[2129, 2130], [4893, 4896], [3747, 3748], [4319, 4320], [4663, 4664], [5099, 5100], [5267, 5268], [5285, 5286], [5545, 5546], [5969, 5970], [6240, 6241], [6620, 6621]], "110": [[4668, 4671]], "111": [[4516, 4520]], "112": [[4763, 4764]], "113": [[6047, 6048]], "114": [[4919, 4923]], "115": [[1974, 1975]], "116": [[2121, 2125]], "117": [[3031, 3035]], "118": [[22, 24]], "119": [[4115, 4122]], "12": [[1006, 1010], [4735, 4736]], "120": [[913, 919]], "121": [[909, 911]], "122": [[3895, 3898]], "123": [[5215, 5219]], "124": [[762, 765]], "125": [[3574, 3575]], "126": [[2948, 2952]], "127": [[825, 829]], "128": [[4349, 4352]], "13": [[3558, 3560], [4903, 4905]], "14": [[5110, 5112], [5273, 5275], [5431, 5433], [5556, 5558], [5775, 5777], [5980, 5982], [6096, 6098], [6628, 6630]], "15": [[2989, 2994], [3922, 3927], [2467, 2472]], "16": [[4528, 4531], [4617, 4620]], "17": [[401, 403], [950, 952]], "18": [[1224, 1226], [1733, 1736]], "19": [[2067, 2068], [3047, 3048], [3323, 3324], [3384, 3385], [3459, 3460], [3479, 3480], [3526, 3527]], "2": [[1804, 1808], [3444, 3446], [3800, 3802], [4452, 4456]], "20": [[3577, 3579], [6178, 6181], [6229, 6232], [6267, 6269]], "21": [[265, 267], [562, 564]], "22": [[2126, 2127], [2144, 2145], [5226, 5227], [6083, 6084]], "23": [[4890, 4891], [4906, 4907], [4934, 4935]], "24": [[558, 561], [1954, 1955]], "25": [[2284, 2286], [5461, 5463]], "26": [[2169, 2171], [2280, 2282]], "27": [[413, 416], [1316, 1319]], "28": [[4687, 4692]], "29": [[1425, 1426], [5102, 5103], [5548, 5549], [5972, 5973], [6616, 6617]], "3": [[483, 485], [549, 551], [3023, 3025], [3027, 3029], [3570, 3572], [4236, 4238], [4321, 4323], [5389, 5391], [6159, 6162], [6186, 6188]], "30": [[5057, 5060], [6298, 6301]], "31": [[1398, 1400], [5204, 5206], [5598, 5600], [6063, 6065]], "32": [[2810, 2811], [5506, 5507], [5713, 5714], [5792, 5793]], "33": [[5695, 5698]], "34": [[4790, 4793]], "35": [[140, 143], [2528, 2531], [3932, 3935], [5524, 5527], [154, 157], [184, 187], [2407, 2410], [2492, 2495], [5516, 5519]], "36": [[408, 409], [1660, 1661], [2150, 2151], [2195, 2196], [2386, 2387], [2912, 2913], [2998, 2999], [3199, 3200], [5208, 5209], [5255, 5256], [5602, 5603], [5614, 5615], [6067, 6068], [2955, 2956], [5439, 5440], [5728, 5729], [5753, 5754], [5784, 5785], [6217, 6218]], "37": [[10, 11], [565, 567]], "38": [[82, 85], [4798, 4800], [4802, 4804]], "39": [[4898, 4900]], "4": [[397, 400], [3957, 3960]], "40": [[6028, 6032]], "41": [[2276, 2277], [5287, 5288], [5479, 5480]], "42": [[4338, 4341], [4345, 4348]], "43": [[5339, 5341], [6146, 6148]], "44": [[4851, 4855]], "45": [[3634, 3637], [3653, 3656], [4553, 4556]], "46": [[610, 612]], "47": [[1501, 1503], [4503, 4505], [4521, 4523], [4589, 4591], [4628, 4631]], "48": [[4606, 4608]], "49": [[4190, 4191]], "5": [[193, 197], [405, 407], [1403, 1407]], "50": [[5322, 5324], [5681, 5683], [6136, 6137]], "51": [[5399, 5401]], "52": [[4795, 4797]], "53": [[4961, 4962]], "54": [[4685, 4686]], "55": [[5105, 5107], [5551, 5553], [5756, 5758], [5975, 5977]], "56": [[6656, 6660]], "57": [[4682, 4684]], "58": [[4623, 4625]], "59": [[4477, 4480]], "6": [[2, 5], [53, 56], [113, 116], [198, 203], [209, 212], [602, 605], [1052, 1055], [1061, 1064], [1231, 1234], [1606, 1609], [1615, 1618], [3061, 3064], [4981, 4984], [5638, 5641], [6660, 6663]], "60": [[5073, 5076]], "61": [[5211, 5213], [5605, 5607]], "62": [[4533, 4535]], "63": [[4964, 4971]], "64": [[4774, 4777]], "65": [[4838, 4844]], "66": [[1601, 1603]], "67": [[65, 69]], "68": [[862, 864]], "69": [[1620, 1622]], "7": [[3406, 3407], [6692, 6694]], "70": [[1951, 1953]], "71": [[3660, 3661], [3979, 3980]], "72": [[5794, 5795]], "73": [[3641, 3643]], "74": [[4972, 4975]], "75": [[858, 859]], "76": [[4211, 4214]], "77": [[4656, 4658]], "78": [[733, 736], [767, 770], [1295, 1298], [3949, 3952]], "79": [[4638, 4639]], "8": [[5379, 5380], [5476, 5477], [5492, 5495]], "80": [[2821, 2823]], "81": [[942, 949]], "82": [[1591, 1593]], "83": [[1976, 1980]], "84": [[1815, 1818]], "85": [[4196, 4199]], "86": [[4536, 4540]], "87": [[710, 714], [1308, 1312]], "88": [[5610, 5612]], "89": [[598, 600]], "9": [[3639, 3640], [4705, 4708], [982, 983], [1183, 1184], [3688, 3689], [4129, 4130]], "90": [[4592, 4594]], "91": [[619, 627]], "92": [[4472, 4473]], "93": [[511, 513]], "94": [[497, 500]], "95": [[6038, 6042]], "96": [[1527, 1530]], "97": [[58, 61]], "98": [[417, 418]], "99": [[1598, 1600]]}, "doc_id": "34273979fd2a62fd7b49ee6d14a925864ff94e74", "method_subrelations": {"_RR": [[[1, 3], "RR"]]}, "n_ary_relations": [{"Material": "bAbi", "Method": "_RR", "Metric": "Mean_Error_Rate", "Task": "Question_Answering", "score": "0.46%"}], "ner": [[2, 5, "Method"], [10, 11, "Task"], [22, 24, "Method"], [53, 56, "Method"], [58, 61, "Method"], [65, 69, "Method"], [72, 77, "Method"], [82, 85, "Method"], [93, 95, "Method"], [105, 111, "Material"], [113, 116, "Method"], [125, 126, "Material"], [132, 134, "Method"], [140, 143, "Material"], [149, 151, "Method"], [193, 197, "Method"], [198, 203, "Method"], [209, 212, "Method"], [216, 218, "Material"], [232, 234, "Method"], [255, 257, "Material"], [265, 267, "Task"], [290, 291, "Material"], [293, 294, "Material"], [397, 400, "Method"], [401, 403, "Task"], [405, 407, "Method"], [408, 409, "Method"], [413, 416, "Method"], [417, 418, "Method"], [476, 478, "Method"], [483, 485, "Method"], [497, 500, "Task"], [511, 513, "Method"], [549, 551, "Method"], [558, 561, "Task"], [562, 564, "Task"], [565, 567, "Task"], [598, 600, "Method"], [602, 605, "Method"], [610, 612, "Method"], [616, 618, "Method"], [619, 627, "Task"], [697, 699, "Method"], [710, 714, "Method"], [733, 736, "Method"], [762, 765, "Task"], [767, 770, "Method"], [804, 806, "Method"], [825, 829, "Method"], [839, 845, "Material"], [855, 857, "Method"], [858, 859, "Method"], [862, 864, "Method"], [867, 869, "Method"], [909, 911, "Method"], [913, 919, "Method"], [935, 937, "Method"], [942, 949, "Method"], [950, 952, "Task"], [970, 971, "Task"], [999, 1002, "Method"], [1006, 1010, "Method"], [1046, 1047, "Material"], [1048, 1049, "Material"], [1052, 1055, "Method"], [1061, 1064, "Method"], [1070, 1072, "Material"], [1121, 1124, "Method"], [1224, 1226, "Task"], [1231, 1234, "Method"], [1295, 1298, "Method"], [1308, 1312, "Method"], [1316, 1319, "Method"], [1398, 1400, "Method"], [1403, 1407, "Method"], [1425, 1426, "Method"], [1501, 1503, "Method"], [1527, 1530, "Method"], [1591, 1593, "Method"], [1598, 1600, "Task"], [1601, 1603, "Task"], [1606, 1609, "Method"], [1615, 1618, "Method"], [1620, 1622, "Task"], [1660, 1661, "Method"], [1733, 1736, "Task"], [1804, 1808, "Method"], [1815, 1818, "Task"], [1936, 1937, "Material"], [1951, 1953, "Task"], [1954, 1955, "Task"], [1972, 1973, "Task"], [1974, 1975, "Task"], [1976, 1980, "Task"], [2067, 2068, "Metric"], [2121, 2125, "Method"], [2126, 2127, "Method"], [2129, 2130, "Method"], [2144, 2145, "Method"], [2150, 2151, "Method"], [2169, 2171, "Method"], [2195, 2196, "Method"], [2276, 2277, "Method"], [2280, 2282, "Method"], [2284, 2286, "Method"], [2311, 2313, "Method"], [2386, 2387, "Method"], [2395, 2397, "Method"], [2412, 2413, "Material"], [2419, 2421, "Method"], [2441, 2443, "Method"], [2516, 2518, "Method"], [2528, 2531, "Material"], [2810, 2811, "Method"], [2821, 2823, "Method"], [2837, 2839, "Method"], [2899, 2900, "Material"], [2912, 2913, "Method"], [2948, 2952, "Method"], [2989, 2994, "Material"], [2998, 2999, "Method"], [3023, 3025, "Method"], [3027, 3029, "Method"], [3031, 3035, "Task"], [3047, 3048, "Metric"], [3061, 3064, "Method"], [3143, 3145, "Material"], [3199, 3200, "Method"], [3323, 3324, "Metric"], [3384, 3385, "Metric"], [3406, 3407, "Method"], [3416, 3418, "Method"], [3444, 3446, "Method"], [3459, 3460, "Metric"], [3479, 3480, "Metric"], [3526, 3527, "Metric"], [3558, 3560, "Method"], [3570, 3572, "Method"], [3574, 3575, "Method"], [3577, 3579, "Method"], [3628, 3630, "Method"], [3634, 3637, "Method"], [3639, 3640, "Method"], [3641, 3643, "Method"], [3653, 3656, "Method"], [3660, 3661, "Task"], [3738, 3739, "Material"], [3760, 3761, "Material"], [3800, 3802, "Method"], [3895, 3898, "Method"], [3908, 3910, "Method"], [3920, 3921, "Material"], [3922, 3927, "Material"], [3932, 3935, "Material"], [3949, 3952, "Method"], [3957, 3960, "Method"], [3964, 3967, "Method"], [3979, 3980, "Task"], [3986, 3987, "Material"], [4047, 4049, "Method"], [4115, 4122, "Method"], [4190, 4191, "Method"], [4196, 4199, "Method"], [4211, 4214, "Method"], [4236, 4238, "Method"], [4240, 4242, "Method"], [4313, 4315, "Method"], [4321, 4323, "Method"], [4324, 4326, "Method"], [4338, 4341, "Method"], [4345, 4348, "Method"], [4349, 4352, "Method"], [4452, 4456, "Method"], [4472, 4473, "Task"], [4477, 4480, "Method"], [4503, 4505, "Method"], [4516, 4520, "Method"], [4521, 4523, "Method"], [4528, 4531, "Method"], [4533, 4535, "Task"], [4536, 4540, "Task"], [4553, 4556, "Method"], [4589, 4591, "Method"], [4592, 4594, "Method"], [4606, 4608, "Method"], [4617, 4620, "Method"], [4623, 4625, "Method"], [4628, 4631, "Method"], [4638, 4639, "Method"], [4656, 4658, "Task"], [4668, 4671, "Method"], [4682, 4684, "Task"], [4685, 4686, "Method"], [4687, 4692, "Method"], [4705, 4708, "Method"], [4731, 4734, "Method"], [4735, 4736, "Method"], [4759, 4761, "Method"], [4763, 4764, "Method"], [4765, 4767, "Method"], [4774, 4777, "Metric"], [4790, 4793, "Method"], [4795, 4797, "Method"], [4798, 4800, "Method"], [4802, 4804, "Method"], [4838, 4844, "Method"], [4851, 4855, "Task"], [4890, 4891, "Method"], [4893, 4896, "Method"], [4898, 4900, "Task"], [4903, 4905, "Method"], [4906, 4907, "Method"], [4919, 4923, "Method"], [4934, 4935, "Method"], [4958, 4960, "Method"], [4961, 4962, "Method"], [4964, 4971, "Task"], [4972, 4975, "Method"], [4981, 4984, "Method"], [5057, 5060, "Task"], [5073, 5076, "Material"], [5086, 5087, "Material"], [5102, 5103, "Method"], [5105, 5107, "Method"], [5110, 5112, "Method"], [5204, 5206, "Method"], [5208, 5209, "Method"], [5211, 5213, "Method"], [5215, 5219, "Method"], [5226, 5227, "Method"], [5255, 5256, "Method"], [5273, 5275, "Method"], [5287, 5288, "Method"], [5322, 5324, "Method"], [5332, 5334, "Metric"], [5339, 5341, "Method"], [5379, 5380, "Task"], [5389, 5391, "Method"], [5399, 5401, "Method"], [5431, 5433, "Method"], [5461, 5463, "Method"], [5476, 5477, "Task"], [5479, 5480, "Method"], [5492, 5495, "Task"], [5506, 5507, "Method"], [5524, 5527, "Material"], [5533, 5534, "Material"], [5548, 5549, "Method"], [5551, 5553, "Method"], [5556, 5558, "Method"], [5598, 5600, "Method"], [5602, 5603, "Method"], [5605, 5607, "Method"], [5610, 5612, "Method"], [5614, 5615, "Method"], [5638, 5641, "Method"], [5681, 5683, "Method"], [5685, 5687, "Metric"], [5695, 5698, "Method"], [5713, 5714, "Method"], [5723, 5725, "Method"], [5756, 5758, "Method"], [5775, 5777, "Method"], [5792, 5793, "Method"], [5794, 5795, "Method"], [5807, 5809, "Material"], [5972, 5973, "Method"], [5975, 5977, "Method"], [5980, 5982, "Method"], [6028, 6032, "Method"], [6038, 6042, "Method"], [6047, 6048, "Task"], [6063, 6065, "Method"], [6067, 6068, "Method"], [6079, 6080, "Material"], [6096, 6098, "Method"], [6136, 6137, "Method"], [6139, 6141, "Metric"], [6146, 6148, "Method"], [6159, 6162, "Method"], [6178, 6181, "Method"], [6186, 6188, "Method"], [6194, 6196, "Method"], [6229, 6232, "Method"], [6267, 6269, "Method"], [6293, 6295, "Method"], [6298, 6301, "Task"], [6612, 6613, "Material"], [6616, 6617, "Method"], [6628, 6630, "Method"], [6656, 6660, "Method"], [6660, 6663, "Method"], [6692, 6694, "Method"], [154, 157, "Material"], [172, 174, "Method"], [184, 187, "Material"], [539, 541, "Method"], [958, 960, "Method"], [982, 983, "Method"], [992, 994, "Method"], [1029, 1031, "Method"], [1183, 1184, "Method"], [1931, 1932, "Material"], [2048, 2049, "Material"], [2317, 2318, "Material"], [2402, 2403, "Material"], [2407, 2410, "Material"], [2467, 2472, "Material"], [2492, 2495, "Material"], [2955, 2956, "Method"], [3688, 3689, "Method"], [3747, 3748, "Method"], [4004, 4005, "Material"], [4129, 4130, "Method"], [4280, 4282, "Method"], [4319, 4320, "Method"], [4372, 4374, "Method"], [4663, 4664, "Method"], [5099, 5100, "Method"], [5267, 5268, "Method"], [5285, 5286, "Method"], [5359, 5360, "Material"], [5375, 5376, "Material"], [5439, 5440, "Method"], [5516, 5519, "Material"], [5545, 5546, "Method"], [5728, 5729, "Method"], [5753, 5754, "Method"], [5784, 5785, "Method"], [5969, 5970, "Method"], [6083, 6084, "Method"], [6217, 6218, "Method"], [6240, 6241, "Method"], [6620, 6621, "Method"]], "sections": [[0, 258], [258, 1050], [1050, 1222], [1222, 1505], [1505, 1589], [1589, 1731], [1731, 1819], [1819, 1916], [1916, 1929], [1929, 2405], [2405, 3128], [3128, 3803], [3803, 3887], [3887, 4232], [4232, 5033], [5033, 5077], [5077, 5080], [5080, 5084], [5084, 5357], [5357, 5514], [5514, 5805], [5805, 5953], [5953, 6157], [6157, 6296], [6296, 6654], [6654, 6689], [6689, 6786]], "sentences": [[0, 5], [5, 50], [50, 70], [70, 96], [96, 124], [124, 152], [152, 183], [183, 204], [204, 235], [235, 258], [258, 261], [261, 282], [282, 292], [292, 349], [349, 372], [372, 392], [392, 420], [420, 462], [462, 482], [482, 547], [547, 577], [577, 606], [606, 628], [628, 652], [652, 683], [683, 750], [750, 761], [761, 799], [799, 811], [811, 836], [836, 866], [866, 901], [901, 927], [927, 933], [933, 934], [934, 953], [953, 986], [986, 1003], [1003, 1017], [1017, 1050], [1050, 1055], [1055, 1073], [1073, 1119], [1119, 1166], [1166, 1167], [1167, 1172], [1172, 1189], [1189, 1205], [1205, 1222], [1222, 1230], [1230, 1243], [1243, 1259], [1259, 1288], [1288, 1320], [1320, 1347], [1347, 1368], [1368, 1384], [1384, 1408], [1408, 1421], [1421, 1432], [1432, 1458], [1458, 1474], [1474, 1505], [1505, 1511], [1511, 1531], [1531, 1559], [1559, 1589], [1589, 1594], [1594, 1603], [1603, 1609], [1609, 1612], [1612, 1647], [1647, 1678], [1678, 1711], [1711, 1731], [1731, 1737], [1737, 1761], [1761, 1787], [1787, 1809], [1809, 1819], [1819, 1823], [1823, 1839], [1839, 1855], [1855, 1876], [1876, 1909], [1909, 1916], [1916, 1919], [1919, 1929], [1929, 1936], [1936, 1956], [1956, 1981], [1981, 1986], [1986, 1987], [1987, 1992], [1992, 2010], [2010, 2011], [2011, 2017], [2017, 2023], [2023, 2025], [2025, 2035], [2035, 2054], [2054, 2069], [2069, 2079], [2079, 2112], [2112, 2128], [2128, 2136], [2136, 2152], [2152, 2160], [2160, 2172], [2172, 2180], [2180, 2206], [2206, 2213], [2213, 2228], [2228, 2245], [2245, 2251], [2251, 2272], [2272, 2292], [2292, 2299], [2299, 2320], [2320, 2333], [2333, 2351], [2351, 2388], [2388, 2405], [2405, 2410], [2410, 2448], [2448, 2449], [2449, 2456], [2456, 2466], [2466, 2490], [2490, 2519], [2519, 2528], [2528, 2542], [2542, 2548], [2548, 2549], [2549, 2550], [2550, 2564], [2564, 2574], [2574, 2593], [2593, 2611], [2611, 2617], [2617, 2629], [2629, 2630], [2630, 2635], [2635, 2640], [2640, 2641], [2641, 2642], [2642, 2651], [2651, 2687], [2687, 2695], [2695, 2697], [2697, 2722], [2722, 2747], [2747, 2752], [2752, 2756], [2756, 2765], [2765, 2766], [2766, 2785], [2785, 2786], [2786, 2791], [2791, 2812], [2812, 2824], [2824, 2849], [2849, 2863], [2863, 2878], [2878, 2895], [2895, 2919], [2919, 2937], [2937, 2975], [2975, 2982], [2982, 2988], [2988, 2989], [2989, 3026], [3026, 3055], [3055, 3086], [3086, 3092], [3092, 3128], [3128, 3131], [3131, 3156], [3156, 3191], [3191, 3232], [3232, 3238], [3238, 3268], [3268, 3275], [3275, 3294], [3294, 3319], [3319, 3336], [3336, 3361], [3361, 3372], [3372, 3394], [3394, 3400], [3400, 3432], [3432, 3447], [3447, 3475], [3475, 3490], [3490, 3518], [3518, 3532], [3532, 3551], [3551, 3561], [3561, 3567], [3567, 3580], [3580, 3587], [3587, 3598], [3598, 3619], [3619, 3631], [3631, 3647], [3647, 3680], [3680, 3696], [3696, 3731], [3731, 3767], [3767, 3787], [3787, 3803], [3803, 3807], [3807, 3819], [3819, 3841], [3841, 3843], [3843, 3844], [3844, 3850], [3850, 3858], [3858, 3866], [3866, 3874], [3874, 3887], [3887, 3890], [3890, 3920], [3920, 3948], [3948, 3968], [3968, 3991], [3991, 4027], [4027, 4057], [4057, 4075], [4075, 4123], [4123, 4155], [4155, 4186], [4186, 4204], [4204, 4232], [4232, 4236], [4236, 4238], [4238, 4251], [4251, 4265], [4265, 4283], [4283, 4321], [4321, 4345], [4345, 4356], [4356, 4375], [4375, 4385], [4385, 4397], [4397, 4400], [4400, 4412], [4412, 4429], [4429, 4441], [4441, 4465], [4465, 4474], [4474, 4507], [4507, 4521], [4521, 4541], [4541, 4570], [4570, 4582], [4582, 4598], [4598, 4621], [4621, 4651], [4651, 4666], [4666, 4676], [4676, 4710], [4710, 4713], [4713, 4719], [4719, 4728], [4728, 4762], [4762, 4787], [4787, 4826], [4826, 4845], [4845, 4856], [4856, 4888], [4888, 4906], [4906, 4928], [4928, 4955], [4955, 4976], [4976, 4991], [4991, 5016], [5016, 5033], [5033, 5036], [5036, 5061], [5061, 5077], [5077, 5080], [5080, 5084], [5084, 5089], [5089, 5113], [5113, 5161], [5161, 5183], [5183, 5203], [5203, 5210], [5210, 5232], [5232, 5237], [5237, 5245], [5245, 5282], [5282, 5292], [5292, 5319], [5319, 5349], [5349, 5357], [5357, 5362], [5362, 5382], [5382, 5412], [5412, 5426], [5426, 5428], [5428, 5450], [5450, 5464], [5464, 5481], [5481, 5489], [5489, 5508], [5508, 5514], [5514, 5521], [5521, 5534], [5534, 5559], [5559, 5597], [5597, 5604], [5604, 5626], [5626, 5635], [5635, 5645], [5645, 5666], [5666, 5678], [5678, 5705], [5705, 5726], [5726, 5751], [5751, 5782], [5782, 5805], [5805, 5809], [5809, 5840], [5840, 5869], [5869, 5885], [5885, 5898], [5898, 5910], [5910, 5926], [5926, 5936], [5936, 5953], [5953, 5958], [5958, 5983], [5983, 6018], [6018, 6033], [6033, 6056], [6056, 6062], [6062, 6069], [6069, 6091], [6091, 6107], [6107, 6121], [6121, 6157], [6157, 6164], [6164, 6177], [6177, 6189], [6189, 6208], [6208, 6228], [6228, 6257], [6257, 6266], [6266, 6296], [6296, 6302], [6302, 6326], [6326, 6345], [6345, 6372], [6372, 6389], [6389, 6435], [6435, 6478], [6478, 6496], [6496, 6514], [6514, 6536], [6536, 6560], [6560, 6575], [6575, 6582], [6582, 6589], [6589, 6604], [6604, 6631], [6631, 6646], [6646, 6654], [6654, 6660], [6660, 6672], [6672, 6681], [6681, 6689], [6689, 6694], [6694, 6698], [6698, 6734], [6734, 6759], [6759, 6774], [6774, 6786]], "words": ["document", ":", "Recurrent", "Relational", "Networks", "This", "paper", "is", "concerned", "with", "learning", "to", "solve", "tasks", "that", "require", "a", "chain", "of", "interdependent", "steps", "of", "relational", "inference", ",", "like", "answering", "complex", "questions", "about", "the", "relationships", "between", "objects", ",", "or", "solving", "puzzles", "where", "the", "smaller", "elements", "of", "a", "solution", "mutually", "constrain", "each", "other", ".", "We", "introduce", "the", "recurrent", "relational", "network", ",", "a", "general", "purpose", "module", "that", "operates", "on", "a", "graph", "representation", "of", "objects", ".", "As", "a", "generalization", "of", "\u2019s", "relational", "network", ",", "it", "can", "augment", "any", "neural", "network", "model", "with", "the", "capacity", "to", "do", "many", "-", "step", "relational", "reasoning", ".", "We", "achieve", "state", "of", "the", "art", "results", "on", "the", "bAbI", "textual", "question", "-", "answering", "dataset", "with", "the", "recurrent", "relational", "network", ",", "consistently", "solving", "20", "/", "20", "tasks", ".", "As", "bAbI", "is", "not", "particularly", "challenging", "from", "a", "relational", "reasoning", "point", "of", "view", ",", "we", "introduce", "Pretty", "-", "CLEVR", ",", "a", "new", "diagnostic", "dataset", "for", "relational", "reasoning", ".", "In", "the", "Pretty", "-", "CLEVR", "set", "-", "up", ",", "we", "can", "vary", "the", "question", "to", "control", "for", "the", "number", "of", "relational", "reasoning", "steps", "that", "are", "required", "to", "obtain", "the", "answer", ".", "Using", "Pretty", "-", "CLEVR", ",", "we", "probe", "the", "limitations", "of", "multi", "-", "layer", "perceptrons", ",", "relational", "and", "recurrent", "relational", "networks", ".", "Finally", ",", "we", "show", "how", "recurrent", "relational", "networks", "can", "learn", "to", "solve", "Sudoku", "puzzles", "from", "supervised", "training", "data", ",", "a", "challenging", "task", "requiring", "upwards", "of", "64", "steps", "of", "relational", "reasoning", ".", "We", "achieve", "state", "-", "of", "-", "the", "-", "art", "results", "amongst", "comparable", "methods", "by", "solving", "96.6", "%", "of", "the", "hardest", "Sudoku", "puzzles", ".", "section", ":", "Introduction", "A", "central", "component", "of", "human", "intelligence", "is", "the", "ability", "to", "abstractly", "reason", "about", "objects", "and", "their", "interactions", "spelke1995development", ",", "spelke2007core", ".", "As", "an", "illustrative", "example", ",", "consider", "solving", "a", "Sudoku", ".", "A", "Sudoku", "consists", "of", "81", "cells", "that", "are", "arranged", "in", "a", "9", "-", "by", "-", "9", "grid", ",", "which", "must", "be", "filled", "with", "digits", "1", "to", "9", "so", "that", "each", "digit", "appears", "exactly", "once", "in", "each", "row", ",", "column", "and", "3", "-", "by", "-", "3", "non", "-", "overlapping", "box", ",", "with", "a", "number", "of", "digits", "given", ".", "To", "solve", "a", "Sudoku", ",", "one", "methodically", "reasons", "about", "the", "puzzle", "in", "terms", "of", "its", "cells", "and", "their", "interactions", "over", "many", "steps", ".", "One", "tries", "placing", "digits", "in", "cells", "and", "see", "how", "that", "affects", "other", "cells", ",", "iteratively", "working", "toward", "a", "solution", ".", "Contrast", "this", "with", "the", "canonical", "deep", "learning", "approach", "to", "solving", "problems", ",", "the", "multilayer", "perceptron", "(", "MLP", ")", ",", "or", "multilayer", "convolutional", "neural", "net", "(", "CNN", ")", ".", "These", "architectures", "take", "the", "entire", "Sudoku", "as", "an", "input", "and", "output", "the", "entire", "solution", "in", "a", "single", "forward", "pass", ",", "ignoring", "the", "inductive", "bias", "that", "objects", "exists", "in", "the", "world", ",", "and", "that", "they", "affect", "each", "other", "in", "a", "consistent", "manner", ".", "Not", "surprisingly", "these", "models", "fall", "short", "when", "faced", "with", "problems", "that", "require", "even", "basic", "relational", "reasoning", "lake2016building", ",", "santoro2017simple", ".", "The", "relational", "network", "of", "santoro2017simple", "is", "an", "important", "first", "step", "towards", "a", "simple", "module", "for", "reasoning", "about", "objects", "and", "their", "interactions", "but", "it", "is", "limited", "to", "performing", "a", "single", "relational", "operation", ",", "and", "was", "evaluated", "on", "datasets", "that", "require", "a", "maximum", "of", "three", "steps", "of", "reasoning", "(", "which", ",", "surprisingly", ",", "can", "be", "solved", "by", "a", "single", "relational", "reasoning", "step", "as", "we", "show", ")", ".", "Looking", "beyond", "relational", "networks", ",", "there", "is", "a", "rich", "literature", "on", "logic", "and", "reasoning", "in", "artificial", "intelligence", "and", "machine", "learning", ",", "which", "we", "discuss", "in", "section", "[", "reference", "]", ".", "Toward", "generally", "realizing", "the", "ability", "to", "methodically", "reason", "about", "objects", "and", "their", "interactions", "over", "many", "steps", ",", "this", "paper", "introduces", "a", "composite", "function", ",", "the", "recurrent", "relational", "network", ".", "It", "serves", "as", "a", "modular", "component", "for", "many", "-", "step", "relational", "reasoning", "in", "end", "-", "to", "-", "end", "differentiable", "learning", "systems", ".", "It", "encodes", "the", "inductive", "biases", "that", "1", ")", "objects", "exists", "in", "the", "world", "2", ")", "they", "can", "be", "sufficiently", "described", "by", "properties", "3", ")", "properties", "can", "change", "over", "time", "4", ")", "objects", "can", "affect", "each", "other", "and", "5", ")", "given", "the", "properties", ",", "the", "effects", "object", "have", "on", "each", "other", "is", "invariant", "to", "time", ".", "An", "important", "insight", "from", "the", "work", "of", "santoro2017simple", "is", "to", "decompose", "a", "function", "for", "relational", "reasoning", "into", "two", "components", "or", "\u2018", "\u2018", "modules", "\u2019", "\u2019", ":", "a", "perceptual", "front", "-", "end", ",", "which", "is", "tasked", "to", "recognize", "objects", "in", "the", "raw", "input", "and", "represent", "them", "as", "vectors", ",", "and", "a", "relational", "reasoning", "module", ",", "which", "uses", "the", "representation", "to", "reason", "about", "the", "objects", "and", "their", "interactions", ".", "Both", "modules", "are", "trained", "jointly", "end", "-", "to", "-", "end", ".", "In", "computer", "science", "parlance", ",", "the", "relational", "reasoning", "module", "implements", "an", "interface", ":", "it", "operates", "on", "a", "graph", "of", "nodes", "and", "directed", "edges", ",", "where", "the", "nodes", "are", "represented", "by", "real", "valued", "vectors", ",", "and", "is", "differentiable", ".", "This", "paper", "chiefly", "develops", "the", "relational", "reasoning", "side", "of", "that", "interface", ".", "Some", "of", "the", "tasks", "we", "evaluate", "on", "can", "be", "efficiently", "and", "perfectly", "solved", "by", "hand", "-", "crafted", "algorithms", "that", "operate", "on", "the", "symbolic", "level", ".", "For", "example", ",", "9", "-", "by", "-", "9", "Sudokus", "can", "be", "solved", "in", "a", "fraction", "of", "a", "second", "with", "constraint", "propagation", "and", "search", "norvig2006solving", "or", "with", "dancing", "links", "knuth2000dancing", ".", "These", "symbolic", "algorithms", "are", "superior", "in", "every", "respect", "but", "one", ":", "they", "do", "n\u2019t", "comply", "with", "the", "interface", ",", "as", "they", "are", "not", "differentiable", "and", "do", "n\u2019t", "work", "with", "real", "-", "valued", "vector", "descriptions", ".", "They", "therefore", "can", "not", "be", "used", "in", "a", "combined", "model", "with", "a", "deep", "learning", "perceptual", "front", "-", "end", "and", "learned", "end", "-", "to", "-", "end", ".", "Following", ",", "we", "use", "the", "term", "\u2018", "\u2018", "relational", "reasoning", "\u2019", "\u2019", "liberally", "for", "an", "object", "-", "and", "interaction", "-", "centric", "approach", "to", "problem", "solving", ".", "Although", "the", "term", "\u2018", "\u2018", "relational", "reasoning", "\u2019", "\u2019", "is", "similar", "to", "terms", "in", "other", "branches", "of", "science", ",", "like", "relational", "logic", "or", "first", "order", "logic", ",", "no", "direct", "parallel", "is", "intended", ".", "This", "paper", "considers", "many", "-", "step", "relational", "reasoning", ",", "a", "challenging", "task", "for", "deep", "learning", "architectures", ".", "We", "develop", "a", "recurrent", "relational", "reasoning", "module", ",", "which", "constitutes", "our", "main", "contribution", ".", "We", "show", "that", "it", "is", "a", "powerful", "architecture", "for", "many", "-", "step", "relational", "reasoning", "on", "three", "varied", "datasets", ",", "achieving", "state", "-", "of", "-", "the", "-", "art", "results", "on", "bAbI", "and", "Sudoku", ".", "section", ":", "Recurrent", "Relational", "Networks", "We", "ground", "the", "discussion", "of", "a", "recurrent", "relational", "network", "in", "something", "familiar", ",", "solving", "a", "Sudoku", "puzzle", ".", "A", "simple", "strategy", "works", "by", "noting", "that", "if", "a", "certain", "Sudoku", "cell", "is", "given", "as", "a", "\u2018", "\u2018", "7", "\u2019", "\u2019", ",", "one", "can", "safely", "remove", "\u2018", "\u2018", "7", "\u2019", "\u2019", "as", "an", "option", "from", "other", "cells", "in", "the", "same", "row", ",", "column", "and", "box", ".", "In", "a", "message", "passing", "framework", ",", "that", "cell", "needs", "to", "send", "a", "message", "to", "each", "other", "cell", "in", "the", "same", "row", ",", "column", ",", "and", "box", ",", "broadcasting", "it", "\u2019s", "value", "as", "\u2018", "\u2018", "7", "\u2019", "\u2019", ",", "and", "informing", "those", "cells", "not", "to", "take", "the", "value", "\u2018", "\u2018", "7", "\u2019", "\u2019", ".", "In", "an", "iteration", ",", "these", "messages", "are", "sent", "simultaneously", ",", "in", "parallel", ",", "between", "all", "cells", ".", "Each", "cell", "should", "then", "consider", "all", "incoming", "messages", ",", "and", "update", "its", "internal", "state", "to", ".", "With", "the", "updated", "state", "each", "cell", "should", "send", "out", "new", "messages", ",", "and", "the", "process", "repeats", ".", "paragraph", ":", "Message", "passing", "on", "a", "graph", ".", "The", "recurrent", "relational", "network", "will", "learn", "to", "pass", "messages", "on", "a", "graph", ".", "For", "Sudoku", ",", "the", "graph", "has", "nodes", ",", "one", "for", "each", "cell", "in", "the", "Sudoku", ".", "Each", "node", "has", "an", "input", "feature", "vector", ",", "and", "edges", "to", "and", "from", "all", "nodes", "that", "are", "in", "the", "same", "row", ",", "column", "and", "box", "in", "the", "Sudoku", ".", "The", "graph", "is", "the", "input", "to", "the", "relational", "reasoning", "module", ",", "and", "vectors", "would", "generally", "be", "the", "output", "of", "a", "perceptual", "front", "-", "end", ",", "for", "instance", "a", "convolutional", "neural", "network", ".", "Keeping", "with", "our", "Sudoku", "example", ",", "each", "encodes", "the", "initial", "cell", "content", "(", "empty", "or", "given", ")", "and", "the", "row", "and", "column", "position", "of", "the", "cell", ".", "At", "each", "step", "each", "node", "has", "a", "hidden", "state", "vector", ",", "which", "is", "initialized", "to", "the", "features", ",", "such", "that", ".", "At", "each", "step", ",", "each", "node", "sends", "a", "message", "to", "each", "of", "its", "neighboring", "nodes", ".", "We", "define", "the", "message", "from", "node", "to", "node", "at", "step", "by", "where", ",", "the", "message", "function", ",", "is", "a", "multi", "-", "layer", "perceptron", ".", "This", "allows", "the", "network", "to", "learn", "what", "kind", "of", "messages", "to", "send", ".", "In", "our", "experiments", ",", "MLPs", "with", "linear", "outputs", "were", "used", ".", "Since", "a", "node", "needs", "to", "consider", "all", "the", "incoming", "messages", "we", "sum", "them", "with", "where", "are", "all", "the", "nodes", "that", "have", "an", "edge", "into", "node", ".", "For", "Sudoku", ",", "contains", "the", "nodes", "in", "the", "same", "row", ",", "column", "and", "box", "as", ".", "In", "our", "experiments", ",", "since", "the", "messages", "in", "(", "[", "reference", "]", ")", "are", "linear", ",", "this", "is", "similar", "to", "how", "log", "-", "probabilities", "are", "summed", "in", "belief", "propagation", "murphy1999loopy", ".", "paragraph", ":", "Recurrent", "node", "updates", ".", "Finally", "we", "update", "the", "node", "hidden", "state", "via", "where", ",", "the", "node", "function", ",", "is", "another", "learned", "neural", "network", ".", "The", "dependence", "on", "the", "previous", "node", "hidden", "state", "allows", "the", "network", "to", "iteratively", "work", "towards", "a", "solution", "instead", "of", "starting", "with", "a", "blank", "slate", "at", "every", "step", ".", "Injecting", "the", "feature", "vector", "at", "each", "step", "like", "this", "allows", "the", "node", "function", "to", "focus", "on", "the", "messages", "from", "the", "other", "nodes", "instead", "of", "trying", "to", "remember", "the", "input", ".", "paragraph", ":", "Supervised", "training", ".", "The", "above", "equations", "for", "sending", "messages", "and", "updating", "node", "states", "define", "a", "recurrent", "relational", "network", "\u2019s", "core", ".", "To", "train", "a", "recurrent", "relational", "network", "in", "a", "supervised", "manner", "to", "solve", "a", "Sudoku", "we", "introduce", "an", "output", "probability", "distribution", "over", "the", "digits", "1", "-", "9", "for", "each", "of", "the", "nodes", "in", "the", "graph", ".", "The", "output", "distribution", "for", "node", "at", "step", "is", "given", "by", "where", "is", "a", "MLP", "that", "maps", "the", "node", "hidden", "state", "to", "the", "output", "probabilities", ",", "e.g.", "using", "a", "softmax", "nonlinearity", ".", "Given", "the", "target", "digits", "the", "loss", "at", "step", ",", "is", "then", "the", "sum", "of", "cross", "-", "entropy", "terms", ",", "one", "for", "each", "node", ":", ",", "where", "is", "the", "\u2019", "th", "component", "of", ".", "Equations", "(", "[", "reference", "]", ")", "to", "(", "[", "reference", "]", ")", "are", "illustrated", "in", "figure", "[", "reference", "]", ".", "paragraph", ":", "Convergent", "message", "passing", ".", "A", "distinctive", "feature", "of", "our", "proposed", "model", "is", "that", "we", "minimize", "the", "cross", "entropy", "between", "the", "output", "and", "target", "distributions", "at", "every", "step", ".", "At", "test", "time", "we", "only", "consider", "the", "output", "probabilities", "at", "the", "last", "step", ",", "but", "having", "a", "loss", "at", "every", "step", "during", "training", "is", "beneficial", ".", "Since", "the", "target", "digits", "are", "constant", "over", "the", "steps", ",", "it", "encourages", "the", "network", "to", "learn", "a", "convergent", "message", "passing", "algorithm", ".", "Secondly", ",", "it", "helps", "with", "the", "vanishing", "gradient", "problem", ".", "paragraph", ":", "Variations", ".", "If", "the", "edges", "are", "unknown", ",", "the", "graph", "can", "be", "assumed", "to", "be", "fully", "connected", ".", "In", "this", "case", "the", "network", "will", "need", "to", "learn", "which", "objects", "interact", "with", "each", "other", ".", "If", "the", "edges", "have", "attributes", ",", ",", "the", "message", "function", "in", "equation", "[", "reference", "]", "can", "be", "modified", "such", "that", ".", "If", "the", "output", "of", "interest", "is", "for", "the", "whole", "graph", "instead", "of", "for", "each", "node", "the", "output", "in", "equation", "[", "reference", "]", "can", "be", "modified", "such", "that", "there", "\u2019s", "a", "single", "output", ".", "The", "loss", "can", "be", "modified", "accordingly", ".", "section", ":", "Experiments", "Code", "to", "reproduce", "all", "experiments", "can", "be", "found", "at", ".", "subsection", ":", "bAbI", "question", "-", "answering", "tasks", "bAbI", "is", "a", "text", "based", "QA", "dataset", "from", "Facebook", "weston2015towards", "designed", "as", "a", "set", "of", "prerequisite", "tasks", "for", "reasoning", ".", "It", "consists", "of", "20", "types", "of", "tasks", ",", "with", "10", ",", "000", "questions", "each", ",", "including", "deduction", ",", "induction", ",", "spatial", "and", "temporal", "reasoning", ".", "Each", "question", ",", "e.g.", "\u2018", "\u2018", "Where", "is", "the", "milk", "?", "\u2019", "\u2019", "is", "preceded", "by", "a", "number", "of", "facts", "in", "the", "form", "of", "short", "sentences", ",", "e.g.", "\u2018", "\u2018", "Daniel", "journeyed", "to", "the", "garden", ".", "Daniel", "put", "down", "the", "milk", ".", "\u2019", "\u2019", "The", "target", "is", "a", "single", "word", ",", "in", "this", "case", "\u2018", "\u2018", "garden", "\u2019", "\u2019", ",", "one", "-", "hot", "encoded", "over", "the", "full", "bAbI", "vocabulary", "of", "177", "words", ".", "A", "task", "is", "considered", "solved", "if", "a", "model", "achieves", "greater", "than", "95", "%", "accuracy", ".", "The", "most", "difficult", "tasks", "require", "reasoning", "about", "three", "facts", ".", "To", "map", "the", "questions", "into", "a", "graph", "we", "treat", "the", "facts", "related", "to", "a", "question", "as", "the", "nodes", "in", "a", "fully", "connected", "graph", "up", "to", "a", "maximum", "of", "the", "last", "20", "facts", ".", "The", "fact", "and", "question", "sentences", "are", "both", "encoded", "by", "Long", "Short", "Term", "Memory", "(", "LSTM", ")", "hochreiter1997long", "layers", "with", "32", "hidden", "units", "each", ".", "We", "concatenate", "the", "last", "hidden", "state", "of", "each", "LSTM", "and", "pass", "that", "through", "a", "MLP", ".", "The", "output", "is", "considered", "the", "node", "features", ".", "Following", "santoro2017simple", "all", "edge", "features", "are", "set", "to", "the", "question", "encoding", ".", "We", "train", "the", "network", "for", "three", "steps", ".", "At", "each", "step", ",", "we", "sum", "the", "node", "hidden", "states", "and", "pass", "that", "through", "a", "MLP", "to", "get", "a", "single", "output", "for", "the", "whole", "graph", ".", "For", "details", "see", "the", "supplementary", "material", ".", "Our", "trained", "network", "solves", "20", "of", "20", "tasks", "in", "13", "out", "of", "15", "runs", ".", "This", "is", "state", "-", "of", "-", "the", "-", "art", "and", "markedly", "more", "stable", "than", "competing", "methods", ".", "See", "table", "[", "reference", "]", ".", "We", "perform", "ablation", "experiment", "to", "see", "which", "parts", "of", "the", "model", "are", "important", ",", "including", "varying", "the", "number", "of", "steps", ".", "We", "find", "that", "using", "dropout", "and", "appending", "the", "question", "encoding", "to", "the", "fact", "encodings", "is", "important", "for", "the", "performance", ".", "See", "the", "supplementary", "material", "for", "details", ".", "Surprisingly", ",", "we", "find", "that", "we", "only", "need", "a", "single", "step", "of", "relational", "reasoning", "to", "solve", "all", "the", "bAbI", "tasks", ".", "This", "is", "surprising", "since", "the", "hardest", "tasks", "requires", "reasoning", "about", "three", "facts", ".", "It", "\u2019s", "possible", "that", "there", "are", "superficial", "correlations", "in", "the", "tasks", "that", "the", "model", "learns", "to", "exploit", ".", "Alternatively", "the", "model", "learns", "to", "compress", "all", "the", "relevant", "fact", "-", "relations", "into", "the", "128", "floats", "resulting", "from", "the", "sum", "over", "the", "node", "hidden", "states", ",", "and", "perform", "the", "remaining", "reasoning", "steps", "in", "the", "output", "MLP", ".", "Regardless", ",", "it", "appears", "multiple", "steps", "of", "relational", "reasoning", "are", "not", "important", "for", "the", "bAbI", "dataset", ".", "subsection", ":", "Pretty", "-", "CLEVR", "Given", "that", "bAbI", "did", "not", "require", "multiple", "steps", "of", "relational", "reasoning", "and", "in", "order", "to", "test", "our", "hypothesis", "that", "our", "proposed", "model", "is", "better", "suited", "for", "tasks", "requiring", "more", "steps", "of", "relational", "reasoning", "we", "create", "a", "diagnostic", "dataset", "\u2018", "\u2018", "Pretty", "-", "CLEVER", "\u2019", "\u2019", ".", "It", "can", "be", "seen", "as", "an", "extension", "of", "the", "\u2018", "\u2018", "Sort", "-", "of", "-", "CLEVR", "\u2019", "\u2019", "data", "set", "by", "santoro2017simple", "which", "has", "questions", "of", "a", "non", "-", "relational", "and", "relational", "nature", ".", "\u2018", "\u2018", "Pretty", "-", "CLEVR", "\u2019", "\u2019", "takes", "this", "a", "step", "further", "and", "has", "non", "-", "relational", "questions", "as", "well", "as", "questions", "requiring", "varying", "degrees", "of", "relational", "reasoning", ".", "position", "=", "bottom", "Samples.", "[", ".24", "]", "Results", ".", "Pretty", "-", "CLEVR", "consists", "of", "scenes", "with", "eight", "colored", "shapes", "and", "associated", "questions", ".", "Questions", "are", "of", "the", "form", ":", "\u2018", "\u2018", "Starting", "at", "object", "X", "which", "object", "is", "N", "jumps", "away", "?", "\u2019", "\u2019", ".", "Objects", "are", "uniquely", "defined", "by", "their", "color", "or", "shape", ".", "If", "the", "start", "object", "is", "defined", "by", "color", ",", "the", "answer", "is", "a", "shape", ",", "and", "vice", "versa", ".", "Jumps", "are", "defined", "as", "moving", "to", "the", "closest", "object", ",", "without", "going", "to", "an", "object", "already", "visited", ".", "See", "figure", "[", "reference", "]", ".", "Questions", "with", "zero", "jumps", "are", "non", "-", "relational", "and", "correspond", "to", ":", "\u2018", "\u2018", "What", "color", "is", "shape", "X", "?", "\u2019", "\u2019", "or", "\u2018", "\u2018", "What", "shape", "is", "color", "X", "?", "\u2019", "\u2019", ".", "We", "create", "100", ",", "000", "random", "scenes", ",", "and", "128", "questions", "for", "each", "(", "8", "start", "objects", ",", "0", "-", "7", "jumps", ",", "output", "is", "color", "or", "shape", ")", ",", "resulting", "in", "12.8", "M", "questions", ".", "We", "also", "render", "the", "scenes", "as", "images", ".", "The", "\u2018", "\u2018", "jump", "to", "nearest", "\u2019", "\u2019", "type", "question", "is", "chosen", "in", "an", "effort", "to", "eliminate", "simple", "correlations", "between", "the", "scene", "state", "and", "the", "answer", ".", "It", "is", "highly", "non", "-", "linear", "in", "the", "sense", "that", "slight", "differences", "in", "the", "distance", "between", "objects", "can", "cause", "the", "answer", "to", "change", "drastically", ".", "It", "is", "also", "asymmetrical", ",", "i.e.", "if", "the", "question", "\u2018", "\u2018", "x", ",", "n", "jumps", "\u2019", "\u2019", "equals", "\u2018", "\u2018", "y", "\u2019", "\u2019", ",", "there", "is", "no", "guarantee", "that", "\u2018", "\u2018", "y", ",", "n", "jumps", "\u2019", "\u2019", "equals", "\u2018", "\u2018", "x", "\u2019", "\u2019", ".", "We", "find", "it", "is", "a", "surprisingly", "difficult", "task", "to", "solve", ",", "even", "with", "a", "powerful", "model", "such", "as", "the", "RRN", ".", "We", "hope", "others", "will", "use", "it", "to", "evaluate", "their", "relational", "models", ".", "Since", "we", "are", "solely", "interested", "in", "examining", "the", "effect", "of", "multiple", "steps", "of", "relational", "reasoning", "we", "train", "on", "the", "state", "descriptions", "of", "the", "scene", ".", "We", "consider", "each", "scene", "as", "a", "fully", "connected", "undirected", "graph", "with", "8", "nodes", ".", "The", "feature", "vector", "for", "each", "object", "consists", "of", "the", "position", ",", "shape", "and", "color", ".", "We", "encode", "the", "question", "as", "the", "start", "object", "shape", "or", "color", "and", "the", "number", "of", "jumps", ".", "As", "we", "did", "for", "bAbI", "we", "concatenate", "the", "question", "and", "object", "features", "and", "pass", "it", "through", "a", "MLP", "to", "get", "the", "node", "features", ".", "To", "make", "the", "task", "easier", "we", "set", "the", "edge", "features", "to", "the", "euclidean", "distance", "between", "the", "objects", ".", "We", "train", "our", "network", "for", "four", "steps", "and", "compare", "to", "a", "single", "step", "relational", "network", "and", "a", "baseline", "MLP", "that", "considers", "the", "entire", "scene", "state", ",", "all", "pairwise", "distances", ",", "and", "the", "question", "as", "a", "single", "vector", ".", "For", "details", "see", "the", "supplementary", "material", ".", "Mirroring", "the", "results", "from", "the", "\u2018", "\u2018", "Sort", "-", "of", "-", "CLEVR", "\u2019", "\u2019", "dataset", "the", "MLP", "perfectly", "solves", "the", "non", "-", "relational", "questions", ",", "but", "struggle", "with", "even", "single", "jump", "questions", "and", "seem", "to", "lower", "bound", "the", "performance", "of", "the", "relational", "networks", ".", "The", "relational", "network", "solves", "the", "non", "-", "relational", "questions", "as", "well", "as", "the", "ones", "requiring", "a", "single", "jump", ",", "but", "the", "accuracy", "sharply", "drops", "off", "with", "more", "jumps", ".", "This", "matches", "the", "performance", "of", "the", "recurrent", "relational", "network", "which", "generally", "performs", "well", "as", "long", "as", "the", "number", "of", "steps", "is", "greater", "than", "or", "equal", "to", "the", "number", "of", "jumps", ".", "See", "fig", "[", "reference", "]", ".", "It", "seems", "that", ",", "despite", "our", "best", "efforts", ",", "there", "are", "spurious", "correlations", "in", "the", "data", "such", "that", "questions", "with", "six", "to", "seven", "jumps", "are", "easier", "to", "solve", "than", "those", "with", "four", "to", "five", "jumps", ".", "subsection", ":", "Sudoku", "We", "create", "training", ",", "validation", "and", "testing", "sets", "totaling", "216", ",", "000", "Sudoku", "puzzles", "with", "a", "uniform", "distribution", "of", "givens", "between", "17", "and", "34", ".", "We", "consider", "each", "of", "the", "81", "cells", "in", "the", "9x9", "Sudoku", "grid", "a", "node", "in", "a", "graph", ",", "with", "edges", "to", "and", "from", "each", "other", "cell", "in", "the", "same", "row", ",", "column", "and", "box", ".", "The", "node", "features", "are", "the", "output", "of", "a", "MLP", "which", "takes", "as", "input", "the", "digit", "for", "the", "cell", "(", "0", "-", "9", ",", "0", "if", "not", "given", ")", ",", "and", "the", "row", "and", "column", "position", "(", "1", "-", "9", ")", ".", "Edge", "features", "are", "not", "used", ".", "We", "run", "the", "network", "for", "32", "steps", "and", "at", "every", "step", "the", "output", "function", "maps", "each", "node", "hidden", "state", "to", "nine", "output", "logits", "corresponding", "to", "the", "nine", "possible", "digits", ".", "For", "details", "see", "the", "supplementary", "material", ".", "Our", "network", "learns", "to", "solve", "94.1", "%", "of", "even", "the", "hardest", "17", "-", "givens", "Sudokus", "after", "32", "steps", ".", "We", "only", "consider", "a", "puzzled", "solved", "if", "all", "the", "digits", "are", "correct", ",", "i.e.", "no", "partial", "credit", "is", "given", "for", "getting", "individual", "digits", "correct", ".", "For", "more", "givens", "the", "accuracy", "(", "fraction", "of", "test", "puzzles", "solved", ")", "quickly", "approaches", "100", "%", ".", "Since", "the", "network", "outputs", "a", "probability", "distribution", "for", "each", "step", ",", "we", "can", "visualize", "how", "the", "network", "arrives", "at", "the", "solution", "step", "by", "step", ".", "For", "an", "example", "of", "this", "see", "figure", "[", "reference", "]", ".", "To", "examine", "our", "hypothesis", "that", "multiple", "steps", "are", "required", "we", "plot", "the", "accuracy", "as", "a", "function", "of", "the", "number", "of", "steps", ".", "See", "figure", "[", "reference", "]", ".", "We", "can", "see", "that", "even", "simple", "Sudokus", "with", "33", "givens", "require", "upwards", "of", "10", "steps", "of", "relational", "reasoning", ",", "whereas", "the", "harder", "17", "givens", "continue", "to", "improve", "even", "after", "32", "steps", ".", "Figure", "[", "reference", "]", "also", "shows", "that", "the", "model", "has", "learned", "a", "convergent", "algorithm", ".", "The", "model", "was", "trained", "for", "32", "steps", ",", "but", "seeing", "that", "the", "accuracy", "increased", "with", "more", "steps", ",", "we", "ran", "the", "model", "for", "64", "steps", "during", "testing", ".", "At", "64", "steps", "the", "accuracy", "for", "the", "17", "givens", "puzzles", "increases", "to", "96.6", "%", ".", "We", "also", "examined", "the", "importance", "of", "the", "row", "and", "column", "features", "by", "multiplying", "the", "row", "and", "column", "embeddings", "by", "zero", "and", "re", "-", "tested", "our", "trained", "network", ".", "At", "64", "steps", "with", "17", "givens", ",", "the", "accuracy", "changed", "to", "96.7", "%", ".", "It", "thus", "seems", "the", "network", "does", "not", "use", "the", "row", "and", "column", "position", "information", "to", "solve", "the", "task", ".", "We", "compare", "our", "network", "to", "several", "other", "differentiable", "methods", ".", "See", "table", "[", "reference", "]", ".", "We", "train", "two", "relational", "networks", ":", "a", "node", "and", "a", "graph", "centric", ".", "For", "details", "see", "the", "supplementary", "material", ".", "Of", "the", "two", ",", "the", "node", "centric", "was", "considerably", "better", ".", "The", "node", "centric", "correspond", "exactly", "to", "our", "proposed", "network", "with", "a", "single", "step", ",", "yet", "fails", "to", "solve", "any", "Sudoku", ".", "This", "shows", "that", "multiple", "steps", "are", "crucial", "for", "complex", "relational", "reasoning", ".", "Our", "network", "outperforms", "loopy", "belief", "propagation", ",", "with", "parallel", "and", "random", "messages", "passing", "updates", "bauke2008passing", ".", "It", "also", "outperforms", "a", "version", "of", "loopy", "belief", "propagation", "modified", "specifically", "for", "solving", "Sudokus", "that", "uses", "250", "steps", ",", "Sinkhorn", "balancing", "every", "two", "steps", "and", "iteratively", "picks", "the", "most", "probable", "digit", "khan2014solving", ".", "We", "also", "compare", "to", "learning", "the", "messages", "in", "parallel", "loopy", "BP", "as", "presented", "in", "lin2015deeply", ".", "We", "tried", "a", "few", "variants", "including", "a", "single", "step", "as", "presented", "and", "32", "steps", "with", "and", "without", "a", "loss", "on", "every", "step", ",", "but", "could", "not", "get", "it", "to", "solve", "any", "17", "given", "Sudokus", ".", "Finally", "we", "outperform", "park2016can", "which", "treats", "the", "Sudoku", "as", "a", "9x9", "image", ",", "uses", "10", "convolutional", "layers", ",", "iteratively", "picks", "the", "most", "probable", "digit", ",", "and", "evaluate", "on", "easier", "Sudokus", "with", "24", "-", "36", "givens", ".", "We", "also", "tried", "to", "train", "a", "version", "of", "our", "network", "that", "only", "had", "a", "loss", "at", "the", "last", "step", ".", "It", "was", "harder", "to", "train", ",", "performed", "worse", "and", "did", "n\u2019t", "learn", "a", "convergent", "algorithm", ".", "subsection", ":", "Age", "arithmetic", "Anonymous", "reviewer", "2", "suggested", "the", "following", "task", "which", "we", "include", "here", ".", "The", "task", "is", "to", "infer", "the", "age", "of", "a", "person", "given", "a", "single", "absolute", "age", "and", "a", "set", "of", "age", "differences", ",", "e.g.", "\u2018", "\u2018", "Alice", "is", "20", "years", "old", ".", "Alice", "is", "4", "years", "older", "than", "Bob", ".", "Charlie", "is", "6", "years", "younger", "than", "Bob", ".", "How", "old", "is", "Charlie", "?", "\u2019", "\u2019", ".", "Please", "see", "the", "supplementary", "material", "for", "details", "on", "the", "task", "and", "results", ".", "section", ":", "Discussion", "We", "have", "proposed", "a", "general", "relational", "reasoning", "model", "for", "solving", "tasks", "requiring", "an", "order", "of", "magnitude", "more", "complex", "relational", "reasoning", "than", "the", "current", "state", "-", "of", "-", "the", "art", ".", "BaBi", "and", "Sort", "-", "of", "-", "CLEVR", "require", "a", "few", "steps", ",", "Pretty", "-", "CLEVR", "requires", "up", "to", "eight", "steps", "and", "Sudoku", "requires", "more", "than", "ten", "steps", ".", "Our", "relational", "reasoning", "module", "can", "be", "added", "to", "any", "deep", "learning", "model", "to", "add", "a", "powerful", "relational", "reasoning", "capacity", ".", "We", "get", "state", "-", "of", "-", "the", "-", "art", "results", "on", "Sudokus", "solving", "96.6", "%", "of", "the", "hardest", "Sudokus", "with", "17", "givens", ".", "We", "also", "markedly", "improve", "state", "-", "of", "-", "the", "-", "art", "on", "the", "BaBi", "dataset", "solving", "20", "/", "20", "tasks", "in", "13", "out", "of", "15", "runs", "with", "a", "single", "model", "trained", "jointly", "on", "all", "tasks", ".", "One", "potential", "issue", "with", "having", "a", "loss", "at", "every", "step", "is", "that", "it", "might", "encourage", "the", "network", "to", "learn", "a", "greedy", "algorithm", "that", "gets", "stuck", "in", "a", "local", "minima", ".", "However", ",", "the", "output", "function", "separates", "the", "node", "hidden", "states", "and", "messages", "from", "the", "output", "probability", "distributions", ".", "The", "network", "therefore", "has", "the", "capacity", "to", "use", "a", "small", "part", "of", "the", "hidden", "state", "for", "retaining", "a", "current", "best", "guess", ",", "which", "can", "remain", "constant", "over", "several", "steps", ",", "and", "other", "parts", "of", "the", "hidden", "state", "for", "running", "a", "non", "-", "greedy", "multi", "-", "step", "algorithm", ".", "Sending", "messages", "for", "all", "nodes", "in", "parallel", "and", "summing", "all", "the", "incoming", "messages", "might", "seem", "like", "an", "unsophisticated", "approach", "that", "risk", "resulting", "in", "oscillatory", "behavior", "and", "drowning", "out", "the", "important", "messages", ".", "However", ",", "since", "the", "receiving", "node", "hidden", "state", "is", "an", "input", "to", "the", "message", "function", ",", "the", "receiving", "node", "can", "in", "a", "sense", "determine", "which", "messages", "it", "wishes", "to", "receive", ".", "As", "such", ",", "the", "sum", "can", "be", "seen", "as", "an", "implicit", "attention", "mechanism", "over", "the", "incoming", "messages", ".", "Similarly", "the", "network", "can", "learn", "an", "optimal", "message", "passing", "schedule", ",", "by", "ignoring", "messages", "based", "on", "the", "history", "and", "current", "state", "of", "the", "receiving", "and", "sending", "node", ".", "section", ":", "Related", "work", "Relational", "networks", "santoro2017simple", "and", "interaction", "networks", "battaglia2016interaction", "are", "the", "most", "directly", "comparable", "to", "ours", ".", "These", "models", "correspond", "to", "using", "a", "single", "step", "of", "equation", "[", "reference", "]", ".", "Since", "it", "only", "does", "one", "step", "it", "can", "not", "naturally", "do", "complex", "multi", "-", "step", "relational", "reasoning", ".", "In", "order", "to", "solve", "the", "tasks", "that", "require", "more", "than", "a", "single", "step", "it", "must", "compress", "all", "the", "relevant", "relations", "into", "a", "fixed", "size", "vector", ",", "then", "perform", "the", "remaining", "relational", "reasoning", "in", "the", "last", "forward", "layers", ".", "Relational", "networks", ",", "interaction", "networks", "and", "our", "proposed", "model", "can", "all", "be", "seen", "as", "an", "instance", "of", "Graph", "Neural", "Networks", "scarselli2009graph", ",", "gilmer2017neural", ".", "Graph", "neural", "networks", "with", "message", "passing", "computations", "go", "back", "to", ".", "However", ",", "there", "are", "key", "differences", "that", "we", "found", "important", "for", "implementing", "stable", "multi", "-", "step", "relational", "reasoning", ".", "Including", "the", "node", "features", "at", "every", "step", "in", "eq", ".", "[", "reference", "]", "is", "important", "to", "the", "stability", "of", "the", "network", ".", ",", "eq", ".", "3", "has", "the", "node", "features", ",", ",", "inside", "the", "message", "function", ".", "battaglia2016interaction", "use", "an", "in", "the", "node", "update", "function", ",", "but", "this", "is", "an", "external", "driving", "force", ".", "sukhbaatar2016learning", "also", "proposed", "to", "include", "the", "node", "features", "at", "every", "step", ".", "Optimizing", "the", "loss", "at", "every", "step", "in", "order", "to", "learn", "a", "convergent", "message", "passing", "algorithm", "is", "novel", "to", "the", "best", "of", "our", "knowledge", ".", "introduces", "an", "explicit", "loss", "term", "to", "ensure", "convergence", ".", "ross2011learning", "trains", "the", "inference", "machine", "predictors", "on", "every", "step", ",", "but", "there", "are", "no", "hidden", "states", ";", "the", "node", "states", "are", "the", "output", "marginals", "directly", ",", "similar", "to", "how", "belief", "propagation", "works", ".", "Our", "model", "can", "also", "be", "seen", "as", "a", "completely", "learned", "message", "passing", "algorithm", ".", "Belief", "propagation", "is", "a", "hand", "-", "crafted", "message", "passing", "algorithm", "for", "performing", "exact", "inference", "in", "directed", "acyclic", "graphical", "models", ".", "If", "the", "graph", "has", "cycles", ",", "one", "can", "use", "a", "variant", ",", "loopy", "belief", "propagation", ",", "but", "it", "is", "not", "guaranteed", "to", "be", "exact", ",", "unbiased", "or", "converge", ".", "Empirically", "it", "works", "well", "though", "and", "it", "is", "widely", "used", "murphy1999loopy", ".", "Several", "works", "have", "proposed", "replacing", "parts", "of", "belief", "propagation", "with", "learned", "modules", "heess2013learning", ",", "lin2015deeply", ".", "Our", "work", "differs", "by", "not", "being", "rooted", "in", "loopy", "BP", ",", "and", "instead", "learning", "all", "parts", "of", "a", "general", "message", "passing", "algorithm", ".", "ross2011learning", "proposes", "Inference", "Machines", "which", "ditch", "the", "belief", "propagation", "algorithm", "altogether", "and", "instead", "train", "a", "series", "of", "regressors", "to", "output", "the", "correct", "marginals", "by", "passing", "messages", "on", "a", "graph", ".", "wei2016convolutional", "applies", "this", "idea", "to", "pose", "estimation", "using", "a", "series", "of", "convolutional", "layers", "and", "deng2016structure", "introduces", "a", "recurrent", "node", "update", "for", "the", "same", "domain", ".", "There", "is", "rich", "literature", "on", "combining", "symbolic", "reasoning", "and", "logic", "with", "sub", "-", "symbolic", "distributed", "representations", "which", "goes", "all", "the", "way", "back", "to", "the", "birth", "of", "the", "idea", "of", "parallel", "distributed", "processing", "mcculloch1943logical", ".", "See", "raedt2016statistical", ",", "besold2017neural", "for", "two", "recent", "surveys", ".", "Here", "we", "describe", "only", "a", "few", "recent", "methods", ".", "serafini2016learning", "introduces", "the", "Logic", "Tensor", "Network", "(", "LTN", ")", "which", "describes", "a", "first", "order", "logic", "in", "which", "symbols", "are", "grounded", "as", "vector", "embeddings", ",", "and", "predicates", "and", "functions", "are", "grounded", "as", "tensor", "networks", ".", "The", "embeddings", "and", "tensor", "networks", "are", "then", "optimized", "jointly", "to", "maximize", "a", "fuzzy", "satisfiability", "measure", "over", "a", "set", "of", "known", "facts", "and", "fuzzy", "constraints", ".", "vsourek2015lifted", "introduces", "the", "Lifted", "Relational", "Network", "which", "combines", "relational", "logic", "with", "neural", "networks", "by", "creating", "neural", "networks", "from", "lifted", "rules", "and", "training", "examples", ",", "such", "that", "the", "connections", "between", "neurons", "created", "from", "the", "same", "lifted", "rules", "shares", "weights", ".", "Our", "approach", "differs", "fundamentally", "in", "that", "we", "do", "not", "aim", "to", "bridge", "symbolic", "and", "sub", "-", "symbolic", "methods", ".", "Instead", "we", "stay", "completely", "in", "the", "sub", "-", "symbolic", "realm", ".", "We", "do", "not", "introduce", "or", "consider", "any", "explicit", "logic", ",", "aim", "to", "discover", "(", "fuzzy", ")", "logic", "rules", ",", "or", "attempt", "to", "include", "prior", "knowledge", "in", "the", "form", "of", "logical", "constraints", ".", "amos2017optnet", "Introduces", "OptNet", ",", "a", "neural", "network", "layer", "that", "solve", "quadratic", "programs", "using", "an", "efficient", "differentiable", "solver", ".", "OptNet", "is", "trained", "to", "solve", "4x4", "Sudokus", "amongst", "other", "problems", "and", "beats", "the", "deep", "convolutional", "network", "baseline", "as", "described", "in", "park2016can", ".", "Unfortunately", "we", "can", "not", "compare", "to", "OptNet", "directly", "as", "it", "has", "computational", "issues", "scaling", "to", "9x9", "Sudokus", "(", "Brandon", "Amos", ",", "2018", ",", "personal", "communication", ")", ".", "sukhbaatar2016learning", "proposes", "the", "Communication", "Network", "(", "CommNet", ")", "for", "learning", "multi", "-", "agent", "cooperation", "and", "communication", "using", "back", "-", "propagation", ".", "It", "is", "similar", "to", "our", "recurrent", "relational", "network", ",", "but", "differs", "in", "key", "aspects", ".", "The", "messages", "passed", "between", "all", "nodes", "at", "a", "given", "step", "are", "the", "same", ",", "corresponding", "to", "the", "average", "of", "all", "the", "node", "hidden", "states", ".", "Also", ",", "it", "is", "not", "trained", "to", "minimize", "the", "loss", "on", "every", "step", "of", "the", "algorithm", ".", "subsubsection", ":", "Acknowledgments", "We", "\u2019d", "like", "to", "thank", "the", "anonymous", "reviewers", "for", "the", "valuable", "comments", "and", "suggestions", ",", "especially", "reviewer", "2", "who", "suggested", "the", "age", "arithmetic", "task", ".", "This", "research", "was", "supported", "by", "the", "NVIDIA", "Corporation", "with", "the", "donation", "of", "TITAN", "X", "GPUs", ".", "bibliography", ":", "References", "section", ":", "Supplementary", "Material", "subsection", ":", "bAbI", "experimental", "details", "Unless", "otherwise", "specified", "we", "use", "128", "hidden", "units", "for", "all", "layers", "and", "all", "MLPs", "are", "3", "ReLU", "layers", "followed", "by", "a", "linear", "layer", ".", "We", "compute", "each", "node", "feature", "vector", "as", "where", "is", "fact", ",", "is", "the", "question", ",", "is", "the", "sentence", "position", "(", "1", "-", "20", ")", "of", "fact", "and", "is", "a", "random", "offset", "per", "question", "(", "1", "-", "20", ")", ",", "such", "that", "the", "onehot", "output", "is", "40", "dimensional", ".", "The", "offset", "is", "constant", "for", "all", "facts", "related", "to", "a", "single", "question", "to", "avoid", "changing", "the", "relative", "order", "of", "the", "facts", ".", "The", "random", "offset", "prevents", "the", "network", "from", "memorizing", "the", "position", "of", "the", "facts", "and", "rather", "reason", "about", "their", "ordering", ".", "Our", "message", "function", "is", "a", "MLP", ".", "Our", "node", "function", "uses", "an", "LSTM", "over", "reasoning", "steps", "where", "is", "the", "cell", "state", "of", "the", "LSTM", "for", "unit", "at", "time", ".", "is", "initialized", "to", "zero", ".", "We", "run", "our", "network", "for", "three", "steps", ".", "To", "get", "a", "graph", "level", "output", ",", "we", "use", "a", "MLP", "over", "the", "sum", "of", "the", "node", "hidden", "states", ",", "with", "3", "layers", ",", "the", "final", "being", "a", "linear", "layer", "that", "maps", "to", "the", "output", "logits", ".", "The", "last", "two", "layers", "uses", "dropout", "of", "50", "%", ".", "We", "train", "and", "validate", "on", "all", "20", "tasks", "jointly", "using", "the", "9", ",", "000", "training", "and", "1", ",", "000", "validation", "samples", "defined", "in", "the", "en_valid_10k", "split", ".", "We", "use", "the", "Adam", "optimizer", "with", "a", "batch", "size", "of", "512", ",", "a", "learning", "rate", "of", "2e", "-", "4", "and", "L2", "regularization", "with", "a", "rate", "of", "1e", "-", "5", ".", "We", "train", "for", "5", "M", "gradient", "steps", ".", "subsection", ":", "bAbI", "ablation", "experiments", "To", "test", "which", "parts", "of", "the", "proposed", "model", "is", "important", "to", "solving", "the", "bAbI", "tasks", "we", "perform", "ablation", "experiments", ".", "One", "of", "the", "main", "differences", "between", "the", "relational", "network", "and", "our", "proposed", "model", ",", "aside", "from", "the", "recurrent", "steps", ",", "is", "that", "we", "encode", "the", "sentences", "and", "question", "together", ".", "We", "ablate", "the", "model", "in", "two", "ways", "to", "test", "how", "important", "this", "is", ".", "1", ")", "Using", "a", "single", "linear", "layer", "instead", "of", "the", "4", "-", "layer", "MLP", "baseline", ",", "and", "2", ")", "Not", "encoding", "them", "together", ".", "In", "this", "case", "the", "node", "hidden", "states", "are", "initialized", "to", "the", "fact", "encodings", ".", "We", "found", "dropout", "to", "be", "important", ",", "so", "we", "also", "perform", "an", "ablation", "experiment", "without", "dropout", ".", "We", "run", "each", "ablation", "experiment", "eight", "times", ".", "We", "also", "do", "pseudo", "-", "ablation", "experiments", "with", "fewer", "steps", "by", "measuring", "at", "each", "step", "of", "the", "RRN", ".", "See", "table", "[", "reference", "]", ".", "subsection", ":", "Pretty", "-", "CLEVR", "experimental", "details", "Our", "setup", "for", "Pretty", "-", "CLEVR", "is", "a", "bit", "simpler", "than", "for", "bAbI.", "Unless", "otherwise", "specified", "we", "use", "128", "hidden", "units", "for", "all", "hidden", "layers", "and", "all", "MLPs", "are", "1", "ReLU", "layer", "followed", "by", "a", "linear", "layer", ".", "We", "compute", "each", "node", "feature", "vector", "as", "where", "is", "the", "position", ",", ",", "is", "the", "color", ",", "is", "the", "marker", ",", "is", "the", "marker", "or", "color", "of", "the", "start", "object", ",", "and", "is", "the", "number", "of", "jumps", ".", "Our", "message", "function", "is", "a", "MLP", ".", "Our", "node", "function", "is", ",", "Our", "output", "function", "is", "a", "MLP", "with", "a", "dropout", "fraction", "of", "0.5", "in", "the", "penultimate", "layer", ".", "The", "last", "layer", "has", "16", "hidden", "linear", "units", ".", "We", "run", "our", "recurrent", "relational", "network", "for", "4", "steps", ".", "We", "train", "on", "the", "12.8", "M", "training", "questions", ",", "and", "augment", "the", "data", "by", "scaling", "and", "rotating", "the", "scenes", "randomly", ".", "We", "use", "separate", "validation", "and", "test", "sets", "of", "128.000", "questions", "each", ".", "We", "use", "the", "Adam", "optimizer", "with", "a", "learning", "rate", "of", "1e", "-", "4", "and", "train", "for", "10", "M", "gradient", "updates", "with", "a", "batch", "size", "of", "128", ".", "The", "baseline", "RN", "is", "identical", "to", "the", "described", "RRN", ",", "except", "it", "only", "does", "a", "single", "step", "of", "relational", "reasoning", ".", "The", "baseline", "MLP", "takes", "the", "entire", "scene", "state", ",", ",", "as", "an", "input", ",", "such", "that", "where", "is", "the", "euclidean", "distance", "from", "object", "to", ".", "The", "baseline", "MLP", "has", "4", "ReLu", "layers", "with", "256", "hidden", "units", ",", "with", "dropout", "of", "0.5", "on", "the", "last", "layer", ",", "followed", "by", "a", "linear", "layer", "with", "16", "hidden", "units", ".", "The", "baseline", "MLP", "has", "87", "%", "more", "parameters", "than", "the", "RRN", "and", "RN", "(", "261", ",", "136", "vs", "139", ",", "536", ")", ".", "subsection", ":", "Sudoku", "dataset", "To", "generate", "our", "dataset", "the", "starting", "point", "is", "the", "collection", "of", "49", ",", "151", "unique", "17", "-", "givens", "puzzles", "gathered", "by", "royle2016minimum", "which", "we", "solve", "using", "the", "solver", "from", "norvig2006solving", ".", "Then", "we", "split", "the", "puzzles", "into", "a", "test", ",", "validation", "and", "training", "pool", ",", "with", "10", ",", "000", ",", "1", ",", "000", "and", "38", ",", "151", "samples", "respectively", ".", "To", "generate", "the", "sets", "we", "train", ",", "validate", "and", "test", "on", "we", "do", "the", "following", ":", "for", "each", "we", "sample", "puzzles", "from", "the", "respective", "pool", ",", "with", "replacement", ".", "For", "each", "sampled", "puzzle", "we", "add", "random", "digits", "from", "the", "solution", ".", "We", "then", "swap", "the", "digits", "according", "to", "a", "random", "permutation", ",", "e.g.", ",", ",", "etc", ".", "The", "resulting", "puzzle", "is", "added", "to", "the", "respective", "set", ".", "For", "the", "test", ",", "validation", "and", "training", "sets", "we", "sample", ",", "and", "puzzles", "in", "this", "way", ".", "subsection", ":", "Sudoku", "experimental", "details", "Unless", "otherwise", "specified", "we", "use", "96", "hidden", "units", "for", "all", "hidden", "layers", "and", "all", "MLPs", "are", "3", "ReLU", "layers", "followed", "by", "a", "linear", "layer", ".", "Denote", "the", "digit", "for", "cell", "(", "0", "-", "9", ",", "0", "if", "not", "given", ")", ",", "and", "the", "row", "and", "column", "position", "(", "1", "-", "9", ")", "and", "(", "1", "-", "9", ")", "respectively", "..", "The", "node", "features", "are", "then", "where", "each", "embed", "is", "a", "16", "dimensional", "learned", "embedding", ".", "We", "could", "probably", "have", "used", "one", "-", "hot", "encoding", "instead", "of", "the", "embeddings", ",", "embedding", "was", "just", "the", "first", "thing", "we", "tried", ".", "Edge", "features", "were", "not", "used", ".", "The", "message", "function", "is", "an", "MLP", ".", "The", "node", "function", ",", "is", "identical", "to", "the", "setup", "for", "bAbI", ",", "i.e.", "The", "LSTM", "cell", "state", "is", "initialized", "to", "zeros", ".", "The", "output", "function", "is", "a", "linear", "layer", "with", "nine", "outputs", "to", "produce", "the", "output", "logits", ".", "We", "run", "the", "network", "for", "32", "steps", "with", "a", "loss", "on", "every", "step", ".", "We", "train", "the", "model", "for", "300.000", "gradient", "updates", "with", "a", "batch", "size", "of", "256", "using", "Adam", "with", "a", "learning", "rate", "of", "2e", "-", "4", "and", "L2", "regularization", "of", "1e", "-", "4", "on", "all", "weight", "matrices", ".", "subsection", ":", "Sudoku", "relational", "network", "baseline", "details", "The", "node", "centric", "corresponds", "exactly", "to", "a", "single", "step", "of", "our", "network", ".", "The", "graph", "centric", "approach", "is", "closer", "to", "the", "original", "relational", "network", ".", "It", "does", "one", "step", "of", "relational", "reasoning", "as", "our", "network", ",", "then", "sums", "all", "the", "node", "hidden", "states", ".", "The", "sum", "is", "then", "passed", "through", "a", "4", "layer", "MLP", "with", "outputs", ",", "one", "for", "each", "cell", "and", "digit", ".", "The", "graph", "centric", "model", "has", "larger", "hidden", "states", "of", "256", "in", "all", "layers", "to", "compensate", "somewhat", "for", "the", "sum", "squashing", "the", "entire", "graph", "into", "a", "fixed", "size", "vector", ".", "Otherwise", "both", "networks", "are", "identical", "to", "our", "network", ".", "The", "graph", "centric", "has", "over", "4", "times", "as", "many", "parameters", "as", "our", "model", "(", "944", ",", "874", "vs.", "201", ",", "194", ")", "but", "performs", "worse", "than", "the", "node", "centric", ".", "subsection", ":", "Age", "arithmetic", "task", "details", "We", "generated", "all", "262", ",", "144", "unique", "trees", "with", "8", "nodes", "and", "split", "them", "90%", "/", "10", "%", "into", "training", "and", "test", "graphs", ".", "The", "nodes", "represent", "the", "persons", ",", "and", "the", "edges", "which", "age", "differences", "will", "be", "given", "to", "the", "network", ".", "During", "training", "and", "testing", "we", "sample", "a", "batch", "of", "graphs", "from", "the", "respective", "set", "and", "sample", "8", "random", "ages", "(", "0", "-", "99", ")", "for", "each", ".", "We", "compute", "the", "absolute", "difference", "as", "well", "as", "the", "sign", "for", "each", "edge", "in", "the", "graphs", ".", "This", "gives", "us", "7", "relative", "facts", "on", "the", "form", "\u201c", "person", "A", "(", "0", "-", "7", ")", ",", "person", "B", "(", "0", "-", "7", ")", ",", "younger", "/", "older", "(", "-", "1", ",", "1", ")", ",", "absolute", "age", "difference", "(", "0", "-", "99", ")", "\u201d", ".", "Then", "we", "add", "the", "final", "fact", "which", "is", "the", "age", "of", "one", "of", "the", "nodes", "at", "random", ",", "e.g.", "\u201c", "3", ",", "3", ",", "0", ",", "47", "\u201d", ",", "using", "the", "zero", "sign", "to", "indicate", "this", "fact", "is", "absolute", "and", "not", "relative", ".", "The", "question", "is", "the", "age", "of", "one", "of", "the", "persons", "at", "random", "(", "0", "-", "7", ")", ".", "For", "each", "graph", "we", "compute", "the", "shortest", "path", "from", "the", "anchor", "person", "to", "the", "person", "in", "question", ".", "This", "is", "the", "minimum", "number", "of", "arithmetic", "computations", "that", "must", "be", "performed", "to", "infer", "the", "persons", "age", "from", "the", "given", "facts", ".", "The", "8", "facts", "(", "1", "anchor", ",", "7", "relative", ")", "are", "given", "to", "the", "network", "as", "a", "fully", "connected", "graph", "of", "8", "nodes", ".", "Note", ",", "this", "graph", "is", "different", "from", "the", "tree", "used", "to", "generate", "the", "facts", ".", "The", "network", "never", "sees", "the", "tree", ".", "The", "input", "vector", "for", "each", "fact", "are", "the", "four", "fact", "integers", "and", "the", "question", "integer", "one", "-", "hot", "encoded", "and", "concatenated", ".", "We", "use", "the", "same", "architecture", "as", "for", "the", "bAbI", "experiments", "except", "all", "MLPs", "are", "3", "dense", "layers", "with", "128", "ReLu", "units", "followed", "by", "one", "linear", "layer", ".", "We", "train", "the", "network", "for", "8", "steps", ",", "and", "test", "it", "for", "each", "step", ".", "See", "figure", "[", "reference", "]", "for", "results", ".", "subsection", ":", "Unrolled", "recurrent", "relational", "network", "Recurrent", "relational", "network", "on", "a", "fully", "connected", "graph", "with", "3", "nodes", ".", "Subscripts", "denote", "node", "indices", "and", "superscripts", "denote", "steps", ".", "The", "dashed", "lines", "indicate", "the", "recurrent", "connections", ".", "subsection", ":", "Full", "Sudoku", "solution", "An", "example", "Sudoku", ".", "Each", "of", "the", "81", "cells", "contain", "each", "digit", "1", "-", "9", ",", "which", "is", "useful", "if", "the", "reader", "wishes", "to", "try", "to", "solve", "the", "Sudoku", "as", "they", "can", "be", "crossed", "out", "or", "highlighted", ",", "etc", ".", "The", "digit", "font", "size", "corresponds", "to", "the", "probability", "our", "model", "assigns", "to", "each", "digit", "at", "step", "0", ",", "i.e.", "before", "any", "steps", "are", "taken", ".", "Subsequent", "pages", "contains", "the", "Sudoku", "as", "it", "evolves", "with", "more", "steps", "of", "our", "model", ".", "Step", "1", "Step", "4", "Step", "8", "Step", "12", "Step", "16", "Step", "20"]}