{"coref": {"BLEU-4": [], "Drug_Discovery": [], "Error_ratio": [[4347, 4348]], "GGS-NN": [[1131, 1134], [4879, 4882], [6020, 6023], [6052, 6057], [6272, 6276], [7645, 7649], [7665, 7669], [7724, 7728], [7786, 7790], [7899, 7902], [8140, 8144], [8277, 8283], [8360, 8364], [8455, 8459], [10508, 10512]], "Gated_Graph_Sequence_NN": [[2, 7], [398, 403], [975, 980], [981, 984], [2566, 2571], [2574, 2579], [2580, 2583], [3012, 3015], [3343, 3346], [3432, 3435], [3666, 3669], [3828, 3831], [3889, 3892], [4498, 4501], [4971, 4974], [5164, 5167], [5183, 5186], [5189, 5192], [5992, 5995], [7681, 7684], [7917, 7920], [9052, 9055], [9381, 9384], [9412, 9415], [9555, 9558], [9662, 9665], [10751, 10754], [10784, 10787], [10974, 10977], [9576, 9579], [10805, 10808]], "QM9": [], "SQL-to-Text": [], "WikiSQL": []}, "coref_non_salient": {"0": [[1000, 1004], [8778, 8783]], "1": [[2479, 2482], [7611, 7613], [7932, 7935]], "10": [[3274, 3277], [5576, 5581]], "100": [[8882, 8885]], "101": [[7752, 7754]], "102": [[8239, 8240]], "103": [[4632, 4637]], "104": [[620, 622]], "105": [[10819, 10821]], "106": [[11025, 11028], [11042, 11045]], "107": [[1736, 1742]], "108": [[261, 262], [301, 302], [1155, 1156], [1171, 1172], [1327, 1328], [1818, 1819], [1886, 1887], [8516, 8517], [8534, 8535], [8541, 8542], [8579, 8580], [8598, 8599], [8868, 8869], [8945, 8946], [8987, 8988], [9027, 9028]], "109": [[3815, 3817]], "11": [[243, 244], [407, 411], [658, 660], [801, 805]], "110": [[5101, 5104]], "111": [[8423, 8427]], "112": [[8834, 8837]], "113": [[4567, 4569]], "114": [[3363, 3367]], "115": [[1792, 1795]], "116": [[1174, 1178]], "117": [[1648, 1649]], "118": [[8429, 8431]], "119": [[8846, 8851]], "12": [[96, 100], [8820, 8824]], "120": [[8568, 8570]], "121": [[9186, 9188]], "122": [[811, 816]], "123": [[1421, 1423]], "124": [[1482, 1488]], "125": [[7952, 7954]], "126": [[2518, 2521]], "127": [[1031, 1033]], "128": [[589, 593]], "129": [[8332, 8334]], "13": [[2968, 2972], [11151, 11153]], "130": [[5460, 5465]], "131": [[5532, 5536]], "132": [[4672, 4674]], "133": [[8857, 8858]], "134": [[8671, 8673]], "135": [[5491, 5493]], "136": [[628, 630]], "137": [[4640, 4642]], "138": [[7882, 7885]], "139": [[4293, 4294]], "14": [[3088, 3091], [3231, 3234], [10223, 10226], [10233, 10236]], "140": [[4325, 4328]], "141": [[2310, 2312]], "142": [[8585, 8588]], "143": [[5211, 5215]], "144": [[1409, 1413]], "145": [[5539, 5540]], "146": [[291, 293]], "147": [[1630, 1634]], "148": [[755, 758]], "149": [[5228, 5233]], "15": [[661, 665], [885, 889]], "150": [[7737, 7738]], "151": [[5000, 5002]], "152": [[9004, 9006]], "153": [[2415, 2419]], "154": [[4605, 4607]], "155": [[728, 731]], "156": [[8616, 8618]], "157": [[2509, 2513]], "158": [[2425, 2432]], "159": [[8386, 8388]], "16": [[2626, 2628], [2973, 2974], [2977, 2978], [6006, 6008], [11029, 11030]], "160": [[9679, 9681]], "161": [[8501, 8505]], "162": [[66, 68]], "163": [[3409, 3410]], "164": [[8611, 8614]], "165": [[966, 972]], "166": [[2409, 2412]], "167": [[3353, 3356]], "168": [[8634, 8638]], "169": [[953, 955]], "17": [[3407, 3408], [4598, 4600]], "18": [[8404, 8407], [8466, 8468]], "19": [[7805, 7807], [7875, 7879], [7893, 7895]], "2": [[147, 149], [220, 222], [343, 346], [742, 744], [1019, 1023], [5180, 5182], [5199, 5201], [5206, 5209]], "20": [[1786, 1789], [1919, 1922], [2475, 2478], [2588, 2591], [3208, 3211], [3246, 3249], [3428, 3431], [8600, 8603], [8683, 8686], [9163, 9166], [9481, 9484], [9489, 9492], [2617, 2620]], "21": [[103, 104], [3822, 3823], [4033, 4034], [4125, 4126], [4655, 4657], [4669, 4670], [4710, 4711], [4805, 4806], [4956, 4957], [4982, 4983], [5157, 5158], [10218, 10219], [10229, 10230], [10267, 10268], [10401, 10402], [10434, 10435], [10555, 10556], [10588, 10589], [10674, 10675], [10769, 10770], [10794, 10795], [4749, 4750]], "22": [[1616, 1620], [2530, 2534]], "23": [[1585, 1589], [7760, 7765], [8011, 8016]], "24": [[1528, 1529], [6059, 6065]], "25": [[2375, 2379], [8680, 8682]], "26": [[3820, 3821], [4031, 4032], [4123, 4124], [4653, 4654], [4667, 4668], [4708, 4709], [4803, 4804], [4954, 4955], [4980, 4981], [5155, 5156], [10216, 10217], [10227, 10228], [10265, 10266], [10399, 10400], [10432, 10433], [10553, 10554], [10586, 10587], [10670, 10671], [10678, 10679], [10767, 10768], [10792, 10793], [4747, 4748], [10661, 10662]], "27": [[1233, 1235], [1345, 1347], [1424, 1426], [1428, 1430], [1438, 1440], [2155, 2157], [7717, 7720], [9617, 9619]], "28": [[8957, 8959], [9009, 9011]], "29": [[10034, 10036], [10044, 10046]], "3": [[8101, 8103], [8108, 8113]], "30": [[3403, 3404], [9209, 9211], [9288, 9290]], "31": [[6150, 6153], [6264, 6267], [10987, 10990], [11035, 11038]], "32": [[85, 88], [782, 785], [1498, 1500], [1724, 1726], [2537, 2539], [2986, 2988], [8744, 8746]], "33": [[1341, 1343], [1655, 1656], [2171, 2173], [4457, 4459], [7673, 7675]], "34": [[631, 633], [1621, 1622], [1635, 1636], [4698, 4700], [7603, 7604], [8300, 8301], [11247, 11248]], "35": [[551, 554], [1073, 1076]], "36": [[10985, 10986]], "37": [[1701, 1703], [9806, 9808]], "38": [[3328, 3330], [4356, 4358]], "39": [[634, 636], [1876, 1877], [9074, 9076]], "4": [[8698, 8704], [9976, 9977]], "40": [[1642, 1647], [1854, 1858]], "41": [[51, 54], [257, 260], [613, 616], [648, 651], [765, 768], [849, 852], [1142, 1145], [1151, 1154], [1977, 1980], [9720, 9723], [1775, 1778], [1782, 1785]], "42": [[8963, 8967]], "43": [[9811, 9822]], "44": [[4986, 4989], [9695, 9697]], "45": [[5064, 5066], [6010, 6013], [8095, 8098]], "46": [[281, 284], [871, 874]], "47": [[4559, 4560], [4828, 4829]], "48": [[3357, 3358], [120, 121], [3382, 3383]], "49": [[574, 576], [8766, 8768]], "5": [[3405, 3406], [3920, 3922], [4592, 4594]], "50": [[5295, 5297], [5528, 5530], [5779, 5781], [5878, 5880], [5938, 5940], [6074, 6076], [6119, 6121], [6141, 6143], [8354, 8356], [8448, 8450], [10858, 10860], [11300, 11302]], "51": [[4519, 4521], [5044, 5046], [5075, 5077], [10242, 10244], [10747, 10749]], "52": [[9218, 9220], [9297, 9299]], "53": [[4522, 4525], [10258, 10261]], "54": [[4536, 4537], [7732, 7733]], "55": [[8892, 8894]], "56": [[5932, 5934]], "57": [[8414, 8416]], "58": [[9325, 9329]], "59": [[2748, 2750], [3024, 3026]], "6": [[5092, 5098], [7631, 7636]], "60": [[1236, 1238], [8817, 8819]], "61": [[325, 327], [9962, 9964]], "62": [[1138, 1139], [4403, 4405], [4435, 4436], [4439, 4440], [4737, 4739], [4822, 4823], [4858, 4859], [4977, 4979], [8317, 8318], [8342, 8343]], "63": [[8662, 8665]], "64": [[9367, 9370]], "65": [[7558, 7560], [11215, 11217]], "66": [[9883, 9885]], "67": [[1354, 1356], [1525, 1527], [1530, 1532], [1878, 1880], [2452, 2454], [2657, 2659], [2724, 2726], [8538, 8540]], "68": [[4289, 4290], [4397, 4398]], "69": [[4676, 4679]], "7": [[308, 310], [996, 998], [3370, 3372], [3373, 3375], [3425, 3427], [3786, 3788], [3847, 3851], [3916, 3918], [4163, 4165], [4298, 4300], [4464, 4466], [4833, 4835], [4847, 4849], [4994, 4998], [9178, 9180], [9523, 9525], [10238, 10240], [10742, 10744], [9448, 9450]], "70": [[61, 64], [286, 289], [1823, 1826]], "71": [[35, 38], [239, 242]], "72": [[8690, 8692]], "73": [[2440, 2445]], "74": [[8875, 8879]], "75": [[3412, 3415], [3797, 3799], [4167, 4169], [4837, 4839]], "76": [[5985, 5987]], "77": [[272, 274], [1637, 1638]], "78": [[3379, 3381]], "79": [[3648, 3651], [3933, 3936], [4478, 4481], [4732, 4735], [4816, 4819], [6256, 6259], [4620, 4623], [7659, 7662], [9266, 9269], [9348, 9351]], "8": [[3236, 3240], [10253, 10256]], "80": [[11048, 11051]], "81": [[1416, 1418], [2109, 2111], [2224, 2226], [2231, 2233], [2653, 2655], [2662, 2664], [2717, 2719], [4515, 4517], [7653, 7655], [9860, 9862]], "82": [[3421, 3423]], "83": [[8727, 8729]], "84": [[4704, 4706]], "85": [[91, 93]], "86": [[8496, 8498]], "87": [[8306, 8313]], "88": [[9058, 9063]], "89": [[4702, 4703]], "9": [[2194, 2195], [11203, 11205]], "90": [[4414, 4416]], "91": [[8718, 8723]], "92": [[3866, 3868]], "93": [[9740, 9742]], "94": [[1551, 1556]], "95": [[5315, 5319]], "96": [[9733, 9735]], "97": [[2706, 2709]], "98": [[1471, 1474]], "99": [[8940, 8944]]}, "doc_id": "2d2a22f1f9eae9188f3d43254daa2d5b7f3a2470", "method_subrelations": {"GGS-NN": [[[0, 6], "GGS-NN"]], "Gated_Graph_Sequence_NN": [[[0, 23], "Gated_Graph_Sequence_NN"]]}, "n_ary_relations": [{"Material": "QM9", "Method": "Gated_Graph_Sequence_NN", "Metric": "Error_ratio", "Task": "Drug_Discovery", "score": "1.36"}, {"Material": "WikiSQL", "Method": "GGS-NN", "Metric": "BLEU-4", "Task": "SQL-to-Text", "score": "35.53"}], "ner": [[2, 7, "Method"], [35, 38, "Method"], [51, 54, "Method"], [61, 64, "Method"], [66, 68, "Method"], [85, 88, "Method"], [91, 93, "Metric"], [96, 100, "Method"], [103, 104, "Method"], [147, 149, "Task"], [220, 222, "Task"], [239, 242, "Method"], [243, 244, "Task"], [257, 260, "Method"], [261, 262, "Method"], [272, 274, "Method"], [281, 284, "Method"], [286, 289, "Method"], [291, 293, "Method"], [301, 302, "Method"], [308, 310, "Task"], [325, 327, "Method"], [343, 346, "Task"], [398, 403, "Method"], [407, 411, "Task"], [551, 554, "Task"], [574, 576, "Method"], [589, 593, "Method"], [613, 616, "Method"], [620, 622, "Method"], [628, 630, "Task"], [631, 633, "Task"], [634, 636, "Method"], [648, 651, "Method"], [658, 660, "Task"], [661, 665, "Task"], [728, 731, "Method"], [742, 744, "Task"], [755, 758, "Task"], [765, 768, "Method"], [782, 785, "Method"], [801, 805, "Task"], [811, 816, "Method"], [849, 852, "Method"], [871, 874, "Method"], [885, 889, "Task"], [953, 955, "Method"], [966, 972, "Method"], [975, 980, "Method"], [981, 984, "Method"], [996, 998, "Task"], [1000, 1004, "Task"], [1019, 1023, "Task"], [1031, 1033, "Task"], [1073, 1076, "Task"], [1131, 1134, "Method"], [1138, 1139, "Metric"], [1142, 1145, "Method"], [1151, 1154, "Method"], [1155, 1156, "Method"], [1171, 1172, "Method"], [1174, 1178, "Method"], [1233, 1235, "Method"], [1236, 1238, "Method"], [1327, 1328, "Method"], [1341, 1343, "Method"], [1345, 1347, "Method"], [1354, 1356, "Method"], [1409, 1413, "Method"], [1416, 1418, "Method"], [1421, 1423, "Method"], [1424, 1426, "Method"], [1428, 1430, "Method"], [1438, 1440, "Method"], [1471, 1474, "Method"], [1482, 1488, "Method"], [1498, 1500, "Method"], [1525, 1527, "Method"], [1528, 1529, "Task"], [1530, 1532, "Method"], [1551, 1556, "Method"], [1585, 1589, "Task"], [1616, 1620, "Task"], [1621, 1622, "Task"], [1630, 1634, "Method"], [1635, 1636, "Task"], [1637, 1638, "Method"], [1642, 1647, "Method"], [1648, 1649, "Method"], [1655, 1656, "Method"], [1701, 1703, "Method"], [1724, 1726, "Method"], [1736, 1742, "Method"], [1786, 1789, "Method"], [1792, 1795, "Method"], [1818, 1819, "Method"], [1823, 1826, "Method"], [1854, 1858, "Method"], [1876, 1877, "Method"], [1878, 1880, "Method"], [1886, 1887, "Method"], [1919, 1922, "Method"], [1977, 1980, "Method"], [2109, 2111, "Method"], [2155, 2157, "Method"], [2171, 2173, "Method"], [2194, 2195, "Method"], [2224, 2226, "Method"], [2231, 2233, "Method"], [2310, 2312, "Method"], [2375, 2379, "Method"], [2409, 2412, "Method"], [2415, 2419, "Method"], [2425, 2432, "Method"], [2440, 2445, "Method"], [2452, 2454, "Method"], [2475, 2478, "Method"], [2479, 2482, "Task"], [2509, 2513, "Method"], [2518, 2521, "Method"], [2530, 2534, "Task"], [2537, 2539, "Method"], [2566, 2571, "Method"], [2574, 2579, "Method"], [2580, 2583, "Method"], [2588, 2591, "Method"], [2626, 2628, "Task"], [2653, 2655, "Method"], [2657, 2659, "Method"], [2662, 2664, "Method"], [2706, 2709, "Method"], [2717, 2719, "Method"], [2724, 2726, "Method"], [2748, 2750, "Method"], [2968, 2972, "Method"], [2973, 2974, "Task"], [2977, 2978, "Task"], [2986, 2988, "Method"], [3012, 3015, "Method"], [3024, 3026, "Method"], [3088, 3091, "Task"], [3208, 3211, "Method"], [3231, 3234, "Task"], [3236, 3240, "Task"], [3246, 3249, "Method"], [3274, 3277, "Method"], [3328, 3330, "Task"], [3343, 3346, "Method"], [3353, 3356, "Task"], [3357, 3358, "Task"], [3363, 3367, "Method"], [3370, 3372, "Task"], [3373, 3375, "Task"], [3379, 3381, "Task"], [3403, 3404, "Task"], [3405, 3406, "Task"], [3407, 3408, "Task"], [3409, 3410, "Task"], [3412, 3415, "Task"], [3421, 3423, "Method"], [3425, 3427, "Task"], [3428, 3431, "Method"], [3432, 3435, "Method"], [3648, 3651, "Method"], [3666, 3669, "Method"], [3786, 3788, "Task"], [3797, 3799, "Task"], [3815, 3817, "Method"], [3820, 3821, "Method"], [3822, 3823, "Method"], [3828, 3831, "Method"], [3847, 3851, "Task"], [3866, 3868, "Method"], [3889, 3892, "Method"], [3916, 3918, "Task"], [3920, 3922, "Task"], [3933, 3936, "Method"], [4031, 4032, "Method"], [4033, 4034, "Method"], [4123, 4124, "Method"], [4125, 4126, "Method"], [4163, 4165, "Task"], [4167, 4169, "Task"], [4289, 4290, "Task"], [4293, 4294, "Task"], [4298, 4300, "Task"], [4325, 4328, "Task"], [4347, 4348, "Metric"], [4356, 4358, "Task"], [4397, 4398, "Task"], [4403, 4405, "Metric"], [4414, 4416, "Metric"], [4435, 4436, "Metric"], [4439, 4440, "Metric"], [4457, 4459, "Method"], [4464, 4466, "Task"], [4478, 4481, "Method"], [4498, 4501, "Method"], [4515, 4517, "Method"], [4519, 4521, "Task"], [4522, 4525, "Task"], [4536, 4537, "Method"], [4559, 4560, "Method"], [4567, 4569, "Method"], [4592, 4594, "Task"], [4598, 4600, "Task"], [4605, 4607, "Task"], [4632, 4637, "Method"], [4640, 4642, "Method"], [4653, 4654, "Method"], [4655, 4657, "Method"], [4667, 4668, "Method"], [4669, 4670, "Method"], [4672, 4674, "Method"], [4676, 4679, "Method"], [4698, 4700, "Task"], [4702, 4703, "Metric"], [4704, 4706, "Metric"], [4708, 4709, "Method"], [4710, 4711, "Method"], [4732, 4735, "Method"], [4737, 4739, "Metric"], [4803, 4804, "Method"], [4805, 4806, "Method"], [4816, 4819, "Method"], [4822, 4823, "Metric"], [4828, 4829, "Method"], [4833, 4835, "Task"], [4837, 4839, "Task"], [4847, 4849, "Task"], [4858, 4859, "Metric"], [4879, 4882, "Method"], [4954, 4955, "Method"], [4956, 4957, "Method"], [4971, 4974, "Method"], [4977, 4979, "Metric"], [4980, 4981, "Method"], [4982, 4983, "Method"], [4986, 4989, "Method"], [4994, 4998, "Task"], [5000, 5002, "Task"], [5064, 5066, "Task"], [5092, 5098, "Method"], [5101, 5104, "Method"], [5155, 5156, "Method"], [5157, 5158, "Method"], [5164, 5167, "Method"], [5180, 5182, "Task"], [5183, 5186, "Method"], [5189, 5192, "Method"], [5199, 5201, "Task"], [5206, 5209, "Task"], [5211, 5215, "Task"], [5228, 5233, "Task"], [5295, 5297, "Method"], [5315, 5319, "Task"], [5460, 5465, "Method"], [5491, 5493, "Method"], [5532, 5536, "Method"], [5539, 5540, "Method"], [5576, 5581, "Method"], [5932, 5934, "Method"], [5985, 5987, "Method"], [5992, 5995, "Method"], [6006, 6008, "Task"], [6010, 6013, "Task"], [6020, 6023, "Method"], [6052, 6057, "Method"], [6059, 6065, "Task"], [6150, 6153, "Method"], [6256, 6259, "Method"], [6264, 6267, "Method"], [6272, 6276, "Method"], [7558, 7560, "Method"], [7603, 7604, "Task"], [7611, 7613, "Task"], [7631, 7636, "Method"], [7645, 7649, "Method"], [7653, 7655, "Method"], [7665, 7669, "Method"], [7673, 7675, "Method"], [7681, 7684, "Method"], [7717, 7720, "Method"], [7724, 7728, "Method"], [7737, 7738, "Task"], [7752, 7754, "Metric"], [7760, 7765, "Task"], [7786, 7790, "Method"], [7805, 7807, "Task"], [7875, 7879, "Task"], [7882, 7885, "Method"], [7893, 7895, "Task"], [7899, 7902, "Method"], [7917, 7920, "Method"], [7932, 7935, "Task"], [7952, 7954, "Task"], [8011, 8016, "Task"], [8095, 8098, "Task"], [8101, 8103, "Task"], [8108, 8113, "Task"], [8140, 8144, "Method"], [8239, 8240, "Metric"], [8277, 8283, "Method"], [8300, 8301, "Task"], [8306, 8313, "Task"], [8317, 8318, "Metric"], [8332, 8334, "Method"], [8342, 8343, "Metric"], [8360, 8364, "Method"], [8386, 8388, "Method"], [8404, 8407, "Method"], [8414, 8416, "Method"], [8423, 8427, "Method"], [8429, 8431, "Method"], [8455, 8459, "Method"], [8466, 8468, "Method"], [8496, 8498, "Method"], [8501, 8505, "Task"], [8516, 8517, "Method"], [8534, 8535, "Method"], [8538, 8540, "Method"], [8541, 8542, "Method"], [8568, 8570, "Task"], [8579, 8580, "Method"], [8585, 8588, "Method"], [8598, 8599, "Method"], [8600, 8603, "Method"], [8611, 8614, "Task"], [8616, 8618, "Method"], [8634, 8638, "Method"], [8662, 8665, "Method"], [8671, 8673, "Method"], [8680, 8682, "Method"], [8683, 8686, "Method"], [8690, 8692, "Method"], [8698, 8704, "Task"], [8718, 8723, "Method"], [8727, 8729, "Method"], [8744, 8746, "Method"], [8766, 8768, "Method"], [8778, 8783, "Task"], [8817, 8819, "Method"], [8820, 8824, "Method"], [8834, 8837, "Method"], [8846, 8851, "Method"], [8857, 8858, "Method"], [8868, 8869, "Method"], [8875, 8879, "Method"], [8882, 8885, "Method"], [8892, 8894, "Method"], [8940, 8944, "Task"], [8945, 8946, "Method"], [8957, 8959, "Method"], [8963, 8967, "Method"], [8987, 8988, "Method"], [9004, 9006, "Metric"], [9009, 9011, "Method"], [9027, 9028, "Method"], [9052, 9055, "Method"], [9058, 9063, "Method"], [9074, 9076, "Method"], [9163, 9166, "Method"], [9178, 9180, "Task"], [9186, 9188, "Method"], [9209, 9211, "Task"], [9218, 9220, "Method"], [9288, 9290, "Task"], [9297, 9299, "Method"], [9325, 9329, "Task"], [9367, 9370, "Method"], [9381, 9384, "Method"], [9412, 9415, "Method"], [9481, 9484, "Method"], [9489, 9492, "Method"], [9523, 9525, "Task"], [9555, 9558, "Method"], [9617, 9619, "Method"], [9662, 9665, "Method"], [9679, 9681, "Method"], [9695, 9697, "Method"], [9720, 9723, "Method"], [9733, 9735, "Method"], [9740, 9742, "Method"], [9806, 9808, "Method"], [9811, 9822, "Method"], [9860, 9862, "Method"], [9883, 9885, "Method"], [9962, 9964, "Method"], [9976, 9977, "Task"], [10034, 10036, "Task"], [10044, 10046, "Task"], [10216, 10217, "Method"], [10218, 10219, "Method"], [10223, 10226, "Task"], [10227, 10228, "Method"], [10229, 10230, "Method"], [10233, 10236, "Task"], [10238, 10240, "Task"], [10253, 10256, "Task"], [10258, 10261, "Task"], [10265, 10266, "Method"], [10267, 10268, "Method"], [10399, 10400, "Method"], [10401, 10402, "Method"], [10432, 10433, "Method"], [10434, 10435, "Method"], [10508, 10512, "Method"], [10553, 10554, "Method"], [10555, 10556, "Method"], [10586, 10587, "Method"], [10588, 10589, "Method"], [10670, 10671, "Method"], [10674, 10675, "Method"], [10678, 10679, "Method"], [10742, 10744, "Task"], [10751, 10754, "Method"], [10767, 10768, "Method"], [10769, 10770, "Method"], [10784, 10787, "Method"], [10792, 10793, "Method"], [10794, 10795, "Method"], [10819, 10821, "Task"], [10974, 10977, "Method"], [10985, 10986, "Method"], [10987, 10990, "Method"], [11025, 11028, "Method"], [11029, 11030, "Task"], [11035, 11038, "Method"], [11042, 11045, "Method"], [11048, 11051, "Method"], [11151, 11153, "Method"], [11203, 11205, "Method"], [11215, 11217, "Method"], [11247, 11248, "Task"], [120, 121, "Task"], [1775, 1778, "Method"], [1782, 1785, "Method"], [2617, 2620, "Method"], [3382, 3383, "Task"], [4620, 4623, "Method"], [4747, 4748, "Method"], [4749, 4750, "Method"], [5044, 5046, "Task"], [5075, 5077, "Task"], [5528, 5530, "Method"], [5779, 5781, "Method"], [5878, 5880, "Method"], [5938, 5940, "Method"], [6074, 6076, "Method"], [6119, 6121, "Method"], [6141, 6143, "Method"], [7659, 7662, "Method"], [7732, 7733, "Method"], [8354, 8356, "Method"], [8448, 8450, "Method"], [9266, 9269, "Method"], [9348, 9351, "Method"], [9448, 9450, "Task"], [9576, 9579, "Method"], [10242, 10244, "Task"], [10661, 10662, "Method"], [10747, 10749, "Task"], [10805, 10808, "Method"], [10858, 10860, "Method"], [11300, 11302, "Method"]], "sections": [[0, 531], [531, 1140], [1140, 1414], [1414, 1523], [1523, 1772], [1772, 1881], [1881, 2222], [2222, 2450], [2450, 2564], [2564, 3075], [3075, 3283], [3283, 3326], [3326, 3368], [3368, 3898], [3898, 4144], [4144, 4258], [4258, 4559], [4559, 4828], [4828, 4984], [4984, 5178], [5178, 5561], [5561, 5564], [5564, 5750], [5750, 5887], [5887, 5988], [5988, 7636], [7636, 7803], [7803, 8161], [8161, 8506], [8506, 9142], [9142, 9145], [9145, 9371], [9371, 9765], [9765, 9801], [9801, 9804], [9804, 10032], [10032, 10212], [10212, 10817], [10817, 11305]], "sentences": [[0, 7], [7, 29], [29, 44], [44, 75], [75, 113], [113, 130], [130, 162], [162, 175], [175, 193], [193, 233], [233, 250], [250, 265], [265, 294], [294, 306], [306, 375], [375, 412], [412, 438], [438, 455], [455, 460], [460, 472], [472, 483], [483, 495], [495, 496], [496, 507], [507, 514], [514, 531], [531, 534], [534, 560], [560, 595], [595, 641], [641, 655], [655, 690], [690, 722], [722, 737], [737, 759], [759, 796], [796, 837], [837, 875], [875, 896], [896, 948], [948, 986], [986, 1012], [1012, 1024], [1024, 1065], [1065, 1108], [1108, 1140], [1140, 1145], [1145, 1157], [1157, 1171], [1171, 1185], [1185, 1196], [1196, 1228], [1228, 1245], [1245, 1264], [1264, 1285], [1285, 1295], [1295, 1306], [1306, 1327], [1327, 1336], [1336, 1369], [1369, 1391], [1391, 1414], [1414, 1418], [1418, 1427], [1427, 1475], [1475, 1501], [1501, 1523], [1523, 1529], [1529, 1547], [1547, 1557], [1557, 1583], [1583, 1614], [1614, 1637], [1637, 1669], [1669, 1686], [1686, 1704], [1704, 1721], [1721, 1742], [1742, 1745], [1745, 1772], [1772, 1778], [1778, 1804], [1804, 1814], [1814, 1848], [1848, 1871], [1871, 1881], [1881, 1885], [1885, 1912], [1912, 1933], [1933, 1961], [1961, 1994], [1994, 2009], [2009, 2023], [2023, 2038], [2038, 2048], [2048, 2064], [2064, 2099], [2099, 2148], [2148, 2164], [2164, 2191], [2191, 2222], [2222, 2226], [2226, 2247], [2247, 2265], [2265, 2291], [2291, 2303], [2303, 2332], [2332, 2364], [2364, 2372], [2372, 2399], [2399, 2420], [2420, 2450], [2450, 2454], [2454, 2473], [2473, 2498], [2498, 2535], [2535, 2554], [2554, 2564], [2564, 2571], [2571, 2600], [2600, 2614], [2614, 2635], [2635, 2647], [2647, 2660], [2660, 2682], [2682, 2696], [2696, 2706], [2706, 2710], [2710, 2727], [2727, 2751], [2751, 2772], [2772, 2797], [2797, 2883], [2883, 2887], [2887, 2897], [2897, 2901], [2901, 2911], [2911, 2915], [2915, 2925], [2925, 2939], [2939, 2943], [2943, 2953], [2953, 2957], [2957, 2964], [2964, 2976], [2976, 3039], [3039, 3071], [3071, 3075], [3075, 3082], [3082, 3107], [3107, 3145], [3145, 3165], [3165, 3189], [3189, 3219], [3219, 3250], [3250, 3269], [3269, 3283], [3283, 3290], [3290, 3326], [3326, 3330], [3330, 3347], [3347, 3368], [3368, 3372], [3372, 3389], [3389, 3416], [3416, 3436], [3436, 3467], [3467, 3491], [3491, 3503], [3503, 3536], [3536, 3563], [3563, 3574], [3574, 3593], [3593, 3615], [3615, 3640], [3640, 3655], [3655, 3676], [3676, 3731], [3731, 3764], [3764, 3773], [3773, 3808], [3808, 3842], [3842, 3878], [3878, 3898], [3898, 3903], [3903, 3923], [3923, 3945], [3945, 3962], [3962, 3975], [3975, 3986], [3986, 4030], [4030, 4044], [4044, 4048], [4048, 4052], [4052, 4054], [4054, 4057], [4057, 4060], [4060, 4064], [4064, 4068], [4068, 4072], [4072, 4073], [4073, 4085], [4085, 4136], [4136, 4144], [4144, 4149], [4149, 4170], [4170, 4200], [4200, 4240], [4240, 4258], [4258, 4264], [4264, 4291], [4291, 4319], [4319, 4354], [4354, 4417], [4417, 4449], [4449, 4463], [4463, 4495], [4495, 4518], [4518, 4529], [4529, 4559], [4559, 4564], [4564, 4609], [4609, 4626], [4626, 4638], [4638, 4648], [4648, 4666], [4666, 4707], [4707, 4720], [4720, 4729], [4729, 4775], [4775, 4800], [4800, 4828], [4828, 4832], [4832, 4876], [4876, 4906], [4906, 4940], [4940, 4953], [4953, 4962], [4962, 4984], [4984, 4989], [4989, 5012], [5012, 5032], [5032, 5061], [5061, 5085], [5085, 5105], [5105, 5145], [5145, 5155], [5155, 5178], [5178, 5186], [5186, 5202], [5202, 5228], [5228, 5238], [5238, 5251], [5251, 5281], [5281, 5290], [5290, 5311], [5311, 5347], [5347, 5373], [5373, 5399], [5399, 5423], [5423, 5467], [5467, 5494], [5494, 5532], [5532, 5561], [5561, 5564], [5564, 5572], [5572, 5588], [5588, 5601], [5601, 5630], [5630, 5650], [5650, 5662], [5662, 5677], [5677, 5682], [5682, 5683], [5683, 5696], [5696, 5725], [5725, 5750], [5750, 5754], [5754, 5766], [5766, 5819], [5819, 5845], [5845, 5877], [5877, 5887], [5887, 5890], [5890, 5902], [5902, 5935], [5935, 5952], [5952, 5966], [5966, 5988], [5988, 5995], [5995, 6014], [6014, 6043], [6043, 6066], [6066, 6083], [6083, 6104], [6104, 6136], [6136, 6154], [6154, 6201], [6201, 6213], [6213, 6230], [6230, 6246], [6246, 6277], [6277, 6293], [6293, 6307], [6307, 6312], [6312, 6335], [6335, 6347], [6347, 6349], [6349, 6357], [6357, 6374], [6374, 6449], [6449, 6460], [6460, 6463], [6463, 6465], [6465, 6471], [6471, 6495], [6495, 6510], [6510, 6572], [6572, 6583], [6583, 6597], [6597, 6600], [6600, 6608], [6608, 6626], [6626, 6647], [6647, 6708], [6708, 6711], [6711, 6722], [6722, 6736], [6736, 6739], [6739, 6747], [6747, 6765], [6765, 6771], [6771, 6853], [6853, 6867], [6867, 6881], [6881, 6889], [6889, 6900], [6900, 6944], [6944, 6946], [6946, 6954], [6954, 6975], [6975, 7036], [7036, 7050], [7050, 7067], [7067, 7075], [7075, 7093], [7093, 7116], [7116, 7181], [7181, 7184], [7184, 7209], [7209, 7212], [7212, 7220], [7220, 7238], [7238, 7244], [7244, 7259], [7259, 7329], [7329, 7354], [7354, 7357], [7357, 7365], [7365, 7383], [7383, 7406], [7406, 7478], [7478, 7503], [7503, 7506], [7506, 7514], [7514, 7557], [7557, 7558], [7558, 7566], [7566, 7574], [7574, 7579], [7579, 7603], [7603, 7610], [7610, 7611], [7611, 7636], [7636, 7641], [7641, 7656], [7656, 7680], [7680, 7721], [7721, 7732], [7732, 7758], [7758, 7784], [7784, 7803], [7803, 7808], [7808, 7839], [7839, 7870], [7870, 7891], [7891, 7907], [7907, 7931], [7931, 7958], [7958, 7990], [7990, 8010], [8010, 8035], [8035, 8054], [8054, 8081], [8081, 8114], [8114, 8134], [8134, 8148], [8148, 8161], [8161, 8165], [8165, 8199], [8199, 8237], [8237, 8274], [8274, 8291], [8291, 8322], [8322, 8347], [8347, 8369], [8369, 8377], [8377, 8394], [8394, 8432], [8432, 8476], [8476, 8506], [8506, 8510], [8510, 8526], [8526, 8541], [8541, 8571], [8571, 8589], [8589, 8615], [8615, 8660], [8660, 8709], [8709, 8760], [8760, 8764], [8764, 8766], [8766, 8768], [8768, 8804], [8804, 8816], [8816, 8825], [8825, 8838], [8838, 8856], [8856, 8862], [8862, 8880], [8880, 8900], [8900, 8930], [8930, 8945], [8945, 8978], [8978, 9052], [9052, 9142], [9142, 9145], [9145, 9152], [9152, 9167], [9167, 9189], [9189, 9207], [9207, 9265], [9265, 9286], [9286, 9345], [9345, 9371], [9371, 9374], [9374, 9419], [9419, 9439], [9439, 9465], [9465, 9505], [9505, 9518], [9518, 9539], [9539, 9559], [9559, 9574], [9574, 9592], [9592, 9620], [9620, 9654], [9654, 9666], [9666, 9714], [9714, 9765], [9765, 9768], [9768, 9801], [9801, 9804], [9804, 9809], [9809, 9823], [9823, 9843], [9843, 9863], [9863, 9875], [9875, 9879], [9879, 9901], [9901, 9951], [9951, 9954], [9954, 9957], [9957, 9978], [9978, 10004], [10004, 10032], [10032, 10036], [10036, 10054], [10054, 10056], [10056, 10060], [10060, 10066], [10066, 10095], [10095, 10119], [10119, 10138], [10138, 10159], [10159, 10183], [10183, 10212], [10212, 10227], [10227, 10257], [10257, 10272], [10272, 10337], [10337, 10348], [10348, 10373], [10373, 10398], [10398, 10415], [10415, 10431], [10431, 10454], [10454, 10480], [10480, 10486], [10486, 10507], [10507, 10557], [10557, 10576], [10576, 10606], [10606, 10665], [10665, 10688], [10688, 10710], [10710, 10738], [10738, 10751], [10751, 10773], [10773, 10799], [10799, 10817], [10817, 10822], [10822, 10851], [10851, 10867], [10867, 10901], [10901, 10920], [10920, 10936], [10936, 10971], [10971, 10990], [10990, 10997], [10997, 11024], [11024, 11039], [11039, 11095], [11095, 11140], [11140, 11160], [11160, 11214], [11214, 11215], [11215, 11223], [11223, 11231], [11231, 11247], [11247, 11254], [11254, 11255], [11255, 11266], [11266, 11267], [11267, 11273], [11273, 11296], [11296, 11299], [11299, 11305]], "words": ["document", ":", "Gated", "Graph", "Sequence", "Neural", "Networks", "Graph", "-", "structured", "data", "appears", "frequently", "in", "domains", "including", "chemistry", ",", "natural", "language", "semantics", ",", "social", "networks", ",", "and", "knowledge", "bases", ".", "In", "this", "work", ",", "we", "study", "feature", "learning", "techniques", "for", "graph", "-", "structured", "inputs", ".", "Our", "starting", "point", "is", "previous", "work", "on", "Graph", "Neural", "Networks", "scarselli2009graph", ",", "which", "we", "modify", "to", "use", "gated", "recurrent", "units", "and", "modern", "optimization", "techniques", "and", "then", "extend", "to", "output", "sequences", ".", "The", "result", "is", "a", "flexible", "and", "broadly", "useful", "class", "of", "neural", "network", "models", "that", "has", "favorable", "inductive", "biases", "relative", "to", "purely", "sequence", "-", "based", "models", "(", "e.g.", ",", "LSTMs", ")", "when", "the", "problem", "is", "graph", "-", "structured", ".", "We", "demonstrate", "the", "capabilities", "on", "some", "simple", "AI", "(", "bAbI", ")", "and", "graph", "algorithm", "learning", "tasks", ".", "We", "then", "show", "it", "achieves", "state", "-", "of", "-", "the", "-", "art", "performance", "on", "a", "problem", "from", "program", "verification", ",", "in", "which", "subgraphs", "need", "to", "be", "described", "as", "abstract", "data", "structures", ".", "Much", "data", "in", "the", "real", "world", "is", "naturally", "represented", "as", "a", "graph", ".", "For", "example", ",", "entities", "can", "be", "represented", "as", "nodes", ",", "with", "relations", "between", "them", "represented", "as", "edges", ".", "Graph", "-", "structured", "data", "comes", "up", "often", "in", "chemistry", ",", "social", "networks", ",", "knowledge", "bases", ",", "and", "web", "-", "based", "data", ",", "and", "in", "other", "domains", "like", "program", "verification", "which", "requires", "reasoning", "about", "abstract", "data", "structures", "represented", "as", "graphs", ".", "In", "this", "work", ",", "we", "study", "feature", "learning", "techniques", "for", "learning", "from", "graph", "-", "structured", "inputs", ".", "Our", "starting", "point", "is", "previous", "work", "on", "Graph", "Neural", "Networks", "(", "GNNs", ")", "scarselli2009graph", ".", "We", "begin", "by", "adapting", "the", "model", "and", "learning", "algorithm", "to", "make", "use", "of", "recent", "advances", "in", "recurrent", "neural", "networks", ",", "incorporating", "gated", "recurrent", "units", "and", "modern", "optimization", "routines", ".", "Our", "main", "contribution", "is", "then", "to", "extend", "GNNs", "to", "output", "sequences", ".", "We", "use", "bAbI", "tasks", "to", "illustrate", "the", "components", "of", "the", "model", "and", "explain", "what", "is", "being", "learned", "by", "the", "GNN", "models", ",", "and", "then", "we", "develop", "a", "full", "model", "that", "learns", "to", "predict", "loop", "invariants", "for", "a", "program", "verification", "task", ",", "where", "we", "map", "from", "graphs", "representing", "the", "state", "of", "memory", "during", "a", "program", "\u2019s", "execution", "to", "a", "logical", "description", "of", "the", "data", "structures", "that", "have", "been", "instantiated", ".", "We", "show", "that", "we", "are", "able", "to", "match", "the", "performance", "of", "a", "system", "that", "has", "been", "heavily", "hand", "-", "engineered", ",", "indicating", "the", "Gated", "Graph", "Sequence", "Neural", "Networks", "are", "promising", "models", "for", "feature", "learning", "on", "graphs", ".", "arrows", ",", "decorations.pathmorphing", ",", "backgrounds", ",", "fit", ",", "automata", ",", "shapes", ",", "calc", ",", "positioning", ",", "shadows", "heapgraph", "/", ".style=", "everynode", "/", ".style", "=", "rectangle", ",", "font=", ",", "tree", "/", ".appendstyle", "=", "draw", "=", "black", ",", "thick", ",", "minimumwidth=.4", "cm", ",", "fill", "=", "blue!20", ",", "list", "/", ".appendstyle", "=", "draw", "=", "black", ",", "thick", ",", "minimumwidth=.4", "cm", ",", "fill", "=", "green!20", ",", "prefixaftercommand=", "everylabel", "/", ".style", "=", "font=", ",", "innersep=2pt", ",", "active", "/", ".appendstyle", "=", "double", ",", "explained", "/", ".appendstyle", "=", "fill", "=", "white", ",", "colLabel", "/", ".appendstyle", "=", "font=", ",", "stepLabel", "/", ".appendstyle", "=", "textwidth=2", "cm", ",", "align", "=", "left", ",", "font=", ",", "outLabel", "/", ".appendstyle", "=", "font=", ",", "heapEdgeLabel", "/", ".appendstyle", "=", "font=", ",", "innersep=2pt", ",", ",", "section", ":", "Introduction", "Many", "practical", "applications", "build", "on", "graph", "-", "structured", "data", ",", "and", "thus", "we", "often", "want", "to", "perform", "machine", "learning", "tasks", "that", "take", "graphs", "as", "inputs", ".", "Standard", "approaches", "to", "the", "problem", "include", "engineering", "custom", "features", "of", "an", "input", "graph", ",", "graph", "kernels", "kashima2003marginalized", ",", "shervashidze2011weisfeiler", ",", "and", "methods", "that", "define", "graph", "features", "in", "terms", "of", "random", "walks", "on", "graphs", "perozzi2014deepwalk", ".", "More", "closely", "related", "to", "our", "goal", "in", "this", "work", "are", "methods", "that", "learn", "features", "on", "graphs", ",", "including", "Graph", "Neural", "Networks", "gori2005new", ",", "scarselli2009graph", ",", "spectral", "networks", "bruna2013spectral", "and", "recent", "work", "on", "learning", "graph", "fingerprints", "for", "classification", "tasks", "on", "graph", "representations", "of", "chemical", "molecules", "duvenaud2015convolutional", ".", "Our", "main", "contribution", "is", "an", "extension", "of", "Graph", "Neural", "Networks", "that", "outputs", "sequences", ".", "Previous", "work", "on", "feature", "learning", "for", "graph", "-", "structured", "inputs", "has", "focused", "on", "models", "that", "produce", "single", "outputs", "such", "as", "graph", "-", "level", "classifications", ",", "but", "many", "problems", "with", "graph", "inputs", "require", "outputting", "sequences", ".", "Examples", "include", "paths", "on", "a", "graph", ",", "enumerations", "of", "graph", "nodes", "with", "desirable", "properties", ",", "or", "sequences", "of", "global", "classifications", "mixed", "with", ",", "for", "example", ",", "a", "start", "and", "end", "node", ".", "We", "are", "not", "aware", "of", "existing", "graph", "feature", "learning", "work", "suitable", "for", "this", "problem", ".", "Our", "motivating", "application", "comes", "from", "program", "verification", "and", "requires", "outputting", "logical", "formulas", ",", "which", "we", "formulate", "as", "a", "sequential", "output", "problem", ".", "A", "secondary", "contribution", "is", "highlighting", "that", "Graph", "Neural", "Networks", "(", "and", "further", "extensions", "we", "develop", "here", ")", "are", "a", "broadly", "useful", "class", "of", "neural", "network", "model", "that", "is", "applicable", "to", "many", "problems", "currently", "facing", "the", "field", ".", "There", "are", "two", "settings", "for", "feature", "learning", "on", "graphs", ":", "(", "1", ")", "learning", "a", "representation", "of", "the", "input", "graph", ",", "and", "(", "2", ")", "learning", "representations", "of", "the", "internal", "state", "during", "the", "process", "of", "producing", "a", "sequence", "of", "outputs", ".", "Here", ",", "(", "1", ")", "is", "mostly", "achieved", "by", "previous", "work", "on", "Graph", "Neural", "Networks", "scarselli2009graph", ";", "we", "make", "several", "minor", "adaptations", "of", "this", "framework", ",", "including", "changing", "it", "to", "use", "modern", "practices", "around", "Recurrent", "Neural", "Networks", ".", "(", "2", ")", "is", "important", "because", "we", "desire", "outputs", "from", "graph", "-", "structured", "problems", "that", "are", "not", "solely", "individual", "classifications", ".", "In", "these", "cases", ",", "the", "challenge", "is", "how", "to", "learn", "features", "on", "the", "graph", "that", "encode", "the", "partial", "output", "sequence", "that", "has", "already", "been", "produced", "(", "e.g.", ",", "the", "path", "so", "far", "if", "outputting", "a", "path", ")", "and", "that", "still", "needs", "to", "be", "produced", "(", "e.g.", ",", "the", "remaining", "path", ")", ".", "We", "will", "show", "how", "the", "GNN", "framework", "can", "be", "adapted", "to", "these", "settings", ",", "leading", "to", "a", "novel", "graph", "-", "based", "neural", "network", "model", "that", "we", "call", "Gated", "Graph", "Sequence", "Neural", "Networks", "(", "GGS", "-", "NNs", ")", ".", "We", "illustrate", "aspects", "of", "this", "general", "model", "in", "experiments", "on", "bAbI", "tasks", "weston2015towards", "and", "graph", "algorithm", "learning", "tasks", "that", "illustrate", "the", "capabilities", "of", "the", "model", ".", "We", "then", "present", "an", "application", "to", "the", "verification", "of", "computer", "programs", ".", "When", "attempting", "to", "prove", "properties", "such", "as", "memory", "safety", "(", "i.e.", ",", "that", "there", "are", "no", "null", "pointer", "dereferences", "in", "a", "program", ")", ",", "a", "core", "problem", "is", "to", "find", "mathematical", "descriptions", "of", "the", "data", "structures", "used", "in", "a", "program", ".", "Following", ",", "we", "have", "phrased", "this", "as", "a", "machine", "learning", "problem", "where", "we", "will", "learn", "to", "map", "from", "a", "set", "of", "input", "graphs", ",", "representing", "the", "state", "of", "memory", ",", "to", "a", "logical", "description", "of", "the", "data", "structures", "that", "have", "been", "instantiated", ".", "Whereas", "relied", "on", "a", "large", "amount", "of", "hand", "-", "engineering", "of", "features", ",", "we", "show", "that", "the", "system", "can", "be", "replaced", "with", "a", "GGS", "-", "NN", "at", "no", "cost", "in", "accuracy", ".", "section", ":", "Graph", "Neural", "Networks", "In", "this", "section", ",", "we", "review", "Graph", "Neural", "Networks", "(", "GNNs", ")", "gori2005new", ",", "scarselli2009graph", "and", "introduce", "notation", "and", "concepts", "that", "will", "be", "used", "throughout", ".", "GNNs", "are", "a", "general", "neural", "network", "architecture", "defined", "according", "to", "a", "graph", "structure", ".", "Nodes", "take", "unique", "values", "from", ",", "and", "edges", "are", "pairs", ".", "We", "will", "focus", "in", "this", "work", "on", "directed", "graphs", ",", "so", "represents", "a", "directed", "edge", ",", "but", "we", "note", "that", "the", "framework", "can", "easily", "be", "adapted", "to", "undirected", "graphs", ";", "see", ".", "The", "node", "vector", "(", "or", "node", "representation", "or", "node", "embedding", ")", "for", "node", "is", "denoted", "by", ".", "Graphs", "may", "also", "contain", "node", "labels", "for", "each", "node", "and", "edge", "labels", "or", "edge", "types", "for", "each", "edge", ".", "We", "will", "overload", "notation", "and", "let", "when", "is", "a", "set", "of", "nodes", ",", "and", "when", "is", "a", "set", "of", "edges", ".", "The", "function", "returns", "the", "set", "of", "predecessor", "nodes", "with", ".", "Analogously", ",", "is", "the", "set", "of", "successor", "nodes", "with", "edges", ".", "The", "set", "of", "all", "nodes", "neighboring", "is", ",", "and", "the", "set", "of", "all", "edges", "incoming", "to", "or", "outgoing", "from", "is", ".", "GNNs", "map", "graphs", "to", "outputs", "via", "two", "steps", ".", "First", ",", "there", "is", "a", "propagation", "step", "that", "computes", "node", "representations", "for", "each", "node", ";", "second", ",", "an", "output", "model", "maps", "from", "node", "representations", "and", "corresponding", "labels", "to", "an", "output", "for", "each", ".", "In", "the", "notation", "for", ",", "we", "leave", "the", "dependence", "on", "parameters", "implicit", ",", "and", "we", "will", "continue", "to", "do", "this", "throughout", ".", "The", "system", "is", "differentiable", "from", "end", "-", "to", "-", "end", ",", "so", "all", "parameters", "are", "learned", "jointly", "using", "gradient", "-", "based", "optimization", ".", "subsection", ":", "Propagation", "Model", "Here", ",", "an", "iterative", "procedure", "propagates", "node", "representations", ".", "Initial", "node", "representations", "are", "set", "to", "arbitrary", "values", ",", "then", "each", "node", "representation", "is", "updated", "following", "the", "recurrence", "below", "until", "convergence", ",", "where", "denotes", "the", "timestep", ":", "Several", "variants", "are", "discussed", "in", "including", "positional", "graph", "forms", ",", "node", "-", "specific", "updates", ",", "and", "alternative", "representations", "of", "neighborhoods", ".", "Concretely", ",", "suggest", "decomposing", "to", "be", "a", "sum", "of", "per", "-", "edge", "terms", ":", "where", "is", "either", "a", "linear", "function", "of", "or", "a", "neural", "network", ".", "The", "parameters", "of", "depends", "on", "the", "configuration", "of", "labels", ",", "e.g.", "in", "the", "following", "linear", "case", ",", "and", "are", "learnable", "parameters", ",", "subsection", ":", "Output", "Model", "and", "Learning", "The", "output", "model", "is", "defined", "per", "node", "and", "is", "a", "differentiable", "function", "that", "maps", "to", "an", "output", ".", "This", "is", "generally", "a", "linear", "or", "neural", "network", "mapping", ".", "focus", "on", "outputs", "that", "are", "independent", "per", "node", ",", "which", "are", "implemented", "by", "mapping", "the", "final", "node", "representations", ",", "to", "an", "output", "for", "each", "node", ".", "To", "handle", "graph", "-", "level", "classifications", ",", "they", "suggest", "to", "create", "a", "dummy", "\u201c", "super", "node", "\u201d", "that", "is", "connected", "to", "all", "other", "nodes", "by", "a", "special", "type", "of", "edge", ".", "Thus", ",", "graph", "-", "level", "regression", "or", "classification", "can", "be", "handled", "in", "the", "same", "manner", "as", "node", "-", "level", "regression", "or", "classification", ".", "Learning", "is", "done", "via", "the", "Almeida", "-", "Pineda", "algorithm", "almeida1990learning", ",", "pineda1987generalization", ",", "which", "works", "by", "running", "the", "propagation", "to", "convergence", ",", "and", "then", "computing", "gradients", "based", "upon", "the", "converged", "solution", ".", "This", "has", "the", "advantage", "of", "not", "needing", "to", "store", "intermediate", "states", "in", "order", "to", "compute", "gradients", ".", "The", "disadvantage", "is", "that", "parameters", "must", "be", "constrained", "so", "that", "the", "propagation", "step", "is", "a", "contraction", "map", ".", "This", "is", "needed", "to", "ensure", "convergence", ",", "but", "it", "may", "limit", "the", "expressivity", "of", "the", "model", ".", "When", "is", "a", "neural", "network", ",", "this", "is", "encouraged", "using", "a", "penalty", "term", "on", "the", "1", "-", "norm", "of", "the", "network", "\u2019s", "Jacobian", ".", "See", "Appendix", "[", "reference", "]", "for", "an", "example", "that", "gives", "the", "intuition", "that", "contraction", "maps", "have", "trouble", "propagating", "information", "across", "a", "long", "range", "in", "a", "graph", ".", "section", ":", "Gated", "Graph", "Neural", "Networks", "We", "now", "describe", "Gated", "Graph", "Neural", "Networks", "(", "GG", "-", "NNs", ")", ",", "our", "adaptation", "of", "GNNs", "that", "is", "suitable", "for", "non", "-", "sequential", "outputs", ".", "We", "will", "describe", "sequential", "outputs", "in", "the", "next", "section", ".", "The", "biggest", "modification", "of", "GNNs", "is", "that", "we", "use", "Gated", "Recurrent", "Units", "cho2014learning", "and", "unroll", "the", "recurrence", "for", "a", "fixed", "number", "of", "steps", "and", "use", "backpropagation", "through", "time", "in", "order", "to", "compute", "gradients", ".", "This", "requires", "more", "memory", "than", "the", "Almeida", "-", "Pineda", "algorithm", ",", "but", "it", "removes", "the", "need", "to", "constrain", "parameters", "to", "ensure", "convergence", ".", "We", "also", "extend", "the", "underlying", "representations", "and", "output", "model", ".", "subsection", ":", "Node", "Annotations", "In", "GNNs", ",", "there", "is", "no", "point", "in", "initializing", "node", "representations", "because", "the", "contraction", "map", "constraint", "ensures", "that", "the", "fixed", "point", "is", "independent", "of", "the", "initializations", ".", "This", "is", "no", "longer", "the", "case", "with", "GG", "-", "NNs", ",", "which", "lets", "us", "incorporate", "node", "labels", "as", "additional", "inputs", ".", "To", "distinguish", "these", "node", "labels", "used", "as", "inputs", "from", "the", "ones", "introduced", "before", ",", "we", "call", "them", "node", "annotations", ",", "and", "use", "vector", "to", "denote", "these", "annotations", ".", "To", "illustrate", "how", "the", "node", "annotations", "are", "used", ",", "consider", "an", "example", "task", "of", "training", "a", "graph", "neural", "network", "to", "predict", "whether", "node", "can", "be", "reached", "from", "node", "on", "a", "given", "graph", ".", "For", "this", "task", ",", "there", "are", "two", "problem", "-", "related", "special", "nodes", ",", "and", ".", "To", "mark", "these", "nodes", "as", "special", ",", "we", "give", "them", "an", "initial", "annotation", ".", "The", "first", "node", "gets", "the", "annotation", ",", "and", "the", "second", "node", "gets", "the", "annotation", ".", "All", "other", "nodes", "have", "their", "initial", "annotation", "set", "to", ".", "Intuitively", ",", "this", "marks", "as", "the", "first", "input", "argument", "and", "as", "the", "second", "input", "argument", ".", "We", "then", "initialize", "the", "node", "state", "vectors", "using", "these", "label", "vectors", "by", "copying", "into", "the", "first", "dimensions", "and", "padding", "with", "extra", "0", "\u2019s", "to", "allow", "hidden", "states", "that", "are", "larger", "than", "the", "annotation", "size", ".", "In", "the", "reachability", "example", ",", "it", "is", "easy", "for", "the", "propagation", "model", "to", "learn", "to", "propagate", "the", "node", "annotation", "for", "to", "all", "nodes", "reachable", "from", ",", "for", "example", "by", "setting", "the", "propagation", "matrix", "associated", "with", "forward", "edges", "to", "have", "a", "1", "in", "position", "(", "0", ",", "0", ")", ".", "This", "will", "cause", "the", "first", "dimension", "of", "node", "representation", "to", "be", "copied", "along", "forward", "edges", ".", "With", "this", "setting", "of", "parameters", ",", "the", "propagation", "step", "will", "cause", "all", "nodes", "reachable", "from", "to", "have", "their", "first", "bit", "of", "node", "representation", "set", "to", "1", ".", "The", "output", "step", "classifier", "can", "then", "easily", "tell", "whether", "node", "is", "reachable", "from", "by", "looking", "whether", "some", "node", "has", "nonzero", "entries", "in", "the", "first", "two", "dimensions", "of", "its", "representation", "vector", ".", "subsection", ":", "Propagation", "Model", "The", "basic", "recurrence", "of", "the", "propagation", "model", "is", "The", "matrix", "determines", "how", "nodes", "in", "the", "graph", "communicate", "with", "each", "other", ".", "The", "sparsity", "structure", "and", "parameter", "tying", "in", "is", "illustrated", "in", "fig", ":", "graphs", "-", "and", "-", "sparsity", ".", "The", "sparsity", "structure", "corresponds", "to", "the", "edges", "of", "the", "graph", ",", "and", "the", "parameters", "in", "each", "submatrix", "are", "determined", "by", "the", "edge", "type", "and", "direction", ".", "are", "the", "two", "columns", "of", "blocks", "in", "and", "corresponding", "to", "node", ".", "(", "[", "reference", "]", ")", "is", "the", "initialization", "step", ",", "which", "copies", "node", "annotations", "into", "the", "first", "components", "of", "the", "hidden", "state", "and", "pads", "the", "rest", "with", "zeros", ".", "(", "[", "reference", "]", ")", "is", "the", "step", "that", "passes", "information", "between", "different", "nodes", "of", "the", "graph", "via", "incoming", "and", "outgoing", "edges", "with", "parameters", "dependent", "on", "the", "edge", "type", "and", "direction", ".", "contains", "activations", "from", "edges", "in", "both", "directions", ".", "The", "remaining", "are", "GRU", "-", "like", "updates", "that", "incorporate", "information", "from", "the", "other", "nodes", "and", "from", "the", "previous", "timestep", "to", "update", "each", "node", "\u2019s", "hidden", "state", ".", "and", "are", "the", "update", "and", "reset", "gates", ",", "is", "the", "logistic", "sigmoid", "function", ",", "and", "is", "element", "-", "wise", "multiplication", ".", "We", "initially", "experimented", "with", "a", "vanilla", "recurrent", "neural", "network", "-", "style", "update", ",", "but", "in", "preliminary", "experiments", "we", "found", "this", "GRU", "-", "like", "propagation", "step", "to", "be", "more", "effective", ".", "subsection", ":", "Output", "Models", "There", "are", "several", "types", "of", "one", "-", "step", "outputs", "that", "we", "would", "like", "to", "produce", "in", "different", "situations", ".", "First", ",", "GG", "-", "NNs", "support", "node", "selection", "tasks", "by", "making", "for", "each", "node", "output", "node", "scores", "and", "applying", "a", "softmax", "over", "node", "scores", ".", "Second", ",", "for", "graph", "-", "level", "outputs", ",", "we", "define", "a", "graph", "level", "representation", "vector", "as", "where", "acts", "as", "a", "soft", "attention", "mechanism", "that", "decides", "which", "nodes", "are", "relevant", "to", "the", "current", "graph", "-", "level", "task", ".", "and", "are", "neural", "networks", "that", "take", "the", "concatenation", "of", "and", "as", "input", "and", "outputs", "real", "-", "valued", "vectors", ".", "The", "functions", "can", "also", "be", "replaced", "with", "the", "identity", ".", "section", ":", "Gated", "Graph", "Sequence", "Neural", "Networks", "Here", "we", "describe", "Gated", "Graph", "Sequence", "Neural", "Networks", "(", "GGS", "-", "NNs", ")", ",", "in", "which", "several", "GG", "-", "NNs", "operate", "in", "sequence", "to", "produce", "an", "output", "sequence", ".", "For", "the", "output", "step", ",", "we", "denote", "the", "matrix", "of", "node", "annotations", "as", ".", "We", "use", "two", "GG", "-", "NNs", "k", "and", "k", ":", "k", "for", "predicting", "from", ",", "and", "k", "for", "predicting", "from", ".", "can", "be", "seen", "as", "the", "states", "carried", "over", "from", "step", "to", ".", "Both", "k", "and", "k", "contain", "a", "propagation", "model", "and", "an", "output", "model", ".", "In", "the", "propagation", "models", ",", "we", "denote", "the", "matrix", "of", "node", "vectors", "at", "the", "propagation", "step", "of", "the", "output", "step", "as", ".", "As", "before", ",", "in", "step", ",", "we", "set", "by", "-", "extending", "per", "node", ".", "An", "overview", "of", "the", "model", "is", "shown", "in", "fig", ":", "seq", "-", "architecture2", ".", "Alternatively", ",", "and", "can", "share", "a", "single", "propagation", "model", ",", "and", "just", "have", "separate", "output", "models", ".", "This", "simpler", "variant", "is", "faster", "to", "train", "and", "evaluate", ",", "and", "in", "many", "cases", "can", "achieve", "similar", "performance", "level", "as", "the", "full", "model", ".", "But", "in", "cases", "where", "the", "desired", "propagation", "behavior", "for", "and", "are", "different", ",", "this", "variant", "may", "not", "work", "as", "well", ".", "[", "hstate", "/", ".style", "=", "draw", ",", "rectangle", ",", "rounded", "corners", ",", "inner", "sep=2pt", ",", "font=", ",", "updateLabel", "/", ".style", "=", "sloped", ",", "font=", "]", "[", "hstate", "]", "(", "L1", ")", "at", "(", "0", ",", "0", ")", ";", "[", "hstate", "]", "(", "H11", ")", "at", "(", ")", ";", "[", "hstate", "]", "(", "O1", ")", "at", "(", ")", ";", "[", "hstate", "]", "(", "L2", ")", "at", "(", ")", ";", "[", "hstate", "]", "(", "H21", ")", "at", "(", ")", ";", "[", "hstate", "]", "(", "O2", ")", "at", "(", ")", ";", "[", "hstate", "]", "(", "L3", ")", "at", "(", ")", ";", "[", "]", "(", "cnt", ")", "at", "(", ")", ";", "above", ",", "updateLabel", "]", "Init", "(", "H11", ")", "(", "H11", ")", "edge", "node", "[", "above", ",", "updateLabel", "]", "1", "(", "O1", ")", "(", "H11", ")", "edge", "node", "[", "above", ",", "updateLabel", "]", "1", "(", "L2", ")", "(", "L2", ")", "edge", "node", "[", "above", ",", "updateLabel", "]", "Init", "(", "H21", ")", "(", "H21", ")", "edge", "node", "[", "above", ",", "updateLabel", "]", "2", "(", "O2", ")", "(", "H21", ")", "edge", "node", "[", "above", ",", "updateLabel", "]", "2", "(", "L3", ")", "(", "L3", ")", "edge", "(", "cnt", ")", ";", "We", "introduce", "a", "node", "annotation", "output", "model", "for", "predicting", "from", ".", "The", "prediction", "is", "done", "for", "each", "node", "independently", "using", "a", "neural", "network", "that", "takes", "the", "concatenation", "of", "and", "as", "input", "and", "outputs", "a", "vector", "of", "real", "-", "valued", "scores", ":", "There", "are", "two", "settings", "for", "training", "GGS", "-", "NNs", ":", "specifying", "all", "intermediate", "annotations", ",", "or", "training", "the", "full", "model", "end", "-", "to", "-", "end", "given", "only", ",", "graphs", "and", "target", "sequences", ".", "The", "former", "can", "improve", "performance", "when", "we", "have", "domain", "knowledge", "about", "specific", "intermediate", "information", "that", "should", "be", "represented", "in", "the", "internal", "state", "of", "nodes", ",", "while", "the", "latter", "is", "more", "general", ".", "We", "describe", "both", ".", "paragraph", ":", "Sequence", "outputs", "with", "observed", "annotations", "Consider", "the", "task", "of", "making", "a", "sequence", "of", "predictions", "for", "a", "graph", ",", "where", "each", "prediction", "is", "only", "about", "a", "part", "of", "the", "graph", ".", "In", "order", "to", "ensure", "we", "predict", "an", "output", "for", "each", "part", "of", "the", "graph", "exactly", "once", ",", "it", "suffices", "to", "have", "one", "bit", "per", "node", ",", "indicating", "whether", "the", "node", "has", "been", "\u201c", "explained", "\u201d", "so", "far", ".", "In", "some", "settings", ",", "a", "small", "number", "of", "annotations", "are", "sufficient", "to", "capture", "the", "state", "of", "the", "output", "procedure", ".", "When", "this", "is", "the", "case", ",", "we", "may", "want", "to", "directly", "input", "this", "information", "into", "the", "model", "via", "labels", "indicating", "target", "intermediate", "annotations", ".", "In", "some", "cases", ",", "these", "annotations", "may", "be", "sufficient", ",", "in", "that", "we", "can", "define", "a", "model", "where", "the", "GG", "-", "NNs", "are", "rendered", "conditionally", "independent", "given", "the", "annotations", ".", "In", "this", "case", ",", "at", "training", "time", ",", "given", "the", "annotations", "the", "sequence", "prediction", "task", "decomposes", "into", "single", "step", "prediction", "tasks", "and", "can", "be", "trained", "as", "separate", "GG", "-", "NNs", ".", "At", "test", "time", ",", "predicted", "annotations", "from", "one", "step", "will", "be", "used", "as", "input", "to", "the", "next", "step", ".", "This", "is", "analogous", "to", "training", "directed", "graphical", "models", "when", "data", "is", "fully", "observed", ".", "paragraph", ":", "Sequence", "outputs", "with", "latent", "annotations", "More", "generally", ",", "when", "intermediate", "node", "annotations", "are", "not", "available", "during", "training", ",", "we", "treat", "them", "as", "hidden", "units", "in", "the", "network", ",", "and", "train", "the", "whole", "model", "jointly", "by", "backpropagating", "through", "the", "whole", "sequence", ".", "section", ":", "Explanatory", "Applications", "In", "this", "section", "we", "present", "example", "applications", "that", "concretely", "illustrate", "the", "use", "of", "GGS", "-", "NNs", ".", "We", "focus", "on", "a", "selection", "of", "bAbI", "artificial", "intelligence", "(", "AI", ")", "tasks", "weston2015towards", "and", "two", "graph", "algorithm", "learning", "tasks", ".", "subsection", ":", "bAbI", "Tasks", "The", "bAbI", "tasks", "are", "meant", "to", "test", "reasoning", "capabilities", "that", "AI", "systems", "should", "be", "capable", "of", ".", "In", "the", "bAbI", "suite", ",", "there", "are", "20", "tasks", "that", "test", "basic", "forms", "of", "reasoning", "like", "deduction", ",", "induction", ",", "counting", ",", "and", "path", "-", "finding", ".", "We", "have", "defined", "a", "basic", "transformation", "procedure", "that", "maps", "bAbI", "tasks", "to", "GG", "-", "NNs", "or", "GGS", "-", "NNs", ".", "We", "use", "the", "--", "symbolic", "option", "from", "the", "released", "bAbI", "code", "to", "get", "stories", "that", "just", "involve", "sequences", "of", "relations", "between", "entities", ",", "which", "are", "then", "converted", "into", "a", "graph", ".", "Each", "entity", "is", "mapped", "to", "a", "node", ",", "and", "each", "relation", "is", "mapped", "to", "an", "edge", "with", "edge", "label", "given", "by", "the", "relation", ".", "The", "full", "story", "is", "consumed", "and", "mapped", "to", "a", "single", "graph", ".", "Questions", "are", "marked", "by", "eval", "in", "the", "data", "and", "are", "comprised", "of", "a", "question", "type", "(", "e.g.", ",", "has_fear", ")", ",", "and", "some", "argument", "(", "e.g.", ",", "one", "or", "more", "nodes", ")", ".", "The", "arguments", "are", "converted", "into", "initial", "node", "annotations", ",", "with", "the", "-", "th", "bit", "of", "the", "-", "th", "argument", "node", "\u2019s", "annotation", "vector", "set", "to", "1", ".", "For", "example", ",", "if", "the", "eval", "line", "is", "eval", "E", ">", "A", "true", ",", "then", "E", "gets", "initial", "annotation", ",", "A", "gets", ",", "and", "for", "all", "other", "nodes", ",", ".", "Question", "type", "is", "1", "(", "for", "\u2018", ">", "\u2019", ")", "and", "output", "is", "class", "1", "(", "for", "\u2018", "true", "\u2019", ")", ".", "Some", "tasks", "have", "multiple", "question", "types", ",", "for", "example", "Task", "4", "which", "has", "4", "question", "types", ":", "e", ",", "s", ",", "w", ",", "n", ".", "For", "such", "tasks", "we", "simply", "train", "a", "separate", "GG", "-", "NN", "for", "each", "task", ".", "We", "do", "not", "use", "the", "strong", "supervision", "labels", "or", "give", "the", "GGS", "-", "NNs", "any", "intermediate", "annotations", "in", "any", "experiments", ".", "While", "simple", ",", "this", "transformation", "does", "not", "preserve", "all", "information", "about", "the", "story", "(", "e.g.", ",", "it", "discards", "temporal", "order", "of", "the", "inputs", ")", ",", "and", "it", "does", "not", "easily", "handle", "ternary", "and", "higher", "order", "relations", "(", "e.g.", ",", "Yesterday", "John", "went", "to", "the", "garden", "is", "not", "easily", "mapped", "to", "a", "simple", "edge", ")", ".", "We", "also", "emphasize", "that", "it", "is", "a", "non", "-", "trivial", "task", "to", "map", "general", "natural", "language", "to", "symbolic", "form", ",", "so", "we", "could", "not", "directly", "apply", "this", "approach", "to", "arbitrary", "natural", "language", ".", "Relaxing", "these", "restrictions", "is", "left", "for", "future", "work", ".", "However", ",", "even", "with", "this", "simple", "transformation", ",", "there", "are", "a", "variety", "of", "bAbI", "tasks", "that", "can", "be", "formulated", ",", "including", "Task", "19", "(", "Path", "Finding", ")", ",", "which", "is", "arguably", "the", "hardest", "task", ".", "We", "provide", "baselines", "to", "show", "that", "the", "symbolic", "representation", "does", "not", "help", "RNNs", "or", "LSTMs", "significantly", ",", "and", "show", "that", "GGS", "-", "NNs", "solve", "the", "problem", "with", "a", "small", "number", "of", "training", "instances", ".", "We", "also", "develop", "two", "new", "bAbI", "-", "like", "tasks", "that", "involve", "outputting", "sequences", "on", "graphs", ":", "shortest", "paths", ",", "and", "a", "simple", "form", "of", "Eulerian", "circuits", "(", "on", "random", "connected", "2", "-", "regular", "graphs", ")", ".", "The", "point", "of", "these", "experiments", "is", "to", "illustrate", "the", "capabilities", "of", "GGS", "-", "NNs", "across", "a", "variety", "of", "problems", ".", "paragraph", ":", "Example", "1", ".", "As", "an", "example", ",", "below", "is", "an", "instance", "from", "the", "symbolic", "dataset", "for", "bAbI", "task", "15", ",", "Basic", "Deduction", ".", "Here", "the", "first", "8", "lines", "describe", "the", "facts", ",", "the", "GG", "-", "NN", "will", "use", "these", "facts", "to", "build", "a", "graph", ".", "Capital", "letters", "are", "nodes", ",", "is", "and", "has_fear", "are", "interpreted", "as", "edge", "labels", "or", "edge", "types", ".", "The", "last", "4", "lines", "are", "4", "questions", "asked", "for", "this", "input", "data", ".", "has_fear", "in", "these", "lines", "are", "interpreted", "as", "a", "question", "type", ".", "For", "this", "task", ",", "in", "each", "question", "only", "one", "node", "is", "special", ",", "e.g.", "the", "B", "in", "eval", "B", "has_fear", ",", "and", "we", "assign", "a", "single", "value", "1", "to", "the", "annotation", "vector", "for", "this", "special", "node", "and", "0", "to", "all", "the", "other", "nodes", ".", "For", "RNN", "and", "LSTM", "the", "data", "is", "converted", "into", "token", "sequences", "like", "below", ":", "n6", "e1", "n1", "eol", "n6", "e1", "n5", "eol", "n1", "e1", "n2", "eol", "n4", "e1", "n5", "eol", "n3", "e1", "n4", "eol", "n3", "e1", "n5", "eol", "n6", "e1", "n4", "eol", "q1", "n6", "n2", "ans", "1", "where", "n", "<", "i", "d", ">", "are", "nodes", ",", "e", "<", "i", "d", ">", "are", "edges", ",", "q", "<", "i", "d", ">", "are", "question", "types", ",", "extra", "tokens", "eol", "(", "end", "-", "of", "-", "line", ")", "and", "ans", "(", "answer", ")", "are", "added", "to", "give", "the", "RNN", "&", "LSTM", "access", "to", "the", "complete", "information", "available", "in", "the", "dataset", ".", "The", "final", "number", "is", "the", "class", "label", ".", "paragraph", ":", "Example", "2", ".", "As", "a", "second", "example", ",", "below", "is", "an", "instance", "from", "the", "symbolic", "dataset", "for", "bAbI", "task", "19", ",", "Path", "Finding", ".", "Here", "the", "first", "4", "lines", "describe", "edges", ",", "s", ",", "n", ",", "w", ",", "e", "(", "e", "does", "not", "appear", "in", "this", "example", ")", "are", "all", "different", "edge", "types", ".", "The", "last", "line", "is", "a", "path", "question", ",", "the", "answer", "is", "a", "sequence", "of", "directions", "w", ",", "s", ",", "as", "the", "path", "going", "from", "B", "to", "A", "is", "to", "first", "go", "west", "to", "E", "then", "go", "south", "to", "A", ".", "The", "s", ",", "n", ",", "w", ",", "e", "in", "the", "question", "lines", "are", "treated", "as", "output", "classes", ".", "paragraph", ":", "More", "Training", "Details", ".", "For", "all", "tasks", "in", "this", "section", ",", "we", "generate", "1000", "training", "examples", "and", "1000", "test", "examples", ",", "50", "of", "the", "training", "examples", "are", "used", "for", "validation", ".", "When", "evaluating", "model", "performance", ",", "for", "all", "bAbI", "tasks", "that", "contain", "more", "than", "one", "questions", "in", "one", "example", ",", "the", "predictions", "for", "different", "questions", "were", "evaluated", "independently", ".", "As", "there", "is", "randomness", "in", "the", "dataset", "generation", "process", ",", "we", "generated", "10", "such", "datasets", "for", "each", "task", ",", "and", "report", "the", "mean", "and", "standard", "deviation", "of", "the", "evaluation", "performance", "across", "the", "10", "datasets", ".", "For", "all", "explanatory", "tasks", ",", "we", "start", "by", "training", "different", "models", "on", "only", "50", "training", "examples", ",", "and", "gradually", "increase", "the", "number", "of", "training", "examples", "to", "100", ",", "250", ",", "500", ",", "and", "950", "(", "50", "of", "the", "training", "examples", "are", "reserved", "for", "validation", ")", "until", "the", "model", "\u2019s", "test", "accuracy", "reaches", "95", "%", "or", "above", ",", "a", "success", "by", "bAbI", "standard", ".", "For", "each", "method", ",", "we", "report", "the", "minimum", "number", "of", "training", "examples", "it", "needs", "to", "reach", "95", "%", "accuracy", "along", "with", "the", "accuracy", "it", "reaches", "with", "that", "amount", "of", "training", "examples", ".", "In", "all", "these", "cases", ",", "we", "unrolled", "the", "propagation", "process", "for", "5", "steps", ".", "For", "bAbI", "task", "4", ",", "15", ",", "16", ",", "18", ",", "19", ",", "we", "used", "GG", "-", "NN", "with", "the", "size", "of", "node", "vectors", "set", "to", ",", ",", ",", "and", "respectively", ".", "For", "all", "the", "GGS", "-", "NNs", "in", "this", "section", "we", "used", "the", "simpler", "variant", "in", "which", "and", "share", "a", "single", "propagation", "model", ".", "For", "shortest", "path", "and", "Eulerian", "circuit", "tasks", ",", "we", "used", ".", "All", "models", "are", "trained", "long", "enough", "with", "Adam", "kingma2014adam", ",", "and", "the", "validation", "set", "is", "used", "to", "choose", "the", "best", "model", "to", "evaluate", "and", "avoid", "models", "that", "are", "overfitting", ".", "subsubsection", ":", "Single", "Step", "Outputs", "We", "choose", "four", "bAbI", "tasks", "that", "are", "suited", "to", "the", "restrictions", "described", "above", "and", "require", "single", "step", "outputs", ":", "4", "(", "Two", "Argument", "Relations", ")", ",", "15", "(", "Basic", "Deduction", ")", ",", "16", "(", "Basic", "Induction", ")", ",", "and", "18", "(", "Size", "Reasoning", ")", ".", "For", "Task", "4", ",", "15", "and", "16", ",", "a", "node", "selection", "GG", "-", "NN", "is", "used", ".", "For", "Task", "18", "we", "used", "a", "graph", "-", "level", "classification", "version", ".", "All", "the", "GGNN", "networks", "contain", "less", "than", "600", "parameters", ".", "As", "baselines", ",", "we", "train", "RNN", "and", "LSTM", "models", "on", "the", "symbolic", "data", "in", "raw", "sequence", "form", ".", "The", "RNNs", "and", "LSTMs", "use", "50", "dimensional", "embeddings", "and", "50", "dimensional", "hidden", "layers", ";", "they", "predict", "a", "single", "output", "at", "the", "end", "of", "the", "sequences", "and", "the", "output", "is", "treated", "as", "a", "classification", "problem", ",", "the", "loss", "is", "cross", "entropy", ".", "The", "RNNs", "and", "LSTMs", "contain", "around", "5k", "and", "30k", "parameters", ",", "respectively", ".", "Test", "results", "appear", "in", "Table", "[", "reference", "]", ".", "For", "all", "tasks", "GG", "-", "NN", "achieves", "perfect", "test", "accuracy", "using", "only", "50", "training", "examples", ",", "while", "the", "RNN", "/", "LSTM", "baselines", "either", "use", "more", "training", "examples", "(", "Task", "4", ")", "or", "fail", "to", "solve", "the", "tasks", "(", "Task", "15", ",", "16", "and", "18", ")", ".", "In", "Table", "[", "reference", "]", ",", "we", "further", "break", "down", "performance", "of", "the", "baselines", "for", "task", "4", "as", "the", "amount", "of", "training", "data", "varies", ".", "While", "both", "the", "RNN", "and", "LSTM", "are", "able", "to", "solve", "the", "task", "almost", "perfectly", ",", "the", "GG", "-", "NN", "reaches", "100", "%", "accuracy", "with", "much", "less", "data", ".", "subsubsection", ":", "Sequential", "Outputs", "The", "bAbI", "Task", "19", "(", "Path", "Finding", ")", "is", "arguably", "the", "hardest", "task", "among", "all", "bAbI", "tasks", "(", "see", "e.g.", ",", "sukhbaatar2015end", ",", "which", "reports", "an", "accuracy", "of", "less", "than", "20", "%", "for", "all", "methods", "that", "do", "not", "use", "the", "strong", "supervision", ")", ".", "We", "apply", "a", "GGS", "-", "NN", "to", "this", "problem", ",", "again", "on", "the", "symbolic", "form", "of", "the", "data", "(", "so", "results", "are", "not", "comparable", "to", "those", "in", "sukhbaatar2015end", ")", ".", "An", "extra", "\u2018", "end", "\u2019", "class", "is", "added", "to", "the", "end", "of", "each", "output", "sequence", ";", "at", "test", "time", "the", "network", "will", "keep", "making", "predictions", "until", "it", "predicts", "the", "\u2018", "end", "\u2019", "class", ".", "The", "results", "for", "this", "task", "are", "given", "in", "Table", "[", "reference", "]", ".", "Both", "RNN", "and", "LSTM", "fail", "on", "this", "task", ".", "However", ",", "with", "only", "50", "training", "examples", ",", "our", "GGS", "-", "NNs", "achieve", "much", "better", "test", "accuracy", "than", "RNN", "and", "LSTM", ".", "subsection", ":", "Learning", "Graph", "Algorithms", "We", "further", "developed", "two", "new", "bAbI", "-", "like", "tasks", "based", "on", "algorithmic", "problems", "on", "graphs", ":", "Shortest", "Paths", ",", "and", "Eulerian", "Circuits", ".", "For", "the", "first", ",", "we", "generate", "random", "graphs", "and", "produce", "a", "story", "that", "lists", "all", "edges", "in", "the", "graphs", ".", "Questions", "come", "from", "choosing", "two", "random", "nodes", "and", "and", "asking", "for", "the", "shortest", "path", "(", "expressed", "as", "a", "sequence", "of", "nodes", ")", "that", "connects", "the", "two", "chosen", "nodes", ".", "We", "constrain", "the", "data", "generation", "to", "only", "produce", "questions", "where", "there", "is", "a", "unique", "shortest", "path", "from", "to", "of", "length", "at", "least", "2", ".", "For", "Eulerian", "circuits", ",", "we", "generate", "a", "random", "two", "-", "regular", "connected", "graph", "and", "a", "separate", "random", "distractor", "graph", ".", "The", "question", "gives", "two", "nodes", "and", "to", "start", "the", "circuit", ",", "then", "the", "question", "is", "to", "return", "the", "Eulerian", "circuit", "(", "again", "expressed", "as", "a", "sequence", "of", "nodes", ")", "on", "the", "given", "subgraph", "that", "starts", "by", "going", "from", "to", ".", "Results", "are", "shown", "in", "the", "Table", "[", "reference", "]", ".", "RNN", "and", "LSTM", "fail", "on", "both", "tasks", ",", "but", "GGS", "-", "NNs", "learns", "to", "make", "perfect", "predictions", "using", "only", "50", "training", "examples", ".", "section", ":", "Program", "Verification", "with", "GGS", "-", "NNs", "Our", "work", "on", "GGS", "-", "NNs", "is", "motivated", "by", "a", "practical", "application", "in", "program", "verification", ".", "A", "crucial", "step", "in", "automatic", "program", "verification", "is", "the", "inference", "of", "program", "invariants", ",", "which", "approximate", "the", "set", "of", "program", "states", "reachable", "in", "an", "execution", ".", "Finding", "invariants", "about", "data", "structures", "is", "an", "open", "problem", ".", "As", "an", "example", ",", "consider", "the", "simple", "C", "function", "on", "the", "right", ".", "To", "prove", "that", "this", "program", "indeed", "concatenates", "the", "two", "lists", "a", "and", "b", "and", "that", "all", "pointer", "dereferences", "are", "valid", ",", "we", "need", "to", "(", "mathematically", ")", "characterize", "the", "program", "\u2019s", "heap", "in", "each", "iteration", "of", "the", "loop", ".", "For", "this", ",", "we", "use", "separation", "logic", "OHearn01", ",", "Reynolds02", ",", "which", "uses", "inductive", "predicates", "to", "describe", "abstract", "data", "structures", ".", "For", "example", ",", "a", "l", "ist", "s", "egment", "is", "defined", "as", ",", "where", "means", "that", "points", "to", "a", "memory", "region", "that", "contains", "a", "structure", "with", "val", "and", "next", "fields", "whose", "values", "are", "in", "turn", "and", ".", "The", "connective", "is", "a", "conjunction", "as", "in", "Boolean", "logic", ",", "but", "additionally", "requires", "that", "its", "operators", "refer", "to", "\u201c", "separate", "\u201d", "parts", "of", "the", "heap", ".", "Thus", ",", "implies", "that", "cur", "is", "either", "NULL", ",", "or", "that", "it", "points", "to", "two", "values", "on", "the", "heap", ",", "where", "is", "described", "by", "again", ".", "The", "formula", "is", "an", "invariant", "of", "the", "loop", "(", "i.e.", ",", "it", "holds", "when", "entering", "the", "loop", ",", "and", "after", "every", "iteration", ")", ".", "Using", "it", ",", "we", "can", "prove", "that", "no", "program", "run", "will", "fail", "due", "to", "dereferencing", "an", "unallocated", "memory", "address", "(", "this", "property", "is", "called", "memory", "safety", ")", "and", "that", "the", "function", "indeed", "concatenates", "two", "lists", "using", "a", "Hoare", "-", "style", "verification", "scheme", "Hoare69", ".", "The", "hardest", "part", "of", "this", "process", "is", "coming", "up", "with", "formulas", "that", "describe", "data", "structures", ",", "and", "this", "is", "where", "we", "propose", "to", "use", "machine", "learning", ".", "Given", "a", "program", ",", "we", "run", "it", "a", "few", "times", "and", "extract", "the", "state", "of", "memory", "(", "represented", "as", "a", "graph", ";", "see", "below", ")", "at", "relevant", "program", "locations", ",", "and", "then", "predict", "a", "separation", "logic", "formula", ".", "Static", "program", "analysis", "tools", "(", "e.g.", ",", "Piskac14", ")", "can", "check", "whether", "a", "candidate", "formula", "is", "sufficient", "to", "prove", "the", "desired", "properties", "(", "e.g.", ",", "memory", "safety", ")", ".", "subsection", ":", "Formalization", "paragraph", ":", "Representing", "Heap", "State", "as", "a", "Graph", "As", "inputs", "we", "consider", "directed", ",", "possibly", "cyclic", "graphs", "representing", "the", "heap", "of", "a", "program", ".", "These", "graphs", "can", "be", "automatically", "constructed", "from", "a", "program", "\u2019s", "memory", "state", ".", "Each", "graph", "node", "corresponds", "to", "an", "address", "in", "memory", "at", "which", "a", "sequence", "of", "pointers", "is", "stored", "(", "we", "ignore", "non", "-", "pointer", "values", "in", "this", "work", ")", ".", "Graph", "edges", "reflect", "these", "pointer", "values", ",", "i.e.", ",", "has", "edges", "labeled", "with", "that", "point", "to", "nodes", ",", "respectively", ".", "A", "subset", "of", "nodes", "are", "labeled", "as", "corresponding", "to", "program", "variables", ".", "An", "example", "input", "graph", "is", "displayed", "as", "\u201c", "Input", "\u201d", "in", "fig", ":", "annotations2", ".", "In", "it", ",", "the", "node", "i", "d", "(", "i.e.", ",", "memory", "address", ")", "is", "displayed", "in", "the", "node", ".", "Edge", "labels", "correspond", "to", "specific", "fields", "in", "the", "program", ",", "e.g.", ",", "in", "our", "example", "corresponds", "to", "the", "next", "pointer", "in", "our", "example", "function", "from", "the", "previous", "section", ".", "For", "binary", "trees", "there", "are", "two", "more", "types", "of", "pointers", "left", "and", "right", "pointing", "to", "the", "left", "and", "right", "children", "of", "a", "tree", "node", ".", "paragraph", ":", "Output", "Representation", "Our", "aim", "is", "to", "mathematically", "describe", "the", "shape", "of", "the", "heap", ".", "In", "our", "model", ",", "we", "restrict", "ourselves", "to", "a", "syntactically", "restricted", "version", "of", "separation", "logic", ",", "in", "which", "formulas", "are", "of", "the", "form", ",", "where", "each", "atomic", "formula", "is", "either", "(", "a", "list", "from", "to", ")", ",", "(", "a", "binary", "tree", "starting", "in", ")", ",", "or", "(", "no", "data", "structure", "at", ")", ".", "Existential", "quantifiers", "are", "used", "to", "give", "names", "to", "heap", "nodes", "which", "are", "needed", "to", "describe", "a", "shape", ",", "but", "not", "labeled", "by", "a", "program", "variable", ".", "For", "example", ",", "to", "describe", "a", "\u201c", "panhandle", "list", "\u201d", "(", "a", "list", "that", "ends", "in", "a", "cycle", ")", ",", "the", "first", "list", "element", "on", "the", "cycle", "needs", "to", "be", "named", ".", "In", "separation", "logic", ",", "this", "can", "be", "expressed", "as", ".", "paragraph", ":", "Data", "We", "can", "generate", "synthetic", "(", "labeled", ")", "datasets", "for", "this", "problem", ".", "For", "this", ",", "we", "fix", "a", "set", "of", "predicates", "such", "as", "and", "(", "extensions", "could", "consider", "doubly", "-", "linked", "list", "segments", ",", "multi", "-", "trees", ",", ")", "together", "with", "their", "inductive", "definitions", ".", "Then", "we", "enumerate", "separation", "logic", "formulas", "instantiating", "our", "predicates", "using", "a", "given", "set", "of", "program", "variables", ".", "Finally", ",", "for", "each", "formula", ",", "we", "enumerate", "heap", "graphs", "satisfying", "that", "formula", ".", "The", "result", "is", "a", "dataset", "consisting", "of", "pairs", "of", "heap", "graphs", "and", "associated", "formulas", "that", "are", "used", "by", "our", "learning", "procedures", ".", "subsection", ":", "Formulation", "as", "GGS", "-", "NNs", "It", "is", "easy", "to", "obtain", "the", "node", "annotations", "for", "the", "intermediate", "prediction", "steps", "from", "the", "data", "generation", "process", ".", "So", "we", "train", "a", "variant", "of", "GGS", "-", "NN", "with", "observed", "annotations", "(", "observed", "at", "training", "time", ";", "not", "test", "time", ")", "to", "infer", "formulas", "from", "heap", "graphs", ".", "Note", "that", "it", "is", "also", "possible", "to", "use", "an", "unobserved", "GGS", "-", "NN", "variant", "and", "do", "end", "-", "to", "-", "end", "learning", ".", "The", "procedure", "breaks", "down", "the", "production", "of", "a", "separation", "logic", "formula", "into", "a", "sequence", "of", "steps", ".", "We", "first", "decide", "whether", "to", "declare", "existential", "variables", ",", "and", "if", "so", ",", "choose", "which", "node", "corresponds", "to", "the", "variable", ".", "Once", "we", "have", "declared", "existentials", ",", "we", "iterate", "over", "all", "variable", "names", "and", "produce", "a", "separation", "logic", "formula", "describing", "the", "data", "structure", "rooted", "at", "the", "node", "corresponding", "to", "the", "current", "variable", ".", "The", "full", "algorithm", "for", "predicting", "separation", "logic", "formula", "appears", "below", ",", "as", "alg", ":", "seplogic", "-", "prediction", ".", "We", "use", "three", "explicit", "node", "annotations", ",", "namely", "is", "-", "named", "(", "heap", "node", "labeled", "by", "program", "variable", "or", "declared", "existentially", "quantified", "variable", ")", ",", "active", "(", "cf", ".", "algorithm", ")", "and", "is", "-", "explained", "(", "heap", "node", "is", "part", "of", "data", "structure", "already", "predicted", ")", ".", "Initial", "node", "labels", "can", "be", "directly", "computed", "from", "the", "input", "graph", ":", "\u201c", "is", "-", "named", "\u201d", "is", "on", "for", "nodes", "labeled", "by", "program", "variables", ",", "\u201c", "active", "\u201d", "and", "\u201c", "is", "-", "explained", "\u201d", "are", "always", "off", "(", "done", "in", "line", "2", ")", ".", "The", "commented", "lines", "in", "the", "algorithm", "are", "implemented", "using", "a", "GG", "-", "NN", ",", "i.e.", ",", "alg", ":", "seplogic", "-", "prediction", "is", "an", "instance", "of", "our", "GGS", "-", "NN", "model", ".", "An", "illustration", "of", "the", "beginning", "of", "a", "run", "of", "the", "algorithm", "is", "shown", "in", "fig", ":", "annotations2", ",", "where", "each", "step", "is", "related", "to", "one", "line", "of", "the", "algorithm", ".", "[", "heapgraph", ",", "scale=.9", "]", "[", "colLabel", "]", "(", "labelStep", ")", "at", "(", "0", ",", "0", ")", "Step", ";", "[", "colLabel", "]", "(", "labelGraph", ")", "at", "(", ")", "Labeled", "Graph", ";", "[", "colLabel", "]", "(", "labelOut", ")", "at", "(", ")", "Out", "p", ";", "[", "stepLabel", ",", "anchor", "=", "north", "]", "(", "0labelStep", ")", "at", "(", ")", "Input", ";", "[", "anchor", "=", "west", ",", "list", ",", "label=90", ":", "b", "]", "(", "0b", ")", "at", "(", ")", ";", "[", "list", "]", "(", "0bn", ")", "at", "(", ")", ";", "[", "list", "]", "(", "0", "t", ")", "at", "(", ")", ";", "[", "list", "]", "(", "0tn", ")", "at", "(", ")", ";", "[", "anchor", "=", "west", ",", "outLabel", "]", "(", "0labelOut", ")", "at", "(", ")", ";", "below", ",", "heapEdgeLabel", "]", "(", "0bn", ")", "(", "0bn", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "0", "t", ")", "(", "0", "t", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "0tn", ")", "(", "0tn", ")", "edge", "[", "bend", "right", "]", "node", "[", "above", ",", "heapEdgeLabel", "]", "(", "0", "t", ")", ";", "[", "stepLabel", ",", "anchor", "=", "north", "]", "(", "1labelStep", ")", "at", "(", ")", "Line", "3", "/", ";", "[", "anchor", "=", "west", ",", "list", ",", "label=90", ":", "b", "]", "(", "1b", ")", "at", "(", ")", ";", "[", "list", "]", "(", "1bn", ")", "at", "(", ")", ";", "[", "list", ",", "label=90", ":", "]", "(", "1", "t", ")", "at", "(", ")", ";", "[", "list", "]", "(", "1tn", ")", "at", "(", ")", ";", "[", "anchor", "=", "west", ",", "outLabel", "]", "(", "1labelOut", ")", "at", "(", ")", ";", "below", ",", "heapEdgeLabel", "]", "(", "1bn", ")", "(", "1bn", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "1", "t", ")", "(", "1", "t", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "1tn", ")", "(", "1tn", ")", "edge", "[", "bend", "right", "]", "node", "[", "above", ",", "heapEdgeLabel", "]", "(", "1", "t", ")", ";", "[", "stepLabel", ",", "anchor", "=", "north", "]", "(", "2labelStep", ")", "at", "(", ")", "Line", "4", "-", "7", "/", ";", "[", "anchor", "=", "west", ",", "list", ",", "label=90", ":", "b", "]", "(", "2b", ")", "at", "(", ")", ";", "[", "list", "]", "(", "2bn", ")", "at", "(", ")", ";", "[", "list", ",", "label=90", ":", "]", "(", "2", "t", ")", "at", "(", ")", ";", "[", "list", "]", "(", "2tn", ")", "at", "(", ")", ";", "[", "anchor", "=", "west", ",", "outLabel", "]", "(", "2labelOut", ")", "at", "(", ")", ";", "below", ",", "heapEdgeLabel", "]", "(", "2bn", ")", "(", "2bn", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "2", "t", ")", "(", "2", "t", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "2tn", ")", "(", "2tn", ")", "edge", "[", "bend", "right", "]", "node", "[", "above", ",", "heapEdgeLabel", "]", "(", "2", "t", ")", ";", "[", "stepLabel", ",", "anchor", "=", "north", "]", "(", "3labelStep", ")", "at", "(", ")", "Line", "10", "(", "for", "b", ")", ";", "[", "anchor", "=", "west", ",", "list", ",", "active", ",", "label=90", ":", "b", "]", "(", "3b", ")", "at", "(", ")", ";", "[", "list", "]", "(", "3bn", ")", "at", "(", ")", ";", "[", "list", ",", "label=90", ":", "]", "(", "3", "t", ")", "at", "(", ")", ";", "[", "list", "]", "(", "3tn", ")", "at", "(", ")", ";", "[", "anchor", "=", "west", ",", "outLabel", "]", "(", "3labelOut", ")", "at", "(", ")", ";", "below", ",", "heapEdgeLabel", "]", "(", "3bn", ")", "(", "3bn", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "3", "t", ")", "(", "3", "t", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "3tn", ")", "(", "3tn", ")", "edge", "[", "bend", "right", "]", "node", "[", "above", ",", "heapEdgeLabel", "]", "(", "3", "t", ")", ";", "[", "-", "]", "(", ")", "\u2013", "(", ")", ";", "[", "colLabel", "]", "(", "labelStep", "\u2019", ")", "at", "(", ")", "Step", ";", "[", "colLabel", "]", "(", "labelGraph", "\u2019", ")", "at", "(", ")", "Labeled", "Graph", ";", "[", "colLabel", "]", "(", "labelOut", "\u2019", ")", "at", "(", ")", "Out", "p", ";", "[", "stepLabel", ",", "anchor", "=", "west", "]", "(", "4labelStep", ")", "at", "(", ")", "Line", "11", "/", ";", "[", "anchor", "=", "west", ",", "list", ",", "active", ",", "label=90", ":", "b", "]", "(", "4b", ")", "at", "(", ")", ";", "[", "list", "]", "(", "4bn", ")", "at", "(", ")", ";", "[", "list", ",", "label=90", ":", "]", "(", "4", "t", ")", "at", "(", ")", ";", "[", "list", "]", "(", "4tn", ")", "at", "(", ")", ";", "[", "anchor", "=", "west", ",", "outLabel", "]", "(", "4labelOut", ")", "at", "(", ")", ";", "below", ",", "heapEdgeLabel", "]", "(", "4bn", ")", "(", "4bn", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "4", "t", ")", "(", "4", "t", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "4tn", ")", "(", "4tn", ")", "edge", "[", "bend", "right", "]", "node", "[", "above", ",", "heapEdgeLabel", "]", "(", "4", "t", ")", ";", "[", "stepLabel", ",", "anchor", "=", "west", "]", "(", "5labelStep", ")", "at", "(", ")", "Line", "13", ",", "14", "/", ";", "[", "anchor", "=", "west", ",", "list", ",", "active", ",", "label=90", ":", "b", "]", "(", "5b", ")", "at", "(", ")", ";", "[", "list", "]", "(", "5bn", ")", "at", "(", ")", ";", "[", "list", ",", "label=90", ":", "]", "(", "5", "t", ")", "at", "(", ")", ";", "[", "list", "]", "(", "5tn", ")", "at", "(", ")", ";", "[", "anchor", "=", "west", ",", "align", "=", "left", ",", "outLabel", "]", "(", "5labelOut", ")", "at", "(", ")", ";", "below", ",", "heapEdgeLabel", "]", "(", "5bn", ")", "(", "5bn", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "5", "t", ")", "(", "5", "t", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "5tn", ")", "(", "5tn", ")", "edge", "[", "bend", "right", "]", "node", "[", "above", ",", "heapEdgeLabel", "]", "(", "5", "t", ")", ";", "[", "stepLabel", ",", "anchor", "=", "west", "]", "(", "6labelStep", ")", "at", "(", ")", "Line", "18", "/", ";", "[", "anchor", "=", "west", ",", "list", ",", "explained", ",", "label=90", ":", "b", "]", "(", "6b", ")", "at", "(", ")", ";", "[", "list", ",", "explained", "]", "(", "6bn", ")", "at", "(", ")", ";", "[", "list", ",", "label=90", ":", "]", "(", "6", "t", ")", "at", "(", ")", ";", "[", "list", "]", "(", "6tn", ")", "at", "(", ")", ";", "[", "anchor", "=", "west", ",", "align", "=", "left", ",", "outLabel", "]", "(", "6labelOut", ")", "at", "(", ")", ";", "below", ",", "heapEdgeLabel", "]", "(", "6bn", ")", "(", "6bn", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "6", "t", ")", "(", "6", "t", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "6tn", ")", "(", "6tn", ")", "edge", "[", "bend", "right", "]", "node", "[", "above", ",", "heapEdgeLabel", "]", "(", "6", "t", ")", ";", "[", "stepLabel", ",", "anchor", "=", "west", "]", "(", "7labelStep", ")", "at", "(", ")", "Line", "10", "(", "for", ")", ";", "[", "anchor", "=", "west", ",", "list", ",", "explained", ",", "label=90", ":", "b", "]", "(", "7b", ")", "at", "(", ")", ";", "[", "list", ",", "explained", "]", "(", "7bn", ")", "at", "(", ")", ";", "[", "list", ",", "active", ",", "label=90", ":", "]", "(", "7", "t", ")", "at", "(", ")", ";", "[", "list", "]", "(", "7tn", ")", "at", "(", ")", ";", "[", "anchor", "=", "west", ",", "align", "=", "left", ",", "outLabel", "]", "(", "7labelOut", ")", "at", "(", ")", ";", "below", ",", "heapEdgeLabel", "]", "(", "7bn", ")", "(", "7bn", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "7", "t", ")", "(", "7", "t", ")", "edge", "node", "[", "below", ",", "heapEdgeLabel", "]", "(", "7tn", ")", "(", "7tn", ")", "edge", "[", "bend", "right", "]", "node", "[", "above", ",", "heapEdgeLabel", "]", "(", "7", "t", ")", ";", "[", "1", "]", "Heap", "graph", "with", "named", "program", "variables", "compute", "initial", "labels", "from", "initialize", "node", "vectors", "by", "-", "extending", "quantifier", "needed", "Graph", "-", "level", "Classification", "(", "\u2020", ")", "fresh", "variable", "name", "pick", "node", "Node", "Selection", "(", "\u2021", ")", "turn", "on", "\u201c", "is", "-", "named", "\u201d", "for", "in", "print", "\u201c", "\u201d", "node", "with", "label", "\u201c", "is", "-", "named", "\u201d", "in", "initialize", "node", "vectors", ",", "turn", "on", "\u201c", "active", "\u201d", "label", "for", "in", "pick", "data", "structure", "predicate", "Graph", "-", "level", "Classification", "(", "\u22c6", ")", "pick", "list", "end", "node", "Node", "Selection", "(", "\u2661", ")", "print", "\u201c", "\u201d", "print", "\u201c", "\u201d", "update", "node", "annotations", "in", "Node", "Annotation", "(", "\u2660", ")", "Separation", "logic", "formula", "prediction", "procedure", "subsection", ":", "Model", "Setup", "Details", "We", "use", "the", "full", "GGS", "-", "NN", "model", "where", "and", "have", "separate", "propagation", "models", ".", "For", "all", "the", "GG", "-", "NN", "components", "in", "the", "GGS", "-", "NN", "pipeline", ",", "we", "unrolled", "the", "propagation", "process", "for", "10", "time", "steps", ".", "The", "GGS", "-", "NNs", "associated", "with", "step", "(", ")", "(", "deciding", "wheter", "more", "existentially", "quantified", "variable", "need", "to", "be", "declared", ")", "and", "(", ")", "(", "identify", "which", "node", "need", "to", "be", "declared", "as", "existentially", "quantified", ")", "uses", "dimensional", "node", "representations", ".", "For", "all", "other", "GGS", "-", "NN", "components", ",", "is", "used", ".", "Adam", "kingma2014adam", "is", "used", "for", "optimization", ",", "the", "models", "are", "trained", "on", "minibatches", "of", "20", "graphs", ",", "and", "optimized", "until", "training", "error", "is", "very", "low", ".", "For", "the", "graph", "-", "level", "classification", "tasks", ",", "we", "also", "artificially", "balanced", "classes", "to", "have", "even", "number", "of", "examples", "from", "each", "class", "in", "each", "minibatch", ".", "All", "the", "GGS", "-", "NN", "components", "contain", "less", "than", "5k", "parameters", "and", "no", "overfitting", "is", "observed", "during", "training", ".", "subsection", ":", "Batch", "Prediction", "Details", "In", "practice", ",", "a", "set", "of", "heap", "graphs", "will", "be", "given", "as", "input", "and", "a", "single", "output", "formula", "is", "expected", "to", "describe", "and", "be", "consistent", "with", "all", "the", "input", "graphs", ".", "The", "different", "heap", "graphs", "can", "be", "snapshots", "of", "the", "heap", "state", "at", "different", "points", "in", "the", "program", "execution", "process", ",", "or", "different", "runs", "of", "the", "same", "program", "with", "different", "inputs", ".", "We", "call", "this", "the", "\u201c", "batch", "prediction", "\u201d", "setup", "contrasting", "with", "the", "single", "graph", "prediction", "described", "in", "the", "main", "paper", ".", "To", "make", "batch", "predictions", ",", "we", "run", "one", "GGS", "-", "NN", "for", "each", "graph", "simultaneously", ".", "For", "each", "prediction", "step", ",", "the", "outputs", "of", "all", "the", "GGS", "-", "NNs", "at", "that", "step", "across", "the", "batch", "of", "graphs", "are", "aggregated", ".", "For", "node", "selection", "outputs", ",", "the", "common", "named", "variables", "link", "nodes", "on", "different", "graphs", "togeter", ",", "which", "is", "the", "key", "for", "aggregating", "predictions", "in", "a", "batch", ".", "We", "compute", "the", "score", "for", "a", "particular", "named", "variable", "as", ",", "where", "maps", "variable", "name", "to", "a", "node", "in", "graph", ",", "and", "is", "the", "output", "score", "for", "named", "variable", "in", "graph", ".", "When", "applying", "a", "softmax", "over", "all", "names", "using", "as", "scores", ",", "this", "is", "equivalent", "to", "a", "model", "that", "computes", ".", "For", "graph", "-", "level", "classification", "outputs", ",", "we", "add", "up", "scores", "of", "a", "particular", "class", "across", "the", "batch", "of", "graphs", ",", "or", "equivalently", "compute", ".", "Node", "annotation", "outputs", "are", "updated", "for", "each", "graph", "independently", "as", "different", "graphs", "have", "completely", "different", "set", "of", "nodes", ".", "However", ",", "when", "the", "algorithm", "tries", "to", "update", "the", "annotation", "for", "one", "named", "variable", ",", "the", "nodes", "associated", "with", "that", "variable", "in", "all", "graphs", "are", "updated", ".", "During", "training", ",", "all", "labels", "for", "intermediate", "steps", "are", "available", "to", "us", "from", "the", "data", "generation", "process", ",", "so", "the", "training", "process", "again", "can", "be", "decomposed", "to", "single", "output", "single", "graph", "training", ".", "A", "more", "complex", "scenario", "allowing", "for", "nested", "data", "structures", "(", "e.g.", ",", "list", "of", "lists", ")", "was", "discussed", "in", ".", "We", "have", "also", "successfully", "extended", "the", "GGS", "-", "NN", "model", "to", "this", "case", ".", "More", "details", "on", "this", "can", "be", "found", "in", "Appendix", "[", "reference", "]", ".", "subsection", ":", "Experiments", ".", "For", "this", "paper", ",", "we", "produced", "a", "dataset", "of", "327", "formulas", "that", "involves", "three", "program", "variables", ",", "with", "498", "graphs", "per", "formula", ",", "yielding", "around", "160", ",", "000", "formula", "/", "heap", "graph", "combinations", ".", "To", "evaluate", ",", "we", "split", "the", "data", "into", "training", ",", "validation", "and", "test", "sets", "using", "a", "6:2:2", "split", "on", "the", "formulas", "(", "i.e.", ",", "the", "formulas", "in", "the", "test", "set", "were", "not", "in", "the", "training", "set", ")", ".", "We", "measure", "correctness", "by", "whether", "the", "formula", "predicted", "at", "test", "time", "is", "logically", "equivalent", "to", "the", "ground", "truth", ";", "equivalence", "is", "approximated", "by", "canonicalizing", "names", "and", "order", "of", "the", "formulas", "and", "then", "comparing", "for", "exact", "equality", ".", "We", "compared", "our", "GGS", "-", "NN", "-", "based", "model", "with", "a", "method", "we", "developed", "earlier", "brockschmidt2015learning", ".", "The", "earlier", "approach", "treats", "each", "prediction", "step", "as", "standard", "classification", ",", "and", "requires", "complex", ",", "manual", ",", "problem", "-", "specific", "feature", "engineering", ",", "to", "achieve", "an", "accuracy", "of", "89.11", "%", ".", "In", "contrast", ",", "our", "new", "model", "was", "trained", "with", "no", "feature", "engineering", "and", "very", "little", "domain", "knowledge", "and", "achieved", "an", "accuracy", "of", "89.96", "%", ".", "An", "example", "heap", "graph", "and", "the", "corresponding", "separation", "logic", "formula", "found", "by", "our", "GGS", "-", "NN", "model", "is", "shown", "in", "fig", ":", "appendix", "-", "heap", "-", "graph", "-", "example", ".", "This", "example", "also", "involves", "nested", "data", "structures", "and", "the", "batching", "extension", "developed", "in", "the", "previous", "section", ".", "We", "have", "also", "successfully", "used", "our", "new", "model", "in", "a", "program", "verification", "framework", ",", "supplying", "needed", "program", "invariants", "to", "a", "theorem", "prover", "to", "prove", "correctness", "of", "a", "collection", "of", "list", "-", "manipulating", "algorithms", "such", "as", "insertion", "sort", ".", "The", "following", "Table", "[", "reference", "]", "lists", "a", "set", "of", "benchmark", "list", "manipulation", "programs", "and", "the", "separation", "logic", "formula", "invariants", "found", "by", "the", "GGS", "-", "NN", "model", ",", "which", "were", "successfully", "used", "in", "a", "verification", "framework", "to", "prove", "the", "correctness", "of", "corresponding", "programs", ".", "A", "further", "extension", "of", "the", "current", "pipeline", "has", "been", "shown", "to", "be", "able", "to", "successfully", "prove", "more", "sophisticated", "programs", "like", "sorting", "programs", "and", "various", "other", "list", "-", "manipulating", "programs", ".", "section", ":", "Related", "Work", "The", "most", "closely", "related", "work", "is", "GNNs", ",", "which", "we", "have", "discussed", "at", "length", "above", ".", "proposed", "another", "closely", "related", "model", "that", "differs", "from", "GNNs", "mainly", "in", "the", "output", "model", ".", "GNNs", "have", "been", "applied", "in", "several", "domains", "gori2005new", ",", "di2006comparison", ",", "scarselli2009graph", ",", "uwents2011neural", ",", "but", "they", "do", "not", "appear", "to", "be", "in", "widespread", "use", "in", "the", "ICLR", "community", ".", "Part", "of", "our", "aim", "here", "is", "to", "publicize", "GNNs", "as", "a", "useful", "and", "interesting", "neural", "network", "variant", ".", "An", "analogy", "can", "be", "drawn", "between", "our", "adaptation", "from", "GNNs", "to", "GG", "-", "NNs", ",", "to", "the", "work", "of", "and", "in", "the", "structured", "prediction", "setting", ".", "There", "belief", "propagation", "(", "which", "must", "be", "run", "to", "near", "convergence", "to", "get", "good", "gradients", ")", "is", "replaced", "with", "truncated", "belief", "propagation", "updates", ",", "and", "then", "the", "model", "is", "trained", "so", "that", "the", "truncated", "iteration", "produce", "good", "results", "after", "a", "fixed", "number", "of", "iterations", ".", "Similarly", ",", "Recursive", "Neural", "Networks", "goller1996learning", ",", "socher2011parsing", "being", "extended", "to", "Tree", "LSTMs", "tai2015improved", "is", "analogous", "to", "our", "using", "of", "GRU", "updates", "in", "GG", "-", "NNs", "instead", "of", "the", "standard", "GNN", "recurrence", "with", "the", "aim", "of", "improving", "the", "long", "-", "term", "propagation", "of", "information", "across", "a", "graph", "structure", ".", "The", "general", "idea", "expressed", "in", "this", "paper", "of", "assembling", "problem", "-", "specific", "neural", "networks", "as", "a", "composition", "of", "learned", "components", "has", "a", "long", "history", ",", "dating", "back", "at", "least", "to", "the", "work", "of", "on", "assembling", "neural", "networks", "according", "to", "a", "family", "tree", "structure", "in", "order", "to", "predict", "relations", "between", "people", ".", "Similar", "ideas", "appear", "in", "and", ".", "Graph", "kernels", "shervashidze2011weisfeiler", ",", "kashima2003marginalized", "can", "be", "used", "for", "a", "variety", "of", "kernel", "-", "based", "learning", "tasks", "with", "graph", "-", "structured", "inputs", ",", "but", "we", "are", "not", "aware", "of", "work", "that", "learns", "the", "kernels", "and", "outputs", "sequences", ".", "convert", "graphs", "into", "sequences", "by", "following", "random", "walks", "on", "the", "graph", "then", "learns", "node", "embeddings", "using", "sequence", "-", "based", "methods", ".", "map", "graphs", "to", "graph", "vectors", "then", "classify", "using", "an", "output", "neural", "network", ".", "There", "are", "several", "models", "that", "make", "use", "of", "similar", "propagation", "of", "node", "representations", "on", "a", "graph", "structure", ".", "generalize", "convolutions", "to", "graph", "structures", ".", "The", "difference", "between", "their", "work", "and", "GNNs", "is", "analogous", "to", "the", "difference", "between", "convolutional", "and", "recurrent", "networks", ".", "also", "consider", "convolutional", "like", "operations", "on", "graphs", ",", "building", "a", "learnable", ",", "differentiable", "variant", "of", "a", "successful", "graph", "feature", ".", "converts", "an", "arbitrary", "undirected", "graph", "to", "a", "number", "of", "different", "DAGs", "with", "different", "orientations", "and", "then", "propagates", "node", "representations", "inwards", "towards", "each", "root", ",", "training", "an", "ensemble", "of", "models", ".", "In", "all", "of", "the", "above", ",", "the", "focus", "is", "on", "one", "-", "step", "problems", ".", "GNNs", "and", "our", "extensions", "have", "many", "of", "the", "same", "desirable", "properties", "of", "pointer", "networks", "vinyals2015pointer", ";", "when", "using", "node", "selection", "output", "layers", ",", "nodes", "from", "the", "input", "can", "be", "chosen", "as", "outputs", ".", "There", "are", "two", "main", "differences", ":", "first", ",", "in", "GNNs", "the", "graph", "structure", "is", "explicit", ",", "which", "makes", "the", "models", "less", "general", "but", "may", "provide", "stronger", "generalization", "ability", ";", "second", ",", "pointer", "networks", "require", "that", "each", "node", "has", "properties", "(", "e.g.", ",", "a", "location", "in", "space", ")", ",", "while", "GNNs", "can", "represent", "nodes", "that", "are", "defined", "only", "by", "their", "position", "in", "the", "graph", ",", "which", "makes", "them", "more", "general", "along", "a", "different", "dimension", ".", "GGS", "-", "NNs", "are", "related", "to", "soft", "alignment", "and", "attentional", "models", "(", "e.g.", ",", ")", "in", "two", "respects", ":", "first", ",", "the", "graph", "representation", "in", "(", "[", "reference", "]", ")", "uses", "context", "to", "focus", "attention", "on", "which", "nodes", "are", "important", "to", "the", "current", "decision", ";", "second", ",", "node", "annotations", "in", "the", "program", "verification", "example", "keep", "track", "of", "which", "nodes", "have", "been", "explained", "so", "far", ",", "which", "gives", "an", "explicit", "mechanism", "for", "making", "sure", "that", "each", "node", "in", "the", "input", "has", "been", "used", "over", "the", "sequence", "of", "producing", "an", "output", ".", "section", ":", "Discussion", "paragraph", ":", "What", "is", "being", "learned", "?", "It", "is", "instructive", "to", "consider", "what", "is", "being", "learned", "by", "the", "GG", "-", "NNs", ".", "To", "do", "so", ",", "we", "can", "draw", "analogy", "between", "how", "the", "bAbI", "task", "15", "would", "be", "solved", "via", "a", "logical", "formulation", ".", "As", "an", "example", ",", "consider", "the", "subset", "of", "lines", "needed", "to", "answer", "one", "example", "on", "the", "right", ".", "To", "do", "logical", "reasoning", ",", "we", "would", "need", "not", "only", "a", "logical", "encoding", "of", "the", "facts", "present", "in", "the", "story", "but", "also", "the", "background", "world", "knowledge", "encoded", "as", "inference", "rules", "such", "as", "Our", "encoding", "of", "the", "tasks", "simplifies", "the", "parsing", "of", "the", "story", "into", "graph", "form", ",", "but", "it", "does", "not", "provide", "any", "of", "the", "background", "knowledge", ".", "The", "GG", "-", "NN", "model", "can", "be", "seen", "as", "learning", "this", ",", "with", "results", "stored", "in", "the", "neural", "network", "weights", ".", "To", "do", "logical", "reasoning", ",", "we", "would", "need", "not", "only", "a", "logical", "encoding", "of", "the", "facts", "present", "in", "the", "story", "but", "also", "the", "background", "world", "knowledge", "encoded", "as", "inference", "rules", "such", "as", "Our", "encoding", "of", "the", "tasks", "simplifies", "the", "parsing", "of", "the", "story", "into", "graph", "form", ",", "but", "it", "does", "not", "provide", "any", "of", "the", "background", "world", "knowledge", ".", "Thus", ",", "the", "GG", "-", "NN", "model", "can", "be", "seen", "as", "learning", "the", "background", "world", "knowledge", ",", "with", "results", "stored", "in", "the", "neural", "network", "weights", ".", "paragraph", ":", "Discussion", "The", "results", "in", "the", "paper", "show", "that", "GGS", "-", "NNs", "have", "desirable", "inductive", "biases", "across", "a", "range", "of", "problems", "that", "have", "some", "intrinsic", "graph", "structure", "to", "them", ",", "and", "we", "believe", "there", "to", "be", "many", "more", "cases", "where", "GGS", "-", "NNs", "will", "be", "useful", ".", "There", "are", ",", "however", ",", "some", "limitations", "that", "need", "to", "be", "overcome", "to", "make", "them", "apply", "even", "more", "broadly", ".", "Two", "limitations", "that", "we", "mentioned", "previously", "are", "that", "the", "bAbI", "task", "translation", "does", "not", "incorporate", "temporal", "order", "of", "inputs", "or", "ternary", "and", "higher", "order", "relations", ".", "We", "can", "imagine", "several", "possibilities", "for", "lifting", "these", "restrictions", ",", "such", "as", "concatenating", "a", "series", "of", "GG", "-", "NNs", ",", "where", "there", "is", "one", "GG", "-", "NNs", "for", "each", "edge", ",", "and", "representing", "higher", "order", "relations", "as", "factor", "graphs", ".", "A", "more", "significant", "challenge", "is", "how", "to", "handle", "less", "structured", "input", "representations", ".", "For", "example", ",", "in", "the", "bAbI", "tasks", "it", "would", "be", "desirable", "not", "to", "use", "the", "symbolic", "form", "of", "the", "inputs", ".", "One", "possible", "approach", "is", "to", "incorporate", "less", "structured", "inputs", ",", "and", "latent", "vectors", ",", "in", "our", "GGS", "-", "NNs", ".", "However", ",", "experimentation", "is", "needed", "to", "find", "the", "best", "way", "of", "addressing", "these", "issues", ".", "The", "current", "GGS", "-", "NNs", "formulation", "specifies", "a", "question", "only", "after", "all", "the", "facts", "have", "been", "consumed", ".", "This", "implies", "that", "the", "network", "must", "try", "to", "derive", "all", "consequences", "of", "the", "seen", "facts", "and", "store", "all", "pertinent", "information", "to", "a", "node", "within", "its", "node", "representation", ".", "This", "is", "likely", "not", "ideal", ";", "it", "would", "be", "preferable", "to", "develop", "methods", "that", "take", "the", "question", "as", "an", "initial", "input", ",", "and", "then", "dynamically", "derive", "the", "facts", "needed", "to", "answer", "the", "question", ".", "We", "are", "optimistic", "about", "the", "further", "applications", "of", "GGS", "-", "NNs", ".", "We", "are", "particularly", "interested", "in", "continuing", "to", "develop", "end", "-", "to", "-", "end", "learnable", "systems", "that", "can", "learn", "about", "semantic", "properties", "of", "programs", ",", "that", "can", "learn", "more", "complicated", "graph", "algorithms", ",", "and", "in", "applying", "these", "ideas", "to", "problems", "that", "require", "reasoning", "over", "knowledge", "bases", "and", "databases", ".", "More", "generally", ",", "we", "consider", "these", "graph", "neural", "networks", "as", "representing", "a", "step", "towards", "a", "model", "that", "can", "combine", "structured", "representations", "with", "the", "powerful", "algorithms", "of", "deep", "learning", ",", "with", "the", "aim", "of", "taking", "advantage", "of", "known", "structure", "while", "learning", "and", "inferring", "how", "to", "reason", "with", "and", "extend", "these", "representations", ".", "section", ":", "Acknowledgements", "We", "thank", "Siddharth", "Krishna", ",", "Alex", "Gaunt", ",", "Emine", "Yilmaz", ",", "Milad", "Shokouhi", ",", "and", "Pushmeet", "Kohli", "for", "useful", "conversations", "and", "Douwe", "Kiela", "for", "comments", "on", "an", "earlier", "draft", "of", "the", "paper", ".", "bibliography", ":", "References", "appendix", ":", "Contraction", "Map", "Example", "Consider", "a", "linear", "1", "-", "hidden", "unit", "cycle", "-", "structured", "GNN", "with", "nodes", ".", "For", "simplicity", "we", "ignored", "all", "edge", "labels", "and", "node", "labels", ",", "equivalently", "this", "is", "a", "simple", "example", "with", "and", ".", "At", "each", "timestep", "we", "update", "hidden", "states", "as", "for", "each", ",", "where", "and", "are", "parameters", "of", "the", "propagation", "model", ".", "We", "use", "the", "convention", "that", "cycles", "around", "and", "refers", "to", "when", ".", "Let", ",", "and", ".", "We", "can", "write", "the", "joint", "update", "for", "all", "as", "Restrict", "the", "update", "to", "define", "a", "contraction", "mapping", "in", "the", "Euclidean", "metric", ".", "This", "means", "that", "there", "is", "some", "such", "that", "for", "any", ",", "or", "in", "other", "words", ",", "We", "can", "immediately", "see", "that", "this", "implies", "that", "for", "each", "by", "letting", "be", "the", "elementary", "vector", "that", "is", "all", "zero", "except", "for", "a", "1", "in", "position", "and", "letting", "be", "the", "all", "zeros", "vector", ".", "Expanding", "Eq", ".", "[", "reference", "]", ",", "we", "get", "In", "the", "GNN", "model", ",", "node", "label", "controls", "which", "values", "of", "and", "are", "used", "during", "the", "propagation", ".", "Looking", "at", "this", "expansion", "and", "noting", "that", "for", "all", ",", "we", "see", "that", "information", "about", "labels", "of", "nodes", "away", "will", "decay", "at", "a", "rate", "of", ".", "Thus", ",", "at", "least", "in", "this", "simple", "case", ",", "the", "restriction", "that", "be", "a", "contraction", "means", "that", "it", "is", "not", "able", "to", "maintain", "long", "-", "range", "dependencies", ".", "subsection", ":", "Nonlinear", "Case", "The", "same", "analysis", "can", "be", "applied", "to", "a", "nonlinear", "update", ",", "i.e.", "where", "is", "any", "nonlinear", "function", ".", "Then", ".", "Let", ",", "where", ".", "The", "contraction", "map", "definition", "Eq", ".", "[", "reference", "]", "implies", "that", "each", "entry", "of", "the", "Jacobian", "matrix", "of", "is", "bounded", "by", ",", "i.e.", "To", "see", "this", ",", "consider", "two", "vectors", "and", ",", "where", "and", ".", "The", "definition", "in", "(", "[", "reference", "]", ")", "implies", "that", "for", "all", ",", "Therefore", "where", "the", "left", "hand", "side", "is", "by", "definition", "as", ".", "When", ",", "Also", ",", "because", "of", "the", "special", "cycle", "graph", "structure", ",", "for", "all", "other", "s", "we", "have", ".", "Applying", "this", "to", "the", "update", "at", "timestep", ",", "we", "get", "Now", "let", "\u2019s", "see", "how", "a", "change", "in", "could", "affect", ".", "Using", "the", "chain", "rule", "and", "the", "special", "graph", "structure", ",", "we", "have", "As", ",", "this", "derivative", "will", "approach", "0", "exponentially", "fast", "as", "grows", ".", "Intuitively", ",", "this", "means", "that", "the", "impact", "one", "node", "has", "on", "another", "node", "far", "away", "will", "decay", "exponetially", ",", "therefore", "making", "it", "difficult", "to", "model", "long", "range", "dependencies", ".", "appendix", ":", "Why", "are", "RNN", "and", "LSTM", "so", "Bad", "on", "the", "Sequence", "Prediction", "Tasks", "?", "RNN", "and", "LSTM", "performance", "on", "the", "sequence", "prediction", "tasks", ",", "i.e.", "bAbI", "task", "19", ",", "shortest", "path", "and", "Eulerian", "circuit", ",", "are", "very", "poor", "compared", "to", "single", "output", "tasks", ".", "The", "Eulerian", "circuit", "task", "is", "the", "one", "that", "RNN", "and", "LSTM", "fail", "most", "dramatically", ".", "A", "typical", "training", "example", "for", "this", "task", "looks", "like", "the", "following", ",", "This", "describes", "a", "graph", "with", "two", "cycles", "3", "-", "7", "-", "5", "-", "8", "-", "6", "and", "1", "-", "2", "-", "4", "-", "0", ",", "where", "3", "-", "7", "-", "5", "-", "8", "-", "6", "is", "the", "target", "cycle", "and", "1", "-", "2", "-", "4", "-", "0", "is", "a", "smaller", "distractor", "graph", ".", "All", "edges", "are", "presented", "twice", "in", "both", "directions", "for", "symmetry", ".", "The", "task", "is", "to", "find", "the", "cycle", "that", "starts", "with", "the", "given", "two", "nodes", "and", "in", "the", "direction", "from", "the", "first", "to", "the", "second", ".", "The", "distractor", "graph", "is", "added", "to", "increase", "the", "difficulty", "of", "this", "task", ",", "this", "also", "makes", "the", "output", "cycle", "not", "strictly", "\u201c", "Eulerian", "\u201d", ".", "For", "RNN", "and", "LSTM", "the", "above", "training", "example", "is", "further", "transformed", "into", "a", "sequence", "of", "tokens", ",", "Note", "the", "node", "IDs", "here", "are", "different", "from", "the", "ones", "in", "the", "original", "symbolic", "data", ".", "The", "RNN", "and", "LSTM", "read", "through", "the", "whole", "sequence", ",", "and", "start", "to", "predict", "the", "first", "output", "when", "reading", "the", "ans", "token", ".", "Then", "for", "each", "prediction", "step", ",", "the", "ans", "token", "is", "fed", "as", "the", "input", "and", "the", "target", "node", "ID", "(", "treated", "as", "a", "class", "label", ")", "is", "expected", "as", "the", "output", ".", "In", "this", "current", "setup", ",", "the", "output", "of", "each", "prediction", "step", "is", "not", "fed", "as", "the", "input", "for", "the", "next", ".", "Our", "GGS", "-", "NN", "model", "uses", "the", "same", "setup", ",", "where", "the", "output", "of", "one", "step", "is", "not", "used", "as", "input", "to", "the", "next", ",", "only", "the", "predicted", "node", "annotations", "carry", "over", "from", "one", "step", "to", "the", "next", ",", "so", "the", "comparison", "is", "still", "fair", "for", "RNN", "and", "LSTM", ".", "Changing", "both", "our", "method", "and", "the", "baselines", "to", "make", "use", "of", "previous", "predictions", "is", "left", "as", "future", "work", ".", "From", "this", "example", "we", "can", "see", "that", "the", "sequences", "the", "RNN", "and", "LSTM", "have", "to", "handle", "is", "quite", "long", ",", "close", "to", "80", "tokens", "before", "the", "predictions", "are", "made", ".", "Some", "predictions", "really", "depend", "on", "long", "range", "memory", ",", "for", "example", "the", "first", "edge", "(", "3", "-", "7", ")", "and", "first", "a", "few", "tokens", "(", "n4", "e1", "n8", ")", "in", "the", "sequence", "are", "needed", "to", "make", "prediction", "in", "the", "third", "prediction", "step", "(", "3", "in", "the", "original", "symbolic", "data", ",", "and", "4", "in", "the", "tokenized", "RNN", "data", ")", ".", "Keeping", "long", "range", "memory", "in", "RNNs", "is", "challenging", ",", "LSTMs", "do", "better", "than", "RNNs", "but", "still", "ca", "n\u2019t", "completely", "solve", "the", "problem", ".", "Another", "challenge", "about", "this", "task", "is", "the", "output", "sequence", "does", "not", "appear", "in", "the", "same", "order", "as", "in", "the", "input", "sequence", ".", "In", "fact", ",", "the", "data", "has", "no", "sequential", "nature", "at", "all", ",", "even", "when", "the", "edges", "are", "randomly", "permutated", ",", "the", "target", "output", "sequence", "should", "not", "change", ".", "The", "same", "applies", "for", "bAbI", "task", "19", "and", "the", "shortest", "path", "task", ".", "GGS", "-", "NNs", "are", "good", "at", "handling", "this", "type", "of", "\u201c", "static", "\u201d", "data", ",", "while", "RNN", "and", "LSTM", "are", "not", ".", "However", "future", "work", "is", "needed", "to", "determine", "how", "best", "to", "apply", "GGS", "-", "NNs", "to", "temporal", "sequential", "data", "which", "RNN", "and", "LSTM", "are", "good", "at", ".", "This", "is", "one", "limitation", "of", "the", "GGS", "-", "NNs", "model", "which", "we", "discussed", "in", "sec", ":", "discussion", ".", "appendix", ":", "Nested", "Prediction", "Details", "Data", "structures", "like", "list", "of", "lists", "are", "nested", "data", "structures", ",", "in", "which", "the", "val", "pointer", "of", "each", "node", "in", "a", "data", "structure", "points", "to", "another", "data", "structure", ".", "Such", "data", "structures", "can", "be", "represented", "in", "separation", "logic", "by", "allowing", "predicates", "to", "be", "nested", ".", "For", "example", ",", "a", "list", "of", "lists", "can", "be", "represented", "as", ",", "where", "is", "a", "lambda", "expression", "and", "says", "that", "for", "each", "node", "in", "the", "list", "from", "to", ",", "its", "val", "pointer", "satisfies", ".", "So", "there", "is", "a", "list", "from", "to", ",", "where", "each", "node", "in", "that", "list", "points", "to", "another", "list", ".", "A", "simple", "list", "without", "nested", "structures", "can", "be", "represented", "as", "where", "represents", "an", "empty", "predicate", ".", "Note", "that", "unlike", "the", "non", "-", "nested", "case", "where", "the", "val", "pointer", "always", "points", "to", "NULL", ",", "we", "have", "to", "consider", "the", "val", "pointers", "here", "in", "order", "to", "describe", "and", "handle", "nested", "data", "structures", ".", "To", "make", "our", "GGS", "-", "NNs", "able", "to", "predict", "nested", "formulas", ",", "we", "adapt", "alg", ":", "seplogic", "-", "prediction", "to", "alg", ":", "seplogic", "-", "nesting", ".", "Where", "an", "outer", "loop", "goes", "through", "each", "named", "variable", "once", "and", "generate", "a", "nested", "predicate", "with", "the", "node", "associated", "with", "that", "variable", "as", "the", "active", "node", ".", "The", "nested", "prediction", "procedure", "handles", "prediction", "similarly", "as", "in", "alg", ":", "seplogic", "-", "prediction", ".", "Before", "calling", "the", "nested", "prediction", "procedure", "recursively", ",", "the", "node", "annotation", "update", "in", "line", "[", "reference", "]", "not", "only", "annotates", "nodes", "in", "the", "current", "structure", "as", "\u201c", "is", "-", "explained", "\u201d", ",", "but", "also", "annotates", "nodes", "linked", "to", "via", "the", "\u201c", "val", "\u201d", "pointer", "from", "all", "nodes", "in", "the", "current", "structure", "as", "\u201c", "active", "\u201d", ".", "For", "the", "list", "of", "lists", "example", ",", "after", "predicting", "\u201c", "\u201d", ",", "the", "annotation", "step", "annotates", "all", "nodes", "in", "the", "list", "from", "to", "as", "\u201c", "is", "-", "explained", "\u201d", "and", "all", "nodes", "the", "val", "pointer", "points", "to", "from", "the", "list", "as", "\u201c", "active", "\u201d", ".", "This", "knowledge", "is", "not", "hard", "coded", "into", "the", "algorithm", ",", "the", "annotation", "model", "can", "learn", "this", "behavior", "from", "data", ".", "[", "1", "]", "OuterLoop", "Graph", "with", "named", "program", "variables", "compute", "initial", "labels", "from", "each", "variable", "name", "node", "associated", "with", "turn", "on", "\u201c", "active", "\u201d", "bit", "for", "in", "PredictNestedFormula", ",", ",", "PredictNestedFormula", ",", ",", "initialize", "node", "vectors", "by", "-", "extending", "quantifier", "needed", "Graph", "-", "level", "Classification", "(", "\u2020", ")", "fresh", "existentially", "quantified", "variable", "name", "pick", "node", "Node", "Selection", "(", "\u2021", ")", "turn", "on", "\u201c", "is", "-", "named", "\u201d", "for", "in", "print", "\u201c", "\u201d", "is", "a", "lambda", "variable", "name", "print", "\u201c", "\u201d", "pick", "data", "structure", "predicate", "Graph", "-", "level", "Classification", "(", "\u22c6", ")", "pick", "list", "end", "node", "Node", "Selection", "(", "\u2661", ")", "get", "variable", "name", "associated", "with", "print", "\u201c", "\u201d", "print", "\u201c", "\u201d", "print", "\u201c", "\u201d", "update", "node", "annotations", "in", "Node", "Annotation", "(", "\u2660", ")", "fresh", "lambda", "variable", "name", "PredictNestedFormula", ",", ",", "Recursively", "predict", "all", "nested", "formulas", ".", "print", "\u201c", "\u201d", "Nested", "separation", "logic", "formula", "prediction", "procedure"]}