{"coref": {"MAE": [[1597, 1600], [1601, 1602], [1935, 1936], [1946, 1947], [2543, 2544]], "Pain_Intensity_Regression": [[7, 10], [804, 808], [928, 932], [1176, 1179], [2104, 2107], [2701, 2704], [2719, 2722], [2771, 2774]], "Regularized_Deep_Regressor": [[140, 143]], "UNBC-McMaster_ShoulderPain_dataset": [[158, 165], [583, 586], [593, 596], [934, 938], [1622, 1626], [1854, 1858], [2086, 2090], [2248, 2254], [2384, 2388], [2753, 2760]]}, "coref_non_salient": {"0": [[581, 582], [587, 590]], "1": [[739, 745], [2261, 2263]], "10": [[242, 244], [518, 520]], "11": [[68, 70], [135, 137], [709, 711], [1232, 1235], [2236, 2238], [2683, 2685]], "12": [[187, 189], [897, 899], [1360, 1362], [1921, 1924]], "13": [[1398, 1399], [2545, 2546], [1245, 1246], [1284, 1285], [1512, 1513], [1580, 1581], [1914, 1915]], "14": [[1204, 1208], [2740, 2745]], "15": [[952, 953], [957, 958]], "16": [[374, 381], [458, 461]], "17": [[1135, 1139], [2214, 2218]], "18": [[53, 56], [296, 300], [695, 698], [2669, 2672], [2799, 2802]], "19": [[34, 37], [559, 561]], "2": [[1753, 1756], [2852, 2855]], "20": [[178, 181], [1349, 1352], [1848, 1851], [1899, 1904]], "21": [[2243, 2246]], "22": [[687, 691], [2664, 2668]], "23": [[1394, 1397], [1516, 1518], [1552, 1554], [1584, 1585], [1241, 1244]], "24": [[2355, 2357], [2375, 2380]], "25": [[892, 894], [2351, 2352], [2480, 2482], [2516, 2517], [2619, 2621], [2645, 2647]], "26": [[982, 985], [1056, 1058]], "27": [[452, 453]], "28": [[1068, 1070], [1102, 1104]], "29": [[1051, 1055], [1078, 1082]], "3": [[96, 99], [726, 729], [1129, 1132], [2208, 2211], [2697, 2700]], "30": [[1907, 1909], [2518, 2520]], "31": [[945, 946], [2407, 2408], [2495, 2496], [2586, 2587]], "32": [[1288, 1290], [1500, 1502], [2711, 2713]], "33": [[1910, 1911], [1929, 1930]], "34": [[1072, 1074]], "35": [[1843, 1845]], "36": [[2318, 2321]], "37": [[2490, 2492]], "38": [[2363, 2368]], "39": [[2844, 2848]], "4": [[303, 304], [1334, 1335], [1812, 1813], [2731, 2732], [2850, 2851], [748, 749], [1041, 1042]], "40": [[305, 306], [1249, 1250], [118, 119], [750, 751], [1200, 1201], [1386, 1387], [1390, 1391], [1790, 1791], [2328, 2329], [2453, 2454], [2747, 2748], [2837, 2838]], "41": [[1094, 1095], [1411, 1412], [1446, 1447], [1795, 1796]], "42": [[1525, 1526], [1115, 1116]], "43": [[789, 791]], "44": [[1433, 1436]], "45": [[1260, 1262]], "46": [[2512, 2513]], "47": [[1834, 1836]], "48": [[521, 523]], "49": [[602, 604]], "5": [[1031, 1033], [1034, 1038]], "50": [[250, 252]], "51": [[2487, 2489]], "52": [[1155, 1158], [1236, 1238]], "53": [[1467, 1470]], "54": [[2038, 2040]], "55": [[414, 416]], "56": [[245, 249]], "57": [[746, 747]], "58": [[1607, 1608]], "59": [[2608, 2612]], "6": [[301, 302], [547, 548], [556, 558]], "60": [[1916, 1917]], "61": [[995, 997]], "62": [[2510, 2511]], "63": [[19, 23]], "64": [[948, 951]], "65": [[1771, 1775]], "66": [[2353, 2355]], "67": [[1085, 1087]], "68": [[2547, 2549]], "69": [[1017, 1021]], "7": [[101, 104], [734, 737], [1210, 1213], [1381, 1383]], "70": [[542, 546]], "71": [[125, 127]], "72": [[1090, 1093]], "73": [[1059, 1060]], "74": [[940, 944]], "75": [[399, 402]], "76": [[1062, 1065]], "77": [[2, 6]], "78": [[1149, 1151]], "79": [[455, 457]], "8": [[480, 482], [2282, 2284]], "80": [[1002, 1010]], "81": [[328, 332]], "82": [[1539, 1544]], "83": [[863, 865]], "84": [[31, 33]], "85": [[2823, 2825]], "86": [[2879, 2881]], "9": [[754, 756], [874, 877], [1161, 1163], [1609, 1611], [1672, 1674], [2727, 2729]]}, "doc_id": "2594a77a3f0dd5073f79ba620e2f287804cec630", "method_subrelations": {"Regularized_Deep_Regressor": [[[0, 26], "Regularized_Deep_Regressor"]]}, "n_ary_relations": [{"Material": "UNBC-McMaster_ShoulderPain_dataset", "Method": "Regularized_Deep_Regressor", "Metric": "MAE", "Task": "Pain_Intensity_Regression", "score": "0.389"}], "ner": [[2, 6, "Method"], [7, 10, "Task"], [19, 23, "Task"], [31, 33, "Method"], [34, 37, "Task"], [53, 56, "Task"], [68, 70, "Task"], [96, 99, "Method"], [101, 104, "Method"], [125, 127, "Method"], [135, 137, "Task"], [140, 143, "Method"], [158, 165, "Material"], [178, 181, "Metric"], [187, 189, "Task"], [242, 244, "Task"], [245, 249, "Task"], [250, 252, "Task"], [296, 300, "Task"], [301, 302, "Method"], [303, 304, "Method"], [305, 306, "Method"], [328, 332, "Task"], [374, 381, "Task"], [399, 402, "Task"], [414, 416, "Method"], [452, 453, "Method"], [455, 457, "Method"], [458, 461, "Task"], [480, 482, "Metric"], [518, 520, "Task"], [521, 523, "Task"], [542, 546, "Method"], [547, 548, "Method"], [556, 558, "Method"], [559, 561, "Task"], [581, 582, "Material"], [583, 586, "Material"], [587, 590, "Material"], [593, 596, "Material"], [602, 604, "Task"], [687, 691, "Method"], [695, 698, "Task"], [709, 711, "Task"], [726, 729, "Method"], [734, 737, "Method"], [739, 745, "Method"], [746, 747, "Method"], [754, 756, "Method"], [789, 791, "Method"], [804, 808, "Task"], [863, 865, "Metric"], [874, 877, "Method"], [892, 894, "Metric"], [897, 899, "Task"], [928, 932, "Task"], [934, 938, "Material"], [940, 944, "Method"], [945, 946, "Method"], [948, 951, "Method"], [952, 953, "Method"], [957, 958, "Method"], [982, 985, "Task"], [995, 997, "Metric"], [1002, 1010, "Method"], [1017, 1021, "Method"], [1031, 1033, "Method"], [1034, 1038, "Method"], [1051, 1055, "Method"], [1056, 1058, "Task"], [1059, 1060, "Task"], [1062, 1065, "Task"], [1068, 1070, "Method"], [1072, 1074, "Method"], [1078, 1082, "Method"], [1085, 1087, "Task"], [1090, 1093, "Method"], [1094, 1095, "Method"], [1102, 1104, "Method"], [1129, 1132, "Method"], [1135, 1139, "Material"], [1149, 1151, "Method"], [1155, 1158, "Method"], [1161, 1163, "Method"], [1176, 1179, "Task"], [1204, 1208, "Method"], [1210, 1213, "Method"], [1232, 1235, "Task"], [1236, 1238, "Method"], [1249, 1250, "Method"], [1260, 1262, "Method"], [1288, 1290, "Method"], [1334, 1335, "Method"], [1349, 1352, "Metric"], [1360, 1362, "Task"], [1381, 1383, "Method"], [1394, 1397, "Metric"], [1398, 1399, "Metric"], [1433, 1436, "Method"], [1467, 1470, "Task"], [1500, 1502, "Method"], [1516, 1518, "Metric"], [1525, 1526, "Method"], [1539, 1544, "Metric"], [1552, 1554, "Metric"], [1584, 1585, "Metric"], [1597, 1600, "Metric"], [1601, 1602, "Metric"], [1607, 1608, "Task"], [1609, 1611, "Method"], [1622, 1626, "Material"], [1672, 1674, "Method"], [1753, 1756, "Method"], [1771, 1775, "Method"], [1812, 1813, "Method"], [1834, 1836, "Method"], [1843, 1845, "Method"], [1848, 1851, "Metric"], [1854, 1858, "Material"], [1899, 1904, "Metric"], [1907, 1909, "Metric"], [1910, 1911, "Metric"], [1916, 1917, "Method"], [1921, 1924, "Task"], [1929, 1930, "Metric"], [1935, 1936, "Metric"], [1946, 1947, "Metric"], [2038, 2040, "Method"], [2086, 2090, "Material"], [2104, 2107, "Task"], [2208, 2211, "Method"], [2214, 2218, "Material"], [2236, 2238, "Task"], [2243, 2246, "Method"], [2248, 2254, "Material"], [2261, 2263, "Method"], [2282, 2284, "Metric"], [2318, 2321, "Metric"], [2351, 2352, "Metric"], [2353, 2355, "Metric"], [2355, 2357, "Method"], [2363, 2368, "Task"], [2375, 2380, "Method"], [2384, 2388, "Material"], [2407, 2408, "Method"], [2480, 2482, "Metric"], [2487, 2489, "Metric"], [2490, 2492, "Metric"], [2495, 2496, "Method"], [2510, 2511, "Method"], [2512, 2513, "Method"], [2516, 2517, "Metric"], [2518, 2520, "Metric"], [2543, 2544, "Metric"], [2545, 2546, "Metric"], [2547, 2549, "Method"], [2586, 2587, "Method"], [2608, 2612, "Method"], [2619, 2621, "Metric"], [2645, 2647, "Metric"], [2664, 2668, "Method"], [2669, 2672, "Task"], [2683, 2685, "Task"], [2697, 2700, "Method"], [2701, 2704, "Task"], [2711, 2713, "Method"], [2719, 2722, "Task"], [2727, 2729, "Method"], [2731, 2732, "Method"], [2740, 2745, "Method"], [2753, 2760, "Material"], [2771, 2774, "Task"], [2799, 2802, "Task"], [2823, 2825, "Method"], [2844, 2848, "Task"], [2850, 2851, "Method"], [2852, 2855, "Method"], [2879, 2881, "Method"], [118, 119, "Method"], [748, 749, "Method"], [750, 751, "Method"], [1041, 1042, "Method"], [1115, 1116, "Method"], [1200, 1201, "Method"], [1241, 1244, "Metric"], [1245, 1246, "Metric"], [1284, 1285, "Metric"], [1386, 1387, "Method"], [1390, 1391, "Method"], [1411, 1412, "Method"], [1446, 1447, "Method"], [1512, 1513, "Metric"], [1580, 1581, "Metric"], [1790, 1791, "Method"], [1795, 1796, "Method"], [1914, 1915, "Metric"], [2328, 2329, "Method"], [2453, 2454, "Method"], [2747, 2748, "Method"], [2837, 2838, "Method"]], "sections": [[0, 306], [306, 916], [916, 1111], [1111, 1379], [1379, 1605], [1605, 1846], [1846, 2049], [2049, 2074], [2074, 2349], [2349, 2514], [2514, 2648], [2648, 2915], [2915, 3004], [3004, 3007]], "sentences": [[0, 10], [10, 24], [24, 51], [51, 76], [76, 111], [111, 138], [138, 177], [177, 194], [194, 201], [201, 203], [203, 229], [229, 235], [235, 267], [267, 276], [276, 284], [284, 296], [296, 306], [306, 309], [309, 333], [333, 363], [363, 430], [430, 451], [451, 462], [462, 502], [502, 518], [518, 550], [550, 591], [591, 610], [610, 641], [641, 656], [656, 660], [660, 676], [676, 716], [716, 775], [775, 779], [779, 809], [809, 823], [823, 916], [916, 920], [920, 940], [940, 955], [955, 972], [972, 981], [981, 1011], [1011, 1039], [1039, 1061], [1061, 1083], [1083, 1111], [1111, 1116], [1116, 1147], [1147, 1164], [1164, 1188], [1188, 1203], [1203, 1223], [1223, 1227], [1227, 1251], [1251, 1279], [1279, 1299], [1299, 1304], [1304, 1327], [1327, 1339], [1339, 1344], [1344, 1355], [1355, 1368], [1368, 1379], [1379, 1383], [1383, 1393], [1393, 1437], [1437, 1457], [1457, 1466], [1466, 1483], [1483, 1490], [1490, 1521], [1521, 1534], [1534, 1565], [1565, 1574], [1574, 1590], [1590, 1605], [1605, 1611], [1611, 1664], [1664, 1669], [1669, 1702], [1702, 1710], [1710, 1735], [1735, 1739], [1739, 1764], [1764, 1781], [1781, 1806], [1806, 1819], [1819, 1846], [1846, 1851], [1851, 1875], [1875, 1890], [1890, 1925], [1925, 1941], [1941, 1957], [1957, 1978], [1978, 1990], [1990, 2013], [2013, 2032], [2032, 2049], [2049, 2052], [2052, 2062], [2062, 2074], [2074, 2080], [2080, 2108], [2108, 2117], [2117, 2152], [2152, 2178], [2178, 2207], [2207, 2232], [2232, 2255], [2255, 2270], [2270, 2281], [2281, 2296], [2296, 2322], [2322, 2349], [2349, 2355], [2355, 2369], [2369, 2393], [2393, 2430], [2430, 2443], [2443, 2456], [2456, 2466], [2466, 2493], [2493, 2514], [2514, 2520], [2520, 2538], [2538, 2563], [2563, 2581], [2581, 2597], [2597, 2622], [2622, 2648], [2648, 2651], [2651, 2690], [2690, 2705], [2705, 2739], [2739, 2775], [2775, 2792], [2792, 2818], [2818, 2832], [2832, 2849], [2849, 2864], [2864, 2882], [2882, 2893], [2893, 2915], [2915, 2918], [2918, 2992], [2992, 3004], [3004, 3007]], "words": ["document", ":", "Regularizing", "Face", "Verification", "Nets", "For", "Pain", "Intensity", "Regression", "Limited", "labeled", "data", "are", "available", "for", "the", "research", "of", "estimating", "facial", "expression", "intensities", ".", "For", "instance", ",", "the", "ability", "to", "train", "deep", "networks", "for", "automated", "pain", "assessment", "is", "limited", "by", "small", "datasets", "with", "labels", "of", "patient", "-", "reported", "pain", "intensities", ".", "Fortunately", ",", "fine", "-", "tuning", "from", "a", "data", "-", "extensive", "pre", "-", "trained", "domain", ",", "such", "as", "face", "verification", ",", "can", "alleviate", "this", "problem", ".", "In", "this", "paper", ",", "we", "propose", "a", "network", "that", "fine", "-", "tunes", "a", "state", "-", "of", "-", "the", "-", "art", "face", "verification", "network", "using", "a", "regularized", "regression", "loss", "and", "additional", "data", "with", "expression", "labels", ".", "In", "this", "way", ",", "the", "expression", "intensity", "regression", "task", "can", "benefit", "from", "the", "rich", "feature", "representations", "trained", "on", "a", "huge", "amount", "of", "data", "for", "face", "verification", ".", "The", "proposed", "regularized", "deep", "regressor", "is", "applied", "to", "estimate", "the", "pain", "expression", "intensity", "and", "verified", "on", "the", "widely", "-", "used", "UNBC", "-", "McMaster", "Shoulder", "-", "Pain", "dataset", ",", "achieving", "the", "state", "-", "of", "-", "the", "-", "art", "performance", ".", "A", "weighted", "evaluation", "metric", "is", "also", "proposed", "to", "address", "the", "imbalance", "issue", "of", "different", "pain", "intensities", ".", "Feng", "Wang1", ",", "4", ",", "Xiang", "Xiang1\u2063", "*", "*", "Corresponding", "author", "(", "e", "-", "mail", ":", "xxiang@cs.jhu.edu", ")", ",", "Chang", "Liu1", ",", "5", ",", "Trac", "D.", "Tran2", ",", "Austin", "Reiter1", ",", "Gregory", "D.", "Hager1", ",", "Harry", "Quon3", ",", "Jian", "Cheng4", ",", "Alan", "L.", "Yuille1", "Dept", ".", "of", "{", "Computer", "Science", ",", "Electrical", "&", "Computer", "Engineering", ",", "Radiation", "Oncology", "}", "Johns", "Hopkins", "University", ",", "3400", "N.", "Charles", "St", ",", "Baltimore", ",", "MD", "21218", ",", "USA", "Dept", ".", "of", "EE", ",", "UESTC", ",", "2006", "Xiyuan", "Ave", ",", "Chengdu", ",", "Sichuan", "611731", ",", "China", "Dept", ".", "of", "CS", ",", "Tsinghua", "University", ",", "Beijing", "100084", ",", "China", "fine", "-", "tuning", ",", "CNN", ",", "regularizer", ",", "regression", "section", ":", "Introduction", "Obtaining", "accurate", "patient", "-", "reported", "pain", "intensities", "is", "important", "to", "effectively", "manage", "pain", "and", "thus", "reduce", "anesthetic", "doses", "and", "in", "-", "hospital", "deterioration", ".", "Traditionally", ",", "caregivers", "work", "with", "patients", "to", "manually", "input", "the", "patients", "\u2019", "pain", "intensity", ",", "ranging", "among", "a", "few", "levels", "such", "as", "mild", ",", "moderate", ",", "severe", "and", "excruciating", ".", "Recently", ",", "a", "couple", "of", "concepts", "have", "been", "proposed", "such", "as", "active", ",", "automated", "and", "objective", "pain", "monitoring", "over", "the", "patient", "\u2019s", "stay", "in", "hospital", ",", "with", "roughly", "the", "same", "motivation", ":", "first", "to", "simplify", "the", "pain", "reporting", "process", "and", "reduce", "the", "strain", "on", "manual", "efforts", ";", "second", "to", "standardize", "the", "feedback", "mechanism", "by", "ensuring", "a", "single", "metric", "that", "performs", "all", "assessments", "and", "thus", "reduces", "bias", ".", "There", "indeed", "exist", "efforts", "to", "assess", "pain", "from", "the", "observational", "or", "behavioral", "effect", "caused", "by", "pain", "such", "as", "physiological", "data", ".", "\u00a9", "Medasense", "has", "developed", "medical", "devices", "for", "objective", "pain", "monitoring", ".", "Their", "basic", "premise", "is", "that", "pain", "may", "cause", "vital", "signs", "such", "as", "blood", "pressure", ",", "pulse", "rate", ",", "respiration", "rate", ",", "SpO2", "from", "EMG", ",", "ECG", "or", "EEG", ",", "alone", "or", "in", "combination", "to", "change", "and", "often", "to", "increase", ".", "Nevertheless", ",", "it", "takes", "much", "more", "effort", "to", "obtain", "physiological", "data", "than", "videos", "of", "faces", ".", "Computer", "vision", "and", "supervised", "learning", "have", "come", "a", "long", "way", "in", "recent", "years", ",", "redefining", "the", "state", "-", "of", "-", "the", "-", "art", "using", "deep", "Convolutional", "Neural", "Networks", "(", "CNNs", ")", ".", "However", ",", "the", "ability", "to", "train", "deep", "CNNs", "for", "pain", "assessment", "is", "limited", "by", "small", "datasets", "with", "labels", "of", "patient", "-", "reported", "pain", "intensities", ",", "i.e.", ",", "annotated", "datasets", "such", "as", "EmoPain", ",", "Shoulder", "-", "Pain", ",", "BioVid", "Heat", "Pain", ".", "Particularly", ",", "Shoulder", "-", "Pain", "is", "the", "only", "dataset", "available", "for", "visual", "analysis", "with", "per", "-", "frame", "labels", ".", "It", "contains", "only", "200", "videos", "of", "25", "patients", "who", "suffer", "from", "shoulder", "pain", "and", "repeatedly", "raise", "their", "arms", "and", "then", "put", "them", "down", "(", "onset", "-", "apex", "-", "offset", ")", ".", "While", "all", "frames", "are", "labeled", "with", "discrete", "-", "valued", "pain", "intensities", "(", "see", "Fig", ".", "[", "reference", "]", ")", ",", "the", "dataset", "is", "small", ",", "the", "label", "is", "discrete", "and", "most", "labels", "are", "0", ".", "Although", "the", "small", "dataset", "problem", "prevents", "us", "from", "directly", "training", "a", "deep", "pain", "intensity", "regressor", ",", "we", "show", "that", "fine", "-", "tuning", "from", "a", "data", "-", "extensive", "pre", "-", "trained", "domain", "such", "as", "face", "verification", "can", "alleviate", "this", "problem", ".", "Our", "solutions", "are", "fine", "-", "tuning", "a", "well", "-", "trained", "face", "verification", "net", "on", "additional", "data", "with", "a", "regularized", "regression", "loss", "and", "a", "hidden", "full", "-", "connected", "layer", "regularized", "using", "dropout", ",", "regularizing", "the", "regression", "loss", "using", "a", "center", "loss", ",", "and", "re", "-", "sampling", "the", "training", "data", "by", "the", "population", "proportion", "of", "a", "certain", "pain", "intensity", "w.r.t", ".", "the", "total", "population", ".", "While", "our", "work", "is", "not", "the", "first", "attempt", "of", "this", "regularization", "idea", ",", "to", "our", "knowledge", "we", "are", "the", "first", "to", "apply", "it", "to", "the", "pain", "expression", "intensity", "estimation", ".", "Correspondingly", ",", "we", "propose", "three", "solutions", "to", "address", "the", "four", "issues", "mentioned", "above", ".", "In", "summary", ",", "the", "contributions", "of", "this", "work", "include", "addressing", "limited", "data", "with", "expression", "intensity", "labels", "by", "relating", "two", "mappings", "from", "the", "same", "input", "face", "space", "to", "different", "output", "label", "space", "where", "the", "identity", "labels", "are", "rich", ",", "pushing", "the", "pain", "assessment", "performance", "by", "a", "large", "margin", ",", "proposing", "to", "add", "center", "loss", "regularizer", "to", "make", "the", "regressed", "values", "closer", "to", "discrete", "values", ",", "and", "proposing", "a", "more", "sensible", "evaluation", "metric", "to", "address", "the", "imbalance", "issue", "caused", "by", "a", "natural", "phenomena", "where", "most", "of", "the", "time", "a", "patient", "does", "not", "express", "pain", ".", "section", ":", "Related", "Works", "Two", "pieces", "of", "recent", "work", "make", "progress", "in", "estimating", "pain", "intensity", "visually", "using", "the", "Shoulder", "-", "Pain", "dataset", "only", ":", "Ordinal", "Support", "Vector", "Regression", "(", "OSVR", ")", "and", "Recurrent", "Convolutional", "Regression", "(", "RCR", ")", ".", "Notably", ",", "RCR", "is", "trained", "end", "-", "to", "-", "end", "yet", "achieving", "sub", "-", "optimal", "performance", ".", "Please", "see", "reference", "therein", "for", "other", "existing", "works", ".", "For", "facial", "expression", "recognition", "in", "general", ",", "there", "is", "a", "trade", "-", "off", "between", "method", "simplicity", "and", "performance", ",", "i.e.", ",", "image", "-", "based", "vs.", "video", "-", "based", "methods", ".", "As", "videos", "are", "sequential", "signals", ",", "appearance", "-", "based", "methods", "including", "ours", "can", "not", "model", "the", "dynamics", "given", "by", "a", "temporal", "model", "or", "spatio", "-", "temporal", "models", ".", "As", "regards", "regularizing", "deep", "networks", ",", "there", "exists", "recent", "work", "that", "regularize", "deep", "face", "recognition", "nets", "for", "expression", "classification", "-", "FaceNet2ExpNet", ".", "During", "pre", "-", "training", ",", "they", "train", "convolutional", "layers", "of", "the", "expression", "net", ",", "regularized", "by", "the", "deep", "face", "recognition", "net", ".", "In", "the", "refining", "stage", ",", "they", "append", "fully", "-", "connected", "(", "FC", ")", "layers", "to", "the", "pre", "-", "trained", "convolutional", "layers", "and", "train", "the", "whole", "network", "jointly", ".", "section", ":", "Regularized", "deep", "regressor", "Our", "network", "is", "based", "on", "a", "state", "-", "of", "-", "the", "-", "art", "face", "verification", "network", "trained", "using", "the", "CASIA", "-", "WebFace", "dataset", "contaning", "million", "face", "images", "with", "identity", "labels", ".", "As", "a", "classification", "network", ",", "it", "employs", "the", "Softmax", "loss", "regularized", "with", "its", "proposed", "center", "loss", ".", "But", "it", "is", "difficult", "to", "directly", "fine", "-", "tune", "the", "network", "for", "pain", "intensity", "classification", "due", "to", "limited", "face", "images", "with", "pain", "labels", ".", "However", ",", "it", "is", "feasible", "to", "fit", "the", "data", "points", "as", "a", "regression", "problem", ".", "Our", "fine", "-", "tuning", "network", "employs", "a", "regression", "loss", "regularized", "with", "the", "center", "loss", ",", "as", "shown", "in", "Fig", ".", "[", "reference", "]", ".", "First", ",", "we", "modify", "the", "face", "verification", "net", "\u2019s", "softmax", "loss", "to", "be", "a", "Mean", "Square", "Error", "(", "MSE", ")", "loss", "for", "regression", ".", "The", "last", "layer", "of", "such", "a", "network", "is", "a", "distance", "layer", ",", "which", "easily", "causes", "gradient", "exploding", "due", "to", "large", "magnitudes", "of", "the", "gradients", "at", "initial", "iterations", ".", "Thus", ",", "we", "replace", "the", "MSE", "loss", "using", "a", "smooth", "loss", "with", "a", "Huber", "loss", "flavor", "(", "see", "Sec", ".", "[", "reference", "]", ")", ".", "Secondly", ",", "as", "labels", "are", "discrete", ",", "it", "is", "sensible", "to", "regularize", "the", "loss", "to", "make", "the", "regressed", "values", "to", "be", "more", "\u00e2\u0080\u0098discrete\u00e2\u0080\u0099.", "We", "introduce", "the", "center", "loss", "as", "a", "regularizer", "(", "see", "Sec", ".", "[", "reference", "]", ")", ".", "Thirdly", ",", "we", "propose", "two", "weighted", "evaluation", "metrics", "in", "Sec", ".", "[", "reference", "]", "to", "address", "label", "imbalance", "which", "may", "induce", "trivial", "method", ".", "In", "the", "following", ",", "we", "elaborate", "on", "the", "three", "solutions", ".", "subsection", ":", "Regression", "Loss", "Similar", "to", "conventional", "regression", "models", ",", "a", "regression", "net", "minimizes", "the", "Mean", "Square", "Error", "(", "MSE", ")", "loss", "defined", "as", "where", "is", "the", "output", "vector", "of", "the", "hidden", "FC", "layer", ",", "is", "a", "vector", "of", "real", "-", "valued", "weights", ",", "is", "the", "ground", "-", "truth", "label", ",", "and", "is", "a", "sigmoid", "activation", "function", ".", "We", "use", "to", "truncate", "the", "output", "of", "the", "second", "FC", "layer", "to", "be", "in", "the", "range", "of", "pain", "intensity", ".", "Here", "we", "omitted", "the", "bias", "term", "for", "elegance", ".", "The", "gradient", "exploding", "problem", "often", "happens", "due", "to", "the", "relatively", "large", "gradient", "magnitude", "during", "initial", "iterations", ".", "This", "phenomenon", "is", "also", "described", "in", ".", "To", "solve", "this", "problem", ",", "we", "follow", "to", "apply", "the", "smooth", "loss", "which", "makes", "the", "gradient", "smaller", "than", "the", "case", "with", "the", "MSE", "loss", "when", "the", "absolute", "error", "is", "large", ".", "Different", "from", ",", "our", "regressor", "outputs", "a", "scalar", "instead", "of", "a", "vector", ".", "It", "is", "a", "compromise", "between", "squared", "and", "absolute", "error", "losses", ":", "where", "is", "the", "turning", "point", "of", "the", "absolute", "error", "between", "the", "squared", "error", "function", "and", "the", "absolute", "error", "function", ".", "It", "has", "a", "flavor", "with", "the", "Huber", "loss", ".", "When", ",", "it", "works", "similar", "with", "MSE", "loss", "since", "the", "error", "is", "usually", "below", "1", ".", "When", ",", "it", "is", "equivalent", "with", "the", "Mean", "Abosolute", "Error", "(", "MAE", ")", "loss", ".", "subsection", ":", "Regularization", "Using", "Center", "Loss", "Since", "the", "pain", "intensity", "is", "labeled", "as", "discrete", "values", "in", "the", "Shoulder", "-", "Pain", "dataset", ",", "it", "is", "natural", "to", "regularize", "the", "network", "to", "make", "the", "regressed", "values", "to", "be", "\u2018", "discrete", "\u2019", "-", "during", "training", ",", "to", "make", "same", "-", "intensity", "\u2019s", "regressed", "values", "as", "compact", "as", "possible", "(", "see", "Fig", ".", "[", "reference", "]", ")", ".", "We", "use", "the", "center", "loss", "which", "minimizes", "the", "within", "-", "class", "distance", "and", "thus", "is", "defined", "as", "where", "represents", "the", "center", "for", "class", "and", "is", "essentially", "the", "mean", "of", "features", "per", "class", ".", "denotes", "the", "norm", "and", "is", "typically", "or", ".", "We", "observe", "from", "expriments", "that", "the", "center", "loss", "shrinks", "the", "distances", "of", "features", "that", "have", "the", "same", "label", ",", "which", "is", "illustrated", "in", "Fig", ".", "[", "reference", "]", ".", "To", "relate", "it", "with", "the", "literature", ",", "it", "is", "a", "similar", "idea", "to", "the", "Linear", "Discriminant", "Analysis", "yet", "without", "minimizing", "between", "-", "class", "distances", ".", "It", "also", "has", "a", "flavor", "of", "the", "k", "-", "means", "clustering", "yet", "in", "a", "supervised", "way", ".", "Now", ",", "the", "center", "loss", "is", "added", "to", "the", "regression", "loss", "after", "the", "hidden", "FC", "layer", "to", "induce", "the", "loss", "where", "is", "a", "coefficient", ".", "Thus", ",", "the", "supervision", "of", "the", "regularizer", "is", "applied", "to", "the", "features", ".", "Different", "from", ",", "we", "jointly", "learn", "the", "centers", "and", "minimize", "within", "-", "class", "distances", "by", "gradient", "descent", ",", "while", "\u2019s", "centers", "are", "learned", "by", "moving", "average", ".", "subsection", ":", "Weighted", "Evaluation", "Metrics", "Labels", "in", "the", "Shoulder", "-", "Pain", "dataset", "are", "highly", "imbalanced", ",", "as", "91.35", "%", "of", "the", "frames", "are", "labeled", "as", "pain", "intensity", "0", ".", "Thus", ",", "it", "is", "relatively", "safe", "to", "predict", "the", "pain", "intensity", "to", "be", "zero", ".", "To", "fairly", "evaluate", "the", "performance", ",", "we", "propose", "the", "weighted", "version", "of", "evaluation", "metrics", ",", "i.e.", ",", "weighted", "MAE", "(", "wMAE", ")", "and", "weighted", "MSE", "(", "wMSE", ")", "to", "address", "the", "dataset", "imbalance", "issue", ".", "For", "example", ",", "the", "wMAE", "is", "simply", "the", "mean", "of", "MAE", "on", "each", "pain", "intensity", ".", "In", "this", "way", ",", "the", "MAE", "is", "weighted", "by", "the", "population", "of", "each", "pain", "intensity", ".", "We", "apply", "two", "techniques", "to", "sample", "the", "training", "data", "to", "make", "our", "training", "set", "more", "consistent", "with", "the", "new", "metrics", ".", "First", ",", "we", "eliminate", "the", "redundant", "frames", "on", "the", "sequences", "following", ".", "If", "the", "intensity", "remains", "the", "same", "for", "more", "than", "5", "consecutive", "frames", ",", "we", "choose", "the", "first", "one", "as", "the", "representative", "frame", ".", "Second", ",", "during", "training", ",", "we", "uniformly", "sample", "images", "from", "the", "6", "classes", "to", "feed", "into", "the", "network", ".", "In", "this", "way", ",", "what", "the", "neural", "network", "\u2018", "see", "\u2019", "is", "a", "totally", "balanced", "dataset", ".", "section", ":", "Experiments", "In", "this", "section", ",", "we", "present", "implementations", "and", "experiments", ".", "The", "project", "page", "has", "been", "set", "up", "with", "programs", "and", "data", ".", "subsection", ":", "Dataset", "and", "Training", "Details", "We", "test", "our", "network", "on", "the", "Shoulder", "-", "Pain", "dataset", "that", "contains", "200", "videos", "of", "25", "subjects", "and", "is", "widely", "used", "for", "benchmarking", "the", "pain", "intensity", "estimation", ".", "The", "dataset", "comes", "with", "four", "types", "of", "labels", ".", "The", "three", "annotated", "online", "during", "the", "video", "collection", "are", "the", "sensory", "scale", ",", "affective", "scale", "and", "visual", "analog", "scale", "ranging", "from", "(", "i.e.", ",", "no", "pain", ")", "to", "(", "i.e.", ",", "severe", "pain", ")", ".", "In", "addition", ",", "observers", "rated", "pain", "intensity", "(", "OPI", ")", "offline", "from", "recorded", "videos", "ranging", "from", "(", "no", "pain", ")", "to", "(", "severe", "pain", ")", ".", "In", "the", "same", "way", "as", "previous", "works", ",", "we", "take", "the", "same", "online", "label", "and", "quantify", "the", "original", "pain", "intensity", "in", "the", "range", "of", "to", "be", "in", "range", ".", "The", "face", "verification", "network", "is", "trained", "on", "CASIA", "-", "WebFace", "dataset", ",", "which", "contains", "494", ",", "414", "training", "images", "from", "10", ",", "575", "identities", ".", "To", "be", "consistent", "with", "face", "verification", ",", "we", "perform", "the", "same", "pre", "-", "processing", "on", "the", "images", "of", "Shoulder", "-", "Pain", "dataset", ".", "To", "be", "specific", ",", "we", "leverage", "MTCNN", "model", "to", "detect", "faces", "and", "facial", "landmarks", ".", "Then", "the", "faces", "are", "aligned", "according", "to", "the", "detected", "landmarks", ".", "The", "learning", "rate", "is", "set", "to", "to", "avoid", "huge", "modification", "on", "the", "convolution", "layers", ".", "The", "network", "is", "trained", "over", "5", ",", "000", "iterations", ",", "which", "is", "reasonable", "for", "the", "networks", "to", "converge", "observed", "in", "a", "few", "cross", "validation", "folds", ".", "We", "set", "the", "weight", "of", "the", "regression", "loss", "to", "be", "1", "and", "the", "weights", "of", "softmax", "loss", "and", "center", "loss", "to", "be", "1", "and", "0.01", "respectively", ".", "subsection", ":", "Evaluation", "Using", "Unweighted", "Metrics", "Cross", "validation", "is", "a", "conventional", "way", "to", "address", "over", "-", "fitting", "small", "dataset", ".", "In", "our", "case", ",", "we", "run", "25", "-", "fold", "cross", "validation", "25", "times", "on", "the", "Shoulder", "-", "Pain", "dataset", "which", "contains", "25", "subjects", ".", "This", "setting", "is", "exactly", "the", "leave", "-", "one", "-", "subject", "-", "out", "setting", "in", "OSVR", "except", "that", "OSVR", "\u2019s", "experiments", "exclude", "one", "subject", "whose", "expressions", "do", "not", "have", "noticeable", "pain", "(", "namely", "24", "-", "fold", ")", ".", "Each", "time", ",", "the", "videos", "of", "one", "subject", "are", "reserved", "for", "testing", ".", "All", "the", "other", "videos", "are", "used", "to", "train", "the", "deep", "regression", "network", ".", "The", "performance", "is", "summarized", "in", "Table", "[", "reference", "]", ".", "It", "can", "be", "concluded", "that", "our", "algorithm", "performs", "best", "or", "equally", "best", "on", "various", "evaluation", "metrics", ",", "especially", "the", "combination", "of", "smooth", "loss", "and", "center", "loss", ".", "Note", "that", "OSVR", "uses", "hand", "-", "crafted", "features", "concatenated", "from", "landmark", "points", ",", "Gabor", "wavelet", "coefficients", "and", "LBP", "+", "PCA", ".", "subsection", ":", "Evaluation", "Using", "Weighted", "Metrics", "In", "Table", "[", "reference", "]", ",", "we", "provide", "the", "performance", "of", "predicting", "all", "zeros", "as", "a", "baseline", ".", "Interestingly", ",", "on", "the", "metrics", "MAE", "and", "MSE", ",", "zero", "prediction", "performs", "much", "better", "than", "several", "state", "-", "of", "-", "the", "-", "art", "algorithms", ".", "Now", ",", "using", "the", "new", "proposed", "metrics", ",", "the", "performance", "is", "summarized", "in", "Table", "[", "reference", "]", ".", "The", "performance", "of", "previous", "work", "OSVR", "is", "no", "longer", "below", "that", "of", "predicting", "all", "zeros", ".", "We", "can", "also", "see", "from", "Table", "[", "reference", "]", "that", "the", "uniform", "class", "sampling", "strategy", "does", "help", "a", "lot", "on", "the", "new", "evaluation", "metrics", ".", "Moreover", ",", "we", "have", "provided", "the", "evaluation", "program", "in", "our", "project", "page", "and", "encourage", "future", "works", "to", "report", "their", "performance", "with", "the", "new", "evaluation", "metrics", ".", "section", ":", "Summary", "Given", "the", "restriction", "of", "labeled", "data", "which", "prevents", "us", "from", "directly", "training", "a", "deep", "pain", "intensity", "regressor", ",", "fine", "-", "tuning", "from", "a", "data", "-", "extensive", "pre", "-", "trained", "domain", "such", "as", "face", "verification", "can", "alleviate", "the", "problem", ".", "In", "this", "paper", ",", "we", "regularize", "a", "face", "verification", "network", "for", "pain", "intensity", "regression", ".", "In", "particular", ",", "we", "introduce", "the", "Smooth", "Loss", "to", "(", "continuous", "-", "valued", ")", "pain", "intensity", "regression", "as", "well", "as", "introduce", "the", "center", "loss", "as", "a", "regularizer", "to", "induce", "concentration", "on", "discrete", "values", ".", "The", "fine", "-", "tuned", "regularizered", "network", "with", "a", "regression", "layer", "is", "tested", "on", "the", "UNBC", "-", "McMaster", "Shoulder", "-", "Pain", "dataset", "and", "achieves", "state", "-", "of", "-", "the", "-", "art", "performance", "on", "pain", "intensity", "estimation", ".", "The", "main", "problem", "that", "motivates", "this", "work", "is", "that", "expertise", "is", "needed", "to", "label", "the", "pain", ".", "The", "take", "-", "home", "message", "is", "that", "fine", "-", "tuning", "from", "a", "data", "-", "extensive", "pre", "-", "trained", "domain", "can", "alleviate", "small", "training", "set", "problems", ".", "On", "the", "other", "hand", ",", "unsupervised", "learning", "does", "not", "rely", "on", "training", "data", ".", "Indeed", ",", "discrete", "-", "valued", "regression", "is", "a", "good", "test", "bed", "for", "center", "-", "based", "clustering", ".", "Although", "regularizing", "a", "supervised", "deep", "network", "is", "intuitive", ",", "its", "performance", "is", "rather", "empirical", ".", "In", "the", "future", ",", "we", "need", "insights", "about", "when", "and", "why", "it", "may", "function", "as", "transfer", "learning", ".", "Note", "that", "no", "temporal", "information", "is", "modeled", "in", "this", "paper", ".", "As", "pain", "is", "temporal", "and", "subjective", ",", "prior", "knowledge", "about", "the", "stimulus", "needs", "to", "be", "incorporated", "to", "help", "quantify", "individual", "differences", ".", "section", ":", "ACKNOWLEDGMENT", "When", "performing", "this", "work", ",", "Xiang", "Xiang", "is", "funded", "by", "JHU", "CS", "Dept", "\u2019s", "teaching", "assistantship", ",", "Feng", "Wang", "&", "Alan", "Yuille", "are", "supported", "by", "the", "Office", "of", "Naval", "Research", "(", "ONR", "N00014", "-", "15", "-", "1", "-", "2356", ")", ",", "Feng", "&", "Jian", "Chen", "are", "supported", "by", "the", "National", "Natural", "Science", "Foundation", "of", "China", "(", "61671125", ",", "61201271", ")", ",", "and", "Feng", "is", "also", "funded", "by", "China", "Scholarship", "Council", "(", "CSC", ")", ".", "Xiang", "is", "grateful", "for", "a", "fellowship", "from", "CSC", "in", "previous", "years", ".", "bibliography", ":", "References"]}