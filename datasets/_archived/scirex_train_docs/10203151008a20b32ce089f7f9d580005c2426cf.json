{"coref": {"Accuracy": [[473, 475], [1054, 1055]], "Image_Retrieval": [[2, 5], [76, 78], [149, 151], [159, 161], [360, 362], [489, 491], [755, 757], [1049, 1051], [1056, 1057], [1263, 1265], [1605, 1607], [2428, 2430], [2957, 2961], [3922, 3924], [5082, 5084], [795, 797]], "MAP": [[3722, 3725], [3726, 3727], [3801, 3802], [4766, 4767]], "Oxf105k": [[996, 998], [3745, 3747], [3810, 3811], [4643, 4644], [4727, 4728], [4756, 4757], [4805, 4806], [4903, 4904]], "Oxf5k": [[996, 998], [3417, 3418], [3745, 3747], [3810, 3811], [4276, 4277], [4687, 4688], [4727, 4728], [4756, 4757], [4805, 4806], [4903, 4904], [5055, 5056]], "Par106k": [[999, 1001], [3748, 3749], [3812, 3813], [4729, 4730], [4758, 4759], [4807, 4808], [4901, 4902]], "Par6k": [[999, 1001], [3419, 3420], [3748, 3749], [3812, 3813], [4689, 4690], [4729, 4730], [4758, 4759], [4807, 4808], [4901, 4902], [5064, 5065]], "QE_": [[217, 219], [4992, 4994], [5158, 5160]], "siaMAC": [], "siaMAC_QE_": []}, "coref_non_salient": {"0": [[552, 554], [3738, 3740]], "1": [[239, 242], [279, 282], [1512, 1514]], "10": [[272, 274], [915, 916], [1527, 1528], [1844, 1845], [1869, 1870], [2908, 2910], [3833, 3834]], "100": [[2122, 2123]], "101": [[1079, 1081]], "102": [[938, 940]], "103": [[2248, 2250]], "104": [[2610, 2613]], "105": [[1292, 1300]], "106": [[3730, 3732]], "107": [[190, 195]], "108": [[251, 253]], "109": [[1126, 1128]], "11": [[3907, 3911], [4310, 4313]], "110": [[1352, 1356]], "111": [[322, 323]], "112": [[260, 261]], "113": [[2226, 2228]], "114": [[1193, 1202]], "115": [[4665, 4668]], "116": [[16, 19], [268, 271]], "117": [[1977, 1980]], "118": [[4816, 4817]], "119": [[1723, 1725]], "12": [[2534, 2535], [3366, 3368]], "120": [[1884, 1887]], "121": [[3657, 3659]], "122": [[2203, 2206]], "13": [[3472, 3473], [3516, 3518]], "14": [[850, 854], [2969, 2971]], "15": [[345, 347], [421, 425]], "16": [[1593, 1597], [1680, 1684]], "17": [[2143, 2145], [2173, 2175], [4570, 4572]], "18": [[770, 771], [4241, 4245]], "19": [[388, 391], [1874, 1876], [1926, 1928], [1933, 1935], [3648, 3650]], "2": [[495, 497], [602, 604], [1149, 1150], [1401, 1403], [1538, 1544], [3926, 3927], [4457, 4458], [4507, 4513]], "20": [[1837, 1840], [4419, 4423], [4874, 4878], [5017, 5020], [5172, 5176]], "21": [[246, 248], [835, 837]], "22": [[113, 115], [701, 703], [2199, 2201], [2518, 2520], [2529, 2531], [2557, 2559], [2604, 2606], [3388, 3391], [3398, 3400], [3623, 3625], [4100, 4102], [4167, 4169]], "23": [[336, 339], [406, 408], [1043, 1045]], "24": [[4340, 4341], [4364, 4365], [4391, 4392]], "25": [[934, 936], [954, 955], [4287, 4288], [4320, 4321]], "26": [[214, 216], [643, 645], [825, 827], [2387, 2390]], "27": [[2165, 2166], [2252, 2253], [4230, 4231], [4264, 4265], [4327, 4328], [4383, 4384], [4516, 4517], [4579, 4580], [4611, 4612]], "28": [[20, 21], [287, 288], [1007, 1008], [1064, 1065], [1900, 1901]], "29": [[482, 483], [1072, 1074], [1357, 1359], [1902, 1903]], "3": [[858, 861], [1685, 1686], [1995, 1996], [4406, 4407], [4440, 4441], [4498, 4499], [4622, 4623], [4814, 4815], [4867, 4868], [1773, 1774], [1808, 1809], [1939, 1940], [1943, 1944], [1956, 1957], [2082, 2083], [2157, 2158], [2281, 2282], [2805, 2806], [2814, 2815], [4427, 4428], [4956, 4957], [4960, 4961], [5046, 5047]], "30": [[4944, 4945], [5011, 5012], [5021, 5022], [5059, 5060], [5068, 5069]], "31": [[1504, 1506], [4041, 4043]], "32": [[839, 841], [5003, 5005]], "33": [[924, 926], [1521, 1523], [1582, 1584], [1676, 1678], [1770, 1772], [4486, 4488]], "34": [[762, 764], [788, 790], [1313, 1315], [1409, 1411], [5092, 5096]], "35": [[735, 737], [2369, 2371]], "36": [[399, 400], [4669, 4670]], "37": [[152, 154], [993, 995]], "38": [[4929, 4931]], "39": [[7, 8], [196, 197], [2385, 2386], [2432, 2433]], "4": [[500, 504], [1449, 1451], [1484, 1486], [1546, 1548], [2006, 2008], [4402, 4404]], "40": [[1011, 1012], [1906, 1907], [3651, 3652]], "41": [[1453, 1455], [1488, 1490], [2062, 2064], [3999, 4001]], "42": [[2118, 2121]], "43": [[4963, 4965]], "44": [[3878, 3881]], "45": [[4270, 4272]], "46": [[1509, 1511], [1532, 1534], [2872, 2873]], "47": [[2141, 2142], [2171, 2172]], "48": [[4861, 4863]], "49": [[4370, 4371]], "5": [[1023, 1026], [1587, 1589], [4856, 4859]], "50": [[2011, 2014]], "51": [[4636, 4642]], "52": [[108, 109], [695, 696], [2469, 2470], [705, 706], [889, 890], [2327, 2328], [2455, 2456], [3380, 3381]], "53": [[1858, 1862]], "54": [[4290, 4292]], "55": [[2422, 2424]], "56": [[3604, 3607]], "57": [[102, 107], [689, 694]], "58": [[4359, 4363], [4395, 4400]], "59": [[1428, 1430], [1467, 1469], [3980, 3982]], "6": [[56, 59], [128, 132], [436, 439], [446, 449], [531, 534], [966, 969], [1169, 1172], [1258, 1262], [1556, 1559], [1888, 1892], [3633, 3636], [4090, 4093], [5076, 5081]], "60": [[4453, 4456], [4478, 4481], [4518, 4521], [4869, 4872]], "61": [[1692, 1695], [4273, 4275]], "62": [[45, 47], [332, 334]], "63": [[629, 632]], "64": [[4085, 4087]], "65": [[257, 259]], "66": [[3123, 3125]], "67": [[4226, 4229]], "68": [[4559, 4560]], "69": [[33, 36]], "7": [[100, 101], [199, 201], [818, 820], [2372, 2374]], "70": [[1727, 1730]], "71": [[1919, 1921]], "72": [[1013, 1014], [1908, 1909], [3653, 3654], [4387, 4388]], "73": [[377, 379]], "74": [[312, 313]], "75": [[2955, 2956], [4966, 4969]], "76": [[671, 674]], "77": [[2367, 2368]], "78": [[1798, 1800]], "79": [[4575, 4577]], "8": [[1731, 1732], [2398, 2400]], "80": [[5052, 5054]], "81": [[3954, 3958]], "82": [[5155, 5157]], "83": [[778, 780]], "84": [[3555, 3558]], "85": [[1575, 1579]], "86": [[443, 445]], "87": [[1272, 1275]], "88": [[2600, 2603]], "89": [[1787, 1789]], "9": [[74, 75], [804, 805], [1242, 1246], [3896, 3897], [3931, 3937]], "90": [[2418, 2421]], "91": [[2472, 2474]], "92": [[177, 178]], "93": [[229, 232]], "94": [[1061, 1063]], "95": [[380, 381]], "96": [[9, 13], [748, 754]], "97": [[1217, 1218]], "98": [[3393, 3395]], "99": [[1333, 1336]]}, "doc_id": "10203151008a20b32ce089f7f9d580005c2426cf", "method_subrelations": {"siaMAC_QE_": [[[0, 6], "siaMAC"], [[7, 10], "QE_"]]}, "n_ary_relations": [{"Material": "Oxf105k", "Method": "siaMAC_QE_", "Metric": "MAP", "Task": "Image_Retrieval", "score": "77.9%"}, {"Material": "Oxf5k", "Method": "siaMAC_QE_", "Metric": "MAP", "Task": "Image_Retrieval", "score": "82.9%"}, {"Material": "Par106k", "Method": "siaMAC_QE_", "Metric": "Accuracy", "Task": "Image_Retrieval", "score": "78.3%"}, {"Material": "Par6k", "Method": "siaMAC_QE_", "Metric": "Accuracy", "Task": "Image_Retrieval", "score": "85.6%"}], "ner": [[2, 5, "Task"], [7, 8, "Method"], [9, 13, "Task"], [16, 19, "Method"], [20, 21, "Method"], [33, 36, "Task"], [45, 47, "Task"], [56, 59, "Task"], [74, 75, "Method"], [76, 78, "Task"], [100, 101, "Method"], [102, 107, "Method"], [108, 109, "Method"], [113, 115, "Method"], [128, 132, "Task"], [149, 151, "Task"], [152, 154, "Method"], [159, 161, "Task"], [177, 178, "Method"], [190, 195, "Method"], [196, 197, "Method"], [199, 201, "Method"], [214, 216, "Task"], [217, 219, "Method"], [229, 232, "Task"], [239, 242, "Task"], [246, 248, "Metric"], [251, 253, "Metric"], [257, 259, "Method"], [260, 261, "Method"], [268, 271, "Method"], [272, 274, "Method"], [279, 282, "Task"], [287, 288, "Method"], [312, 313, "Method"], [322, 323, "Task"], [332, 334, "Task"], [336, 339, "Method"], [345, 347, "Method"], [360, 362, "Task"], [377, 379, "Method"], [380, 381, "Method"], [388, 391, "Method"], [399, 400, "Task"], [406, 408, "Method"], [421, 425, "Method"], [436, 439, "Task"], [443, 445, "Metric"], [446, 449, "Task"], [473, 475, "Metric"], [482, 483, "Task"], [489, 491, "Task"], [495, 497, "Task"], [500, 504, "Method"], [531, 534, "Task"], [552, 554, "Metric"], [602, 604, "Task"], [629, 632, "Method"], [643, 645, "Task"], [671, 674, "Method"], [689, 694, "Method"], [695, 696, "Method"], [701, 703, "Method"], [735, 737, "Task"], [748, 754, "Task"], [755, 757, "Task"], [762, 764, "Method"], [770, 771, "Task"], [778, 780, "Method"], [788, 790, "Method"], [804, 805, "Method"], [818, 820, "Method"], [825, 827, "Task"], [835, 837, "Metric"], [839, 841, "Metric"], [850, 854, "Method"], [858, 861, "Method"], [915, 916, "Method"], [924, 926, "Method"], [934, 936, "Method"], [938, 940, "Task"], [954, 955, "Method"], [966, 969, "Task"], [993, 995, "Method"], [996, 998, "Material"], [999, 1001, "Material"], [1007, 1008, "Method"], [1011, 1012, "Method"], [1013, 1014, "Method"], [1023, 1026, "Method"], [1043, 1045, "Method"], [1049, 1051, "Task"], [1054, 1055, "Metric"], [1056, 1057, "Task"], [1061, 1063, "Method"], [1064, 1065, "Method"], [1072, 1074, "Task"], [1079, 1081, "Metric"], [1126, 1128, "Metric"], [1149, 1150, "Task"], [1169, 1172, "Task"], [1193, 1202, "Task"], [1217, 1218, "Task"], [1242, 1246, "Method"], [1258, 1262, "Task"], [1263, 1265, "Task"], [1272, 1275, "Task"], [1292, 1300, "Task"], [1313, 1315, "Method"], [1333, 1336, "Task"], [1352, 1356, "Task"], [1357, 1359, "Task"], [1401, 1403, "Task"], [1409, 1411, "Method"], [1428, 1430, "Method"], [1449, 1451, "Method"], [1453, 1455, "Method"], [1467, 1469, "Method"], [1484, 1486, "Method"], [1488, 1490, "Method"], [1504, 1506, "Metric"], [1509, 1511, "Method"], [1512, 1514, "Task"], [1521, 1523, "Method"], [1527, 1528, "Method"], [1532, 1534, "Method"], [1538, 1544, "Task"], [1546, 1548, "Method"], [1556, 1559, "Task"], [1575, 1579, "Task"], [1582, 1584, "Method"], [1587, 1589, "Method"], [1593, 1597, "Method"], [1605, 1607, "Task"], [1676, 1678, "Method"], [1680, 1684, "Method"], [1685, 1686, "Method"], [1692, 1695, "Method"], [1723, 1725, "Method"], [1727, 1730, "Method"], [1731, 1732, "Method"], [1770, 1772, "Method"], [1787, 1789, "Method"], [1798, 1800, "Task"], [1837, 1840, "Method"], [1844, 1845, "Method"], [1858, 1862, "Method"], [1869, 1870, "Method"], [1874, 1876, "Method"], [1884, 1887, "Task"], [1888, 1892, "Task"], [1900, 1901, "Method"], [1902, 1903, "Task"], [1906, 1907, "Method"], [1908, 1909, "Method"], [1919, 1921, "Method"], [1926, 1928, "Method"], [1933, 1935, "Method"], [1977, 1980, "Method"], [1995, 1996, "Method"], [2006, 2008, "Method"], [2011, 2014, "Method"], [2062, 2064, "Method"], [2118, 2121, "Method"], [2122, 2123, "Method"], [2141, 2142, "Task"], [2143, 2145, "Task"], [2165, 2166, "Method"], [2171, 2172, "Task"], [2173, 2175, "Task"], [2199, 2201, "Method"], [2203, 2206, "Method"], [2226, 2228, "Method"], [2248, 2250, "Method"], [2252, 2253, "Method"], [2367, 2368, "Task"], [2369, 2371, "Task"], [2372, 2374, "Method"], [2385, 2386, "Method"], [2387, 2390, "Task"], [2398, 2400, "Method"], [2418, 2421, "Method"], [2422, 2424, "Method"], [2428, 2430, "Task"], [2432, 2433, "Method"], [2469, 2470, "Method"], [2472, 2474, "Method"], [2518, 2520, "Method"], [2529, 2531, "Method"], [2534, 2535, "Method"], [2557, 2559, "Method"], [2600, 2603, "Task"], [2604, 2606, "Method"], [2610, 2613, "Method"], [2872, 2873, "Method"], [2908, 2910, "Method"], [2955, 2956, "Task"], [2957, 2961, "Task"], [2969, 2971, "Method"], [3123, 3125, "Method"], [3366, 3368, "Method"], [3388, 3391, "Method"], [3393, 3395, "Method"], [3398, 3400, "Method"], [3417, 3418, "Material"], [3419, 3420, "Material"], [3472, 3473, "Task"], [3516, 3518, "Task"], [3555, 3558, "Metric"], [3604, 3607, "Task"], [3623, 3625, "Method"], [3633, 3636, "Task"], [3648, 3650, "Method"], [3651, 3652, "Method"], [3653, 3654, "Method"], [3657, 3659, "Metric"], [3722, 3725, "Metric"], [3726, 3727, "Metric"], [3730, 3732, "Metric"], [3738, 3740, "Metric"], [3745, 3747, "Material"], [3748, 3749, "Material"], [3801, 3802, "Metric"], [3810, 3811, "Material"], [3812, 3813, "Material"], [3833, 3834, "Method"], [3878, 3881, "Method"], [3896, 3897, "Method"], [3907, 3911, "Method"], [3922, 3924, "Task"], [3926, 3927, "Task"], [3931, 3937, "Method"], [3954, 3958, "Task"], [3980, 3982, "Method"], [3999, 4001, "Method"], [4041, 4043, "Metric"], [4085, 4087, "Metric"], [4090, 4093, "Task"], [4100, 4102, "Method"], [4167, 4169, "Method"], [4226, 4229, "Method"], [4230, 4231, "Method"], [4241, 4245, "Task"], [4264, 4265, "Method"], [4270, 4272, "Method"], [4273, 4275, "Method"], [4276, 4277, "Material"], [4287, 4288, "Method"], [4290, 4292, "Method"], [4310, 4313, "Method"], [4320, 4321, "Method"], [4327, 4328, "Method"], [4340, 4341, "Method"], [4359, 4363, "Method"], [4364, 4365, "Method"], [4370, 4371, "Task"], [4383, 4384, "Method"], [4387, 4388, "Method"], [4391, 4392, "Method"], [4395, 4400, "Method"], [4402, 4404, "Method"], [4406, 4407, "Method"], [4419, 4423, "Method"], [4440, 4441, "Method"], [4453, 4456, "Method"], [4457, 4458, "Task"], [4478, 4481, "Method"], [4486, 4488, "Method"], [4498, 4499, "Method"], [4507, 4513, "Task"], [4516, 4517, "Method"], [4518, 4521, "Method"], [4559, 4560, "Task"], [4570, 4572, "Task"], [4575, 4577, "Method"], [4579, 4580, "Method"], [4611, 4612, "Method"], [4622, 4623, "Method"], [4636, 4642, "Method"], [4643, 4644, "Material"], [4665, 4668, "Method"], [4669, 4670, "Task"], [4687, 4688, "Material"], [4689, 4690, "Material"], [4727, 4728, "Material"], [4729, 4730, "Material"], [4756, 4757, "Material"], [4758, 4759, "Material"], [4766, 4767, "Metric"], [4805, 4806, "Material"], [4807, 4808, "Material"], [4814, 4815, "Method"], [4816, 4817, "Method"], [4856, 4859, "Method"], [4861, 4863, "Method"], [4867, 4868, "Method"], [4869, 4872, "Method"], [4874, 4878, "Method"], [4901, 4902, "Material"], [4903, 4904, "Material"], [4929, 4931, "Method"], [4944, 4945, "Method"], [4963, 4965, "Method"], [4966, 4969, "Task"], [4992, 4994, "Method"], [5003, 5005, "Metric"], [5011, 5012, "Method"], [5017, 5020, "Method"], [5021, 5022, "Method"], [5052, 5054, "Method"], [5059, 5060, "Method"], [5068, 5069, "Method"], [5076, 5081, "Task"], [5082, 5084, "Task"], [5092, 5096, "Method"], [5155, 5157, "Method"], [5158, 5160, "Method"], [5172, 5176, "Method"], [705, 706, "Method"], [795, 797, "Task"], [889, 890, "Method"], [1773, 1774, "Method"], [1808, 1809, "Method"], [1939, 1940, "Method"], [1943, 1944, "Method"], [1956, 1957, "Method"], [2082, 2083, "Method"], [2157, 2158, "Method"], [2281, 2282, "Method"], [2327, 2328, "Method"], [2455, 2456, "Method"], [2805, 2806, "Method"], [2814, 2815, "Method"], [3380, 3381, "Method"], [4427, 4428, "Method"], [4956, 4957, "Method"], [4960, 4961, "Method"], [5046, 5047, "Method"], [5055, 5056, "Material"], [5064, 5065, "Material"]], "sections": [[0, 156], [156, 1033], [1033, 1507], [1507, 1580], [1580, 1856], [1856, 2139], [2139, 2311], [2311, 2365], [2365, 2596], [2596, 2800], [2800, 2882], [2882, 2979], [2979, 3131], [3131, 3288], [3288, 3318], [3318, 3733], [3733, 3918], [3918, 3924], [3924, 4083], [4083, 4220], [4220, 4568], [4568, 4663], [4663, 4830], [4830, 5071], [5071, 5183], [5183, 5199], [5199, 5202]], "sentences": [[0, 16], [16, 37], [37, 64], [64, 91], [91, 133], [133, 155], [155, 156], [156, 159], [159, 199], [199, 220], [220, 233], [233, 254], [254, 264], [264, 287], [287, 302], [302, 322], [322, 335], [335, 357], [357, 399], [399, 416], [416, 446], [446, 476], [476, 492], [492, 522], [522, 562], [562, 583], [583, 626], [626, 640], [640, 655], [655, 679], [679, 704], [704, 726], [726, 741], [741, 758], [758, 772], [772, 799], [799, 830], [830, 855], [855, 876], [876, 884], [884, 917], [917, 927], [927, 930], [930, 961], [961, 975], [975, 978], [978, 1015], [1015, 1033], [1033, 1037], [1037, 1052], [1052, 1066], [1066, 1082], [1082, 1086], [1086, 1107], [1107, 1121], [1121, 1129], [1129, 1151], [1151, 1159], [1159, 1178], [1178, 1203], [1203, 1231], [1231, 1247], [1247, 1276], [1276, 1289], [1289, 1305], [1305, 1331], [1331, 1351], [1351, 1383], [1383, 1404], [1404, 1417], [1417, 1456], [1456, 1480], [1480, 1507], [1507, 1514], [1514, 1549], [1549, 1580], [1580, 1584], [1584, 1608], [1608, 1625], [1625, 1653], [1653, 1665], [1665, 1675], [1675, 1734], [1734, 1753], [1753, 1773], [1773, 1790], [1790, 1812], [1812, 1831], [1831, 1841], [1841, 1856], [1856, 1862], [1862, 1877], [1877, 1910], [1910, 1929], [1929, 1952], [1952, 1974], [1974, 1988], [1988, 2003], [2003, 2015], [2015, 2032], [2032, 2059], [2059, 2113], [2113, 2139], [2139, 2145], [2145, 2162], [2162, 2187], [2187, 2213], [2213, 2225], [2225, 2287], [2287, 2304], [2304, 2311], [2311, 2315], [2315, 2340], [2340, 2365], [2365, 2371], [2371, 2391], [2391, 2411], [2411, 2428], [2428, 2444], [2444, 2471], [2471, 2493], [2493, 2506], [2506, 2525], [2525, 2537], [2537, 2560], [2560, 2578], [2578, 2596], [2596, 2603], [2603, 2625], [2625, 2655], [2655, 2702], [2702, 2719], [2719, 2742], [2742, 2755], [2755, 2773], [2773, 2785], [2785, 2800], [2800, 2808], [2808, 2839], [2839, 2854], [2854, 2882], [2882, 2890], [2890, 2911], [2911, 2933], [2933, 2962], [2962, 2979], [2979, 2987], [2987, 3010], [3010, 3053], [3053, 3070], [3070, 3088], [3088, 3100], [3100, 3122], [3122, 3131], [3131, 3136], [3136, 3159], [3159, 3184], [3184, 3190], [3190, 3208], [3208, 3229], [3229, 3259], [3259, 3288], [3288, 3291], [3291, 3318], [3318, 3325], [3325, 3365], [3365, 3376], [3376, 3392], [3392, 3408], [3408, 3422], [3422, 3448], [3448, 3459], [3459, 3474], [3474, 3503], [3503, 3519], [3519, 3532], [3532, 3548], [3548, 3566], [3566, 3582], [3582, 3608], [3608, 3630], [3630, 3655], [3655, 3686], [3686, 3703], [3703, 3733], [3733, 3740], [3740, 3753], [3753, 3779], [3779, 3796], [3796, 3803], [3803, 3824], [3824, 3835], [3835, 3874], [3874, 3888], [3888, 3902], [3902, 3918], [3918, 3924], [3924, 3928], [3928, 3950], [3950, 3971], [3971, 4002], [4002, 4011], [4011, 4040], [4040, 4071], [4071, 4083], [4083, 4088], [4088, 4103], [4103, 4137], [4137, 4160], [4160, 4179], [4179, 4194], [4194, 4211], [4211, 4220], [4220, 4225], [4225, 4246], [4246, 4279], [4279, 4303], [4303, 4322], [4322, 4333], [4333, 4356], [4356, 4385], [4385, 4401], [4401, 4436], [4436, 4451], [4451, 4474], [4474, 4514], [4514, 4537], [4537, 4545], [4545, 4568], [4568, 4573], [4573, 4585], [4585, 4599], [4599, 4620], [4620, 4648], [4648, 4663], [4663, 4671], [4671, 4694], [4694, 4732], [4732, 4745], [4745, 4775], [4775, 4791], [4791, 4809], [4809, 4830], [4830, 4840], [4840, 4864], [4864, 4891], [4891, 4924], [4924, 4953], [4953, 4975], [4975, 4995], [4995, 5006], [5006, 5041], [5041, 5044], [5044, 5056], [5056, 5065], [5065, 5071], [5071, 5074], [5074, 5085], [5085, 5104], [5104, 5139], [5139, 5169], [5169, 5183], [5183, 5186], [5186, 5187], [5187, 5199], [5199, 5202]], "words": ["document", ":", "CNN", "Image", "Retrieval", "Learns", "from", "BoW", ":", "Unsupervised", "Fine", "-", "Tuning", "with", "Hard", "Examples", "Convolutional", "Neural", "Networks", "(", "CNNs", ")", "achieve", "state", "-", "of", "-", "the", "-", "art", "performance", "in", "many", "computer", "vision", "tasks", ".", "However", ",", "this", "achievement", "is", "preceded", "by", "extreme", "manual", "annotation", "in", "order", "to", "perform", "either", "training", "from", "scratch", "or", "fine", "-", "tuning", "for", "the", "target", "task", ".", "In", "this", "work", ",", "we", "propose", "to", "fine", "-", "tune", "CNN", "for", "image", "retrieval", "from", "a", "large", "collection", "of", "unordered", "images", "in", "a", "fully", "automated", "manner", ".", "We", "employ", "state", "-", "of", "-", "the", "-", "art", "retrieval", "and", "Structure", "-", "from", "-", "Motion", "(", "SfM", ")", "methods", "to", "obtain", "3D", "models", ",", "which", "are", "used", "to", "guide", "the", "selection", "of", "the", "training", "data", "for", "CNN", "fine", "-", "tuning", ".", "We", "show", "that", "both", "hard", "positive", "and", "hard", "negative", "examples", "enhance", "the", "final", "performance", "in", "particular", "object", "retrieval", "with", "compact", "codes", ".", "+", "section", ":", "Introduction", "Image", "retrieval", "has", "received", "a", "lot", "of", "attention", "since", "the", "advent", "of", "invariant", "local", "features", ",", "such", "as", "SIFT", ",", "and", "since", "the", "seminal", "work", "of", "Sivic", "and", "Zisserman", "based", "on", "Bag", "-", "of", "-", "Words", "(", "BoW", ")", ".", "Retrieval", "systems", "have", "reached", "a", "higher", "level", "of", "maturity", "by", "incorporating", "large", "visual", "codebooks", ",", "spatial", "verification", "and", "query", "expansion", ".", "These", "ingredients", "constitute", "the", "state", "of", "the", "art", "on", "particular", "object", "retrieval", ".", "Another", "line", "of", "research", "focuses", "on", "compact", "image", "representations", "in", "order", "to", "decrease", "memory", "requirements", "and", "increase", "the", "search", "efficiency", ".", "Representative", "approaches", "are", "Fisher", "vectors", ",", "VLAD", "and", "alternatives", ".", "Recent", "advances", "show", "that", "Convolutional", "Neural", "Networks", "(", "CNN", ")", "offer", "an", "attractive", "alternative", "for", "image", "search", "representations", "with", "small", "memory", "footprint", ".", "CNNs", "attracted", "a", "lot", "of", "attention", "after", "the", "work", "of", "Krizhevsky", "et", "al", ".", ".", "Their", "success", "is", "mainly", "due", "to", "the", "computational", "power", "of", "GPUs", "and", "the", "use", "of", "very", "large", "annotated", "datasets", ".", "Generation", "of", "the", "latter", "comes", "at", "the", "expense", "of", "costly", "manual", "annotation", ".", "Using", "CNN", "layer", "activations", "as", "off", "-", "the", "-", "shelf", "image", "descriptors", "appears", "very", "effective", "and", "is", "adopted", "in", "many", "tasks", ".", "In", "particular", "for", "image", "retrieval", ",", "Babenko", "et", "al", ".", "and", "Gong", "et", "al", ".", "concurrently", "propose", "the", "use", "of", "Fully", "Connected", "(", "FC", ")", "layer", "activations", "as", "descriptors", ",", "while", "convolutional", "layer", "activations", "are", "later", "shown", "to", "have", "superior", "performance", ".", "Generalization", "to", "other", "tasks", "is", "attained", "by", "CNN", "activations", ",", "at", "least", "up", "to", "some", "extent", ".", "However", ",", "initialization", "by", "a", "pre", "-", "trained", "network", "and", "re", "-", "training", "for", "another", "task", ",", "a", "process", "called", "fine", "-", "tuning", ",", "significantly", "improves", "the", "adaptation", "ability", ".", "Fine", "-", "tuning", "by", "training", "with", "classes", "of", "particular", "objects", ",", "e.g.", "building", "classes", "in", "the", "work", "of", "Babenko", "et", "al", ".", ",", "is", "known", "to", "improve", "retrieval", "accuracy", ".", "This", "formulation", "is", "much", "closer", "to", "classification", "than", "to", "the", "desired", "properties", "of", "instance", "retrieval", ".", "Typical", "architectures", "for", "metric", "learning", ",", "such", "as", "siamese", "or", "triplet", "networks", "employ", "matching", "and", "non", "-", "matching", "pairs", "to", "perform", "the", "training", "and", "better", "suit", "to", "this", "task", ".", "In", "this", "fashion", ",", "Arandjelovic", "et", "al", ".", "perform", "fine", "-", "tuning", "based", "on", "geo", "-", "tagged", "databases", "and", ",", "similar", "to", "our", "work", ",", "they", "directly", "optimize", "the", "the", "similarity", "measure", "to", "be", "used", "in", "the", "final", "task", ".", "In", "contrast", "to", "them", ",", "we", "dispense", "with", "the", "need", "of", "annotated", "data", "or", "any", "assumptions", "on", "the", "training", "dataset", ".", "A", "concurrent", "work", "bears", "resemblance", "to", "ours", "but", "their", "focus", "is", "on", "boosting", "performance", "through", "end", "-", "to", "-", "end", "learning", "of", "a", "more", "sophisticated", "representation", ",", "while", "we", "target", "to", "reveal", "the", "importance", "of", "hard", "examples", "and", "of", "training", "data", "variation", ".", "A", "number", "of", "image", "clustering", "methods", "based", "on", "local", "features", "have", "been", "introduced", ".", "Due", "to", "the", "spatial", "verification", ",", "the", "clusters", "discovered", "by", "these", "methods", "are", "reliable", ".", "In", "fact", ",", "the", "methods", "provide", "not", "only", "clusters", ",", "but", "also", "a", "matching", "graph", "or", "sub", "-", "graph", "on", "the", "cluster", "images", ".", "These", "graphs", "are", "further", "used", "as", "an", "input", "to", "a", "Structure", "-", "from", "-", "Motion", "(", "SfM", ")", "pipeline", "to", "build", "a", "3D", "model", ".", "The", "SfM", "filters", "out", "virtually", "all", "mismatched", "images", ",", "and", "also", "provides", "camera", "positions", "for", "all", "matched", "images", "in", "the", "cluster", ".", "The", "whole", "process", "from", "unordered", "collection", "of", "images", "to", "3D", "reconstructions", "is", "fully", "automatic", ".", "In", "this", "paper", ",", "we", "address", "an", "unsupervised", "fine", "-", "tuning", "of", "CNN", "for", "image", "retrieval", ".", "We", "propose", "to", "exploit", "3D", "reconstructions", "to", "select", "the", "training", "data", "for", "CNN", ".", "We", "show", "that", "compared", "to", "previous", "supervised", "approaches", ",", "the", "variability", "in", "the", "training", "data", "from", "3D", "reconstructions", "delivers", "superior", "performance", "in", "the", "image", "retrieval", "task", ".", "During", "the", "training", "process", "the", "CNN", "is", "trained", "to", "learn", "what", "a", "state", "-", "of", "-", "the", "-", "art", "retrieval", "system", "based", "on", "local", "features", "and", "spatial", "verification", "would", "match", ".", "Such", "a", "system", "has", "large", "memory", "requirements", "and", "high", "query", "times", ",", "while", "our", "goal", "is", "to", "mimic", "this", "via", "CNN", "-", "based", "representation", ".", "We", "derive", "a", "short", "image", "representation", "and", "achieve", "similar", "performance", "to", "such", "state", "-", "of", "-", "the", "-", "art", "systems", ".", "In", "particular", "we", "make", "the", "following", "contributions", ".", "(", "1", ")", "We", "exploit", "SfM", "information", "and", "enforce", "not", "only", "hard", "non", "-", "matching", "(", "negative", ")", "but", "also", "hard", "matching", "(", "positive", ")", "examples", "to", "be", "learned", "by", "the", "CNN", ".", "This", "is", "shown", "to", "enhance", "the", "derived", "image", "representation", ".", "(", "2", ")", "We", "show", "that", "the", "whitening", "traditionally", "performed", "on", "short", "representations", "is", ",", "in", "some", "cases", ",", "unstable", "and", "we", "rather", "propose", "to", "learn", "the", "whitening", "through", "the", "same", "training", "data", ".", "Its", "effect", "is", "complementary", "to", "fine", "-", "tuning", "and", "it", "further", "boosts", "performance", ".", "(", "3", ")", "Finally", ",", "we", "set", "a", "new", "state", "-", "of", "-", "the", "-", "art", "based", "on", "compact", "representations", "for", "Oxford", "Buildings", "and", "Paris", "datasets", "by", "re", "-", "training", "well", "known", "CNNs", ",", "such", "as", "AlexNet", "and", "VGG", ".", "Remarkably", ",", "we", "are", "on", "par", "with", "existing", "256D", "compact", "representations", "even", "by", "using", "32D", "image", "vectors", ".", "section", ":", "Related", "work", "A", "variety", "of", "previous", "methods", "apply", "CNN", "activations", "on", "the", "task", "of", "image", "retrieval", ".", "The", "achieved", "accuracy", "on", "retrieval", "is", "evidence", "for", "the", "generalization", "properties", "of", "CNNs", ".", "The", "employed", "networks", "were", "trained", "for", "image", "classification", "using", "ImageNet", "dataset", ",", "optimizing", "classification", "error", ".", "Babenko", "et", "al", ".", "go", "one", "step", "further", "and", "re", "-", "train", "such", "networks", "with", "a", "dataset", "that", "is", "closer", "to", "the", "target", "task", ".", "They", "perform", "training", "with", "object", "classes", "that", "correspond", "to", "particular", "landmarks", "/", "buildings", ".", "Performance", "is", "improved", "on", "standard", "retrieval", "benchmarks", ".", "Despite", "the", "achievement", ",", "still", ",", "the", "final", "metric", "and", "utilized", "layers", "are", "different", "to", "the", "ones", "actually", "optimized", "during", "learning", ".", "Constructing", "such", "training", "datasets", "requires", "manual", "effort", ".", "The", "same", "stands", "for", "attempts", "on", "different", "tasks", "that", "perform", "fine", "-", "tuning", "and", "achieve", "increase", "of", "performance", ".", "In", "a", "recent", "work", ",", "geo", "-", "tagged", "datasets", "with", "timestamps", "offer", "the", "ground", "for", "weakly", "supervised", "fine", "-", "tuning", "of", "a", "triplet", "network", ".", "Two", "images", "taken", "far", "from", "each", "other", "can", "be", "easily", "considered", "as", "non", "-", "matching", ",", "while", "matching", "examples", "are", "picked", "by", "the", "most", "similar", "nearby", "images", ".", "In", "the", "latter", "case", ",", "similarity", "is", "defined", "by", "the", "current", "representation", "of", "the", "CNN", ".", "This", "is", "the", "first", "approach", "that", "performs", "end", "-", "to", "-", "end", "fine", "-", "tuning", "for", "image", "retrieval", "and", "in", "particular", "for", "the", "task", "of", "geo", "-", "localization", ".", "The", "employed", "training", "data", "are", "now", "much", "closer", "to", "the", "final", "task", ".", "We", "differentiate", "by", "discovering", "matching", "and", "non", "-", "matching", "image", "pairs", "in", "an", "unsupervised", "way", ".", "Moreover", ",", "we", "derive", "matching", "examples", "based", "on", "3D", "reconstruction", "which", "allows", "for", "harder", "examples", ",", "compared", "to", "the", "ones", "that", "the", "current", "network", "identifies", ".", "Even", "though", "hard", "negative", "mining", "is", "a", "standard", "process", ",", "this", "is", "not", "the", "case", "with", "hard", "positive", "examples", ".", "Large", "intra", "-", "class", "variation", "in", "classification", "tasks", "requires", "the", "positive", "pairs", "to", "be", "sampled", "carefully", ";", "forcing", "the", "model", "to", "learn", "extremely", "hard", "positives", "may", "result", "in", "over", "-", "fitting", ".", "Another", "exception", "is", "the", "work", "Simo", "-", "Serra", "et", "al", ".", "where", "they", "mine", "hard", "positive", "patches", "for", "descriptor", "learning", ".", "They", "are", "also", "guided", "by", "3D", "reconstruction", "but", "only", "at", "patch", "level", ".", "Despite", "the", "fact", "that", "one", "of", "the", "recent", "advances", "is", "the", "triplet", "loss", ",", "note", "that", "also", "Arandjelovic", "et", "al", ".", "use", "it", ",", "there", "are", "no", "extenstive", "and", "direct", "comparisons", "to", "siamese", "networks", "and", "the", "contrastive", "loss", ".", "One", "exception", "is", "the", "work", "of", "Hoffer", "and", "Ailon", ",", "where", "triplet", "loss", "is", "shown", "to", "be", "marginally", "better", "only", "on", "MNIST", "dataset", ".", "We", "rather", "employ", "a", "siamese", "architecture", "with", "the", "contrastive", "loss", "and", "find", "it", "to", "generalize", "better", "and", "to", "converge", "at", "higher", "performance", "than", "the", "triplet", "loss", ".", "section", ":", "Network", "architecture", "and", "image", "representation", "In", "this", "section", "we", "describe", "the", "derived", "image", "representation", "that", "is", "based", "on", "CNN", "and", "we", "present", "the", "network", "architecture", "used", "to", "perform", "the", "end", "-", "to", "-", "end", "learning", "in", "a", "siamese", "fashion", ".", "Finally", ",", "we", "describe", "how", ",", "after", "fine", "-", "tuning", ",", "we", "use", "the", "same", "training", "data", "to", "learn", "projections", "that", "appear", "to", "be", "an", "effective", "post", "-", "processing", "step", ".", "subsection", ":", "Image", "representation", "We", "adopt", "a", "compact", "representation", "that", "is", "derived", "from", "activations", "of", "convolutional", "layers", "and", "is", "shown", "to", "be", "effective", "for", "particular", "object", "retrieval", ".", "We", "assume", "that", "a", "network", "is", "fully", "convolutional", "or", "that", "all", "fully", "connected", "layers", "are", "discarded", ".", "Now", ",", "given", "an", "input", "image", ",", "the", "output", "is", "a", "3D", "tensor", "of", "dimensions", ",", "where", "is", "the", "number", "of", "feature", "maps", "in", "the", "last", "layer", ".", "Let", "be", "the", "set", "of", "all", "activations", "for", "feature", "map", "}", ".", "The", "network", "output", "consists", "of", "such", "sets", "of", "activations", ".", "The", "image", "representation", ",", "called", "Maximum", "Activations", "of", "Convolutions", "(", "MAC", ")", ",", "is", "simply", "constructed", "by", "max", "-", "pooling", "over", "all", "dimensions", "per", "feature", "map", "and", "is", "given", "by", "The", "indicator", "function", "takes", "care", "that", "the", "feature", "vector", "is", "non", "-", "negative", ",", "as", "if", "the", "last", "network", "layer", "was", "a", "Rectified", "Linear", "Unit", "(", "ReLU", ")", ".", "The", "feature", "vector", "finally", "consists", "of", "the", "maximum", "activation", "per", "feature", "map", "and", "its", "dimensionality", "is", "equal", "to", ".", "For", "many", "popular", "networks", "this", "is", "equal", "to", "256", "or", "512", ",", "which", "makes", "it", "a", "compact", "image", "representation", ".", "MAC", "vectors", "are", "subsequently", "-", "normalized", "and", "similarity", "between", "two", "images", "is", "evaluated", "with", "inner", "product", ".", "The", "contribution", "of", "a", "feature", "map", "to", "the", "image", "similarity", "is", "measured", "by", "the", "product", "of", "the", "corresponding", "MAC", "vector", "components", ".", "In", "Figure", "[", "reference", "]", "we", "show", "the", "image", "patches", "in", "correspondence", "that", "contribute", "most", "to", "the", "similarity", ".", "Such", "implicit", "correspondences", "are", "improved", "after", "fine", "-", "tuning", ".", "Moreover", ",", "the", "CNN", "fires", "less", "to", "ImageNet", "classes", ",", "e.g.", "cars", "and", "bicycles", ".", "subsection", ":", "Network", "and", "siamese", "learning", "The", "proposed", "approach", "is", "applicable", "to", "any", "CNN", "that", "consists", "of", "only", "convolutional", "layers", ".", "In", "this", "paper", ",", "we", "focus", "on", "re", "-", "training", "(", "i.e.", "fine", "-", "tuning", ")", "state", "-", "of", "-", "the", "-", "art", "CNNs", "for", "classification", ",", "in", "particular", "AlexNet", "and", "VGG", ".", "Fully", "connected", "layers", "are", "discarded", "and", "the", "pre", "-", "trained", "networks", "constitute", "the", "initialization", "for", "our", "convolutional", "layers", ".", "Now", ",", "the", "last", "convolutional", "layer", "is", "followed", "by", "a", "MAC", "layer", "that", "performs", "MAC", "vector", "computation", "(", "[", "reference", "]", ")", ".", "The", "input", "of", "a", "MAC", "layer", "is", "a", "3D", "tensor", "of", "activation", "and", "the", "output", "is", "a", "non", "-", "negative", "vector", ".", "Then", ",", "an", "-", "normalization", "block", "takes", "care", "that", "output", "vectors", "are", "normalized", ".", "In", "the", "rest", "of", "the", "paper", ",", "MAC", "corresponds", "to", "the", "-", "normalized", "vector", ".", "We", "adopt", "a", "siamese", "architecture", "and", "train", "a", "two", "branch", "network", ".", "Each", "branch", "is", "a", "clone", "of", "the", "other", ",", "meaning", "that", "they", "share", "the", "same", "parameters", ".", "Training", "input", "consists", "of", "image", "pairs", "and", "labels", "declaring", "whether", "a", "pair", "is", "non", "-", "matching", "(", "label", "0", ")", "or", "matching", "(", "label", "1", ")", ".", "We", "employ", "the", "contrastive", "loss", "that", "acts", "on", "the", "(", "non", "-)", "matching", "pairs", "and", "is", "defined", "as", "where", "is", "the", "-", "normalized", "MAC", "vector", "of", "image", ",", "and", "is", "a", "parameter", "defining", "when", "non", "-", "matching", "pairs", "have", "large", "enough", "distance", "in", "order", "not", "to", "be", "taken", "into", "account", "in", "the", "loss", ".", "We", "train", "the", "network", "using", "Stochastic", "Gradient", "Descent", "(", "SGD", ")", "and", "a", "large", "training", "set", "created", "automatically", "(", "see", "Section", "[", "reference", "]", ")", ".", "subsection", ":", "Whitening", "and", "dimensionality", "reduction", "In", "this", "section", ",", "the", "post", "-", "processing", "of", "fine", "-", "tuned", "MAC", "vectors", "is", "considered", ".", "Previous", "methods", "use", "PCA", "of", "an", "independent", "set", "for", "whitening", "and", "dimensionality", "reduction", ",", "that", "is", "the", "covariance", "matrix", "of", "all", "descriptors", "is", "analyzed", ".", "We", "propose", "to", "take", "advantage", "of", "the", "labeled", "data", "provided", "by", "the", "3D", "models", "and", "use", "linear", "discriminant", "projections", "originally", "proposed", "by", "Mikolajczyk", "and", "Matas", ".", "The", "projection", "is", "decomposed", "into", "two", "parts", ",", "whitening", "and", "rotation", ".", "The", "whitening", "part", "is", "the", "inverse", "of", "the", "square", "-", "root", "of", "the", "intraclass", "(", "matching", "pairs", ")", "covariance", "matrix", ",", "where", "The", "rotation", "part", "is", "the", "PCA", "of", "the", "interclass", "(", "non", "-", "matching", "pairs", ")", "covariance", "matrix", "in", "the", "whitened", "space", ",", "where", "The", "projection", "is", "then", "applied", "as", ",", "where", "is", "the", "mean", "MAC", "vector", "to", "perform", "centering", ".", "To", "reduce", "the", "descriptor", "dimensionality", "to", "dimensions", ",", "only", "eigenvectors", "corresponding", "to", "largest", "eigenvalues", "are", "used", ".", "Projected", "vectors", "are", "subsequently", "-", "normalized", ".", "section", ":", "Training", "dataset", "In", "this", "section", "we", "briefly", "summarize", "the", "tightly", "-", "coupled", "BoW", "and", "SfM", "reconstruction", "system", "that", "is", "employed", "to", "automatically", "select", "our", "training", "data", ".", "Then", ",", "we", "describe", "how", "we", "exploit", "the", "3D", "information", "to", "select", "harder", "matching", "pairs", "and", "hard", "non", "-", "matching", "pairs", "with", "larger", "variability", ".", "subsection", ":", "BoW", "and", "3D", "reconstruction", "The", "retrieval", "engine", "used", "in", "the", "work", "of", "Schonberger", "et", "al", ".", "builds", "upon", "BoW", "with", "fast", "spatial", "verification", ".", "It", "uses", "Hessian", "affine", "local", "features", ",", "RootSIFT", "descriptors", ",", "and", "a", "fine", "vocabulary", "of", "16", "M", "visual", "words", ".", "Then", ",", "query", "images", "are", "chosen", "via", "min", "-", "hash", "and", "spatial", "verification", ",", "as", "in", ".", "Image", "retrieval", "based", "on", "BoW", "is", "used", "to", "collect", "images", "of", "the", "objects", "/", "landmarks", ".", "These", "images", "serve", "as", "the", "initial", "matching", "graph", "for", "the", "succeeding", "SfM", "reconstruction", ",", "which", "is", "performed", "using", "state", "-", "of", "-", "the", "-", "art", "SfM", ".", "Different", "mining", "techniques", ",", "e.g.", "zoom", "in", ",", "zoom", "out", ",", "sideways", "crawl", ",", "help", "to", "build", "larger", "and", "complete", "model", ".", "In", "this", "work", ",", "we", "exploit", "the", "outcome", "of", "such", "a", "system", ".", "Given", "a", "large", "unannotated", "image", "collection", ",", "images", "are", "clustered", "and", "a", "3D", "model", "is", "constructed", "per", "cluster", ".", "We", "use", "the", "terms", "3D", "model", ",", "model", "and", "cluster", "interchangeably", ".", "For", "each", "image", ",", "the", "estimated", "camera", "position", "is", "known", ",", "as", "well", "as", "the", "local", "features", "registered", "on", "the", "3D", "model", ".", "We", "drop", "redundant", "(", "overlapping", ")", "3D", "models", ",", "that", "might", "have", "been", "constructed", "from", "different", "seeds", ".", "Models", "reconstructing", "the", "same", "landmark", "but", "from", "different", "and", "disjoint", "viewpoints", "are", "considered", "as", "non", "-", "overlapping", ".", "subsection", ":", "Selection", "of", "training", "image", "pairs", "A", "3D", "model", "is", "described", "as", "a", "bipartite", "visibility", "graph", ",", "where", "images", "and", "points", "are", "the", "vertices", "of", "the", "graph", ".", "Edges", "of", "this", "graph", "are", "defined", "by", "visibility", "relations", "between", "cameras", "and", "points", ",", "i.e.", "if", "a", "point", "is", "visible", "in", "an", "image", ",", "then", "there", "exists", "an", "edge", ".", "The", "set", "of", "points", "observed", "by", "an", "image", "is", "given", "by", "We", "create", "a", "dataset", "of", "tuples", ",", "where", "represents", "a", "query", "image", ",", "is", "a", "positive", "image", "that", "matches", "the", "query", ",", "and", "is", "a", "set", "of", "negative", "images", "that", "do", "not", "match", "the", "query", ".", "These", "tuples", "are", "used", "to", "form", "training", "image", "pairs", ",", "where", "each", "tuple", "corresponds", "to", "pairs", ".", "For", "a", "query", "image", ",", "a", "pool", "of", "candidate", "positive", "images", "is", "constructed", "based", "on", "the", "camera", "positions", "in", "the", "cluster", "of", ".", "It", "consists", "of", "the", "images", "with", "closest", "camera", "centers", "to", "the", "query", ".", "Due", "to", "the", "wide", "range", "of", "camera", "orientations", ",", "these", "do", "not", "necessarily", "depict", "the", "same", "object", ".", "We", "therefore", "propose", "three", "different", "ways", "to", "sample", "the", "positive", "image", ".", "The", "positives", "examples", "are", "fixed", "during", "the", "whole", "training", "process", "for", "all", "three", "strategies", ".", "paragraph", ":", "Positive", "images", ":", "MAC", "distance", ".", "The", "image", "that", "has", "the", "lowest", "MAC", "distance", "to", "the", "query", "is", "chosen", "as", "positive", ",", "formally", "This", "strategy", "is", "similar", "to", "the", "one", "followed", "by", "Arandjelovic", "et", "al", ".", ".", "They", "adopt", "this", "choice", "since", "only", "GPS", "coordinates", "are", "available", "and", "not", "camera", "orientations", ".", "Downside", "of", "this", "approach", "is", "that", "the", "chosen", "matching", "examples", "already", "have", "low", "distance", ",", "thus", "not", "forcing", "network", "to", "learn", "much", "out", "of", "the", "positive", "samples", ".", "paragraph", ":", "Positive", "images", ":", "maximum", "inliers", ".", "In", "this", "approach", ",", "the", "3D", "information", "is", "exploited", "to", "choose", "the", "positive", "image", ",", "independently", "of", "the", "CNN", "descriptor", ".", "In", "particular", ",", "the", "image", "that", "has", "the", "highest", "number", "of", "co", "-", "observed", "3D", "points", "with", "the", "query", "is", "chosen", ".", "That", "is", ",", "This", "measure", "corresponds", "to", "the", "number", "of", "spatially", "verified", "features", "between", "two", "images", ",", "a", "measure", "commonly", "used", "for", "ranking", "in", "BoW", "-", "based", "retrieval", ".", "As", "this", "choice", "is", "independent", "of", "the", "CNN", "representation", ",", "it", "delivers", "more", "challenging", "positive", "examples", ".", "paragraph", ":", "Positive", "images", ":", "relaxed", "inliers", ".", "Even", "though", "both", "previous", "methods", "choose", "positive", "images", "depicting", "the", "same", "object", "as", "the", "query", ",", "the", "variance", "of", "viewpoints", "is", "limited", ".", "Instead", "of", "using", "a", "pool", "of", "images", "with", "similar", "camera", "position", ",", "the", "positive", "example", "is", "selected", "at", "random", "from", "a", "set", "of", "images", "that", "co", "-", "observe", "enough", "points", "with", "the", "query", ",", "but", "do", "not", "exhibit", "too", "extreme", "scale", "change", ".", "The", "positive", "example", "in", "this", "case", "is", "where", "is", "the", "scale", "change", "between", "the", "two", "images", ".", "This", "method", "results", "in", "selecting", "harder", "matching", "examples", "which", "are", "still", "guaranteed", "to", "depict", "the", "same", "object", ".", "Method", "chooses", "different", "image", "than", "on", "86.5", "%", "of", "the", "queries", ".", "In", "Figure", "[", "reference", "]", "we", "present", "examples", "of", "query", "images", "and", "the", "corresponding", "positives", "selected", "with", "the", "three", "different", "methods", ".", "The", "relaxed", "method", "increases", "the", "variability", "of", "viewpoints", ".", "paragraph", ":", "Negative", "images", ".", "Negative", "examples", "are", "selected", "from", "clusters", "different", "than", "the", "cluster", "of", "the", "query", "image", ",", "as", "the", "clusters", "are", "non", "-", "overlaping", ".", "Following", "a", "well", "-", "known", "procedure", ",", "we", "choose", "hard", "negatives", ",", "that", "is", ",", "non", "-", "matching", "images", "with", "the", "most", "similar", "descriptor", ".", "Two", "different", "strategies", "are", "proposed", ".", "In", "the", "first", ",", ",", "k", "-", "nearest", "neighbors", "from", "all", "non", "-", "matching", "images", "are", "selected", ".", "In", "the", "other", ",", ",", "the", "same", "criterion", "is", "used", ",", "but", "at", "most", "one", "image", "per", "cluster", "is", "allowed", ".", "While", "often", "leads", "to", "multiple", ",", "and", "very", "similar", ",", "instances", "of", "the", "same", "object", ",", "provides", "higher", "variability", "of", "the", "negative", "examples", ",", "see", "Figure", "[", "reference", "]", ".", "While", "positives", "examples", "are", "fixed", "during", "the", "whole", "training", "process", ",", "hard", "negatives", "depend", "on", "the", "current", "CNN", "parameters", "and", "are", "re", "-", "mined", "multiple", "times", "per", "epoch", ".", "section", ":", "Experiments", "In", "this", "section", "we", "discuss", "implementation", "details", "of", "our", "training", ",", "evaluate", "different", "components", "of", "our", "method", ",", "and", "compare", "to", "the", "state", "of", "the", "art", ".", "subsection", ":", "Training", "setup", "and", "implementation", "details", "Our", "training", "samples", "are", "derived", "from", "the", "dataset", "used", "in", "the", "work", "of", "Schonberger", "et", "al", ".", ",", "which", "consists", "of", "7.4", "million", "images", "downloaded", "from", "Flickr", "using", "keywords", "of", "popular", "landmarks", ",", "cities", "and", "countries", "across", "the", "world", ".", "The", "clustering", "procedure", "gives", "images", "to", "serve", "as", "query", "seeds", ".", "The", "extensive", "retrieval", "-", "SfM", "reconstruction", "of", "the", "whole", "dataset", "results", "in", "reconstructed", "3D", "models", ".", "Removing", "overlapping", "models", "leaves", "us", "with", "3D", "models", "containing", "unique", "images", "from", "the", "initial", "dataset", ".", "The", "initial", "dataset", "contained", "on", "purpose", "all", "images", "of", "Oxford5k", "and", "Paris6k", "datasets", ".", "In", "this", "way", ",", "we", "are", "able", "to", "exclude", "98", "clusters", "that", "contain", "any", "image", "(", "or", "their", "near", "duplicates", ")", "from", "these", "test", "datasets", ".", "The", "largest", "model", "has", "images", ",", "while", "the", "smallest", "has", ".", "We", "randomly", "select", "models", "(", "images", ")", "for", "training", "and", "(", ")", "for", "validation", ".", "The", "number", "of", "training", "queries", "per", "cluster", "is", "10", "%", "of", "the", "cluster", "size", "for", "clusters", "of", "300", "or", "less", "images", ",", "or", "30", "images", "for", "larger", "clusters", ".", "A", "total", "number", "of", "images", "is", "selected", "for", "training", "queries", ",", "and", "for", "validation", "queries", ".", "Each", "training", "and", "validation", "tuple", "contains", "query", ",", "positive", "and", "negative", "images", ".", "The", "pool", "of", "candidate", "positives", "consists", "of", "images", "with", "closest", "camera", "centers", "to", "the", "query", ".", "In", "particular", ",", "for", "method", ",", "the", "inliers", "overlap", "threshold", "is", ",", "and", "the", "scale", "change", "threshold", ".", "Hard", "negatives", "are", "re", "-", "mined", "times", "per", "epoch", ",", "i.e.", "roughly", "every", "training", "queries", ".", "Given", "the", "chosen", "queries", "and", "the", "chosen", "positives", ",", "we", "further", "add", "20", "images", "per", "cluster", "to", "serve", "as", "candidate", "negatives", "during", "re", "-", "mining", ".", "This", "constitutes", "a", "training", "set", "of", "images", "and", "it", "corresponds", "to", "the", "case", "that", "all", "3D", "models", "are", "included", "for", "training", ".", "To", "perform", "the", "fine", "-", "tuning", "as", "described", "in", "Section", "[", "reference", "]", ",", "we", "initialize", "by", "the", "convolutional", "layers", "of", "AlexNet", "or", "VGG", ".", "We", "use", "learning", "rate", "equal", "to", ",", "which", "is", "divided", "by", "every", "epochs", ",", "momentum", ",", "weight", "decay", ",", "parameter", "for", "contrastive", "loss", ",", "and", "batch", "size", "of", "training", "tuples", ".", "All", "training", "images", "are", "resized", "to", "a", "maximum", "dimensionality", ",", "while", "keeping", "the", "original", "aspect", "ratio", ".", "Training", "is", "done", "for", "at", "most", "epochs", "and", "the", "best", "network", "is", "selected", "based", "on", "performance", ",", "measured", "via", "mean", "Average", "Precision", "(", "mAP", ")", ",", "on", "validation", "tuples", ".", "subsection", ":", "Test", "datasets", "and", "evaluation", "protocol", "We", "evaluate", "our", "approach", "on", "Oxford", "buildings", ",", "Paris", "and", "Holidays", "datasets", ".", "First", "two", "are", "closer", "to", "our", "training", "data", ",", "while", "the", "last", "differentiates", "by", "containing", "similar", "scenes", "and", "not", "only", "man", "made", "objects", "or", "buildings", ".", "These", "are", "also", "combined", "with", "100k", "distractors", "from", "Oxford100k", "to", "allow", "for", "evaluation", "at", "larger", "scale", ".", "The", "performance", "is", "measured", "via", "mAP", ".", "We", "follow", "the", "standard", "evaluation", "protocol", "for", "Oxford", "and", "Paris", "and", "crop", "the", "query", "images", "with", "the", "provided", "bounding", "box", ".", "The", "cropped", "image", "is", "fed", "as", "input", "to", "the", "CNN", ".", "However", ",", "to", "deliver", "a", "direct", "comparison", "with", "other", "methods", ",", "we", "also", "evaluate", "queries", "generated", "by", "keeping", "all", "activations", "that", "fall", "into", "this", "bounding", "box", "when", "the", "full", "query", "image", "is", "used", "as", "input", "to", "the", "network", ".", "We", "refer", "to", "the", "cropped", "images", "approach", "as", "and", "the", "cropped", "activations", "as", ".", "The", "dimensionality", "of", "the", "images", "fed", "into", "the", "CNN", "is", "limited", "to", "pixels", ".", "In", "our", "experiments", ",", "no", "vector", "post", "-", "processing", "is", "applied", "if", "not", "otherwise", "stated", ".", "subsection", ":", "Results", "on", "image", "retrieval", "paragraph", ":", "Learning", ".", "We", "evaluate", "the", "off", "-", "the", "-", "shelf", "CNN", "and", "our", "fine", "-", "tuned", "ones", "after", "different", "number", "of", "training", "epochs", ".", "Our", "different", "methods", "for", "positive", "and", "negative", "selection", "are", "evaluated", "independently", "in", "order", "to", "decompose", "the", "benefit", "of", "each", "ingredient", ".", "Finally", ",", "we", "also", "perform", "a", "comparison", "with", "the", "triplet", "loss", ",", "trained", "on", "exactly", "the", "same", "training", "data", "as", "the", "ones", "used", "for", "our", "architecture", "with", "the", "contrastive", "loss", ".", "Results", "are", "presented", "in", "Figure", "[", "reference", "]", ".", "The", "results", "show", "that", "positive", "examples", "with", "larger", "view", "point", "variability", ",", "and", "negative", "examples", "with", "higher", "content", "variability", ",", "both", "acquire", "a", "consistent", "increase", "in", "the", "performance", ".", "The", "triplet", "loss", "appears", "to", "be", "inferior", "in", "our", "context", ";", "we", "observe", "oscillation", "of", "the", "error", "in", "the", "validation", "set", "from", "early", "epochs", ",", "which", "implies", "over", "-", "fitting", ".", "In", "the", "rest", "of", "the", "paper", ",", "we", "adopt", "the", "approach", ".", "paragraph", ":", "Dataset", "variability", ".", "We", "perform", "fine", "-", "tuning", "by", "using", "a", "subset", "of", "the", "available", "3D", "models", ".", "Results", "are", "presented", "in", "Figure", "[", "reference", "]", "with", "10", ",", "100", "and", "551", "(", "all", "available", ")", "clusters", ",", "while", "keeping", "the", "amount", "of", "training", "data", ",", "i.e.", "training", "queries", ",", "fixed", ".", "In", "the", "case", "of", "10", "and", "100", "models", "we", "use", "the", "largest", "ones", ",", "i.e.", "ones", "with", "the", "highest", "number", "of", "images", ".", "It", "is", "better", "to", "train", "with", "all", "3D", "models", "due", "to", "the", "higher", "variability", "in", "the", "training", "set", ".", "Remarkably", ",", "significant", "increase", "in", "performance", "is", "achieved", "even", "with", "10", "or", "100", "models", ".", "However", ",", "the", "network", "is", "able", "to", "over", "-", "fit", "in", "the", "case", "of", "few", "clusters", ".", "All", "models", "are", "utilized", "in", "all", "other", "experiments", ".", "paragraph", ":", "Learned", "projections", ".", "The", "PCA", "-", "whitening", "(", "PCA", ")", "is", "shown", "to", "be", "essential", "in", "some", "cases", "of", "CNN", "-", "based", "descriptors", ".", "On", "the", "other", "hand", ",", "it", "is", "shown", "that", "on", "some", "of", "the", "datasets", ",", "the", "performance", "after", "PCA", "substantially", "drops", "compared", "with", "the", "raw", "descriptors", "(", "max", "pooling", "on", "Oxford5k", ")", ".", "We", "perform", "comparison", "of", "this", "traditional", "way", "of", "whitening", "and", "our", "learned", "whitening", "(", "L", ")", ",", "described", "in", "Section", "[", "reference", "]", ".", "Table", "[", "reference", "]", "shows", "results", "without", "post", "-", "processing", "and", "with", "the", "two", "different", "methods", "of", "whitening", ".", "Our", "experiments", "confirm", ",", "that", "PCA", "often", "reduces", "the", "performance", ".", "In", "contrast", "to", "that", ",", "the", "proposed", "L", "achieves", "the", "best", "performance", "in", "most", "cases", "and", "is", "never", "the", "worst", "performing", "method", ".", "Compared", "to", "no", "post", "-", "processing", "baseline", ",", "L", "reduces", "the", "performance", "twice", "for", "AlexNet", ",", "but", "the", "drop", "is", "negligible", "compared", "to", "the", "drop", "observed", "for", "PCA", ".", "For", "the", "VGG", ",", "the", "proposed", "L", "always", "outperforms", "the", "no", "post", "-", "processing", "baseline", ".", "Our", "unsupervised", "learning", "directly", "optimizes", "MAC", "when", "extracted", "from", "full", "images", ",", "however", ",", "we", "further", "apply", "the", "fine", "-", "tuned", "networks", "to", "construct", "R", "-", "MAC", "representation", "with", "regions", "of", "three", "different", "scales", ".", "It", "consists", "of", "extracting", "MAC", "from", "multiple", "sub", "-", "windows", "and", "then", "aggregating", "them", ".", "Directly", "optimizing", "R", "-", "MAC", "during", "learning", "is", "possible", "and", "could", "offer", "extra", "improvements", ",", "but", "this", "is", "left", "for", "future", "work", ".", "Despite", "the", "fact", "that", "R", "-", "MAC", "offers", "improvements", "due", "to", "the", "regional", "representation", ",", "in", "our", "experiments", "it", "is", "not", "always", "better", "than", "MAC", ",", "since", "the", "latter", "is", "optimized", "during", "the", "end", "-", "to", "-", "end", "learning", ".", "We", "apply", "PCA", "on", "R", "-", "MAC", "as", "in", ",", "that", "is", ",", "we", "whiten", "each", "region", "vector", "first", "and", "then", "aggregate", ".", "Performance", "is", "significantly", "higher", "in", "this", "way", ".", "In", "the", "case", "of", "our", "L", ",", "we", "directly", "whiten", "the", "final", "vector", "after", "aggregation", ",", "which", "is", "also", "faster", "to", "compute", ".", "paragraph", ":", "Dimensionality", "reduction", ".", "We", "compare", "dimensionality", "reduction", "performed", "with", "PCA", "and", "with", "our", "L", ".", "The", "performance", "for", "varying", "descriptor", "dimensionality", "is", "plotted", "in", "Figure", "[", "reference", "]", ".", "The", "plots", "suggest", "that", "L", "works", "better", "in", "higher", "dimensionalities", ",", "while", "PCA", "works", "slightly", "better", "for", "the", "lower", "ones", ".", "Remarkably", ",", "MAC", "reduced", "down", "to", "16D", "outperforms", "state", "-", "of", "-", "the", "-", "art", "on", "BoW", "-", "based", "128D", "compact", "codes", "on", "Oxford105k", "(", "vs", ")", ".", "Further", "results", "on", "very", "short", "codes", "can", "be", "found", "in", "Table", "[", "reference", "]", ".", "paragraph", ":", "Over", "-", "fitting", "and", "generalization", ".", "In", "all", "experiments", ",", "all", "clusters", "including", "any", "image", "(", "not", "only", "query", "landmarks", ")", "from", "Oxford5k", "or", "Paris6k", "datasets", "are", "removed", ".", "To", "evaluate", "whether", "the", "network", "tends", "to", "over", "-", "fit", "to", "the", "training", "data", "or", "to", "generalize", ",", "we", "repeat", "the", "training", ",", "this", "time", "using", "all", "3D", "reconstructions", ",", "including", "those", "of", "Oxford", "and", "Paris", "landmarks", ".", "The", "same", "amount", "of", "training", "queries", "is", "used", "for", "a", "fair", "comparison", ".", "We", "observe", "negligible", "difference", "in", "the", "performance", "of", "the", "network", "on", "Oxford", "and", "Paris", "evaluation", "results", ",", "i.e.", "the", "difference", "in", "mAP", "was", "on", "average", "over", "all", "testing", "datasets", ".", "We", "conclude", "that", "the", "network", "generalizes", "well", "and", "is", "relatively", "insensitive", "to", "over", "-", "fitting", ".", ":", "Full", "images", "are", "used", "as", "queries", "making", "the", "results", "not", "directly", "comparable", "on", "Oxford", "and", "Paris", ".", "\u2021", ":", "Our", "evaluation", "of", "MAC", "with", "PCAw", "as", "in", "[", "]", "with", "the", "off", "-", "the", "-", "shelf", "network", ".", "paragraph", ":", "Comparison", "with", "the", "state", "of", "the", "art", ".", "We", "extensively", "compare", "our", "results", "with", "the", "state", "-", "of", "-", "the", "-", "art", "performance", "on", "compact", "image", "representations", "and", "extremely", "short", "codes", ".", "The", "results", "for", "MAC", "and", "R", "-", "MAC", "with", "the", "fine", "-", "tuned", "networks", "are", "summarized", "together", "with", "previously", "published", "results", "in", "Table", "[", "reference", "]", ".", "The", "proposed", "methods", "outperform", "the", "state", "of", "the", "art", "on", "Paris", "and", "Oxford", "datasets", ",", "with", "and", "without", "distractors", "with", "all", "16D", ",", "32D", ",", "128D", ",", "256D", ",", "and", "512D", "descriptors", ".", "On", "Holidays", "dataset", ",", "the", "Neural", "codes", "win", "the", "extreme", "short", "code", "category", ",", "while", "off", "-", "the", "-", "shelf", "NetVlad", "performs", "the", "best", "on", "256D", "and", "higher", ".", "We", "additionally", "combine", "MAC", "and", "R", "-", "MAC", "with", "recent", "localization", "method", "for", "re", "-", "ranking", "to", "further", "boost", "the", "performance", ".", "Our", "scores", "compete", "with", "state", "-", "of", "-", "the", "-", "art", "systems", "based", "on", "local", "features", "and", "query", "expansion", ".", "These", "have", "much", "higher", "memory", "needs", "and", "larger", "query", "times", ".", "Observations", "on", "the", "recently", "published", "NetVLAD", ":", "(", "1", ")", "After", "fine", "-", "tuning", ",", "NetVLAD", "performance", "drops", "on", "Holidays", ",", "while", "our", "training", "improves", "off", "-", "the", "-", "shelf", "results", "on", "all", "datasets", ".", "(", "2", ")", "Our", "32D", "MAC", "descriptor", "has", "comparable", "performance", "to", "256D", "NetVLAD", "on", "Oxford5k", "(", "ours", "vs", "NetVLAD", ")", ",", "and", "on", "Paris6k", "(", "ours", "vs", "NetVLAD", ")", ".", "section", ":", "Conclusions", "We", "addressed", "fine", "-", "tuning", "of", "CNN", "for", "image", "retrieval", ".", "The", "training", "data", "are", "selected", "from", "an", "automated", "3D", "reconstruction", "system", "applied", "on", "a", "large", "unordered", "photo", "collection", ".", "The", "proposed", "method", "does", "not", "require", "any", "manual", "annotation", "and", "yet", "outperforms", "the", "state", "of", "the", "art", "on", "a", "number", "of", "standard", "benchmarks", "for", "wide", "range", "(", "16", "to", "512", ")", "of", "descriptor", "dimensionality", ".", "The", "achieved", "results", "are", "reaching", "the", "level", "of", "the", "best", "systems", "based", "on", "local", "features", "with", "spatial", "matching", "and", "query", "expansion", ",", "while", "being", "faster", "and", "requiring", "less", "memory", ".", "Training", "data", ",", "fine", "-", "tuned", "networks", "and", "evaluation", "code", "are", "publicly", "available", ".", "paragraph", ":", "Acknowledgment", ".", "Work", "was", "supported", "by", "the", "MSMT", "LL1303", "ERC", "-", "CZ", "grant", ".", "bibliography", ":", "References"]}