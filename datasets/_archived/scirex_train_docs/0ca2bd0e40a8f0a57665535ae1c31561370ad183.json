{"coref": {"Bit_per_Character__BPC_": [[4332, 4337], [4338, 4339], [4591, 4592], [4613, 4614], [4879, 4880], [4938, 4941], [5092, 5093], [5195, 5196]], "LN_HM-LSTM": [], "Language_Modelling": [[143, 148], [1085, 1090], [1097, 1102], [1965, 1967], [2272, 2274], [4083, 4088], [4217, 4222], [4765, 4770], [6617, 6622]], "LayerNorm_HM-LSTM": [[2964, 2971], [4156, 4158]], "Number_of_params": [], "Text8": [[1119, 1121], [4320, 4321], [4589, 4590], [4616, 4619], [4980, 4981], [4982, 4984], [5000, 5001], [5177, 5178], [5292, 5296], [6638, 6640]], "enwiki8": [[1139, 1143], [4325, 4328], [5095, 5098], [5099, 5102], [5103, 5104], [6658, 6662]]}, "coref_non_salient": {"0": [[1590, 1596], [1619, 1622], [1643, 1646], [1684, 1687], [1717, 1720]], "1": [[765, 775], [1040, 1043], [1104, 1107], [1145, 1148], [1177, 1180], [2938, 2941], [6527, 6530], [6687, 6690]], "10": [[2292, 2295], [2337, 2340], [2405, 2408], [2411, 2414], [2493, 2496]], "100": [[2084, 2089]], "101": [[3847, 3849]], "102": [[5043, 5045]], "103": [[1699, 1701]], "104": [[4600, 4607]], "105": [[575, 579]], "106": [[1766, 1769]], "107": [[1061, 1066]], "108": [[112, 114], [5715, 5717]], "109": [[829, 832]], "11": [[3785, 3786], [4667, 4668]], "110": [[1968, 1970]], "111": [[1950, 1954]], "112": [[2489, 2491]], "113": [[2207, 2208]], "114": [[4690, 4692]], "115": [[1946, 1949]], "116": [[2953, 2956]], "117": [[913, 918]], "118": [[580, 583]], "119": [[4223, 4226]], "12": [[919, 920], [1402, 1403], [1445, 1446], [1633, 1634], [1697, 1698], [1770, 1771], [3081, 3082], [3356, 3357], [3552, 3553], [6422, 6423], [6672, 6673], [959, 960], [2944, 2945], [3016, 3017], [4594, 4595]], "120": [[1352, 1353], [1299, 1300], [1605, 1606]], "121": [[4151, 4152]], "122": [[6347, 6349]], "123": [[2793, 2794]], "124": [[585, 587]], "125": [[909, 911], [6578, 6580]], "126": [[962, 965]], "127": [[588, 590]], "128": [[1898, 1901]], "129": [[4376, 4378], [4405, 4407]], "13": [[149, 152], [1091, 1094], [1155, 1158], [4089, 4092], [4194, 4197], [6052, 6055], [6675, 6678]], "130": [[25, 29]], "131": [[3181, 3186]], "14": [[178, 180], [263, 265], [311, 315], [358, 362]], "15": [[1399, 1401], [2266, 2271]], "16": [[1056, 1060], [1247, 1251], [1278, 1282], [3820, 3824], [3833, 3835], [3841, 3845], [3893, 3897], [3924, 3928], [3962, 3966], [4895, 4899]], "17": [[6332, 6334]], "18": [[4705, 4707], [4713, 4715], [4794, 4796], [5059, 5061], [5172, 5174], [6321, 6323]], "19": [[1810, 1812], [1836, 1838]], "2": [[3774, 3776], [3804, 3806], [5214, 5216], [5219, 5221]], "20": [[3750, 3753]], "21": [[5038, 5042], [6379, 6383]], "22": [[1375, 1377], [1384, 1386], [6047, 6049]], "23": [[1325, 1326], [459, 460]], "24": [[4093, 4098], [6338, 6343]], "25": [[364, 366], [408, 410], [599, 601], [741, 744]], "26": [[2113, 2115], [3722, 3724]], "27": [[1775, 1781], [2008, 2011]], "28": [[4751, 4753]], "29": [[164, 167], [213, 216], [251, 255]], "3": [[1826, 1831], [4472, 4474]], "30": [[902, 904], [3174, 3176], [3215, 3217]], "31": [[938, 940], [973, 975], [2067, 2069], [3128, 3130], [5768, 5770]], "32": [[2957, 2960], [3555, 3558], [3675, 3678], [4409, 4412], [4812, 4815], [4848, 4851], [4934, 4937], [5079, 5082], [5189, 5192], [5269, 5272], [6031, 6034], [6061, 6064], [6416, 6419], [6437, 6440], [6480, 6483], [6624, 6627], [6666, 6669]], "33": [[0, 5], [85, 90], [2211, 2216]], "34": [[80, 82], [441, 443]], "35": [[5227, 5228]], "36": [[5237, 5238]], "37": [[4371, 4374], [4384, 4387], [4435, 4438], [4462, 4465], [4818, 4821], [5047, 5050], [6386, 6389]], "38": [[1208, 1210], [2660, 2662]], "39": [[4970, 4972]], "4": [[1267, 1270], [3942, 3945], [3953, 3956], [4885, 4888], [4960, 4962], [6425, 6428]], "40": [[6710, 6711]], "41": [[2141, 2142]], "42": [[2132, 2133]], "43": [[2287, 2291], [2303, 2307], [2341, 2345], [2356, 2360]], "44": [[4127, 4130]], "45": [[966, 967], [3354, 3355]], "46": [[5242, 5243]], "47": [[4120, 4123]], "48": [[2230, 2232], [2774, 2776]], "49": [[2706, 2708]], "5": [[837, 839], [2797, 2799], [3517, 3519], [5265, 5267], [5744, 5746], [6612, 6614]], "50": [[1001, 1003], [2849, 2851]], "51": [[21, 24], [281, 284]], "52": [[6066, 6072]], "53": [[3812, 3813], [3921, 3922]], "54": [[6703, 6706]], "55": [[3530, 3534]], "56": [[5449, 5452]], "57": [[3727, 3731]], "58": [[4162, 4165]], "59": [[2316, 2319], [2362, 2365], [2369, 2372], [2389, 2392], [2433, 2436], [2480, 2483]], "6": [[162, 163], [571, 574]], "60": [[2311, 2315], [2377, 2381]], "61": [[494, 497], [1464, 1467], [1572, 1575]], "62": [[6397, 6400], [6431, 6435]], "63": [[1986, 1988]], "64": [[4380, 4382], [4423, 4425]], "65": [[4440, 4442]], "66": [[556, 558]], "67": [[502, 504]], "68": [[1273, 1275]], "69": [[6268, 6269]], "7": [[285, 286], [324, 325], [454, 455], [679, 680], [718, 719], [1152, 1153], [1316, 1317], [1694, 1695], [2564, 2565], [2644, 2645], [3223, 3224], [4663, 4664], [5851, 5852], [6549, 6550]], "70": [[4360, 4362]], "71": [[4169, 4171]], "72": [[3714, 3717]], "73": [[3671, 3673]], "74": [[3912, 3918]], "75": [[2525, 2530]], "76": [[4833, 4834]], "77": [[4698, 4699]], "78": [[4113, 4116]], "79": [[1327, 1329]], "8": [[2077, 2078], [2094, 2095]], "80": [[4131, 4135]], "81": [[1904, 1905]], "82": [[5671, 5675]], "83": [[10, 14]], "84": [[1815, 1818]], "85": [[273, 276]], "86": [[2097, 2099]], "87": [[1611, 1613]], "88": [[2614, 2615]], "89": [[2137, 2139]], "9": [[986, 988], [3245, 3247], [3251, 3253], [3319, 3321], [5662, 5664]], "90": [[2000, 2004]], "91": [[4141, 4144]], "92": [[865, 868]], "93": [[4427, 4430]], "94": [[3768, 3773]], "95": [[2759, 2762]], "96": [[1737, 1739]], "97": [[6361, 6364]], "98": [[1408, 1411]], "99": [[1807, 1808]]}, "doc_id": "0ca2bd0e40a8f0a57665535ae1c31561370ad183", "method_subrelations": {"LN_HM-LSTM": [[[0, 10], "LN_HM-LSTM"]], "LayerNorm_HM-LSTM": [[[0, 17], "LayerNorm_HM-LSTM"]]}, "n_ary_relations": [{"Material": "Text8", "Method": "LayerNorm_HM-LSTM", "Metric": "Bit_per_Character__BPC_", "Task": "Language_Modelling", "score": "1.29"}, {"Material": "Text8", "Method": "LayerNorm_HM-LSTM", "Metric": "Number_of_params", "Task": "Language_Modelling", "score": "35M"}, {"Material": "enwiki8", "Method": "LN_HM-LSTM", "Metric": "Bit_per_Character__BPC_", "Task": "Language_Modelling", "score": "1.32"}, {"Material": "enwiki8", "Method": "LN_HM-LSTM", "Metric": "Number_of_params", "Task": "Language_Modelling", "score": "35M"}], "ner": [[0, 5, "Method"], [10, 14, "Task"], [21, 24, "Method"], [25, 29, "Method"], [80, 82, "Method"], [85, 90, "Method"], [112, 114, "Method"], [143, 148, "Task"], [149, 152, "Task"], [162, 163, "Task"], [164, 167, "Method"], [178, 180, "Method"], [213, 216, "Method"], [251, 255, "Method"], [263, 265, "Method"], [273, 276, "Task"], [281, 284, "Method"], [285, 286, "Method"], [311, 315, "Method"], [324, 325, "Method"], [358, 362, "Method"], [364, 366, "Method"], [408, 410, "Method"], [441, 443, "Method"], [454, 455, "Method"], [494, 497, "Task"], [502, 504, "Task"], [556, 558, "Task"], [571, 574, "Task"], [575, 579, "Task"], [580, 583, "Task"], [585, 587, "Task"], [588, 590, "Task"], [599, 601, "Method"], [679, 680, "Method"], [718, 719, "Method"], [741, 744, "Method"], [765, 775, "Method"], [829, 832, "Method"], [837, 839, "Method"], [865, 868, "Task"], [902, 904, "Method"], [909, 911, "Method"], [913, 918, "Method"], [919, 920, "Method"], [938, 940, "Method"], [962, 965, "Method"], [966, 967, "Method"], [973, 975, "Method"], [986, 988, "Method"], [1001, 1003, "Method"], [1040, 1043, "Method"], [1056, 1060, "Method"], [1061, 1066, "Method"], [1085, 1090, "Task"], [1091, 1094, "Task"], [1097, 1102, "Task"], [1104, 1107, "Method"], [1119, 1121, "Material"], [1139, 1143, "Material"], [1145, 1148, "Method"], [1152, 1153, "Method"], [1155, 1158, "Task"], [1177, 1180, "Method"], [1208, 1210, "Method"], [1247, 1251, "Method"], [1267, 1270, "Method"], [1273, 1275, "Method"], [1278, 1282, "Method"], [1316, 1317, "Method"], [1325, 1326, "Metric"], [1327, 1329, "Metric"], [1352, 1353, "Method"], [1375, 1377, "Method"], [1384, 1386, "Method"], [1399, 1401, "Method"], [1402, 1403, "Method"], [1408, 1411, "Method"], [1445, 1446, "Method"], [1464, 1467, "Task"], [1572, 1575, "Task"], [1590, 1596, "Method"], [1611, 1613, "Method"], [1619, 1622, "Method"], [1633, 1634, "Method"], [1643, 1646, "Method"], [1684, 1687, "Method"], [1694, 1695, "Method"], [1697, 1698, "Method"], [1699, 1701, "Method"], [1717, 1720, "Method"], [1737, 1739, "Method"], [1766, 1769, "Method"], [1770, 1771, "Method"], [1775, 1781, "Method"], [1807, 1808, "Method"], [1810, 1812, "Method"], [1815, 1818, "Task"], [1826, 1831, "Method"], [1836, 1838, "Method"], [1898, 1901, "Task"], [1904, 1905, "Task"], [1946, 1949, "Method"], [1950, 1954, "Method"], [1965, 1967, "Task"], [1968, 1970, "Task"], [1986, 1988, "Method"], [2000, 2004, "Method"], [2008, 2011, "Method"], [2067, 2069, "Method"], [2077, 2078, "Method"], [2084, 2089, "Method"], [2094, 2095, "Method"], [2097, 2099, "Method"], [2113, 2115, "Method"], [2132, 2133, "Task"], [2137, 2139, "Method"], [2141, 2142, "Method"], [2207, 2208, "Metric"], [2211, 2216, "Method"], [2230, 2232, "Method"], [2266, 2271, "Method"], [2272, 2274, "Task"], [2287, 2291, "Method"], [2292, 2295, "Method"], [2303, 2307, "Method"], [2311, 2315, "Method"], [2316, 2319, "Method"], [2337, 2340, "Method"], [2341, 2345, "Method"], [2356, 2360, "Method"], [2362, 2365, "Method"], [2369, 2372, "Method"], [2377, 2381, "Method"], [2389, 2392, "Method"], [2405, 2408, "Method"], [2411, 2414, "Method"], [2433, 2436, "Method"], [2480, 2483, "Method"], [2489, 2491, "Metric"], [2493, 2496, "Method"], [2525, 2530, "Method"], [2564, 2565, "Method"], [2614, 2615, "Task"], [2644, 2645, "Method"], [2660, 2662, "Method"], [2706, 2708, "Method"], [2759, 2762, "Method"], [2774, 2776, "Method"], [2793, 2794, "Metric"], [2797, 2799, "Method"], [2849, 2851, "Method"], [2938, 2941, "Method"], [2953, 2956, "Method"], [2957, 2960, "Method"], [2964, 2971, "Method"], [3081, 3082, "Method"], [3128, 3130, "Method"], [3174, 3176, "Method"], [3181, 3186, "Task"], [3215, 3217, "Method"], [3223, 3224, "Method"], [3245, 3247, "Method"], [3251, 3253, "Method"], [3319, 3321, "Method"], [3354, 3355, "Method"], [3356, 3357, "Method"], [3517, 3519, "Method"], [3530, 3534, "Method"], [3552, 3553, "Method"], [3555, 3558, "Method"], [3671, 3673, "Method"], [3675, 3678, "Method"], [3714, 3717, "Method"], [3722, 3724, "Method"], [3727, 3731, "Method"], [3750, 3753, "Method"], [3768, 3773, "Task"], [3774, 3776, "Method"], [3785, 3786, "Method"], [3804, 3806, "Method"], [3812, 3813, "Method"], [3820, 3824, "Method"], [3833, 3835, "Method"], [3841, 3845, "Method"], [3847, 3849, "Method"], [3893, 3897, "Method"], [3912, 3918, "Method"], [3921, 3922, "Method"], [3924, 3928, "Method"], [3942, 3945, "Method"], [3953, 3956, "Method"], [3962, 3966, "Method"], [4083, 4088, "Task"], [4089, 4092, "Task"], [4093, 4098, "Method"], [4113, 4116, "Method"], [4120, 4123, "Method"], [4127, 4130, "Method"], [4131, 4135, "Method"], [4141, 4144, "Method"], [4151, 4152, "Method"], [4156, 4158, "Method"], [4162, 4165, "Method"], [4169, 4171, "Method"], [4194, 4197, "Task"], [4217, 4222, "Task"], [4223, 4226, "Task"], [4320, 4321, "Material"], [4325, 4328, "Material"], [4332, 4337, "Metric"], [4338, 4339, "Metric"], [4360, 4362, "Metric"], [4371, 4374, "Method"], [4376, 4378, "Method"], [4380, 4382, "Method"], [4384, 4387, "Method"], [4405, 4407, "Method"], [4409, 4412, "Method"], [4423, 4425, "Method"], [4427, 4430, "Method"], [4435, 4438, "Method"], [4440, 4442, "Method"], [4462, 4465, "Method"], [4472, 4474, "Method"], [4589, 4590, "Material"], [4591, 4592, "Metric"], [4600, 4607, "Method"], [4613, 4614, "Metric"], [4616, 4619, "Material"], [4663, 4664, "Method"], [4667, 4668, "Method"], [4690, 4692, "Method"], [4698, 4699, "Method"], [4705, 4707, "Metric"], [4713, 4715, "Metric"], [4751, 4753, "Method"], [4765, 4770, "Task"], [4794, 4796, "Metric"], [4812, 4815, "Method"], [4818, 4821, "Method"], [4833, 4834, "Metric"], [4848, 4851, "Method"], [4879, 4880, "Metric"], [4885, 4888, "Method"], [4895, 4899, "Method"], [4934, 4937, "Method"], [4938, 4941, "Metric"], [4960, 4962, "Method"], [4970, 4972, "Method"], [4980, 4981, "Material"], [4982, 4984, "Material"], [5000, 5001, "Material"], [5038, 5042, "Method"], [5043, 5045, "Method"], [5047, 5050, "Method"], [5059, 5061, "Metric"], [5079, 5082, "Method"], [5092, 5093, "Metric"], [5095, 5098, "Material"], [5099, 5102, "Material"], [5103, 5104, "Material"], [5172, 5174, "Metric"], [5177, 5178, "Material"], [5189, 5192, "Method"], [5195, 5196, "Metric"], [5214, 5216, "Method"], [5219, 5221, "Method"], [5227, 5228, "Task"], [5237, 5238, "Method"], [5242, 5243, "Method"], [5265, 5267, "Method"], [5269, 5272, "Method"], [5292, 5296, "Material"], [5449, 5452, "Method"], [5662, 5664, "Method"], [5671, 5675, "Task"], [5715, 5717, "Method"], [5744, 5746, "Method"], [5768, 5770, "Method"], [5851, 5852, "Method"], [6031, 6034, "Method"], [6047, 6049, "Method"], [6052, 6055, "Task"], [6061, 6064, "Method"], [6066, 6072, "Task"], [6268, 6269, "Task"], [6321, 6323, "Metric"], [6332, 6334, "Method"], [6338, 6343, "Method"], [6347, 6349, "Method"], [6361, 6364, "Method"], [6379, 6383, "Method"], [6386, 6389, "Method"], [6397, 6400, "Metric"], [6416, 6419, "Method"], [6422, 6423, "Method"], [6425, 6428, "Method"], [6431, 6435, "Metric"], [6437, 6440, "Method"], [6480, 6483, "Method"], [6527, 6530, "Method"], [6549, 6550, "Method"], [6578, 6580, "Method"], [6612, 6614, "Method"], [6617, 6622, "Task"], [6624, 6627, "Method"], [6638, 6640, "Material"], [6658, 6662, "Material"], [6666, 6669, "Method"], [6672, 6673, "Method"], [6675, 6678, "Task"], [6687, 6690, "Method"], [6703, 6706, "Method"], [6710, 6711, "Task"], [459, 460, "Metric"], [959, 960, "Method"], [1299, 1300, "Method"], [1605, 1606, "Method"], [2944, 2945, "Method"], [3016, 3017, "Method"], [4594, 4595, "Method"]], "sections": [[0, 5], [5, 153], [153, 1283], [1283, 2216], [2216, 2743], [2743, 3766], [3766, 4071], [4071, 4215], [4215, 4587], [4587, 4978], [4978, 6050], [6050, 6517], [6517, 6713], [6713, 6715], [6715, 6830], [6830, 6832]], "sentences": [[0, 5], [5, 8], [8, 25], [25, 72], [72, 115], [115, 137], [137, 153], [153, 156], [156, 241], [241, 245], [245, 268], [268, 277], [277, 292], [292, 302], [302, 352], [352, 420], [420, 542], [542, 591], [591, 602], [602, 696], [696, 733], [733, 760], [760, 798], [798, 822], [822, 836], [836, 859], [859, 874], [874, 901], [901, 937], [937, 953], [953, 985], [985, 1023], [1023, 1052], [1052, 1077], [1077, 1095], [1095, 1144], [1144, 1165], [1165, 1193], [1193, 1200], [1200, 1201], [1201, 1226], [1226, 1227], [1227, 1242], [1242, 1243], [1243, 1263], [1263, 1264], [1264, 1283], [1283, 1287], [1287, 1300], [1300, 1304], [1304, 1330], [1330, 1350], [1350, 1380], [1380, 1402], [1402, 1430], [1430, 1443], [1443, 1505], [1505, 1527], [1527, 1565], [1565, 1584], [1584, 1597], [1597, 1618], [1618, 1641], [1641, 1683], [1683, 1710], [1710, 1735], [1735, 1772], [1772, 1796], [1796, 1834], [1834, 1850], [1850, 1868], [1868, 1892], [1892, 1929], [1929, 1971], [1971, 2008], [2008, 2022], [2022, 2028], [2028, 2066], [2066, 2116], [2116, 2128], [2128, 2186], [2186, 2210], [2210, 2216], [2216, 2219], [2219, 2256], [2256, 2321], [2321, 2366], [2366, 2382], [2382, 2409], [2409, 2458], [2458, 2522], [2522, 2562], [2562, 2576], [2576, 2629], [2629, 2649], [2649, 2682], [2682, 2688], [2688, 2743], [2743, 2748], [2748, 2795], [2795, 2864], [2864, 2889], [2889, 2931], [2931, 2948], [2948, 2962], [2962, 2977], [2977, 2978], [2978, 2996], [2996, 2997], [2997, 3011], [3011, 3022], [3022, 3043], [3043, 3052], [3052, 3077], [3077, 3100], [3100, 3127], [3127, 3138], [3138, 3173], [3173, 3212], [3212, 3238], [3238, 3250], [3250, 3291], [3291, 3316], [3316, 3358], [3358, 3404], [3404, 3405], [3405, 3410], [3410, 3411], [3411, 3435], [3435, 3442], [3442, 3475], [3475, 3492], [3492, 3505], [3505, 3509], [3509, 3510], [3510, 3524], [3524, 3542], [3542, 3549], [3549, 3598], [3598, 3622], [3622, 3661], [3661, 3664], [3664, 3681], [3681, 3682], [3682, 3694], [3694, 3701], [3701, 3718], [3718, 3733], [3733, 3766], [3766, 3773], [3773, 3797], [3797, 3840], [3840, 3892], [3892, 3923], [3923, 3941], [3941, 3946], [3946, 3967], [3967, 3988], [3988, 4015], [4015, 4045], [4045, 4071], [4071, 4074], [4074, 4093], [4093, 4112], [4112, 4140], [4140, 4144], [4144, 4150], [4150, 4155], [4155, 4161], [4161, 4183], [4183, 4215], [4215, 4222], [4222, 4246], [4246, 4274], [4274, 4300], [4300, 4301], [4301, 4329], [4329, 4363], [4363, 4364], [4364, 4383], [4383, 4404], [4404, 4422], [4422, 4443], [4443, 4456], [4456, 4477], [4477, 4510], [4510, 4526], [4526, 4536], [4536, 4546], [4546, 4552], [4552, 4587], [4587, 4590], [4590, 4600], [4600, 4620], [4620, 4622], [4622, 4638], [4638, 4669], [4669, 4693], [4693, 4710], [4710, 4730], [4730, 4742], [4742, 4748], [4748, 4761], [4761, 4797], [4797, 4822], [4822, 4845], [4845, 4877], [4877, 4900], [4900, 4933], [4933, 4944], [4944, 4978], [4978, 4981], [4981, 5000], [5000, 5015], [5015, 5032], [5032, 5051], [5051, 5070], [5070, 5078], [5078, 5095], [5095, 5098], [5098, 5119], [5119, 5158], [5158, 5179], [5179, 5217], [5217, 5247], [5247, 5252], [5252, 5297], [5297, 5317], [5317, 5340], [5340, 5387], [5387, 5405], [5405, 5449], [5449, 5453], [5453, 5478], [5478, 5496], [5496, 5517], [5517, 5545], [5545, 5575], [5575, 5600], [5600, 5620], [5620, 5647], [5647, 5699], [5699, 5712], [5712, 5747], [5747, 5771], [5771, 5797], [5797, 5818], [5818, 5837], [5837, 5856], [5856, 5896], [5896, 5897], [5897, 5922], [5922, 5946], [5946, 5957], [5957, 5977], [5977, 5988], [5988, 6018], [6018, 6050], [6050, 6055], [6055, 6079], [6079, 6141], [6141, 6183], [6183, 6219], [6219, 6245], [6245, 6256], [6256, 6274], [6274, 6283], [6283, 6308], [6308, 6328], [6328, 6358], [6358, 6390], [6390, 6412], [6412, 6424], [6424, 6446], [6446, 6468], [6468, 6473], [6473, 6517], [6517, 6520], [6520, 6541], [6541, 6561], [6561, 6591], [6591, 6615], [6615, 6663], [6663, 6679], [6679, 6713], [6713, 6715], [6715, 6718], [6718, 6740], [6740, 6782], [6782, 6808], [6808, 6830], [6830, 6832]], "words": ["HIERARCHICAL", "MULTISCALE", "RECURRENT", "NEURAL", "NETWORKS", "section", ":", "ABSTRACT", "Learning", "both", "hierarchical", "and", "temporal", "representation", "has", "been", "among", "the", "longstanding", "challenges", "of", "recurrent", "neural", "networks", ".", "Multiscale", "recurrent", "neural", "networks", "have", "been", "considered", "as", "a", "promising", "approach", "to", "resolve", "this", "issue", ",", "yet", "there", "has", "been", "a", "lack", "of", "empirical", "evidence", "showing", "that", "this", "type", "of", "models", "can", "actually", "capture", "the", "temporal", "dependencies", "by", "discovering", "the", "latent", "hierarchical", "structure", "of", "the", "sequence", ".", "In", "this", "paper", ",", "we", "propose", "a", "novel", "multiscale", "approach", ",", "called", "the", "hierarchical", "multiscale", "recurrent", "neural", "network", ",", "that", "can", "capture", "the", "latent", "hierarchical", "structure", "in", "the", "sequence", "by", "encoding", "the", "temporal", "dependencies", "with", "different", "timescales", "using", "a", "novel", "update", "mechanism", ".", "We", "show", "some", "evidence", "that", "the", "proposed", "model", "can", "discover", "underlying", "hierarchical", "structure", "in", "the", "sequences", "without", "using", "explicit", "boundary", "information", ".", "We", "evaluate", "our", "proposed", "model", "on", "character", "-", "level", "language", "modelling", "and", "handwriting", "sequence", "generation", ".", "section", ":", "INTRODUCTION", "One", "of", "the", "key", "principles", "of", "learning", "in", "deep", "neural", "networks", "as", "well", "as", "in", "the", "human", "brain", "is", "to", "obtain", "a", "hierarchical", "representation", "with", "increasing", "levels", "of", "abstraction", "[", "reference", "][", "reference", "][", "reference", "]", ".", "A", "stack", "of", "representation", "layers", ",", "learned", "from", "the", "data", "in", "a", "way", "to", "optimize", "the", "target", "task", ",", "make", "deep", "neural", "networks", "entertain", "advantages", "such", "as", "generalization", "to", "unseen", "examples", "[", "reference", "]", ",", "sharing", "learned", "knowledge", "among", "multiple", "tasks", ",", "and", "discovering", "disentangling", "factors", "of", "variation", "[", "reference", "]", ".", "The", "remarkable", "recent", "successes", "of", "the", "deep", "convolutional", "neural", "networks", "are", "particularly", "based", "on", "this", "ability", "to", "learn", "hierarchical", "representation", "for", "spatial", "data", "[", "reference", "]", ".", "For", "modelling", "temporal", "data", ",", "the", "recent", "resurgence", "of", "recurrent", "neural", "networks", "(", "RNN", ")", "has", "led", "to", "remarkable", "advances", "[", "reference", "][", "reference", "][", "reference", "][", "reference", "]", ".", "However", ",", "unlike", "the", "spatial", "data", ",", "learning", "both", "hierarchical", "and", "temporal", "representation", "has", "been", "among", "the", "long", "-", "standing", "challenges", "of", "RNNs", "in", "spite", "of", "the", "fact", "that", "hierarchical", "multiscale", "structures", "naturally", "exist", "in", "many", "temporal", "data", "[", "reference", "][", "reference", "][", "reference", "][", "reference", "][", "reference", "]", ".", "A", "promising", "approach", "to", "model", "such", "hierarchical", "and", "temporal", "representation", "is", "the", "multiscale", "RNNs", "[", "reference", "][", "reference", "][", "reference", "]", ".", "Based", "on", "the", "observation", "that", "high", "-", "level", "abstraction", "changes", "slowly", "with", "temporal", "coherency", "while", "low", "-", "level", "abstraction", "has", "quickly", "changing", "features", "sensitive", "to", "the", "precise", "local", "timing", "[", "reference", "]", ",", "the", "multiscale", "RNNs", "group", "hidden", "units", "into", "multiple", "modules", "of", "different", "timescales", ".", "In", "addition", "to", "the", "fact", "that", "the", "architecture", "fits", "naturally", "to", "the", "latent", "hierarchical", "structures", "in", "many", "temporal", "data", ",", "the", "multiscale", "approach", "provides", "the", "following", "advantages", "that", "resolve", "some", "inherent", "problems", "of", "standard", "RNNs", ":", "(", "a", ")", "computational", "efficiency", "obtained", "by", "updating", "the", "high", "-", "level", "layers", "less", "frequently", ",", "(", "b", ")", "efficiently", "delivering", "long", "-", "term", "dependencies", "with", "fewer", "updates", "at", "the", "high", "-", "level", "layers", ",", "which", "mitigates", "the", "vanishing", "gradient", "problem", ",", "(", "c", ")", "flexible", "resource", "allocation", "(", "e.g.", ",", "more", "hidden", "units", "to", "the", "higher", "layers", "that", "focus", "on", "modelling", "long", "-", "term", "dependencies", "and", "less", "hidden", "units", "to", "the", "lower", "layers", "which", "are", "in", "charge", "of", "learning", "short", "-", "term", "dependencies", ")", ".", "In", "addition", ",", "the", "learned", "latent", "hierarchical", "structures", "can", "provide", "useful", "information", "to", "other", "downstream", "tasks", "such", "Published", "as", "a", "conference", "paper", "at", "ICLR", "2017", "as", "module", "structures", "in", "computer", "program", "learning", ",", "sub", "-", "task", "structures", "in", "hierarchical", "reinforcement", "learning", ",", "and", "story", "segments", "in", "video", "understanding", ".", "There", "have", "been", "various", "approaches", "to", "implementing", "the", "multiscale", "RNNs", ".", "The", "most", "popular", "approach", "is", "to", "set", "the", "timescales", "as", "hyperparameters", "[", "reference", "][", "reference", "]", "instead", "of", "treating", "them", "as", "dynamic", "variables", "that", "can", "be", "learned", "from", "the", "data", "[", "reference", "][", "reference", "][", "reference", "]", ".", "However", ",", "considering", "the", "fact", "that", "non", "-", "stationarity", "is", "prevalent", "in", "temporal", "data", ",", "and", "that", "many", "entities", "of", "abstraction", "such", "as", "words", "and", "sentences", "are", "in", "variable", "length", ",", "we", "claim", "that", "it", "is", "important", "for", "an", "RNN", "to", "dynamically", "adapt", "its", "timescales", "to", "the", "particulars", "of", "the", "input", "entities", "of", "various", "length", ".", "While", "this", "is", "trivial", "if", "the", "hierarchical", "boundary", "structure", "is", "provided", "[", "reference", "]", ",", "it", "has", "been", "a", "challenge", "for", "an", "RNN", "to", "discover", "the", "latent", "hierarchical", "structure", "in", "temporal", "data", "without", "explicit", "boundary", "information", ".", "In", "this", "paper", ",", "we", "propose", "a", "novel", "multiscale", "RNN", "model", ",", "which", "can", "learn", "the", "hierarchical", "multiscale", "structure", "from", "temporal", "data", "without", "explicit", "boundary", "information", ".", "This", "model", ",", "called", "a", "hierarchical", "multiscale", "recurrent", "neural", "network", "(", "HM", "-", "RNN", ")", ",", "does", "not", "assign", "fixed", "update", "rates", ",", "but", "adaptively", "determines", "proper", "update", "times", "corresponding", "to", "different", "abstraction", "levels", "of", "the", "layers", ".", "We", "find", "that", "this", "model", "tends", "to", "learn", "fine", "timescales", "for", "low", "-", "level", "layers", "and", "coarse", "timescales", "for", "high", "-", "level", "layers", ".", "To", "do", "this", ",", "we", "introduce", "a", "binary", "boundary", "detector", "at", "each", "layer", ".", "The", "boundary", "detector", "is", "turned", "on", "only", "at", "the", "time", "steps", "where", "a", "segment", "of", "the", "corresponding", "abstraction", "level", "is", "completely", "processed", ".", "Otherwise", ",", "i.e.", ",", "during", "the", "within", "segment", "processing", ",", "it", "stays", "turned", "off", ".", "Using", "the", "hierarchical", "boundary", "states", ",", "we", "implement", "three", "operations", ",", "UPDATE", ",", "COPY", "and", "FLUSH", ",", "and", "choose", "one", "of", "them", "at", "each", "time", "step", ".", "The", "UPDATE", "operation", "is", "similar", "to", "the", "usual", "update", "rule", "of", "the", "long", "short", "-", "term", "memory", "(", "LSTM", ")", "[", "reference", "]", ",", "except", "that", "it", "is", "executed", "sparsely", "according", "to", "the", "detected", "boundaries", ".", "The", "COPY", "operation", "simply", "copies", "the", "cell", "and", "hidden", "states", "of", "the", "previous", "time", "step", ".", "Unlike", "the", "leaky", "integration", "of", "the", "LSTM", "or", "the", "Gated", "Recurrent", "Unit", "(", "GRU", ")", "[", "reference", "]", ",", "the", "COPY", "operation", "retains", "the", "whole", "states", "without", "any", "loss", "of", "information", ".", "The", "FLUSH", "operation", "is", "executed", "when", "a", "boundary", "is", "detected", ",", "where", "it", "first", "ejects", "the", "summarized", "representation", "of", "the", "current", "segment", "to", "the", "upper", "layer", "and", "then", "reinitializes", "the", "states", "to", "start", "processing", "the", "next", "segment", ".", "Learning", "to", "select", "a", "proper", "operation", "at", "each", "time", "step", "and", "to", "detect", "the", "boundaries", ",", "the", "HM", "-", "RNN", "discovers", "the", "latent", "hierarchical", "structure", "of", "the", "sequences", ".", "We", "find", "that", "the", "straight", "-", "through", "estimator", "[", "reference", "][", "reference", "][", "reference", "]", "is", "efficient", "for", "training", "this", "model", "containing", "discrete", "variables", ".", "We", "evaluate", "our", "model", "on", "two", "tasks", ":", "character", "-", "level", "language", "modelling", "and", "handwriting", "sequence", "generation", ".", "For", "the", "character", "-", "level", "language", "modelling", ",", "the", "HM", "-", "RNN", "achieves", "the", "state", "-", "of", "-", "the", "-", "art", "results", "on", "the", "Text8", "dataset", ",", "and", "comparable", "results", "to", "the", "state", "-", "of", "-", "the", "-", "art", "on", "the", "Penn", "Treebank", "and", "Hutter", "Prize", "Wikipedia", "datasets", ".", "The", "HM", "-", "RNN", "also", "outperforms", "the", "standard", "RNN", "on", "the", "handwriting", "sequence", "generation", "using", "the", "IAM", "-", "OnDB", "dataset", ".", "In", "addition", ",", "we", "demonstrate", "that", "the", "hierarchical", "structure", "found", "by", "the", "HM", "-", "RNN", "is", "indeed", "very", "similar", "to", "the", "intrinsic", "structure", "observed", "in", "the", "data", ".", "The", "contributions", "of", "this", "paper", "are", ":", "\u2022", "We", "propose", "for", "the", "first", "time", "an", "RNN", "model", "that", "can", "learn", "a", "latent", "hierarchical", "structure", "of", "a", "sequence", "without", "using", "explicit", "boundary", "information", ".", "\u2022", "We", "show", "that", "it", "is", "beneficial", "to", "utilize", "the", "above", "structure", "through", "empirical", "evaluation", ".", "\u2022", "We", "show", "that", "the", "straight", "-", "through", "estimator", "is", "an", "efficient", "way", "of", "training", "a", "model", "containing", "discrete", "variables", ".", "\u2022", "We", "propose", "the", "slope", "annealing", "trick", "to", "improve", "the", "training", "procedure", "based", "on", "the", "straight", "-", "through", "estimator", ".", "section", ":", "RELATED", "WORK", "Two", "notable", "early", "attempts", "inspiring", "our", "model", "are", "[", "reference", "]", "and", "El", "[", "reference", "]", ".", "In", "these", "works", ",", "it", "is", "advocated", "to", "stack", "multiple", "layers", "of", "RNNs", "in", "a", "decreasing", "order", "of", "update", "frequency", "for", "computational", "and", "learning", "efficiency", ".", "In", "[", "reference", "]", ",", "the", "author", "shows", "a", "model", "that", "can", "self", "-", "organize", "a", "hierarchical", "multiscale", "structure", ".", "Particularly", "in", "El", "[", "reference", "]", ",", "the", "advantages", "of", "incorporating", "a", "priori", "knowledge", ",", "\"", "temporal", "dependencies", "are", "structured", "hierarchically", "\"", ",", "into", "the", "RNN", "architecture", "is", "studied", ".", "The", "authors", "propose", "an", "RNN", "architecture", "that", "updates", "each", "layer", "with", "a", "fixed", "but", "different", "rate", ",", "called", "a", "hierarchical", "RNN", ".", "LSTMs", "[", "reference", "]", "employ", "the", "multiscale", "update", "concept", ",", "where", "the", "hidden", "units", "have", "different", "forget", "and", "update", "rates", "and", "thus", "can", "operate", "with", "different", "timescales", ".", "However", ",", "unlike", "our", "model", ",", "these", "timescales", "are", "not", "organized", "hierarchically", ".", "Although", "the", "LSTM", "has", "a", "selfloop", "for", "the", "gradients", "that", "helps", "to", "capture", "the", "long", "-", "term", "dependencies", "by", "mitigating", "the", "vanishing", "gradient", "problem", ",", "in", "practice", ",", "it", "is", "still", "limited", "to", "a", "few", "hundred", "time", "steps", "due", "to", "the", "leaky", "integration", "by", "which", "the", "contents", "to", "memorize", "for", "a", "long", "-", "term", "is", "gradually", "diluted", "at", "every", "time", "step", ".", "Also", ",", "the", "model", "remains", "computationally", "expensive", "because", "it", "has", "to", "perform", "the", "update", "at", "every", "time", "step", "for", "each", "unit", ".", "However", ",", "our", "model", "is", "less", "prone", "to", "these", "problems", "because", "it", "learns", "a", "hierarchical", "structure", "such", "that", ",", "by", "design", ",", "high", "-", "level", "layers", "learn", "to", "perform", "less", "frequent", "updates", "than", "low", "-", "level", "layers", ".", "We", "hypothesize", "that", "this", "property", "mitigates", "the", "vanishing", "gradient", "problem", "more", "efficiently", "while", "also", "being", "computationally", "more", "efficient", ".", "A", "more", "recent", "model", ",", "the", "clockwork", "RNN", "(", "CW", "-", "RNN", ")", "[", "reference", "]", "extends", "the", "hierarchical", "RNN", "(", "El", "[", "reference", "]", "and", "the", "NARX", "RNN", "[", "reference", "]", "1", ".", "The", "CW", "-", "RNN", "tries", "to", "solve", "the", "issue", "of", "using", "soft", "timescales", "in", "the", "LSTM", ",", "by", "explicitly", "assigning", "hard", "timescales", ".", "In", "the", "CW", "-", "RNN", ",", "hidden", "units", "are", "partitioned", "into", "several", "modules", ",", "and", "different", "timescales", "are", "assigned", "to", "the", "modules", "such", "that", "a", "module", "i", "updates", "its", "hidden", "units", "at", "every", "2", "(", "i\u22121", ")", "-", "th", "time", "step", ".", "The", "CW", "-", "RNN", "is", "computationally", "more", "efficient", "than", "the", "standard", "RNN", "including", "the", "LSTM", "since", "hidden", "units", "are", "updated", "only", "at", "the", "assigned", "clock", "rates", ".", "However", ",", "finding", "proper", "timescales", "in", "the", "CW", "-", "RNN", "remains", "as", "a", "challenge", "whereas", "our", "model", "learns", "the", "intrinsic", "timescales", "from", "the", "data", ".", "In", "the", "biscale", "RNNs", "[", "reference", "]", ",", "the", "authors", "proposed", "to", "model", "layer", "-", "wise", "timescales", "adaptively", "by", "having", "additional", "gating", "units", ",", "however", "this", "approach", "still", "relies", "on", "the", "soft", "gating", "mechanism", "like", "LSTMs", ".", "Other", "forms", "of", "Hierarchical", "RNN", "(", "HRNN", ")", "architectures", "have", "been", "proposed", "in", "the", "cases", "where", "the", "explicit", "hierarchical", "boundary", "structure", "is", "provided", ".", "In", "[", "reference", "]", ",", "after", "obtaining", "the", "word", "boundary", "via", "tokenization", ",", "the", "HRNN", "architecture", "is", "used", "for", "neural", "machine", "translation", "by", "modelling", "the", "characters", "and", "words", "using", "the", "first", "and", "second", "RNN", "layers", ",", "respectively", ".", "A", "similar", "HRNN", "architecture", "is", "also", "adopted", "in", "[", "reference", "]", "to", "model", "dialogue", "utterances", ".", "However", ",", "in", "many", "cases", ",", "hierarchical", "boundary", "information", "is", "not", "explicitly", "observed", "or", "expensive", "to", "obtain", ".", "Also", ",", "it", "is", "unclear", "how", "to", "deploy", "more", "layers", "than", "the", "number", "of", "boundary", "levels", "that", "is", "explicitly", "observed", "in", "the", "data", ".", "While", "the", "above", "models", "focus", "on", "online", "prediction", "problems", ",", "where", "a", "prediction", "needs", "to", "be", "made", "by", "using", "only", "the", "past", "data", ",", "in", "some", "cases", ",", "predictions", "are", "made", "after", "observing", "the", "whole", "sequence", ".", "In", "this", "setting", ",", "the", "input", "sequence", "can", "be", "regarded", "as", "1", "-", "D", "spatial", "data", ",", "convolutional", "neural", "networks", "with", "1", "-", "D", "kernels", "are", "proposed", "in", "[", "reference", "]", "and", "[", "reference", "]", "for", "language", "modelling", "and", "sentence", "classification", ".", "Also", ",", "in", "[", "reference", "]", "and", ",", "the", "authors", "proposed", "to", "obtain", "high", "-", "level", "representation", "of", "the", "sequences", "of", "reduced", "length", "by", "repeatedly", "merging", "or", "pooling", "the", "lower", "-", "level", "representation", "of", "the", "sequences", ".", "Hierarchical", "RNN", "architectures", "have", "also", "been", "used", "to", "discover", "the", "segmentation", "structure", "in", "sequences", "[", "reference", "][", "reference", "]", ".", "It", "is", "however", "different", "to", "our", "model", "in", "the", "sense", "that", "they", "optimize", "the", "objective", "with", "explicit", "labels", "on", "the", "hierarchical", "segments", "while", "our", "model", "discovers", "the", "intrinsic", "structure", "only", "from", "the", "sequences", "without", "segment", "label", "information", ".", "The", "COPY", "operation", "used", "in", "our", "model", "can", "be", "related", "to", "Zoneout", "[", "reference", "]", "which", "is", "a", "recurrent", "generalization", "of", "stochastic", "depth", "[", "reference", "]", ".", "In", "Zoneout", ",", "an", "identity", "transformation", "is", "randomly", "applied", "to", "each", "hidden", "unit", "at", "each", "time", "step", "according", "to", "a", "Bernoulli", "distribution", ".", "This", "results", "in", "occasional", "copy", "operations", "of", "the", "previous", "hidden", "states", ".", "While", "the", "focus", "of", "Zoneout", "is", "to", "propose", "a", "regularization", "technique", "similar", "to", "dropout", "[", "reference", "]", "(", "where", "the", "regularization", "strength", "is", "controlled", "by", "a", "hyperparameter", ")", ",", "our", "model", "learns", "(", "a", ")", "to", "dynamically", "determine", "when", "to", "copy", "from", "the", "context", "inputs", "and", "(", "b", ")", "to", "discover", "the", "hierarchical", "multiscale", "structure", "and", "representation", ".", "Although", "the", "main", "goal", "of", "our", "proposed", "model", "is", "not", "regularization", ",", "we", "found", "that", "our", "model", "also", "shows", "very", "good", "generalization", "performance", ".", "3", "HIERARCHICAL", "MULTISCALE", "RECURRENT", "NEURAL", "NETWORKS", "section", ":", "MOTIVATION", "To", "begin", "with", ",", "we", "provide", "an", "example", "of", "how", "a", "stacked", "RNN", "can", "model", "temporal", "data", "in", "an", "ideal", "setting", ",", "i.e.", ",", "when", "the", "hierarchy", "of", "segments", "is", "provided", "[", "reference", "][", "reference", "]", ".", "In", "Figure", "1", "(", "a", ")", ",", "we", "depict", "a", "hierarchical", "RNN", "(", "HRNN", ")", "for", "language", "modelling", "with", "two", "layers", ":", "the", "first", "layer", "receives", "characters", "as", "inputs", "and", "generates", "word", "-", "level", "representations", "(", "C2W", "-", "RNN", ")", ",", "and", "the", "second", "layer", "takes", "the", "word", "-", "level", "representations", "as", "inputs", "and", "yields", "phrase", "-", "level", "representations", "(", "W2P", "-", "RNN", ")", ".", "As", "shown", ",", "by", "means", "of", "the", "provided", "end", "-", "of", "-", "word", "labels", ",", "the", "C2W", "-", "RNN", "obtains", "word", "-", "level", "representation", "after", "processing", "the", "last", "character", "of", "each", "word", "and", "passes", "the", "word", "-", "level", "representation", "to", "the", "W2P", "-", "RNN", ".", "Then", ",", "the", "W2P", "-", "RNN", "performs", "an", "update", "of", "the", "phrase", "-", "level", "representation", ".", "Note", "that", "the", "hidden", "states", "of", "the", "W2P", "-", "RNN", "remains", "unchanged", "while", "all", "the", "characters", "of", "a", "word", "are", "processed", "by", "the", "C2W", "-", "RNN", ".", "When", "the", "C2W", "-", "RNN", "starts", "to", "process", "the", "next", "word", ",", "its", "hidden", "states", "are", "reinitialized", "using", "the", "latest", "hidden", "states", "of", "the", "W2P", "-", "RNN", ",", "which", "contain", "summarized", "representation", "of", "all", "the", "words", "that", "have", "been", "processed", "by", "that", "time", "step", ",", "in", "that", "phrase", ".", "From", "this", "simple", "example", ",", "we", "can", "see", "the", "advantages", "of", "having", "a", "hierarchical", "multiscale", "structure", ":", "(", "1", ")", "as", "the", "W2P", "-", "RNN", "is", "updated", "at", "a", "much", "slower", "update", "rate", "than", "the", "C2W", "-", "RNN", ",", "a", "considerable", "amount", "of", "computation", "can", "be", "saved", ",", "(", "2", ")", "gradients", "are", "backpropagated", "through", "a", "much", "smaller", "number", "of", "time", "steps", ",", "and", "(", "3", ")", "layer", "-", "wise", "capacity", "control", "becomes", "possible", "(", "e.g.", ",", "use", "a", "smaller", "number", "of", "hidden", "units", "in", "the", "first", "layer", "which", "models", "short", "-", "term", "dependencies", "but", "whose", "updates", "are", "invoked", "much", "more", "often", ")", ".", "Can", "an", "RNN", "discover", "such", "hierarchical", "multiscale", "structure", "without", "explicit", "hierarchical", "boundary", "information", "?", "Considering", "the", "fact", "that", "the", "boundary", "information", "is", "difficult", "to", "obtain", "(", "for", "example", ",", "consider", "languages", "where", "words", "are", "not", "always", "cleanly", "separated", "by", "spaces", "or", "punctuation", "symbols", ",", "and", "imperfect", "rules", "are", "used", "to", "separately", "perform", "segmentation", ")", "or", "usually", "not", "provided", "at", "all", ",", "this", "is", "a", "legitimate", "problem", ".", "It", "gets", "worse", "when", "we", "consider", "higher", "-", "level", "concepts", "which", "we", "would", "like", "the", "RNN", "to", "discover", "autonomously", ".", "In", "Section", "2", ",", "we", "discussed", "the", "limitations", "of", "the", "existing", "RNN", "models", "under", "this", "setting", ",", "which", "either", "have", "to", "update", "all", "units", "at", "every", "time", "step", "or", "use", "fixed", "update", "frequencies", "[", "reference", "][", "reference", "]", ".", "Unfortunately", ",", "this", "kind", "of", "approach", "is", "not", "well", "suited", "to", "the", "case", "where", "different", "segments", "in", "the", "hierarchical", "decomposition", "have", "different", "lengths", ":", "for", "example", ",", "different", "words", "have", "different", "lengths", ",", "so", "a", "fixed", "hierarchy", "would", "not", "update", "its", "upper", "-", "level", "units", "in", "synchrony", "with", "the", "natural", "boundaries", "in", "the", "data", ".", "section", ":", "THE", "PROPOSED", "MODEL", "A", "key", "element", "of", "our", "model", "is", "the", "introduction", "of", "a", "parametrized", "boundary", "detector", ",", "which", "outputs", "a", "binary", "value", ",", "in", "each", "layer", "of", "a", "stacked", "RNN", ",", "and", "learns", "when", "a", "segment", "should", "end", "in", "such", "a", "way", "to", "optimize", "the", "overall", "target", "objective", ".", "Whenever", "the", "boundary", "detector", "is", "turned", "on", "at", "a", "time", "step", "of", "layer", "(", "i.e.", ",", "when", "the", "boundary", "state", "is", "1", ")", ",", "the", "model", "considers", "this", "to", "be", "the", "end", "of", "a", "segment", "corresponding", "to", "the", "latent", "abstraction", "level", "of", "that", "layer", "(", "e.g.", ",", "word", "or", "phrase", ")", "and", "feeds", "the", "summarized", "representation", "of", "the", "detected", "segment", "into", "the", "upper", "layer", "(", "+", "1", ")", ".", "Using", "the", "boundary", "states", ",", "at", "each", "time", "step", ",", "each", "layer", "selects", "one", "of", "the", "following", "operations", ":", "UPDATE", ",", "COPY", "or", "FLUSH", ".", "The", "selection", "is", "determined", "by", "(", "1", ")", "the", "boundary", "state", "of", "the", "current", "time", "step", "in", "the", "layer", "below", "z", "\u22121", "t", "and", "(", "2", ")", "the", "boundary", "state", "of", "the", "previous", "time", "step", "in", "the", "same", "layer", "z", "t\u22121", ".", "In", "the", "following", ",", "we", "describe", "an", "HM", "-", "RNN", "based", "on", "the", "LSTM", "update", "rule", ".", "We", "call", "this", "model", "a", "hierarchical", "multiscale", "LSTM", "(", "HM", "-", "LSTM", ")", ".", "Consider", "an", "HM", "-", "LSTM", "model", "of", "L", "layers", "(", "=", "1", ",", ".", ".", ".", ",", "L", ")", "which", ",", "at", "each", "layer", ",", "performs", "the", "following", "update", "at", "time", "step", "t", ":", "(", "Here", ",", "h", "and", "c", "denote", "the", "hidden", "and", "cell", "states", ",", "respectively", ".", "The", "function", "f", "HM", "-", "LSTM", "is", "implemented", "as", "follows", ".", "First", ",", "using", "the", "two", "boundary", "states", "z", "t\u22121", "and", "z", "\u22121", "t", ",", "the", "cell", "state", "is", "updated", "by", ":", "and", "then", "the", "hidden", "state", "is", "obtained", "by", ":", "Here", ",", "(", "f", ",", "i", ",", "o", ")", "are", "forget", ",", "input", ",", "output", "gates", ",", "and", "g", "is", "a", "cell", "proposal", "vector", ".", "Note", "that", "unlike", "the", "LSTM", ",", "it", "is", "not", "necessary", "to", "compute", "these", "gates", "and", "cell", "proposal", "values", "at", "every", "time", "step", ".", "For", "example", ",", "in", "the", "case", "of", "the", "COPY", "operation", ",", "we", "do", "not", "need", "to", "compute", "any", "of", "these", "values", "and", "thus", "can", "save", "computations", ".", "The", "COPY", "operation", ",", "which", "simply", "performs", "(", "c", "t", ",", "h", "t", ")", "\u2190", "(", "c", "t\u22121", ",", "h", "t\u22121", ")", ",", "implements", "the", "observation", "that", "an", "upper", "layer", "should", "keep", "its", "state", "unchanged", "until", "it", "receives", "the", "summarized", "input", "from", "the", "lower", "layer", ".", "The", "UPDATE", "operation", "is", "performed", "to", "update", "the", "summary", "representation", "of", "the", "layer", "if", "the", "boundary", "z", "\u22121", "t", "is", "detected", "from", "the", "layer", "below", "but", "the", "boundary", "z", "t\u22121", "was", "not", "found", "at", "the", "previous", "time", "step", ".", "Hence", ",", "the", "UPDATE", "operation", "is", "executed", "sparsely", "unlike", "the", "standard", "RNNs", "where", "it", "is", "executed", "at", "every", "time", "step", ",", "making", "it", "computationally", "inefficient", ".", "If", "a", "boundary", "is", "detected", ",", "the", "FLUSH", "operation", "is", "executed", ".", "The", "FLUSH", "operation", "consists", "of", "two", "sub", "-", "operations", ":", "(", "a", ")", "EJECT", "to", "pass", "the", "current", "state", "to", "the", "upper", "layer", "and", "then", "(", "b", ")", "RESET", "to", "reinitialize", "the", "state", "before", "starting", "to", "read", "a", "new", "segment", ".", "This", "operation", "implicitly", "forces", "the", "upper", "layer", "to", "absorb", "the", "summary", "information", "of", "the", "lower", "layer", "segment", ",", "because", "otherwise", "it", "will", "be", "lost", ".", "Note", "that", "the", "FLUSH", "operation", "is", "a", "hard", "reset", "in", "the", "sense", "that", "it", "completely", "erases", "all", "the", "previous", "states", "of", "the", "same", "layer", ",", "which", "is", "different", "from", "the", "soft", "reset", "or", "soft", "forget", "operation", "in", "the", "GRU", "or", "LSTM", ".", "Whenever", "needed", "(", "depending", "on", "the", "chosen", "operation", ")", ",", "the", "gate", "values", "(", "f", "t", ",", "i", "t", ",", "o", "t", ")", ",", "the", "cell", "proposal", "g", "t", ",", "and", "the", "pre", "-", "activation", "of", "the", "boundary", "detectorz", "t", "2", "are", "then", "obtained", "by", ":", "where", "Here", ",", "we", "use", "W", ")", "\u00d7dim", "(", "h", ")", "to", "denote", "state", "transition", "parameters", "from", "layer", "i", "to", "layer", "j", ",", "and", "b", "\u2208", "R", "4dim", "(", "h", ")", "+", "1", "is", "a", "bias", "term", ".", "In", "the", "last", "layer", "L", ",", "the", "2z", "t", "can", "also", "be", "implemented", "as", "a", "function", "of", "h", "t", ",", "e.g.", ",", "z", "t", "=", "hard", "sigm", "(", "U", "h", "t", ")", ".", "top", "-", "down", "connection", "is", "ignored", ",", "and", "we", "use", "h", "0", "t", "=", "x", "t", ".", "Since", "the", "input", "should", "not", "be", "omitted", ",", "we", "set", "z", "0", "t", "=", "1", "for", "all", "t.", "Also", ",", "we", "do", "not", "use", "the", "boundary", "detector", "for", "the", "last", "layer", ".", "The", "hard", "sigm", "is", "defined", "by", "hard", "sigm", "(", "x", ")", "=", "max", "0", ",", "min", "1", ",", "with", "a", "being", "the", "slope", "variable", ".", "Unlike", "the", "standard", "LSTM", ",", "the", "HM", "-", "LSTM", "has", "a", "top", "-", "down", "connection", "from", "(", "+", "1", ")", "to", ",", "which", "is", "allowed", "to", "be", "activated", "only", "if", "a", "boundary", "is", "detected", "at", "the", "previous", "time", "step", "of", "the", "layer", "(", "see", "Eq", ".", "6", ")", ".", "This", "makes", "the", "layer", "to", "be", "initialized", "with", "more", "long", "-", "term", "information", "after", "the", "boundary", "is", "detected", "and", "execute", "the", "FLUSH", "operation", ".", "In", "addition", ",", "the", "input", "from", "the", "lower", "layer", "(", "\u2212", "1", ")", "becomes", "effective", "only", "when", "a", "boundary", "is", "detected", "at", "the", "current", "time", "step", "in", "the", "layer", "(", "\u2212", "1", ")", "due", "to", "the", "binary", "gate", "z", "\u22121", "t", ".", "Figure", "2", "(", "left", ")", "shows", "the", "gating", "mechanism", "of", "the", "HM", "-", "LSTM", "at", "time", "step", "t.", "Finally", ",", "the", "binary", "boundary", "state", "z", "t", "is", "obtained", "by", ":", "For", "the", "binarization", "function", "f", "bound", ":", "R", "\u2192", "{", "0", ",", "1", "}", ",", "we", "can", "either", "use", "a", "deterministic", "step", "function", ":", "or", "sample", "from", "a", "Bernoulli", "distribution", "z", "t", "\u223c", "Bernoulli", "(", "z", "t", ")", ".", "Although", "this", "binary", "decision", "is", "a", "key", "to", "our", "model", ",", "it", "is", "usually", "difficult", "to", "use", "stochastic", "gradient", "descent", "to", "train", "such", "model", "with", "discrete", "decisions", "as", "it", "is", "not", "differentiable", ".", "section", ":", "COMPUTING", "GRADIENT", "OF", "BOUNDARY", "DETECTOR", "Training", "neural", "networks", "with", "discrete", "variables", "requires", "more", "efforts", "since", "the", "standard", "backpropagation", "is", "no", "longer", "applicable", "due", "to", "the", "non", "-", "differentiability", ".", "Among", "a", "few", "methods", "for", "training", "a", "neural", "network", "with", "discrete", "variables", "such", "as", "the", "REINFORCE", "[", "reference", "][", "reference", "]", "and", "the", "straight", "-", "through", "estimator", "[", "reference", "][", "reference", "]", ",", "we", "use", "the", "straightthrough", "estimator", "to", "train", "our", "model", ".", "The", "straight", "-", "through", "estimator", "is", "a", "biased", "estimator", "because", "the", "non", "-", "differentiable", "function", "used", "in", "the", "forward", "pass", "(", "i.e.", ",", "the", "step", "function", "in", "our", "case", ")", "is", "replaced", "by", "a", "differentiable", "function", "during", "the", "backward", "pass", "(", "i.e.", ",", "the", "hard", "sigmoid", "function", "in", "our", "case", ")", ".", "The", "straight", "-", "through", "estimator", ",", "however", ",", "is", "much", "simpler", "and", "often", "works", "more", "efficiently", "in", "practice", "than", "other", "unbiased", "but", "high", "-", "variance", "estimators", "such", "as", "the", "REINFORCE", ".", "The", "straight", "-", "through", "estimator", "has", "also", "been", "used", "in", "[", "reference", "]", "and", "[", "reference", "]", ".", "The", "Slope", "Annealing", "Trick", ".", "In", "our", "experiment", ",", "we", "use", "the", "slope", "annealing", "trick", "to", "reduce", "the", "bias", "of", "the", "straight", "-", "through", "estimator", ".", "The", "idea", "is", "to", "reduce", "the", "discrepancy", "between", "the", "two", "functions", "used", "during", "the", "forward", "pass", "and", "the", "backward", "pass", ".", "That", "is", ",", "by", "gradually", "increasing", "the", "slope", "a", "of", "the", "hard", "sigmoid", "function", ",", "we", "make", "the", "hard", "sigmoid", "be", "close", "to", "the", "step", "function", ".", "Note", "that", "starting", "with", "a", "high", "slope", "value", "from", "the", "beginning", "can", "make", "the", "training", "difficult", "while", "it", "is", "more", "applicable", "later", "when", "the", "model", "parameters", "become", "more", "stable", ".", "In", "our", "experiments", ",", "starting", "from", "slope", "a", "=", "1", ",", "we", "slowly", "increase", "the", "slope", "until", "it", "reaches", "a", "threshold", "with", "an", "appropriate", "scheduling", ".", "section", ":", "EXPERIMENTS", "We", "evaluate", "the", "proposed", "model", "on", "two", "tasks", ",", "character", "-", "level", "language", "modelling", "and", "handwriting", "sequence", "generation", ".", "Character", "-", "level", "language", "modelling", "is", "a", "representative", "example", "of", "discrete", "[", "reference", "]", "1.67", "MRNN", "[", "reference", "]", "1.60", "GF", "-", "LSTM", "[", "reference", "]", "1.58", "Grid", "-", "LSTM", "[", "reference", "]", "1.47", "MI", "-", "LSTM", "1.44", "Recurrent", "Memory", "Array", "Structures", "(", "Rocki", ",", "2016a", ")", "1.40", "SF", "-", "LSTM", "(", "Rocki", ",", "2016b", ")", "\u2021", "1.37", "HyperNetworks", "[", "reference", "]", "1.35", "LayerNorm", "HyperNetworks", "[", "reference", "]", "1.34", "Recurrent", "Highway", "Networks", "[", "reference", "]", "1", "sequence", "modelling", ",", "where", "the", "discrete", "symbols", "form", "a", "distinct", "hierarchical", "multiscale", "structure", ".", "The", "performance", "on", "real", "-", "valued", "sequences", "is", "tested", "on", "the", "handwriting", "sequence", "generation", "in", "which", "a", "relatively", "clear", "hierarchical", "multiscale", "structure", "exists", "compared", "to", "other", "data", "such", "as", "speech", "signals", ".", "section", ":", "CHARACTER", "-", "LEVEL", "LANGUAGE", "MODELLING", "A", "sequence", "modelling", "task", "aims", "at", "learning", "the", "probability", "distribution", "over", "sequences", "by", "minimizing", "the", "negative", "log", "-", "likelihood", "of", "the", "training", "sequences", ":", "where", "\u03b8", "is", "the", "model", "parameter", ",", "N", "is", "the", "number", "of", "training", "sequences", ",", "and", "T", "n", "is", "the", "length", "of", "the", "n", "-", "th", "sequence", ".", "A", "symbol", "at", "time", "t", "of", "sequence", "n", "is", "denoted", "by", "x", "n", "t", ",", "and", "x", "n", "<", "t", "denotes", "all", "previous", "symbols", "at", "time", "t.", "We", "evaluate", "our", "model", "on", "three", "benchmark", "text", "corpora", ":", "(", "1", ")", "Penn", "Treebank", ",", "(", "2", ")", "Text8", "and", "(", "3", ")", "Hutter", "Prize", "Wikipedia", ".", "We", "use", "the", "bits", "-", "per", "-", "character", "(", "BPC", ")", ",", "E", "[", "\u2212", "log", "2", "p", "(", "x", "t", "+", "1", "|", "x", "\u2264t", ")", "]", ",", "as", "the", "evaluation", "metric", ".", "Model", "We", "use", "a", "model", "consisting", "of", "an", "input", "embedding", "layer", ",", "an", "RNN", "module", "and", "an", "output", "module", ".", "The", "input", "embedding", "layer", "maps", "each", "input", "symbol", "into", "128", "-", "dimensional", "continuous", "vector", "without", "using", "any", "non", "-", "linearity", ".", "The", "RNN", "module", "is", "the", "HM", "-", "LSTM", ",", "described", "in", "Section", "3", ",", "with", "three", "layers", ".", "The", "output", "module", "is", "a", "feedforward", "neural", "network", "with", "two", "layers", ",", "an", "output", "embedding", "layer", "and", "a", "softmax", "layer", ".", "Figure", "2", "(", "right", ")", "shows", "a", "diagram", "of", "the", "output", "module", ".", "At", "each", "time", "step", ",", "the", "output", "embedding", "layer", "receives", "the", "hidden", "states", "of", "the", "three", "RNN", "layers", "as", "input", ".", "In", "order", "to", "adaptively", "control", "the", "importance", "of", "each", "layer", "at", "each", "time", "step", ",", "we", "also", "introduce", "three", "scalar", "gating", "units", "g", "t", "\u2208", "R", "to", "each", "of", "the", "layer", "outputs", ":", "where", "w", "\u2208", "R", "L", "=", "1", "dim", "(", "h", ")", "is", "the", "weight", "parameter", ".", "The", "output", "embedding", "h", "e", "t", "is", "computed", "by", ":", "where", "L", "=", "3", "and", "ReLU", "(", "x", ")", "=", "max", "(", "0", ",", "x", ")", "[", "reference", "]", ".", "Finally", ",", "the", "probability", "distribution", "for", "the", "next", "target", "character", "is", "computed", "by", "the", "softmax", "function", ",", "softmax", "(", "xj", ")", "=", ",", "where", "each", "output", "class", "is", "a", "character", ".", "section", ":", "Text8", "Model", "BPC", "td", "-", "LSTM", "1.63", "HF", "-", "MRNN", "1.54", "MI", "-", "RNN", "1.52", "Skipping", "-", "RNN", "[", "reference", "]", "Table", "2", ":", "BPC", "on", "the", "Text8", "test", "set", ".", "Penn", "Treebank", "We", "process", "the", "Penn", "Treebank", "dataset", "[", "reference", "]", "by", "following", "the", "procedure", "introduced", "in", ".", "Each", "update", "is", "done", "by", "using", "a", "mini", "-", "batch", "of", "64", "examples", "of", "length", "100", "to", "prevent", "the", "memory", "overflow", "problem", "when", "unfolding", "the", "RNN", "in", "time", "for", "backpropagation", ".", "The", "last", "hidden", "state", "of", "a", "sequence", "is", "used", "to", "initialize", "the", "hidden", "state", "of", "the", "next", "sequence", "to", "approximate", "the", "full", "backpropagation", ".", "We", "train", "the", "model", "using", "Adam", "[", "reference", "]", "with", "an", "initial", "learning", "rate", "of", "0.002", ".", "We", "divide", "the", "learning", "rate", "by", "a", "factor", "of", "50", "when", "the", "validation", "negative", "log", "-", "likelihood", "stopped", "decreasing", ".", "The", "norm", "of", "the", "gradient", "is", "clipped", "with", "a", "threshold", "of", "1", "[", "reference", "][", "reference", "]", ".", "We", "also", "apply", "layer", "normalization", "[", "reference", "]", ")", "to", "our", "models", ".", "For", "all", "of", "the", "character", "-", "level", "language", "modelling", "experiments", ",", "we", "apply", "the", "same", "procedure", ",", "but", "only", "change", "the", "number", "of", "hidden", "units", ",", "mini", "-", "batch", "size", "and", "the", "initial", "learning", "rate", ".", "For", "the", "Penn", "Treebank", "dataset", ",", "we", "use", "512", "units", "in", "each", "layer", "of", "the", "HM", "-", "LSTM", "and", "for", "the", "output", "embedding", "layer", ".", "In", "Table", "1", "(", "left", ")", ",", "we", "compare", "the", "test", "BPCs", "of", "four", "variants", "of", "our", "model", "to", "other", "baseline", "models", ".", "Note", "that", "the", "HM", "-", "LSTM", "using", "the", "step", "function", "for", "the", "hard", "boundary", "decision", "outperforms", "the", "others", "using", "either", "sampling", "or", "soft", "boundary", "decision", "(", "i.e.", ",", "hard", "sigmoid", ")", ".", "The", "test", "BPC", "is", "further", "improved", "with", "the", "slope", "annealing", "trick", ",", "which", "reduces", "the", "bias", "of", "the", "straight", "-", "through", "estimator", ".", "We", "increased", "the", "slope", "a", "with", "the", "following", "schedule", "a", "=", "min", "(", "5", ",", "1", "+", "0.04", "\u00b7", "N", "epoch", ")", ",", "where", "N", "epoch", "is", "the", "maximum", "number", "of", "epochs", ".", "The", "HM", "-", "LSTM", "achieves", "test", "BPC", "score", "of", "1.24", ".", "For", "the", "remaining", "tasks", ",", "we", "fixed", "the", "hard", "boundary", "decision", "using", "the", "step", "function", "without", "slope", "annealing", "due", "to", "the", "difficulty", "of", "finding", "a", "good", "annealing", "schedule", "on", "large", "-", "scale", "datasets", ".", "section", ":", "Text8", "The", "Text8", "dataset", "(", "Mahoney", ",", "2009", ")", "consists", "of", "100", "M", "characters", "extracted", "from", "the", "Wikipedia", "corpus", ".", "Text8", "contains", "only", "alphabets", "and", "spaces", ",", "and", "thus", "we", "have", "total", "27", "symbols", ".", "In", "order", "to", "compare", "with", "other", "previous", "works", ",", "we", "follow", "the", "data", "splits", "used", "in", ".", "We", "use", "1024", "units", "for", "each", "HM", "-", "LSTM", "layer", "and", "2048", "units", "for", "the", "output", "embedding", "layer", ".", "The", "mini", "-", "batch", "size", "and", "the", "initial", "learning", "rate", "are", "set", "to", "128", "and", "0.001", ",", "respectively", ".", "The", "results", "are", "shown", "in", "Table", "2", ".", "The", "HM", "-", "LSTM", "obtains", "the", "state", "-", "of", "-", "the", "-", "art", "test", "BPC", "1.29", ".", "Hutter", "Prize", "Wikipedia", "The", "Hutter", "Prize", "Wikipedia", "(", "enwik8", ")", "dataset", "[", "reference", "]", "contains", "205", "symbols", "including", "XML", "markups", "and", "special", "characters", ".", "We", "follow", "the", "data", "splits", "used", "in", "[", "reference", "]", "where", "the", "first", "90", "M", "characters", "are", "used", "to", "train", "the", "model", ",", "the", "next", "5", "M", "characters", "for", "validation", ",", "and", "the", "remainders", "for", "the", "test", "set", ".", "We", "use", "the", "same", "model", "size", ",", "mini", "-", "batch", "size", "and", "the", "initial", "learning", "rate", "as", "in", "the", "Text8", ".", "In", "Table", "1", "(", "right", ")", ",", "we", "show", "the", "HM", "-", "LSTM", "achieving", "the", "test", "BPC", "1.32", ",", "which", "is", "a", "tie", "with", "the", "state", "-", "of", "-", "the", "-", "art", "result", "among", "the", "neural", "models", ".", "Although", "the", "neural", "models", ",", "show", "remarkable", "performances", ",", "their", "compression", "performance", "is", "still", "behind", "the", "best", "models", "such", "as", "PAQ8hp12", "[", "reference", "]", "and", "decomp8", "[", "reference", "]", ".", "Visualizing", "Learned", "Hierarchical", "Multiscale", "Structure", "In", "Figure", "3", "and", "4", ",", "we", "visualize", "the", "boundaries", "detected", "by", "the", "boundary", "detectors", "of", "the", "HM", "-", "LSTM", "while", "reading", "a", "character", "sequence", "of", "total", "length", "270", "taken", "from", "the", "validation", "set", "of", "either", "the", "Penn", "Treebank", "or", "Hutter", "Prize", "Wikipedia", "dataset", ".", "Due", "to", "the", "page", "width", "limit", ",", "the", "figure", "contains", "the", "sequence", "partitioned", "into", "three", "segments", "of", "length", "90", ".", "The", "white", "blocks", "indicate", "boundaries", "z", "t", "=", "1", "while", "the", "black", "blocks", "indicate", "the", "non", "-", "boundaries", "z", "t", "=", "0", ".", "Interestingly", "in", "both", "figures", ",", "we", "can", "observe", "that", "the", "boundary", "detector", "of", "the", "first", "layer", ",", "z", "1", ",", "tends", "to", "be", "turned", "on", "when", "it", "sees", "a", "space", "or", "after", "it", "sees", "a", "space", ",", "which", "is", "a", "reasonable", "breakpoint", "to", "separate", "between", "words", ".", "This", "is", "somewhat", "surprising", "because", "the", "model", "self", "-", "organizes", "this", "structure", "without", "any", "explicit", "boundary", "information", ".", "In", "Figure", "3", ",", "we", "observe", "that", "the", "z", "1", "tends", "to", "detect", "the", "boundaries", "of", "the", "words", "but", "also", "fires", "within", "the", "words", ",", "where", "the", "z", "2", "tends", "to", "fire", "when", "it", "sees", "either", "an", "end", "of", "a", "word", "or", "2", ",", "3", "-", "grams", ".", "In", "Figure", "4", ",", "we", "also", "see", "flushing", "in", "the", "middle", "of", "a", "word", ",", "e.g.", ",", "\"", "tele", "-", "FLUSH", "-", "phone", "\"", ".", "Note", "that", "\"", "tele", "\"", "is", "a", "prefix", "after", "which", "a", "various", "number", "of", "postfixes", "can", "follow", ".", "From", "these", ",", "it", "seems", "that", "the", "model", "uses", "to", "some", "extent", "the", "concept", "of", "surprise", "to", "learn", "the", "boundary", ".", "Although", "interpretation", "of", "the", "second", "layer", "boundaries", "is", "not", "as", "apparent", "as", "the", "first", "layer", "boundaries", ",", "it", "seems", "to", "segment", "at", "reasonable", "semantic", "/", "syntactic", "boundaries", ",", "e.g.", ",", "\"", "consumers", "may", "\"", "-", "\"want", "to", "move", "their", "telephones", "a", "\"", "-", "\"little", "closer", "to", "the", "tv", "set", "<", "unk", ">", "\"", ",", "and", "so", "on", ".", "Another", "remarkable", "point", "is", "the", "fact", "that", "we", "do", "not", "pose", "any", "constraint", "on", "the", "number", "of", "boundaries", "that", "the", "model", "can", "fire", "up", ".", "The", "model", ",", "however", ",", "learns", "that", "it", "is", "more", "beneficial", "to", "delay", "the", "information", "ejection", "to", "some", "extent", ".", "This", "is", "somewhat", "counterintuitive", "because", "it", "might", "look", "more", "beneficial", "to", "feed", "the", "fresh", "update", "to", "the", "upper", "layers", "at", "every", "time", "step", "without", "any", "delay", ".", "We", "conjecture", "the", "reason", "that", "the", "model", "works", "in", "this", "way", "is", "due", "to", "the", "FLUSH", "operation", "that", "poses", "an", "implicit", "constraint", "on", "the", "frequency", "of", "boundary", "detection", ",", "because", "it", "contains", "both", "a", "reward", "(", "feeding", "fresh", "information", "to", "upper", "layers", ")", "and", "a", "penalty", "(", "erasing", "accumulated", "information", ")", ".", "The", "model", "finds", "an", "optimal", "balance", "between", "the", "reward", "and", "the", "penalty", ".", "To", "understand", "the", "update", "mechanism", "more", "intuitively", ",", "in", "Figure", "4", ",", "we", "also", "depict", "the", "heatmap", "of", "the", "2", "-", "norm", "of", "the", "hidden", "states", "along", "with", "the", "states", "of", "the", "boundary", "detectors", ".", "As", "we", "expect", ",", "we", "can", "see", "that", "there", "is", "no", "change", "in", "the", "norm", "value", "within", "segments", "due", "to", "the", "COPY", "operation", ".", "Also", ",", "the", "color", "of", "h", "1", "changes", "quickly", "(", "at", "every", "time", "step", ")", "because", "there", "is", "no", "COPY", "operation", "in", "the", "first", "layer", ".", "The", "color", "of", "h", "2", "changes", "less", "frequently", "based", "on", "the", "states", "of", "z", "1", "t", "and", "z", "2", "t\u22121", ".", "The", "color", "of", "h", "3", "changes", "even", "slowly", ",", "i.e.", ",", "only", "when", "z", "2", "t", "=", "1", ".", "A", "notable", "advantage", "of", "the", "proposed", "architecture", "is", "that", "the", "internal", "process", "of", "the", "RNN", "becomes", "more", "interpretable", ".", "For", "example", ",", "we", "can", "substitute", "the", "states", "of", "z", "1", "t", "and", "z", "2", "t\u22121", "into", "Eq", ".", "2", "and", "infer", "which", "operation", "among", "the", "UPDATE", ",", "COPY", "and", "FLUSH", "was", "applied", "to", "the", "second", "layer", "at", "time", "step", "t.", "We", "can", "also", "inspect", "the", "update", "frequencies", "of", "the", "layers", "simply", "by", "counting", "how", "many", "UPDATE", "and", "FLUSH", "operations", "were", "made", "in", "each", "layer", ".", "For", "example", "in", "Figure", "4", ",", "we", "see", "that", "the", "first", "layer", "updates", "at", "every", "time", "step", "(", "which", "is", "270", "UPDATE", "operations", ")", ",", "the", "second", "layer", "updates", "56", "times", ",", "Figure", "5", ":", "The", "visualization", "by", "segments", "based", "on", "either", "the", "given", "pen", "-", "tip", "location", "or", "states", "of", "the", "z", "2", ".", "and", "only", "9", "updates", "has", "made", "in", "the", "third", "layer", ".", "Note", "that", ",", "by", "design", ",", "the", "first", "layer", "performs", "UPDATE", "operation", "at", "every", "time", "step", "and", "then", "the", "number", "of", "UPDATE", "operations", "decreases", "as", "the", "layer", "level", "increases", ".", "In", "this", "example", ",", "the", "total", "number", "of", "updates", "is", "335", "for", "the", "HM", "-", "LSTM", "which", "is", "60", "%", "of", "reduction", "from", "the", "810", "updates", "of", "the", "standard", "RNN", "architecture", ".", "section", ":", "HANDWRITING", "SEQUENCE", "GENERATION", "We", "extend", "the", "evaluation", "of", "the", "HM", "-", "LSTM", "to", "a", "real", "-", "valued", "sequence", "modelling", "task", "using", "IAMOnDB", "[", "reference", "]", "dataset", ".", "The", "IAM", "-", "OnDB", "dataset", "consists", "of", "12", ",", "179", "handwriting", "examples", ",", "each", "of", "which", "is", "a", "sequence", "of", "(", "x", ",", "y", ")", "coordinate", "and", "a", "binary", "indicator", "p", "for", "pen", "-", "tip", "location", ",", "giving", "us", "(", "x", "1:T", "n", ",", "y", "1:T", "n", ",", "p", "1:T", "n", ")", ",", "where", "n", "is", "an", "index", "of", "a", "sequence", ".", "At", "each", "time", "step", ",", "the", "model", "receives", "(", "x", "t", ",", "y", "t", ",", "p", "t", ")", ",", "and", "the", "goal", "is", "to", "predict", "(", "x", "t", "+", "1", ",", "y", "t", "+", "1", ",", "p", "t", "+", "1", ")", ".", "The", "pen", "-", "up", "(", "p", "t", "=", "1", ")", "indicates", "an", "end", "of", "a", "stroke", ",", "and", "the", "pen", "-", "down", "(", "p", "t", "=", "0", ")", "indicates", "that", "a", "stroke", "is", "in", "progress", ".", "There", "is", "usually", "a", "large", "shift", "in", "the", "(", "x", ",", "y", ")", "coordinate", "to", "start", "a", "new", "stroke", "after", "the", "pen", "-", "up", "happens", ".", "We", "remove", "all", "sequences", "whose", "length", "is", "shorter", "than", "300", ".", "This", "leaves", "us", "10", ",", "465", "sequences", "for", "training", ",", "581", "for", "validation", ",", "582", "for", "test", ".", "The", "average", "length", "of", "the", "sequences", "is", "648", ".", "We", "normalize", "the", "range", "of", "the", "(", "x", ",", "y", ")", "coordinates", "separately", "with", "the", "mean", "and", "standard", "deviation", "obtained", "from", "the", "training", "set", ".", "We", "use", "the", "mini", "-", "batch", "size", "of", "32", ",", "and", "the", "initial", "learning", "rate", "is", "set", "to", "0.0003", ".", "We", "use", "the", "same", "model", "architecture", "as", "used", "in", "the", "character", "-", "level", "language", "model", ",", "except", "that", "the", "output", "layer", "is", "modified", "to", "predict", "real", "-", "valued", "outputs", ".", "We", "use", "the", "mixture", "density", "network", "as", "the", "output", "layer", "following", "[", "reference", "]", ",", "and", "use", "400", "units", "for", "each", "HM", "-", "LSTM", "layer", "and", "for", "the", "output", "embedding", "layer", ".", "In", "Table", "3", ",", "we", "compare", "the", "log", "-", "likelihood", "averaged", "over", "the", "test", "sequences", "of", "the", "IAM", "-", "OnDB", "dataset", ".", "We", "observe", "that", "the", "HM", "-", "LSTM", "outperforms", "the", "standard", "LSTM", ".", "The", "slope", "annealing", "trick", "further", "improves", "the", "test", "log", "-", "likelihood", "of", "the", "HM", "-", "LSTM", "into", "1167", "in", "our", "setting", ".", "In", "this", "experiment", ",", "we", "increased", "the", "slope", "a", "with", "the", "following", "schedule", "a", "=", "min", "(", "3", ",", "1", "+", "0.004", "\u00b7", "N", "epoch", ")", ".", "In", "Figure", "5", ",", "we", "let", "the", "HM", "-", "LSTM", "to", "read", "a", "randomly", "picked", "validation", "sequence", "and", "present", "the", "visualization", "of", "handwriting", "examples", "by", "segments", "based", "on", "either", "the", "states", "of", "z", "2", "or", "the", "states", "of", "pen", "-", "tip", "location", "3", ".", "section", ":", "CONCLUSION", "In", "this", "paper", ",", "we", "proposed", "the", "HM", "-", "RNN", "that", "can", "capture", "the", "latent", "hierarchical", "structure", "of", "the", "sequences", ".", "We", "introduced", "three", "types", "of", "operations", "to", "the", "RNN", ",", "which", "are", "the", "COPY", ",", "UPDATE", "and", "FLUSH", "operations", ".", "In", "order", "to", "implement", "these", "operations", ",", "we", "introduced", "a", "set", "of", "binary", "variables", "and", "a", "novel", "update", "rule", "that", "is", "dependent", "on", "the", "states", "of", "these", "binary", "variables", ".", "Each", "binary", "variable", "is", "learned", "to", "find", "segments", "at", "its", "level", ",", "therefore", ",", "we", "call", "this", "binary", "variable", ",", "a", "boundary", "detector", ".", "On", "the", "character", "-", "level", "language", "modelling", ",", "the", "HM", "-", "LSTM", "achieved", "state", "-", "of", "-", "the", "-", "art", "result", "on", "the", "Text8", "dataset", "and", "comparable", "results", "to", "the", "state", "-", "of", "-", "the", "-", "art", "results", "on", "the", "Penn", "Treebank", "and", "Hutter", "Prize", "Wikipedia", "datasets", ".", "Also", ",", "the", "HM", "-", "LSTM", "outperformed", "the", "standard", "LSTM", "on", "the", "handwriting", "sequence", "generation", ".", "Our", "results", "and", "analysis", "suggest", "that", "the", "proposed", "HM", "-", "RNN", "can", "discover", "the", "latent", "hierarchical", "structure", "of", "the", "sequences", "and", "can", "learn", "efficient", "hierarchical", "multiscale", "representation", "that", "leads", "to", "better", "generalization", "performance", ".", "section", ":", "section", ":", "ACKNOWLEDGMENTS", "The", "authors", "would", "like", "to", "thank", "Alex", "Graves", ",", "Tom", "Schaul", "and", "Hado", "van", "Hasselt", "for", "their", "fruitful", "comments", "and", "discussion", ".", "We", "acknowledge", "the", "support", "of", "the", "following", "agencies", "for", "research", "funding", "and", "computing", "support", ":", "Ubisoft", ",", "Samsung", ",", "IBM", ",", "Facebook", ",", "Google", ",", "Microsoft", ",", "NSERC", ",", "Calcul", "Qu\u00e9bec", ",", "Compute", "Canada", ",", "the", "Canada", "Research", "Chairs", "and", "CIFAR", ".", "The", "authors", "thank", "the", "developers", "of", "Theano", "[", "reference", "]", ".", "JC", "would", "like", "to", "thank", "Arnaud", "Bergenon", "and", "Fr\u00e9d\u00e9ric", "Bastien", "for", "their", "technical", "support", ".", "JC", "would", "also", "like", "to", "thank", "Guillaume", "Alain", ",", "Kyle", "Kastner", "and", "David", "Ha", "for", "providing", "us", "useful", "pieces", "of", "code", ".", "section", ":"]}