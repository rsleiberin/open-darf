name: Config Validate
on:
  pull_request:
    branches: [ main ]
    paths:
      - 'packages/darf_config/**'
      - 'scripts/config_validate.py'
      - 'configs/.env.sample'
      - '.github/workflows/config-validate.yml'
  push:
    branches: [ feat/phase7g-config ]
    paths:
      - 'packages/darf_config/**'
      - 'scripts/config_validate.py'
      - 'configs/.env.sample'
      - '.github/workflows/config-validate.yml'
jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      - name: Install pydantic v1
        run: pip install "pydantic<2"
      - name: Prepare env
        run: |
          mkdir -p configs
          cp configs/.env.sample configs/.env.local
      - name: Run config validation
        run: PYTHONPATH=. python scripts/config_validate.py
